<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Ultimate Loan Officer Sales Coach</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
          <!-- SWITCH TO CLASS MODE -->
    <script>
      tailwind.config = {
        darkMode: 'class'
      }
    </script>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#002B5C">
    <style>
        
     .dark { 
        background: linear-gradient(to bottom, #1a202c, #0f172a); 
        color: #e2e8f0; 
    }

    .card { 
        transition: transform 0.2s, box-shadow 0.2s; 
    }
    .card:hover { 
    transform: translateY(-8px) !important;  /* Lighter than scale — fixes GPU delay, keeps lift effect */
    box-shadow: 0 20px 40px rgba(0,168,157,0.5); 
}

    .accordion-content { 
        max-height: 0; 
        overflow: hidden; 
        transition: max-height 0.3s ease; 
    }
    .accordion-content.open { 
        max-height: 3000px; 
    }

    /* === HEADER - BOLDER & DARKER === */
    header {
        background: linear-gradient(to right, #001429, #002b5c) !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
    }

    /* === SIDEBAR - BOLDER & DARKER === */
    #sidebar {
        background: linear-gradient(to bottom, #001429, #001f3f) !important;
        box-shadow: 12px 0 40px rgba(0, 0, 0, 0.7);
    }

    /* === SIDEBAR GROUP BUTTONS - MORE IMPACT === */
    .sidebar-group {
        font-weight: 900;
        color: white;
        padding: 20px 28px;
        text-transform: uppercase;
        font-size: 1.1rem;
        letter-spacing: 2.2px;
        background-color: rgba(0, 31, 63, 0.9);
        border-radius: 20px;
        margin: 20px 24px 16px 24px;
        text-align: center;
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(12px);
        border: 3px solid rgba(0, 168, 157, 0.9);
        transition: all 0.4s ease;
    }

    .sidebar-group:hover {
        background-color: rgba(0, 43, 92, 1);
        border-color: #00A89D;
        transform: translateY(-6px) scale(1.03);
        box-shadow: 0 20px 50px rgba(0, 168, 157, 0.5);
    }

    .accordion button[aria-expanded="true"] i.fa-chevron-down,
    .accordion-content.open + button i.fa-chevron-down,
    .accordion button .fa-chevron-down {
        transition: transform 0.3s ease;
    }
    .accordion button[aria-expanded="true"] .fa-chevron-down {
        transform: rotate(180deg);
    }

    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.6);
        backdrop-filter: blur(8px);
    }

    .modal-content {
        background-color: #ffffff;
        color: #1f2937;
        margin: 10% auto;
        padding: 32px;
        border-radius: 24px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        max-width: 800px;
        max-height: 80vh;
        overflow-y: auto;
        border: 2px solid #00A89D;
    }

    .dark .modal-content {
        background-color: #1f2937;
        color: #f3f4f6;
    }

    .modal-content p,
    .modal-content ul,
    .modal-content li,
    .modal-content h1,
    .modal-content h2,
    .modal-content h3,
    .modal-content h4 {
        color: inherit;
    }

    .modal-header {
        text-align: center;
        margin-bottom: 24px;
    }
    .modal-header h3 {
        font-size: 2.5rem;
        font-weight: bold;
        color: #F15A29;
    }
    .close-modal {
        color: #aaa;
        float: right;
        font-size: 48px;
        font-weight: bold;
        cursor: pointer;
        position: absolute;
        top: 16px;
        right: 32px;
    }
    .close-modal:hover { color: #F15A29; }
    .dark .close-modal { color: #cbd5e1; }
    .dark .close-modal:hover { color: #F15A29; }

    /* Fixed: Use @apply correctly */
    .modal-suggestions {
        @apply space-y-6;
    }

    .modal-suggestions li {
        padding: 16px;
        background: linear-gradient(to right, #002B5C/5, #00A89D/5);
        border-radius: 16px;
        border-left: 6px solid #00A89D;
        font-size: 1.1rem;
    }

    /* === DETAIL MODAL: Most reliable repaint method === */
        /* === DETAIL MODAL: Most reliable repaint method === */
    #detail-modal {
        opacity: 0;
        transition: opacity 0.2s ease;
        position: fixed;
        inset: 0;
        /* ADD THIS LINE - forces GPU layer and fixes offset/repaint bug */
        transform: translateZ(0);
        backface-visibility: hidden;
    }

    #detail-modal[style*="flex"] {
        opacity: 1;
    }

    /* Eliminate top gap */
    main {
        padding-top: 0 !important;
        margin-top: 0 !important;
    }
    main > section {
        margin-top: 0 !important;
        padding-top: 1.5rem !important;
    }
    main section > *:first-child {
        margin-top: 0 !important;
    }

    /* Input readability */
    input[type="text"],
    input[type="number"],
    input[type="search"],
    textarea,
    select {
        background-color: #ffffff !important;
        color: #1f2937 !important;
    }

    .dark input[type="text"],
    .dark input[type="number"],
    .dark input[type="search"],
    .dark textarea,
    .dark select {
        background-color: #1f2937 !important;
        color: #f3f4f6 !important;
        border-color: #4b5563 !important;
    }

    input::placeholder,
    textarea::placeholder {
        color: #9ca3af !important;
        opacity: 1;
    }
    .dark input::placeholder,
    .dark textarea::placeholder {
        color: #9ca3af !important;
    }

    /* Unified AI Tool Styling */
    .ai-tool-wrapper {
        @apply bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12;
    }

    .ai-tool-wrapper label {
        @apply block text-lg font-semibold mb-3 text-[#00A89D];
    }

    .ai-tool-wrapper select,
    .ai-tool-wrapper input[type="text"],
    .ai-tool-wrapper textarea {
        @apply w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all;
    }

    .ai-tool-wrapper .generate-btn {
        @apply w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl mt-8;
    }

    .ai-tool-wrapper .copy-btn {
        @apply bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md;
    }

    .ai-tool-wrapper .loading-spinner {
        @apply text-center py-12;
    }

    .ai-tool-wrapper .loading-spinner i {
        @apply fas fa-spinner fa-spin text-6xl text-[#00A89D];
    }

    .ai-tool-output {
        @apply bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96;
    }

    /* Mobile safe area */
    @supports (padding-top: env(safe-area-inset-top)) {
        body {
            padding-top: env(safe-area-inset-top);
        }
    }
    
    header, 
    #sidebar, 
    main {
        padding-top: env(safe-area-inset-top);
    }

    .tab-btn {
        @apply px-10 py-4 font-bold text-xl bg-gray-300 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-t-lg transition-all;
    }

    .tab-btn.active {
        @apply bg-[#F15A29] text-white;
    }
    /* Nuclear fix for Chrome fixed modal offset + repaint delay */
#detail-modal {
    opacity: 0;
    transition: opacity 0.2s ease;
    position: fixed !important;
    inset: 0 !important;
    transform: translateZ(0);           /* Promote to GPU layer */
    backface-visibility: hidden;        /* Stabilize fixed positioning */
    will-change: opacity;               /* Hint to browser */
}

#detail-modal[style*="flex"] {
    opacity: 1;
}
#detail-modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 50;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    overflow: auto;
}
#detail-modal.flex {
    display: flex;
}
.force-reflow {
    opacity: 0.99;  /* Tiny change forces repaint without visual flicker */
}
main, #equity-scanner, #equity-output, #opportunity-cards {
    overflow: visible !important;
    overscroll-behavior: auto !important;
}

/* Reduce GPU aggression on detail modal (keeps fixes but less repaint bugs) */
#detail-modal {
    transform: none !important;  /* Remove translateZ(0) — it's often the repaint offender */
    will-change: auto !important;
}
.animate-scroll {
    animation: scroll 45s linear infinite; /* Adjust 45s for faster/slower scroll */
}

@keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); } /* -50% because quotes are duplicated */
}

#quote-display {
    opacity: 1;
    transition: opacity 0.8s ease-in-out;
}

#quote-display.fade {
    opacity: 0;
}
</style>
</head>
<body class="bg-gradient-to-br from-gray-100 to-white dark:from-gray-900 dark:to-gray-800 text-gray-900 dark:text-gray-100 min-h-screen font-sans">
                <header class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white py-6 shadow-2xl">
    <div class="max-w-7xl mx-auto px-6">
        <h1 class="text-4xl md:text-5xl font-bold text-center mb-10">Ultimate Loan Officer Sales Coach</h1>
        
        <div class="max-w-2xl mx-auto mb-6">
            <div class="relative">
                <input type="text" id="search" placeholder="Search for tips, scripts, or tools..." 
                       class="w-full p-4 pr-14 rounded-full bg-white/20 backdrop-blur-md border border-white/30 text-white placeholder-white/70 focus:outline-none focus:ring-4 focus:ring-white/50 text-lg">
                <i class="fas fa-search absolute right-5 top-1/2 -translate-y-1/2 text-white text-xl"></i>
            </div>
        </div>

<!-- Single Quote Display with Manual Arrows & Auto-Rotation – Compact Size -->
<div class="relative bg-gradient-to-r from-[#002B5C] to-[#00A89D] py-3 my-8 rounded-3xl shadow-2xl text-center overflow-hidden max-w-3xl mx-auto">
    <!-- Quote Container – reduced padding & height -->
    <div id="quote-display" class="text-xl md:text-2xl font-bold text-white opacity-90 min-h-[60px] flex items-center justify-center px-6 transition-opacity duration-800">
        "The harder you work, the luckier you get."
    </div>

    <!-- Left Arrow (smaller & positioned tighter) -->
    <button id="quote-prev" class="absolute left-4 top-1/2 -translate-y-1/2 text-white/50 hover:text-white text-4xl font-light transition-all duration-300 z-10 opacity-70 hover:opacity-100">
        ‹
    </button>

    <!-- Right Arrow -->
    <button id="quote-next" class="absolute right-4 top-1/2 -translate-y-1/2 text-white/50 hover:text-white text-4xl font-light transition-all duration-300 z-10 opacity-70 hover:opacity-100">
        ›
    </button>
</div>

        <i class="fas fa-bars cursor-pointer text-3xl absolute top-8 right-6 md:hidden" id="menu-toggle"></i>
    </div>
</header>
             <aside id="sidebar" class="fixed left-[-300px] top-0 bottom-0 w-72 bg-gradient-to-b from-[#002B5C] to-[#00A89D] text-white overflow-y-auto transition-left duration-300 ease-in-out z-50 shadow-2xl rounded-r-xl md:left-0 md:w-64 lg:w-72">
        <ul class="p-6 space-y-3">
            <li class="sidebar-group">A.I. Tools</li>
            <li><a href="#weekly-win-plan" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-fire mr-3"></i> Weekly Win Plan
</a></li>
            <li><a href="#equity-scanner" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-comment-dots mr-3"></i> Equity & Opportunity Scanner
</a></li>
<li><a href="#social-post" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-share-alt mr-3"></i> Social Media Post Creator
</a></li>
<li><a href="#blog" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-pen-fancy mr-3"></i> Blog Creator
</a></li>
<li><a href="#sales-script" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-comment-dots mr-3"></i> Sales Script Generator
</a></li>
<li><a href="#underwriting-search" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-search-dollar mr-3"></i> Underwriting Guideline Search
</a></li>
                      <li><a href="#ai-chat" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-robot mr-3"></i> AI Chat Assistant
</a></li>
                        <li class="sidebar-group">Marketing</li>
            <li><a href="#prospecting" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-search mr-3"></i>Prospecting</a></li>
            <li><a href="#social" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-share-alt mr-3"></i>Social Media</a></li>
            <li><a href="#eventplanning" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-search mr-3"></i>Event Planning</a></li>
            <li class="sidebar-group">Partners & Nurturing</li>
            <li><a href="#referrals" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-handshake mr-3"></i>Referral Partners</a></li>
            <li><a href="#value-vault" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-gem mr-3"></i>Value Vault</a></li>
            <li><a href="#database" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-database mr-3"></i>Database Nurturing</a></li>
            <li class="sidebar-group">Planning & Process</li>
            <li><a href="#planning" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-chart-line mr-3"></i>Business Planning</a></li>
            <li><a href="#process" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-cogs mr-3"></i>Loan Process</a></li>
            <li class="sidebar-group">Tools & Resources</li>
            <li><a href="#resources" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-tools mr-3"></i>Resources</a></li>
            <li><a href="#mindset-motivation" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-brain mr-3"></i>Mindset & Motivation</a></li>
            <li><a href="#books" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-book mr-3"></i>Book Recommendations</a></li>
            <li><a href="#calculator" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-calculator mr-3"></i>Calculator</a></li>
            </ul>
    </aside>
    <!-- AI Chat Assistant - Persistent on every page -->
<div class="fixed bottom-4 right-4 z-50">
    <button onclick="showSection('ai-chat')" 
            class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white p-4 rounded-full shadow-2xl hover:scale-110 transition-all text-2xl">
        <i class="fas fa-robot"></i>
    </button>
</div>

<!-- The full AI Chat section remains where it is, but now accessible from anywhere -->
<main class="p-6 space-y-8 md:ml-64 lg:ml-72 pt-12 bg-gray-50 dark:bg-gray-900 min-h-screen">
    <!-- pt-48 = tight but comfortable spacing below fixed quote bar -->
    <!-- pt-64 gives breathing room below the fixed quote bar -->
                 <section id="mindset-motivation" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Mindset & Motivation</h2>
            <p class="mb-4">Build resilience and stay fired up with principles, quotes, stats, and tips.</p>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Core Pillars & Tips <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Relationship-Building:</strong> Treat interactions as chances to build trust; prioritize care for lasting referrals.</li>
                        <li><strong>Curiosity:</strong> Ask open questions to understand needs: "What challenges are you facing?" Listen 80%, speak 20%.</li>
                        <li><strong>Value-First:</strong> "Help others get what they want." Share resources without expectation.</li>
                        <li><strong>Embrace Challenges:</strong> Overcome to build perseverance; success comes from persistence.</li>
                        <li><strong>Learn from Mistakes:</strong> See errors as growth opportunities: "I’ve found 10,000 ways that won’t work."</li>
                        <li><strong>Encourage Feedback:</strong> Seek from mentors; frame as insights, not criticism.</li>
                        <li><strong>Fill Mind with Positivity:</strong> Consume uplifting content like podcasts/biographies.</li>
                        <li><strong>Attitude Adjustment:</strong> Positive thinking outperforms negative.</li>
                        <li><strong>Persistence:</strong> "Failure is a detour, not dead-end." Bounce back higher.</li>
                        <li><strong>Daily Habits:</strong> Start with gratitude, visualize success, reflect nightly.</li>
                        <li><strong>Self-Belief:</strong> Celebrate wins, reflect on achievements, reward yourself, share to inspire.</li>
                        <li><strong>Enthusiasm:</strong> "For every sale missed from too much enthusiasm, miss 100 from too little."</li>
                        <li><strong>Motivation Daily:</strong> "Motivation doesn’t last, neither does bathing – recommend daily."</li>
                        <li><strong>Helping Over Selling:</strong> "Stop selling. Start helping." Focus on pain points/solutions.</li>
                        <li><strong>Prospecting Mindset:</strong> "Prospecting is the lifeblood of sales; do it daily."</li>
                        <li><strong>Growth:</strong> "Success is 80% mindset, 20% strategy."</li>
                        <li><strong>Giving Value:</strong> "Givers gain; focus on serving first."</li>
                        <li><strong>Word Tracks for Influence:</strong> Use precise language to guide conversations.</li>
                        <li><strong>Authenticity in Prospecting:</strong> Be genuine to build trust quickly.</li>
                        <li><strong>Vision Planning:</strong> "A goal without a plan is just a wish."</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Buffini Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>People do business with those they know, like, and trust.</li>
                        <li>Build relationships first, business second.</li>
                        <li>Embrace challenges for growth.</li>
                        <li>Learn from mistakes as opportunities.</li>
                        <li>Encourage feedback for insights.</li>
                        <li>Fill mind with positivity.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Ziglar Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Your attitude determines your direction.</li>
                        <li>Success is maximum utilization of ability.</li>
                        <li>Stop selling. Start helping.</li>
                        <li>It’s not how far you fall but how high you bounce.</li>
                        <li>Attitude, not aptitude, determines altitude.</li>
                        <li>Make failure your teacher, not undertaker.</li>
                        <li>You don’t have to be great to start, but start to be great.</li>
                        <li>For every sale missed from enthusiasm, miss hundred from lack.</li>
                        <li>People buy for emotional reasons.</li>
                        <li>Top salesperson missed more sales but made more calls.</li>
                        <li>Get all you want by helping others.</li>
                        <li>Learn from defeat, haven’t lost.</li>
                        <li>If not winner in mind, can’t perform as winner.</li>
                        <li>Born to win: plan, prepare, expect.</li>
                        <li>Positive thinking better than negative.</li>
                        <li>Problem-solving key in maturity.</li>
                        <li>Want to earn more, learn more.</li>
                        <li>Motivation gets going, habit gets there.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Phil M. Jones Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>How open-minded are you to exploring options?</li>
                        <li>Just one more thing before you go...</li>
                        <li>When would be a good time to...?</li>
                        <li>If I could, would you...?</li>
                        <li>What makes you say that?</li>
                        <li>How do you mean?</li>
                        <li>Just imagine...</li>
                        <li>The good news is...</li>
                        <li>What happens next is...</li>
                        <li>What do you know about...?</li>
                        <li>Most people in your situation...</li>
                        <li>What would success look like for you?</li>
                        <li>Would it help if...?</li>
                        <li>What's the best outcome for you?</li>
                        <li>How would you feel if...?</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Tom Ferry Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Success is 80% mindset, 20% strategy.</li>
                        <li>Prospect daily or become obsolete.</li>
                        <li>Focus on revenue-generating activities.</li>
                        <li>Build a business, not just a job.</li>
                        <li>Time block for success.</li>
                        <li>Leverage technology for efficiency.</li>
                        <li>Consistent marketing builds brand.</li>
                        <li>Be the knowledge broker.</li>
                        <li>Scale your business with systems.</li>
                        <li>Focus on relationships for referrals.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Mike Ferry Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Prospecting is the lifeblood of your business.</li>
                        <li>Do the work others won't to have what others don't.</li>
                        <li>Scripts are tools for success.</li>
                        <li>Practice daily to master.</li>
                        <li>Own listings for leverage.</li>
                        <li>Call until you connect.</li>
                        <li>Focus on high-payoff activities.</li>
                        <li>Be disciplined in prospecting.</li>
                        <li>Build your database daily.</li>
                        <li>Consistency creates champions.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Ricky Carruth Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Relationships over transactions.</li>
                        <li>Give value freely.</li>
                        <li>Consistency wins.</li>
                        <li>Build your sphere.</li>
                        <li>Follow up relentlessly.</li>
                        <li>Be the go-to expert.</li>
                        <li>Focus on serving.</li>
                        <li>Network with purpose.</li>
                        <li>Personal branding matters.</li>
                        <li>Grow through giving.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Bob Burg Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Givers gain.</li>
                        <li>Focus on serving others.</li>
                        <li>Value first, success follows.</li>
                        <li>Build network through giving.</li>
                        <li>Authenticity key to relationships.</li>
                        <li>The more you give, the more you receive.</li>
                        <li>Success through value creation.</li>
                        <li>Be a go-giver, not go-taker.</li>
                        <li>Compensation determined by value provided.</li>
                        <li>Relationships built on trust.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Brian Tracy Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Successful people are always looking for opportunities to help others.</li>
                        <li>Develop an attitude of gratitude.</li>
                        <li>Goals are the fuel in the furnace of achievement.</li>
                        <li>The key to success is to focus our conscious mind on things we desire not things we fear.</li>
                        <li>Disciplined planning leads to success.</li>
                        <li>Invest in yourself.</li>
                        <li>Continuous learning is key.</li>
                        <li>Time management is life management.</li>
                        <li>Success is getting what you want, happiness is wanting what you get.</li>
                        <li>Leaders think and talk about solutions.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Jeffrey Gitomer Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>People don't like to be sold, but they love to buy.</li>
                        <li>Value first, sales second.</li>
                        <li>Trust is the foundation of sales.</li>
                        <li>Ask questions to uncover needs.</li>
                        <li>Be a resource, not a salesperson.</li>
                        <li>Sales success comes from helping.</li>
                        <li>Build relationships for loyalty.</li>
                        <li>Consistency in follow-up.</li>
                        <li>Learn from every no.</li>
                        <li>Attitude drives sales.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Jill Konrath Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Sell to busy buyers by being concise.</li>
                        <li>Focus on buyer problems.</li>
                        <li>Use agility in sales.</li>
                        <li>Research before calling.</li>
                        <li>Create urgency.</li>
                        <li>Be relevant to needs.</li>
                        <li>Build credibility fast.</li>
                        <li>Avoid pitch, start conversations.</li>
                        <li>Adapt to change.</li>
                        <li>Innovate sales approaches.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Mike Weinberg Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Prospecting is essential; do it authentically.</li>
                        <li>Focus on new business.</li>
                        <li>Be proactive in sales.</li>
                        <li>Avoid excuses, take action.</li>
                        <li>Build pipeline consistently.</li>
                        <li>Sales truth over myths.</li>
                        <li>Own your results.</li>
                        <li>Prospect with purpose.</li>
                        <li>Relationships through value.</li>
                        <li>Discipline in daily activities.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Antoine de Saint-Exupéry Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>A goal without a plan is just a wish.</li>
                        <li>Perfection achieved not when nothing more to add, but nothing left to take away.</li>
                        <li>Love does not consist in gazing at each other, but outward together same direction.</li>
                        <li>What saves a man is to take a step. Then another step.</li>
                        <li>Build a ship, teach longing for sea.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Additional Powerful Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>The harder you work, the luckier you get.</li>
                        <li>Your next loan is one call away.</li>
                        <li>Success is rented, rent due every day.</li>
                        <li>Every “no” closer to “yes.”</li>
                        <li>Start to be great.</li>
                        <li>Turn obstacles into opportunities.</li>
                        <li>Be so good they can’t ignore you.</li>
                        <li>Hustle beats talent.</li>
                        <li>Make someone’s dream come true today.</li>
                        <li>Doubt kills more dreams than failure.</li>
                        <!-- Full 100+ from XLS, grouped -->
                        <li>Consistency the silent closer.</li>
                        <li>Prospecting daily is key to growth.</li>
                        <li>Relationships are currency of sales.</li>
                        <li>Value creates loyalty.</li>
                        <li>Discipline bridges goals and accomplishments.</li>
                        <li>Action cures fear.</li>
                        <li>Success is a journey, not destination.</li>
                        <li>Be the change you wish to see.</li>
                        <li>Failure is success in progress.</li>
                        <li>Believe and act as if impossible to fail.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Success Stats <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-3">
                        <li>67% forget lender in 18 months without follow-up.</li>
                        <li>12% LOs follow up after year, but 89% clients would reuse if contacted.</li>
                        <li>No nurture loses 75% referral business.</li>
                        <li>80% sales require 5–12 follow-ups.</li>
                        <li>48% never follow up; 44% quit after one.</li>
                        <li>Clients 3X likely to switch if neglected.</li>
                        <li>Video converts 80% more; 300% email clicks; 1200% shares.</li>
                        <li>Viewers retain 95% via video vs 10% text.</li>
                        <li>83% say under 1 min video ideal.</li>
                        <li>90%+ marketers say video ROI positive; 87% increases sales; 91% lead gen.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Motivational Tips <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-3">
                        <li>Small consistent actions compound into results.</li>
                        <li>Turn obstacles into opportunities; hustle beats talent.</li>
                        <li>Stay positive, work hard, make it happen.</li>
                        <li>Excuses don’t build empires—grind now, glow later.</li>
                        <li>Confidence closes deals.</li>
                        <li>Pressure makes diamonds—thrive in it.</li>
                        <li>Outwork yesterday’s you.</li>
                        <li>Build relationships, not files.</li>
                        <li>Lead with value, close with ease.</li>
                        <li>Done better than perfect.</li>
                        <li>Be relentless about paying activities.</li>
                        <li>Intentional mornings create unstoppable months.</li>
                        <li>Consistency louder than motivation.</li>
                        <li>Show up on purpose daily.</li>
                        <li>Winners stay consistent unseen.</li>
                        <li>Do boring work consistently for results.</li>
                        <li>Prospect daily or become obsolete.</li>
                        <li>Focus on revenue-generating activities.</li>
                        <li>Time block for success.</li>
                        <li>Leverage technology for efficiency.</li>
                        <li>Consistent marketing builds brand.</li>
                    </ul>
                </div>
            </div>
            
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="p-6 bg-gradient-to-br from-[#00A89D]/20 to-[#F15A29]/20 rounded-2xl shadow-md">
        <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-chart-bar mr-2 text-[#00A89D]"></i>Success Stats</h3>
        <ul class="space-y-3">
            <li>67% forget lender in 18 months without follow-up.</li>
            <li>12% LOs follow up after year, but 89% clients would reuse if contacted.</li>
            <li>No nurture loses 75% referral business.</li>
            <li>80% sales require 5–12 follow-ups.</li>
            <li>48% never follow up; 44% quit after one.</li>
            <li>Clients 3X likely to switch if neglected.</li>
            <li>Video converts 80% more; 300% email clicks; 1200% shares.</li>
            <li>Viewers retain 95% via video vs 10% text.</li>
            <li>83% say under 1 min video ideal.</li>
            <li>90%+ marketers say video ROI positive; 87% increases sales; 91% lead gen.</li>
        </ul>
    </div>
    <div class="p-6 bg-gradient-to-br from-[#F15A29]/20 to-[#00A89D]/20 rounded-2xl shadow-md">
        <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-lightbulb mr-2 text-[#F15A29]"></i>Motivational Tips</h3>
        <ul class="space-y-3">
            <li>Small consistent actions compound into results.</li>
            <li>Turn obstacles into opportunities; hustle beats talent.</li>
            <li>Stay positive, work hard, make it happen.</li>
            <li>Excuses don’t build empires—grind now, glow later.</li>
            <li>Confidence closes deals.</li>
            <li>Pressure makes diamonds—thrive in it.</li>
            <li>Outwork yesterday’s you.</li>
            <li>Build relationships, not files.</li>
            <li>Lead with value, close with ease.</li>
            <li>Done better than perfect.</li>
            <li>Be relentless about paying activities.</li>
            <li>Intentional mornings create unstoppable months.</li>
            <li>Consistency louder than motivation.</li>
            <li>Show up on purpose daily.</li>
            <li>Winners stay consistent unseen.</li>
            <li>Do boring work consistently for results.</li>
            <li>Prospect daily or become obsolete.</li>
            <li>Focus on revenue-generating activities.</li>
            <li>Time block for success.</li>
            <li>Leverage technology for efficiency.</li>
            <li>Consistent marketing builds brand.</li>
        </ul>
    </div>
</div>
        </section>
                
        <section id="planning" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Business Planning – Your Personalized Success Roadmap</h2>
    <p class="mb-8 text-lg">Create a truly customized 2026 business plan. Select your focus style, enter as much data as you want (all fields optional), and get an AI-powered plan tailored to your goals, drawing from proven sales strategies across this tool.</p>

    <!-- Plan Style Selection -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Choose Your Plan Style <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Pick the approach that fits you best — this shapes your customized plan.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <label class="bg-gradient-to-br from-[#002B5C] to-[#00A89D] text-white p-6 rounded-2xl cursor-pointer">
                    <input type="radio" name="plan-style" value="Referral Mastery" checked class="mr-3">
                    <strong>Referral Mastery</strong><br>80%+ from realtors & partners
                </label>
                <label class="bg-gradient-to-br from-[#00A89D] to-[#F15A29] text-white p-6 rounded-2xl cursor-pointer">
                    <input type="radio" name="plan-style" value="Database Reactor" class="mr-3">
                    <strong>Database Reactor</strong><br>Mine past clients & sphere
                </label>
                <label class="bg-gradient-to-br from-[#F15A29] to-[#002B5C] text-white p-6 rounded-2xl cursor-pointer">
                    <input type="radio" name="plan-style" value="Balanced Growth" class="mr-3">
                    <strong>Balanced Growth</strong><br>Multiple sources (partners, database, social/prospecting)
                </label>
            </div>
        </div>
    </div>

    <!-- Input Fields -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Your Goals & Current Stats (All Optional) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Fill what you know — smart defaults (2025 averages) fill the rest: Avg commission ~$6,500/loan, Avg loan $400k, Closing ratio 30%.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <label>Target Annual Income ($)</label>
                    <input type="number" id="target-income" placeholder="e.g., 250000" class="w-full p-3 border rounded-lg">

                    <label>Avg Commission per Closed Loan ($)</label>
                    <input type="number" id="avg-commission" placeholder="e.g., 6500" class="w-full p-3 border rounded-lg">

                    <label>Target Closings (if no income goal)</label>
                    <input type="number" id="target-closings" placeholder="e.g., 60" class="w-full p-3 border rounded-lg">

                    <label>Average Loan Amount ($)</label>
                    <input type="number" id="avg-loan" placeholder="e.g., 400000" class="w-full p-3 border rounded-lg">
                </div>

                <div class="space-y-4">
                    <label>Closing Ratio from Referrals/Leads (%)</label>
                    <input type="number" id="closing-ratio" placeholder="e.g., 30" class="w-full p-3 border rounded-lg">

                    <label>Current Active Referral Partners</label>
                    <input type="number" id="current-partners" placeholder="e.g., 20" class="w-full p-3 border rounded-lg">

                    <label>New Partners to Add This Year</label>
                    <input type="number" id="new-partners" placeholder="e.g., 15" class="w-full p-3 border rounded-lg">

                    <label>Current Database Size (Past Clients + Sphere)</label>
                    <input type="number" id="database-size" placeholder="e.g., 500" class="w-full p-3 border rounded-lg">
                </div>
            </div>

            <button onclick="generatePlan()" class="mt-8 bg-[#F15A29] text-white px-10 py-4 rounded-lg font-bold text-xl hover:opacity-90">Generate My Custom Business Plan</button>
            <p class="mt-4 text-sm text-gray-600 dark:text-gray-400">Your personally customized plan pulls strategies from top industry sales coaches and more.</p>
        </div>
    </div>

    <!-- Results Area -->
    <div id="custom-plan" class="mt-12"></div>

    <script>
    async function generatePlan() {
        const style = document.querySelector('input[name="plan-style"]:checked').value;

        const inputs = {
            income: document.getElementById('target-income').value || '',
            commission: document.getElementById('avg-commission').value || '',
            closings: document.getElementById('target-closings').value || '',
            loanAmount: document.getElementById('avg-loan').value || '',
            ratio: document.getElementById('closing-ratio').value || '',
            currentPartners: document.getElementById('current-partners').value || '',
            newPartners: document.getElementById('new-partners').value || '',
            database: document.getElementById('database-size').value || ''
        };

        // First, quick client-side calc for immediate numbers
        let closings = parseFloat(inputs.closings) || 60;
        const commission = parseFloat(inputs.commission) || 6500;
        if (inputs.income) closings = Math.ceil(parseFloat(inputs.income) / commission);

        const volume = closings * (parseFloat(inputs.loanAmount) || 400000);
        const ratio = (parseFloat(inputs.ratio) || 30) / 100;
        const referrals = Math.ceil(closings / ratio);

        // Show loading + basic numbers
        document.getElementById('custom-plan').innerHTML = `
            <div class="bg-gray-50 dark:bg-gray-900 p-10 rounded-3xl">
                <h3 class="text-2xl font-bold mb-6 text-[#F15A29]">Generating Your Personalized Plan...</h3>
                <p>Quick snapshot while Grok builds the full version:</p>
                <ul class="mt-4 space-y-2 text-lg">
                    <li><strong>Target Closings:</strong> ${closings}</li>
                    <li><strong>Target Volume:</strong> $${volume.toLocaleString()}</li>
                    <li><strong>Referrals Needed:</strong> ~${referrals}</li>
                </ul>
            </div>
        `;

        // Now call Grok API for full customized plan
        const prompt = `You are an expert mortgage sales coach. Create a detailed, motivational 2026 business plan for a loan officer.

Plan Style: ${style}

User Inputs (use defaults where blank - avg commission $6500, loan $400k, 30% close ratio):
- Target Income: ${inputs.income || 'calculated from closings'}
- Avg Commission: ${inputs.commission || '6500'}
- Target Closings: ${inputs.closings || 'calculated'}
- Avg Loan: ${inputs.loanAmount || '400000'}
- Close Ratio: ${inputs.ratio || '30'}%
- Current Partners: ${inputs.currentPartners || 'default'}
- New Partners Goal: ${inputs.newPartners || 'default'}
- Database Size: ${inputs.database || 'default'}

Structure the plan:
1. Executive Summary with key numbers (closings, volume, income, weekly activities)
2. Focus Areas based on style (e.g., Referral Mastery = partner growth strategies)
3. Monthly/Quarterly Milestones
4. Weekly Scorecard Targets
5. Specific Tactics: Pop-bys (ideas), events, objection handlers, database touches, social video ideas
6. Accountability Tips & Motivation

Make it actionable, encouraging, and tied to value-first relationship building.`;

        try {
            const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                    messages: [{ role: "user", content: prompt }],
                    temperature: 0.7,
                    max_tokens: 2000
                })
            });

            const data = await response.json();
            const plan = data.choices[0].message.content;

            document.getElementById('custom-plan').innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-2xl prose prose-lg dark:prose-invert max-w-none">
                    ${marked.parse(plan)}
                </div>
            `;
        } catch (error) {
            document.getElementById('custom-plan').innerHTML += `
                <p class="text-red-600 mt-8">API connection issue — check key or try again. Basic roadmap above.</p>
            `;
        }
    }
    </script>
<!-- Weekly Scorecard & Tracking -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Weekly Scorecard & Tracking Tools <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">What gets measured gets managed. Track these leading indicators every week.</p>

            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-[#002B5C] text-white">
                            <th class="p-4">Activity</th>
                            <th class="p-4">Target</th>
                            <th class="p-4">Why It Matters</th>
                        </tr>
                    </thead>
                    <tbody class="bg-gray-50 dark:bg-gray-900">
                        <tr>
                            <td class="p-4 border-t">Value Touches (pop-bys, calls, notes)</td>
                            <td class="p-4 border-t">30–50/week</td>
                            <td class="p-4 border-t">Builds relationships → referrals</td>
                        </tr>
                        <tr class="bg-white dark:bg-gray-800">
                            <td class="p-4 border-t">New Conversations</td>
                            <td class="p-4 border-t">10–15/week</td>
                            <td class="p-4 border-t">Pipeline fuel</td>
                        </tr>
                        <tr>
                            <td class="p-4 border-t">Pre-Approvals Issued</td>
                            <td class="p-4 border-t">5–10/week</td>
                            <td class="p-4 border-t">Leads → applications</td>
                        </tr>
                        <tr class="bg-white dark:bg-gray-800">
                            <td class="p-4 border-t">Events/Seminars Hosted</td>
                            <td class="p-4 border-t">1–2/month</td>
                            <td class="p-4 border-t">Top-of-mind with groups</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <p class="mt-6">Pro Tip: Review your scorecard every Monday morning — adjust activities, not goals.</p>
        </div>
    </div>

    <!-- Inspiration & Top Producer Insights -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Top Producer Insights & Inspiration <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Real advice from loan officers closing 100+ units/year.</p>
            <ul class="space-y-6">
                <li><strong>“Plan the work, work the plan.”</strong> – Block prospecting time like client appointments. No exceptions.</li>
                <li><strong>“Focus on people, not production.”</strong> – The closings are a byproduct of serving others well.</li>
                <li><strong>“Your database is your gold mine.”</strong> – One past client is worth 10 cold leads.</li>
                <li><strong>“Consistency beats intensity.”</strong> – 30 touches/week for a year > 100 touches in January only.</li>
                <li><strong>“Track everything.”</strong> – You can’t improve what you don’t measure.</li>
            </ul>
        </div>
    </div>

    <!-- Resources & Downloads -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Downloads & External Resources <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-4">
                <li><a href="https://www.themortgagereports.com/business-plan-for-loan-officers" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Free Business Plan Template (The Mortgage Reports)</a></li>
                <li><a href="https://www.brianbuffini.com/" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Buffini & Company Referral Training</a></li>
                <li><a href="https://www.tomferry.com/" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Tom Ferry Coaching & Scripts</a></li>
                <li><a href="https://www.mortgagemarketinganimals.com/" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Mortgage Marketing Animals (Database Strategies)</a></li>
            </ul>
        </div>
    </div>
</section>
              
        <section id="prospecting" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Prospecting Tools</h2>
            <p class="mb-4">Make time for prospecting consistently to build your pipeline.</p>
            <h3 class="text-2xl font-semibold mb-4">Time Blocking Generator</h3>
            <form id="time-block-form" class="space-y-4">
                <label class="block text-lg">Frequency: <select id="frequency" class="p-3 rounded-lg border border-[#00A89D] bg-white dark:bg-gray-800 w-full focus:ring-[#F15A29]">
                    <option>Daily</option><option>Weekly</option><option>Monthly</option><option>Quarterly</option><option>Yearly</option>
                </select></label>
                <button type="button" onclick="generateTimeBlock()" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-6 py-3 rounded-full hover:opacity-90 w-full font-semibold">Generate Full List</button>
                <button type="button" onclick="cycleActivities()" class="bg-gradient-to-r from-[#F15A29] to-[#00A89D] text-white px-6 py-3 rounded-full hover:opacity-90 w-full font-semibold">Cycle New Ideas (Random 5-10)</button>
            </form>
            <div id="time-block-output" class="mt-6 p-6 bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 rounded-2xl shadow-inner"></div>
            <div class="mt-6 p-6 bg-gradient-to-br from-[#F15A29]/10 to-[#00A89D]/10 rounded-2xl shadow-md">
                <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-clock mr-2 text-[#F15A29]"></i>Time Blocking Tips & Strategies</h3>
                <ul class="list-disc pl-6 space-y-2">
                    <li>Do prospecting early in the day to ensure it happens.</li>
                    <li>Block smaller windows when you can in the event an emergency comes up and you need to shift it to a new part of your day.</li>
                    <li>Only 2 things more important than prospecting: Deals literally coming in the door at that moment, and loans in jeopardy of walking out the door at that moment.</li>
                    <li>Protect your blocks like appointments.</li>
                    <li>Use color-coding for prospecting blocks.</li>
                    <li>Review blocks weekly to adjust.</li>
                    <li>Time Blocking Calendar Spreadsheet <a href="https://2759433.fs1.hubspotusercontent-na1.net/hubfs/2759433/Adam%20Images%20to%20Host/Time%20Blocking%20Calendar%20with%20Clear%20All%20and%20ICS%20Export.xlsm" target="_blank" class="text-[#00A89D] hover:text-[#F15A29] underline">Click Here to Download</a></p></li>
                </ul>
            </div>
        </section>
        <!-- MAIN SOCIAL MEDIA TIPS PAGE -->
<!-- MAIN SOCIAL MEDIA TIPS PAGE -->
<section id="social" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-8 text-[#F15A29]">Social Media Strategy for Loan Officers</h2>
    <p class="text-lg mb-12 leading-relaxed">Build genuine relationships, grow your reach organically, and turn followers into referral partners — without ever being salesy. Build strong personal connections by sharing your passions, hobbies, family, pets, vacations, and interests in life.</p>

    <!-- Content Pillars – Visual Boxes (UNCHANGED) -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">
        <div onclick="openModal('Personal')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Personal</h3>
            <p class="text-gray-700 dark:text-gray-300">Behind-the-scenes, hobbies, family (with permission)</p>
        </div>
        <div onclick="openModal('Local')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Local</h3>
            <p class="text-gray-700 dark:text-gray-300">Community events, spotlights, neighborhood insights</p>
        </div>
        <div onclick="openModal('Educational')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Educational</h3>
            <p class="text-gray-700 dark:text-gray-300">Mortgage tips, rate myths, homebuying process</p>
        </div>
        <div onclick="openModal('Client Wins')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Client Wins</h3>
            <p class="text-gray-700 dark:text-gray-300">Just closed stories, testimonials</p>
        </div>
        <div onclick="openModal('Value')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Value</h3>
            <p class="text-gray-700 dark:text-gray-300">Checklists, guides, free resources</p>
        </div>
        <div onclick="openModal('Engagement')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Engagement</h3>
            <p class="text-gray-700 dark:text-gray-300">Polls, questions, "tag a friend"</p>
        </div>
    </div>

    <!-- Big CTA Button to AI Creator (UNCHANGED) -->
    <div class="text-center my-16">
        <div class="inline-block bg-gradient-to-br from-[#002B5C]/5 to-[#00A89D]/10 rounded-3xl p-12 border-4 border-dashed border-[#00A89D]/50 shadow-xl">
            <button onclick="showSocialPostCreator()" 
                    class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-14 py-8 rounded-3xl hover:scale-105 transition-all font-bold text-3xl shadow-2xl inline-flex items-center">
                <i class="fas fa-bolt mr-5 text-4xl"></i> Instantly Generate a Post with AI
            </button>
            <p class="mt-8 text-xl text-gray-700 dark:text-gray-300 font-medium max-w-2xl">
                Ready-to-post, authentic, relationship-focused content — tailored in seconds
            </p>
        </div>
    </div>

    <!-- 1. Proven Content Pillars -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">1. Your 5 Proven Content Pillars (80/20 Rule) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Top LOs post 80% personal or value, 20% business. Follow this mix for trust + leads without being salesy.</p>
            <div class="grid grid-cols-1 md:grid-cols-5 gap-6">
                <div class="text-center p-6 bg-[#002B5C]/10 dark:bg-[#002B5C]/30 rounded-2xl">
                    <div class="text-4xl mb-4">40%</div>
                    <strong>{Personal}</strong><br>Market updates, tips, myth-busts
                </div>
                <div class="text-center p-6 bg-[#00A89D]/10 dark:bg-[#00A89D]/30 rounded-2xl">
                    <div class="text-4xl mb-4">20%</div>
                    <strong>Value</strong><br>Testimonials, closing stories
                </div>
                <div class="text-center p-6 bg-[#F15A29]/10 dark:bg-[#F15A29]/30 rounded-2xl">
                    <div class="text-4xl mb-4">15%</div>
                    <strong>Engagement</strong><br>Behind-the-scenes, family, hobbies
                </div>
                <div class="text-center p-6 bg-[#002B5C]/10 dark:bg-[#002B5C]/30 rounded-2xl">
                    <div class="text-4xl mb-4">15%</div>
                    <strong>Local</strong><br>Community events, spotlights
                </div>
                <div class="text-center p-6 bg-[#00A89D]/10 dark:bg-[#00A89D]/30 rounded-2xl">
                    <div class="text-4xl mb-4">10%</div>
                    <strong>Educational</strong><br>Polls, questions, this-or-that
                </div>
            </div>
            <p class="mt-6 font-semibold">Post 4–5 times/week using this mix → consistent leads without burnout.</p>
        </div>
    </div>

    <!-- 2. Weekly Posting Calendar -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">2. Done-For-You Weekly Posting Schedule <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Batch create on Sunday → schedule all week. Takes 45 minutes, delivers results.</p>
            <table class="w-full text-left border-collapse mb-6">
                <thead>
                    <tr class="bg-[#002B5C] text-white">
                        <th class="p-4">Day</th>
                        <th class="p-4">Pillar</th>
                        <th class="p-4">Content Idea</th>
                        <th class="p-4">Best Time</th>
                    </tr>
                </thead>
                <tbody class="bg-gray-50 dark:bg-gray-900">
                    <tr>
                        <td class="p-4 border-t">Monday</td>
                        <td class="p-4 border-t">Educational</td>
                        <td class="p-4 border-t">Market Update Monday (rates, inventory)</td>
                        <td class="p-4 border-t">8–9 AM</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Tuesday</td>
                        <td class="p-4 border-t">Value Tip</td>
                        <td class="p-4 border-t">Quick mortgage tip or myth-bust</td>
                        <td class="p-4 border-t">10 AM</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Wednesday</td>
                        <td class="p-4 border-t">Engagement</td>
                        <td class="p-4 border-t">Poll or question (“Rent or own in 2026?”)</td>
                        <td class="p-4 border-t">7 PM</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Thursday</td>
                        <td class="p-4 border-t">Client Win</td>
                        <td class="p-4 border-t">Testimonial or closing story</td>
                        <td class="p-4 border-t">11 AM</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Friday</td>
                        <td class="p-4 border-t">Personal/Local</td>
                        <td class="p-4 border-t">Weekend plans or local spotlight</td>
                        <td class="p-4 border-t">3 PM</td>
                    </tr>
                </tbody>
            </table>
            <p class="font-semibold">Bonus: Add 1 Reel/week (use templates below) → massive reach boost.</p>
        </div>
    </div>

    <!-- 3. High-Engagement Reel Ideas -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">3. 12 Proven Reel/Video Scripts (15–60 sec) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Film one per week — these consistently get 5–20x views vs static posts.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>1. Rate Myth Bust</strong><br>“Everyone thinks you need 20% down — reality? Many programs are 3–5% or even 0%. Stop waiting!” (Show text overlays)
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>2. Closing Day Chaos vs Reality</strong><br>Fast cuts of stress → calm signing → happy family. “I handle the chaos so you don’t have to.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>3. “Marry the House, Date the Rate”</strong><br>Wedding analogy skit — “You can refinance the rate later for free.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>4. Local Market Snapshot</strong><br>Point at screen with stats: “Inventory up 12% — best buyer window in years.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>5. Day in the Life</strong><br>Time-lapse: coffee → calls → approvals → celebration. “Love helping families win.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>6. Credit Boost Quick Tip</strong><br>“Raise score 50 points: Pay cards <30%, dispute errors, authorized user.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>7. Buydown Explained</strong><br>“Temporary rate reduction — lower payment first 2 years while building equity.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>8. Client Testimonial Skit</strong><br>Act out before/after: “Stressed renter → happy homeowner in 45 days.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>9. DPA Spotlight</strong><br>“Up to $10k forgiven in MI — who qualifies? Comment below!”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>10. Behind the Scenes</strong><br>Show your desk, team, “Real day helping families buy homes.”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>11. Quick Poll Reel</strong><br>Use trending audio + text: “Rent forever or own your home? Vote!”
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>12. Holiday Tie-In</strong><br>“Cozy home for the holidays? Let’s make it happen in 2026.”
                </div>
            </div>
        </div>
    </div>

    <!-- 4. Hashtag Strategy -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">4. Hashtag Strategy That Actually Works <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Use 8–12 hashtags per post. Mix high-reach + local/niche.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <strong>High-Reach (rotate 3–4)</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>#Mortgage</li>
                        <li>#HomeBuying</li>
                        <li>#RealEstate</li>
                        <li>#FirstTimeHomeBuyer</li>
                        <li>#MortgageTips</li>
                        <li>#HomeLoans</li>
                    </ul>
                </div>
                <div>
                    <strong>Ruoff Market Specific</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>#IndianaRealEstate #IndianapolisHomes</li>
                        <li>#OhioRealEstate #ColumbusHomes</li>
                        <li>#MichiganRealEstate #GrandRapidsHomes</li>
                        <li>#KentuckyRealEstate #LouisvilleHomes</li>
                        <li>#DownPaymentAssistance</li>
                        <li>#RefinanceNow</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 5. Engagement Blueprint -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">5. Engagement Blueprint (Turn Likes into Leads) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Every interaction is an opportunity. Respond fast and personally.</p>
            <ul class="space-y-6 text-lg">
                <li><strong>Comment Formula:</strong> Thank + Relate + Soft CTA<br>“Love that! We just helped a family in [area] save $300/mo — want to see if it works for you?”</li>
                <li><strong>DM Script:</strong> “Thanks for the comment on rates! Happy to send a quick personalized quote — no pressure. When works?”</li>
                <li><strong>Story Replies:</strong> Reply to every partner/realtor story view with value (market stat, article, “Great listing!”)</li>
                <li><strong>Weekly Goal:</strong> 50 meaningful engagements → consistent warm leads</li>
            </ul>
        </div>
    </div>

    <!-- 6. Content Batch System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">6. 45-Minute Weekly Batch System <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Create a full week’s content in one sitting — no daily stress.</p>
            <ol class="list-decimal pl-6 space-y-4">
                <li>Sunday evening: Open Canva + phone</li>
                <li>Film 1 Reel (pick from scripts above)</li>
                <li>Create 4 static posts using Instant Generator</li>
                <li>Add hashtags + captions</li>
                <li>Schedule in Meta Business Suite</li>
                <li>Set daily reminder: 10 min replying to comments</li>
            </ol>
            <p class="mt-6 font-semibold">Tools: Canva (graphics), CapCut (Reels), Meta Business Suite (scheduling)</p>
        </div>
    </div>

    <!-- 7. Idea Bank: Holiday Polls, Questions & Topics -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">7. Massive Idea Bank: Holidays, Polls, Topics & More <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Your full evergreen idea vault — never run out of content.</p>

            <h4 class="text-xl font-bold mb-4">Holiday "This or That" Polls</h4>
            <ul class="columns-1 md:columns-2 gap-8 space-y-2 mb-8 text-lg">
                <li>Real Tree vs. Artificial Tree</li>
                <li>White Lights vs. Multi-Colored Lights</li>
                <li>Tinsel vs. Garland</li>
                <li>Classic Christmas Songs vs. Modern Holiday Hits</li>
                <li>Red Ornaments vs. Gold Ornaments</li>
                <li>Hot Chocolate with Marshmallows vs. Whipped Cream</li>
                <li>Ugly Sweater Party vs. Formal Christmas Dinner</li>
                <li>Open Presents Christmas Eve vs. Christmas Morning</li>
                <li>Christmas Shopping: Black Friday vs. Cyber Monday</li>
                <li>Rudolph vs. Frosty the Snowman</li>
                <li>Elf on the Shelf vs. Christmas Elf</li>
                <li>Baking Cookies vs. Decorating Gingerbread Houses</li>
                <li>Mistletoe vs. Holly</li>
                <li>White Christmas vs. Warm Christmas</li>
                <li>Christmas Market vs. Indoor Shopping</li>
                <li>Christmas in the Mountains vs. Christmas at the Beach</li>
                <li>Snowy Cabin Retreat vs. City Christmas Adventure</li>
                <li>Sleigh Ride vs. Horse Carriage Ride</li>
                <li>Silent Night Indoors vs. Festive Caroling Outside</li>
                <li>Decorating the Outside vs. Inside of Your Home, or BOTH</li>
                <li>Pumpkin Pie vs. Apple Pie</li>
                <li>Eggnog vs. Apple Cider vs. Hot Chocolate</li>
                <li>Roast Turkey vs. Honey-Glazed Ham</li>
                <li>Mashed Potatoes vs. Sweet Potato Casserole</li>
                <li>Sugar Cookies vs. Shortbread</li>
                <li>Hot Toddy vs. Spiked Eggnog</li>
                <li>Peppermint Bark vs. Fudge</li>
                <li>Traditional Fruitcake vs. Yule Log Cake</li>
                <li>Candy Canes vs. Chocolate Truffles</li>
                <li>Gingerbread Cookies vs. Snickerdoodles</li>
                <li>Christmas Movies: Animated vs. Live Action</li>
                <li>Secret Santa vs. White Elephant Gift Exchange</li>
                <li>Caroling vs. Watching Christmas Movies</li>
                <li>Festive Pajamas vs. Regular PJs</li>
                <li>Holiday Movie Marathon vs. Game Night</li>
                <li>Family Gathering at Home vs. Vacation Getaway</li>
                <li>Attending Christmas Markets vs. Shopping Online</li>
                <li>Stocking Stuffers vs. Big Presents</li>
                <li>Driving to See Lights vs. Lighting the Tree at Home</li>
                <li>Making Holiday Crafts vs. Watching Christmas Specials</li>
                <li>Morning Pajamas vs. Matching Sweaters</li>
                <li>Ice Skating vs. Sledding</li>
                <li>Snowman Building vs. Snowball Fight</li>
                <li>Snow Angel vs. Sitting by the Fireplace</li>
                <li>Skiing Vacation vs. Cozy Cabin Stay</li>
                <li>Gift Cards vs. Handmade Gifts</li>
                <li>Traditional Holiday Music vs. Modern Christmas Hits</li>
                <li>Making New Year’s Resolutions: Yes or No</li>
            </ul>

            <h4 class="text-xl font-bold mb-4">Open-Ended Engagement Questions</h4>
            <ul class="columns-1 md:columns-2 gap-8 space-y-2 mb-8 text-lg">
                <!-- All 50+ questions from your original list here — fully preserved -->
                <li>Best gift you've ever received?</li>
                <li>One wish granted this holiday?</li>
                <li>Most memorable Christmas?</li>
                <li>Favorite movie to watch yearly?</li>
                <li>Favorite holiday song?</li>
                <li>Funny/embarrassing holiday stories?</li>
                <li>Worst gift received?</li>
                <li>Dream holiday location?</li>
                <li>Favorite holiday food?</li>
                <li>Favorite New Year's Eve drink?</li>
                <li>Proudest resolution achieved?</li>
                <li>Three dinner guests (living/dead)?</li>
                <li>Unique family tradition?</li>
                <li>Favorite snowy day activity?</li>
                <li>How celebrate New Year?</li>
                <li>Most creative gift given?</li>
                <li>Funny holiday movie scene?</li>
                <li>Prefer giving or receiving gifts?</li>
                <li>Strategy for family gatherings?</li>
                <li>Best holiday party attended?</li>
                <li>New tradition to start?</li>
                <li>Choose your Christmas name?</li>
                <li>Ideal Christmas Day?</li>
                <li>First gift bought with own money?</li>
                <li>Favorite carol and why?</li>
                <li>Surprising place for decoration?</li>
                <li>One irresistible cookie?</li>
                <li>Favorite childhood memory?</li>
                <li>One holiday meal forever?</li>
                <li>Funniest thing at holiday event?</li>
                <li>Holiday activity as Olympic sport?</li>
                <li>Best holiday play/performance?</li>
                <li>Secret Santa story?</li>
                <li>Wish for someone else?</li>
                <li>Holiday miracle?</li>
                <li>Holiday gadget wish?</li>
                <li>Quirky traditions?</li>
                <li>Favorite way to ring in New Year?</li>
                <li>Resolutions worth it?</li>
                <li>Most thoughtful non-physical gift?</li>
                <li>Favorite quote/saying?</li>
                <li>Go-to comfort food?</li>
                <li>Favorite part of season?</li>
                <li>If Santa real?</li>
                <li>Holiday book recommendation?</li>
                <li>Holiday dish from around world?</li>
                <li>Memorable holiday away from home?</li>
                <li>Keep spirit alive in tough times?</li>
                <li>One thing never gets old?</li>
            </ul>

            <h4 class="text-xl font-bold mb-4">Educational & Value Topics</h4>
            <ul class="columns-1 md:columns-2 gap-8 space-y-2 mb-8 text-lg">
                <!-- All your original educational topics fully preserved -->
                <li>What Not to Do Before Buy Home</li>
                <li>How Prepare Home Ownership</li>
                <li>Mortgage Basics Beginners</li>
                <li>3 Myths Getting Mortgage</li>
                <li>Benefits Home Ownership</li>
                <li>5 Steps Secure Dream Home</li>
                <li>What Know Apply Mortgage</li>
                <li>3 Tips Simplify Buying Process</li>
                <li>First-Time Buyer Know</li>
                <li>FICO Credit Score Mean</li>
                <li>Qualify Low Credit Score</li>
                <li>Own Best Long-Term Wealth</li>
                <li>Mortgage Investment Not Debt</li>
                <li>Pre-Approved When</li>
                <li>5 Questions Ask Lender</li>
                <li>Choose Best Mortgage</li>
                <li>10 First-Time Buyer Mistakes Avoid</li>
                <li>Where How Get Mortgage</li>
                <li>Type Loan Right You</li>
                <li>Financing Basics Homebuyers</li>
                <li>Mortgage Mistakes Selling Home</li>
                <li>Buy Sell Same Time</li>
                <li>Own Did Mortgage</li>
                <li>Escrow Know</li>
                <li>Bank vs Broker Mortgage</li>
                <li>Mistakes Apply Mortgage</li>
                <li>Improve Credit Pay Down Cards</li>
                <li>Credit Tips Not Do</li>
                <li>Dos Don'ts Loan Process</li>
                <li>Rent vs Own</li>
                <li>VA Financing Benefits</li>
                <li>DTI Calculate</li>
                <li>LTV Important</li>
                <li>Conforming Jumbo Diff</li>
                <li>Payment History Effects Credit</li>
                <li>Market Updates Trends</li>
                <li>First-Time Homebuyer Tips Credit Down Payment</li>
                <li>Loan Program Spotlights Types Benefits</li>
                <li>Home Equity Basics Benefits Cash-Out</li>
                <li>Own First Investment Property Research Financing ROI</li>
                <li>Pre-Approval vs Pre-Qualification</li>
                <li>Behind-Scenes Closings</li>
                <li>Did You Know Rate History Closing Costs</li>
                <li>Myth-Buster 30 Sec e.g. 20% Down Not True</li>
                <li>Market Pulse Weekly Local Rates</li>
                <li>Client Wins e.g. Teacher 3% Down</li>
                <li>FAQ Common Questions</li>
                <li>Mortgage Process Infographics</li>
                <li>Homeownership Milestones Anniversaries</li>
                <li>Myth Fact e.g. 20% Down</li>
                <li>Industry Data MBA Sources</li>
                <li>Home Maintenance Seasonal</li>
                <li>Mortgage Humor Professional</li>
                <li>Holiday Recognition Fun</li>
                <li>Polls Quizzes e.g. Rent Buy</li>
                <li>Terms Defined Graphics</li>
                <li>Local Housing Snapshots Trends</li>
                <li>5 Mistakes Buyers</li>
                <li>5 Reasons Love Neighborhood</li>
                <li>Buy Now?</li>
                <li>Favorite Transaction Story</li>
                <li>Funniest Strategy</li>
                <li>Worst Transaction</li>
                <li>Reasons Love Referrals</li>
                <li>5 FAQs</li>
            </ul>

            <h4 class="text-xl font-bold mb-4">Recipes, Drinks, Fun Facts, Local & Repeatable Topics</h4>
            <p class="mb-4">All your original creative banks — perfect for personal + value posts.</p>
            <!-- Recipes, Drinks, Fun Facts, Local Spotlights, Repeatable Topics fully preserved in columns for readability -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <strong>Recipes & Drinks</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Holiday Treats Home Tie-In: "Bake these cookies for open houses!"</li>
                        <li>Easy Appetizers Client Events</li>
                        <li>Seasonal Smoothies Home Wellness</li>
                        <li>Mortgage-Themed Cocktails Fun Posts</li>
                        <li>Quick Dinners Busy LOs</li>
                        <li>Budget-Friendly Meals Homebuyers</li>
                        <li>Festive Desserts Client Gifts</li>
                        <li>Healthy Snacks Prospecting Energy</li>
                        <li>Co-branded Recipe Cards Partners</li>
                        <li>Seasonal Soups Cozy Homes</li>
                        <li>Festive Cocktails Client Parties</li>
                        <li>Non-Alcoholic Punches Events</li>
                        <li>Coffee Recipes Morning Motivation</li>
                        <li>Smoothie Ideas Health Homeownership</li>
                        <li>Seasonal Hot Drinks Cozy Homes</li>
                        <li>Mocktails First-Time Buyers</li>
                        <li>Energy Drinks Prospecting Boost</li>
                        <li>Wine Pairings Home Closings</li>
                        <li>Healthy Juices Wellness Tips</li>
                        <li>Themed Drinks Holiday Posts</li>
                    </ul>
                </div>
                <div>
                    <strong>Fun Facts, Local & Repeatable</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Mortgage Trivia: "Average loan term 30 years?"</li>
                        <li>Real Estate Oddities: "World's smallest house?"</li>
                        <li>Finance Fun: "Origin 'mortgage' word?"</li>
                        <li>Home History: "Famous homes facts"</li>
                        <li>LO Life: "Average LO closes X loans/year"</li>
                        <li>Rate Facts: "Lowest historical rate?"</li>
                        <li>Credit Myths: "Checking score hurts it?"</li>
                        <li>Home Value Trivia: "Factors affecting appraisal?"</li>
                        <li>Industry Milestones: "First mortgage date?"</li>
                        <li>Buyer Stats: "Average age first-time buyer?"</li>
                        <li>Restaurant Feature: "Best spot for client lunches"</li>
                        <li>Business Partnership: "Team up with local coffee shop"</li>
                        <li>Community Event: "Upcoming festival – great networking"</li>
                        <li>Neighborhood Highlight: "Why this area hot for buyers"</li>
                        <li>Local Pro Shoutout: "Featured realtor/builder"</li>
                        <li>Fun Fact Friday</li>
                        <li>Tip Tuesday</li>
                        <li>Motivation Monday</li>
                        <li>Throwback Thursday</li>
                        <li>Weekend Wins</li>
                        <li>Question Wednesday</li>
                        <li>Spotlight Saturday</li>
                        <li>Self-Care Sunday</li>
                        <li>Market Monday</li>
                        <li>Testimonial Tuesday</li>
                        <li>Wisdom Wednesday</li>
                        <li>Fun Friday</li>
                        <li>Success Saturday</li>
                        <li>Sunday Setup</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#F15A29] text-white p-10 rounded-3xl text-center mt-12">
        <p class="text-2xl font-bold mb-4">Consistency + Authentic Value = Massive Trust & Referrals</p>
        <p class="text-xl">Follow this system for 90 days. You'll never run out of ideas again.</p>
    </div>
</section>
        <section id="referrals" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Referral Partners – Your Primary Growth Engine</h2>
    <p class="mb-8 text-lg">For most top-producing loan officers, 70–90% of business comes from referral partners (realtors, builders, financial planners, attorneys, insurance agents). This section is your complete playbook for finding, winning, nurturing, and scaling lifelong partnerships that send consistent, high-quality referrals — without ever being transactional.</p>

    <!-- Core Mindset -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">1. The Referral Partner Mindset <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Be a True Partner, Not a Vendor:</strong> Your goal is to make their business easier and more successful — referrals are the byproduct.</li>
                <li><strong>Value First, Always:</strong> Every interaction should give more than it takes.</li>
                <li><strong>Consistency Wins:</strong> One great touch per week beats 12 touches in January.</li>
                <li><strong>Become Indispensable:</strong> Fast pre-approvals, smooth closings, co-marketing, education — make them think, “I can’t succeed without this LO.”</li>
                <li><strong>Track & Celebrate:</strong> Measure referrals, thank publicly, reward generously (compliantly).</li>
            </ul>
            <p class="mt-6 font-semibold text-center text-xl text-[#00A89D]">Great partners don’t send referrals — they send their best clients because they trust you with their reputation.</p>
        </div>
    </div>

    <!-- Finding New Partners -->
    <div class="accordion mb-8">
    <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">2. Partner Types – Click for Detailed Strategies & Examples <i class="fas fa-chevron-down"></i></button>
    <div class="accordion-content">
        <p class="mb-6">Every partner type has unique needs and opportunities. Click each for specific outreach ideas, value offers, scripts, event examples, and nurturing strategies.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div onclick="openReferralModal('Realtors')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Realtors</h3>
                <p class="text-gray-700 dark:text-gray-300">Your primary source — agents with active buyers & listings</p>
            </div>
            <div onclick="openReferralModal('Builders')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Builders</h3>
                <p class="text-gray-700 dark:text-gray-300">New construction & preferred lender status</p>
            </div>
            <div onclick="openReferralModal('Financial Planners')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Financial Planners / CPAs</h3>
                <p class="text-gray-700 dark:text-gray-300">High-net-worth, refi, and investment property referrals</p>
            </div>
            <div onclick="openReferralModal('Attorneys')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Attorneys</h3>
                <p class="text-gray-700 dark:text-gray-300">Divorce, probate, estate planning clients</p>
            </div>
            <div onclick="openReferralModal('Insurance Agents')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Insurance Agents</h3>
                <p class="text-gray-700 dark:text-gray-300">Home + auto bundle opportunities</p>
            </div>
            <div onclick="openReferralModal('Other')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Other Professionals</h3>
                <p class="text-gray-700 dark:text-gray-300">HR directors, relocation companies, title agents, etc.</p>
            </div>
        </div>

            <h4 class="text-lg font-bold mb-4">Proven Prospecting Strategies</h4>
            <ul class="space-y-4 text-lg">
                <li><strong>Open House Approach:</strong> “I’m [Name] with Ruoff — happy to run quick pre-approvals on-site to strengthen offers.” (Bring branded signage + treats)</li>
                <li><strong>Value-First Intro Script:</strong> “I specialize in making offers stand out with fast approvals and creative financing — would love to grab coffee and explore how I can support your listings.”</li>
                <li><strong>Social Media Warm Outreach:</strong> Comment genuinely on their posts → DM value (market update, co-branded tool)</li>
                <li><strong>Host Educational Events:</strong> “Lunch & Learn: Buydowns in Today’s Market” — invite targeted agents</li>
                <li><strong>Referral from Existing Partners:</strong> “Who’s one agent you respect that I should meet?”</li>
            </ul>
        </div>
    </div>

    <!-- Partner Tiers & Nurturing -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">3. Tiered Partner System (Scale Your Effort) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Segment partners so top producers get white-glove treatment.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-[#002B5C]/5 dark:bg-[#002B5C]/20 p-6 rounded-2xl">
                    <strong>A+ Partners (Top 10–20)</strong><br>5+ referrals/year
                    <ul class="list-disc pl-6 mt-4 space-y-2">
                        <li>Weekly personal touch</li>
                        <li>Monthly lunch/coffee</li>
                        <li>Co-branded marketing</li>
                        <li>Exclusive event invites</li>
                        <li>Premium gifts</li>
                    </ul>
                </div>
                <div class="bg-[#00A89D]/5 dark:bg-[#00A89D]/20 p-6 rounded-2xl">
                    <strong>B Partners (Growing)</strong><br>1–4 referrals/year
                    <ul class="list-disc pl-6 mt-4 space-y-2">
                        <li>Bi-weekly value touch</li>
                        <li>Quarterly personal check-in</li>
                        <li>Co-marketing offers</li>
                        <li>Event invites</li>
                    </ul>
                </div>
                <div class="bg-[#F15A29]/5 dark:bg-[#F15A29]/20 p-6 rounded-2xl">
                    <strong>C Partners (New/Prospects)</strong><br>Potential
                    <ul class="list-disc pl-6 mt-4 space-y-2">
                        <li>Weekly automated value</li>
                        <li>Monthly personal outreach</li>
                        <li>Educational event invites</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Weekly Partner Touch System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">4. Weekly Partner Touch System <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Consistent, value-first touches = top-of-mind status.</p>
            <table class="w-full text-left border-collapse mb-6">
                <thead>
                    <tr class="bg-[#002B5C] text-white">
                        <th class="p-4">Touch Type</th>
                        <th class="p-4">Frequency</th>
                        <th class="p-4">Example</th>
                    </tr>
                </thead>
                <tbody class="bg-gray-50 dark:bg-gray-900">
                    <tr>
                        <td class="p-4 border-t">Market Update</td>
                        <td class="p-4 border-t">Weekly</td>
                        <td class="p-4 border-t">Short video/email: rates, inventory, buydown spotlight</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Personal Check-In</td>
                        <td class="p-4 border-t">A+: Weekly, B: Bi-weekly</td>
                        <td class="p-4 border-t">Text/call: “How’s business? Anything I can support?”</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Value Drop</td>
                        <td class="p-4 border-t">Weekly</td>
                        <td class="p-4 border-t">Co-branded flyer, buyer guide, social graphic</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Pop-By</td>
                        <td class="p-4 border-t">A+: Monthly, B: Quarterly</td>
                        <td class="p-4 border-t">Treats + open house tools</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Event Invite</td>
                        <td class="p-4 border-t">Monthly</td>
                        <td class="p-4 border-t">Lunch & learn, happy hour, seminar</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Co-Marketing & Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">5. Co-Marketing & Joint Events <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">Proven Co-Marketing Ideas</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li>Co-branded buyer guides & checklists</li>
                <li>Open house pre-approval station (branded signage)</li>
                <li>Joint social media posts/Reels</li>
                <li>Co-hosted client appreciation events</li>
                <li>Shared email campaigns to their database</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Event Ideas That Generate Referrals</h4>
            <ul class="space-y-4 text-lg">
                <li><strong>Lunch & Learns:</strong> “Creative Financing in Today’s Market” (cater lunch)</li>
                <li><strong>Happy Hours:</strong> Casual networking for their sphere</li>
                <li><strong>Buyer Seminars:</strong> “Home Buying 101” co-hosted at local venue</li>
                <li><strong>Shredding/Pumpkin Events:</strong> Community service + branding</li>
                <li><strong>Charity Partnerships:</strong> Joint fundraising (builds goodwill)</li>
            </ul>
        </div>
    </div>

    <!-- Partner Communication During Transactions -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">6. Transaction Communication (Build Trust) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-4 text-lg">
                <li><strong>Day 1:</strong> Intro call/email to agent: timeline, your role</li>
                <li><strong>Weekly Updates:</strong> Thursday status text/email</li>
                <li><strong>Milestones:</strong> Immediate notification (approval, appraisal, CTC)</li>
                <li><strong>Issues:</strong> Call agent first — never surprise</li>
                <li><strong>Post-Closing:</strong> Thank-you note + highlight for their marketing</li>
            </ul>
        </div>
    </div>

    <!-- Tracking & Accountability -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">7. Track Progress & Celebrate Wins <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">Key Metrics</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li>Number of active partners</li>
                <li>Referrals per partner per year</li>
                <li>Conversion rate from referral to close</li>
                <li>Partner satisfaction (quarterly survey)</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Celebration Ideas (Compliant)</h4>
            <ul class="space-y-4 text-lg">
                <li>Public social shoutouts</li>
                <li>Referral milestone gifts (branded items)</li>
                <li>Annual partner appreciation event</li>
                <li>Handwritten thank-you notes</li>
            </ul>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center mt-12">
        <p class="text-2xl font-bold mb-4">Referral partners aren’t sources — they’re true business partners.</p>
        <p class="text-xl">Invest in them like your business depends on it... because it does.</p>
    </div>
</section>
        <section id="database" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Database Nurturing – Your Most Valuable Asset</h2>
    <p class="mb-8 text-lg">Your database is not a list — it's a living network of real people who already know, like, and trust you. Nurture it intentionally and it will become your #1 source of repeat business, referrals, and lifelong income. This section is your complete playbook for building and maintaining genuine, profitable relationships at scale.</p>

    <!-- Core Philosophy -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">The Mindset: Beyond "Know, Like, Trust" <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Top producers don’t just “stay top of mind” — they become part of their clients’ lives.</p>
            <ul class="space-y-6 text-lg">
                <li><strong>Genuine Care First:</strong> Every touch should feel like it comes from a friend, not a salesperson. Ask about their kids, pets, new kitchen — remember details.</li>
                <li><strong>Give 10x More Than You Ask:</strong> Provide value freely. The referrals come naturally when people feel you genuinely want them to win.</li>
                <li><strong>Consistency Compounds:</strong> One thoughtful touch per month for 10 years beats 12 touches in one year.</li>
                <li><strong>They’re People, Not Leads:</strong> Celebrate their wins, acknowledge life events, show up when it matters — not just when you need business.</li>
                <li><strong>Your Database = Your Net Worth:</strong> A nurtured past client is worth 5–10x more over their lifetime than a new lead.</li>
            </ul>
            <p class="mt-6 font-semibold text-xl text-center text-[#00A89D]">The goal: Make every person in your database say, “I’d never use anyone else — and I tell everyone about them.”</p>
        </div>
    </div>

    <!-- Database Growth & Organization -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Build & Organize Your Database Like a Pro <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Start small, grow intentionally. Aim for quality over quantity.</p>

            <h4 class="text-lg font-bold mb-4">Core Categories (Tag Everyone – Click for Nurturing Strategies)</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <div onclick="openDatabaseModal('Past Clients')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Past Clients</h5>
        <p class="text-gray-600 dark:text-gray-400">Your gold mine (highest referral rate)</p>
    </div>
    <div onclick="openDatabaseModal('Sphere of Influence')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Sphere of Influence</h5>
        <p class="text-gray-600 dark:text-gray-400">Friends, family, social circle</p>
    </div>
    <div onclick="openDatabaseModal('Referral Partners')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Referral Partners</h5>
        <p class="text-gray-600 dark:text-gray-400">Realtors, builders, financial planners</p>
    </div>
    <div onclick="openDatabaseModal('Community Connections')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Community Connections</h5>
        <p class="text-gray-600 dark:text-gray-400">Local business owners, neighbors, groups</p>
    </div>
    <div onclick="openDatabaseModal('Prospects')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Prospects</h5>
        <p class="text-gray-600 dark:text-gray-400">Leads who didn’t close (yet)</p>
    </div>
    <div onclick="openDatabaseModal('A+ VIPs')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">A+ VIPs</h5>
        <p class="text-gray-600 dark:text-gray-400">Top 50 most connected/influential people</p>
    </div>
</div>

            <h4 class="text-lg font-bold mb-4">Growth Targets</h4>
            <ul class="space-y-4 text-lg">
                <li>Year 1: 300–500 contacts</li>
                <li>Year 3: 1,000+</li>
                <li>Year 5: 2,000+ (where the magic happens)</li>
                <li>Add 10–20 new people every month (events, referrals, social)</li>
            </ul>

            <p class="mt-6 font-semibold">Tool Tip: Use tags + custom fields in your CRM (birthdays, home anniversary, kids’ names, hobbies) — personalization at scale.</p>
        </div>
    </div>

    <!-- The 33-Touch System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">The Legendary 33-Touch Annual System <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">The proven formula: 33 meaningful touches per year = 1–3 referrals per 100 contacts.</p>

            <h4 class="text-lg font-bold mb-4">Your Annual Touch Calendar</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-[#002B5C]/5 dark:bg-[#002B5C]/20 p-6 rounded-2xl">
                    <strong>12 High-Value Touches</strong>
                    <ul class="list-disc pl-6 space-y-2 mt-4">
                        <li>Home Anniversary Card + Gift</li>
                        <li>Birthday Call/Card</li>
                        <li>Holiday Gift (pop-by or mailed)</li>
                        <li>Client Appreciation Event Invite</li>
                        <li>Personal Video Check-In (2x/year)</li>
                        <li>Equity Review Offer (annual)</li>
                        <li>Handwritten Note (3x/year)</li>
                        <li>Referral Partner Lunch</li>
                    </ul>
                </div>
                <div class="bg-[#00A89D]/5 dark:bg-[#00A89D]/20 p-6 rounded-2xl">
                    <strong>21 Low-Effort Touches</strong>
                    <ul class="list-disc pl-6 space-y-2 mt-4">
                        <li>Monthly Email Newsletter</li>
                        <li>Market Update Post (shared)</li>
                        <li>Social Media Engagement</li>
                        <li>Text Check-In (quarterly)</li>
                        <li>Event Photos Tagged</li>
                        <li>Quick Value Share (article, tip)</li>
                    </ul>
                </div>
            </div>

            <p class="font-semibold text-center text-xl">Do this consistently → 80%+ of your business will come from your database.</p>
        </div>
    </div>

    <!-- Life Event Nurturing -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Life Event Nurturing (The Referral Goldmine) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Major life events trigger moves. Be the first person they think of.</p>

            <h4 class="text-lg font-bold mb-4">Track & Respond to These Events</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Marriage</strong> → “Congrats! Thinking bigger home?”</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>New Baby</strong> → “Need more space? Let’s chat options.”</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Job Change/Promotion</strong> → Equity review or upgrade opportunity</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Empty Nest</strong> → Downsizing conversation</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Retirement</strong> → Reverse mortgage or cash-out options</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Divorce/Inheritance</strong> → Sensitive support + solutions</li>
            </ul>

            <p class="mt-6 font-semibold">Pro Move: Set calendar reminders for known events — show up when it matters most.</p>
        </div>
    </div>

    <!-- Client Appreciation & Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Client Appreciation Events & Touches <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Make your clients feel celebrated — this turns them into referral machines.</p>

            <h4 class="text-lg font-bold mb-4">Annual Event Ideas</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li><strong>Pie Day (March 14)</strong> – Deliver pies + “Thanks for letting me be part of your home journey”</li>
                <li><strong>Summer Picnic or Shred Day</strong> – Family-friendly, useful</li>
                <li><strong>Fall Pumpkin Giveaway</strong> – Porch drop-offs</li>
                <li><strong>Holiday Party or Cookie Exchange</strong> – Invite past clients + one guest</li>
                <li><strong>Home Anniversary Gift</strong> – Personalized (cutting board, doormat, ornament)</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Low-Cost High-Impact Touches</h4>
            <ul class="space-y-4 text-lg">
                <li>Handwritten anniversary card</li>
                <li>Birthday video message</li>
                <li>“Just Sold” postcard when their neighbor sells</li>
                <li>Equity position update (annual)</li>
                <li>Referral thank-you gift when they send business</li>
            </ul>
        </div>
    </div>

    <!-- Scalable Systems -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scaling Nurturing to 1,000+ Contacts <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Segment & Prioritize:</strong> A+ VIPs get personal calls, B’s get videos, C’s get automated value</li>
                <li><strong>Automate the Basics:</strong> Email sequences, birthday triggers, anniversary campaigns</li>
                <li><strong>Batch Personal Touches:</strong> Record 20 videos in one sitting, handwrite notes weekly</li>
                <li><strong>Outsource Execution:</strong> VA for scheduling, mailing, event planning</li>
                <li><strong>Track Engagement:</strong> Who opens emails? Who attends events? Double down on responders</li>
            </ul>

            <p class="mt-8 text-xl font-bold text-center text-[#00A89D]">You don’t need more leads. You need better relationships with the people you already know.</p>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center mt-12">
        <p class="text-2xl font-bold mb-4">Your database is your legacy.</p>
        <p class="text-xl">Nurture it like the gold mine it is — and it will take care of you for decades.</p>
    </div>
</section>
<section id="equity-scanner" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Equity & Opportunity Scanner</h2>
    <p class="mb-8 text-lg">Upload your past client spreadsheet → get a prioritized, interactive dashboard showing equity built, refi savings, cash-out potential, move-up power, and personalized outreach scripts. Turn your database into your #1 lead source.</p>

    <!-- Upload Area -->
    <div id="upload-area" class="border-4 border-dashed border-[#00A89D] rounded-2xl p-12 text-center hover:border-[#F15A29] transition-all cursor-pointer mb-8">
        <i class="fas fa-file-upload text-6xl text-[#00A89D] mb-6"></i>
        <p class="text-xl mb-4">Drag & drop your spreadsheet here<br><span class="text-sm block mt-2">or click to browse (CSV or Excel files only)</span></p>
        <input type="file" id="database-upload" accept=".csv,.xlsx,.xls" class="hidden">
        <button type="button" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-8 py-4 rounded-full font-bold shadow-lg hover:opacity-90">
            Choose File
        </button>
        <p id="file-status" class="text-sm text-gray-600 dark:text-gray-400 mt-6">No file chosen</p>
        <p id="file-name" class="mt-2 font-bold text-[#F15A29] hidden"></p>
    </div>
<!-- New Refinance Rate Input -->
    <div class="mb-8">
        <label for="new-rate">New Refinance Rate (%)</label>
        <input id="new-rate" type="number" step="0.125" value="6.0" min="0" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all">
    </div>
    <!-- Generate Button -->
    <div class="text-center mb-12">
        <button onclick="generateEquityReport(event)" class="w-full max-w-2xl mx-auto bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl">
            Generate Equity Report
        </button>
    </div>
    <!-- Instructions -->
    <div class="bg-blue-50 dark:bg-blue-900/30 p-6 rounded-2xl mb-8">
        <p class="font-semibold mb-2">Ideal columns (at minimum):</p>
        <ul class="list-disc pl-6 space-y-1 text-gray-700 dark:text-gray-300">
            <li>Borrower's Name</li>
            <li>Borrower's Phone</li>
            <li>Borrower's Email</li>
            <li>Property Address</li>
            <li>Closed Date</li>
            <li>Current Rate (or Original Rate)</li>
            <li>Current Balance (or Original Loan Amount)</li>
            <li>Current Term</li>
            <li>Appraised Value or Purchase Price</li>
        </ul>
           </div>

     <!-- Loading -->
    <div id="equity-loading" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden">
    <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl text-center max-w-md">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-[#F15A29] mx-auto mb-6"></div>
        <p class="text-2xl font-bold text-[#F15A29]">Processing Spreadsheet...</p>
        <p class="text-lg mt-4">This may take a few seconds for large files</p>
        <p id="progress-text" class="text-xl mt-6 text-[#00A89D] font-semibold">Starting...</p>
    </div>
</div>

    <!-- Output -->
    <div id="equity-output" class="hidden">
        <div id="opportunity-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mt-12">
    <!-- Cards will be injected here -->
</div>
        <div id="no-results" class="text-center py-20 text-2xl text-gray-500 hidden">
            No opportunities found. Try adjusting filters or uploading a different file.
        </div>
    </div>
</section>
                        <section id="process" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">The Loan Process – World-Class, Scalable, White-Glove</h2>
    <p class="mb-8 text-lg">This is your complete playbook for delivering an extraordinary, consistent client and referral partner experience — no matter if you're at 20 loans/month or 60. Over-communicate, systematize everything, and build processes that scale without sacrificing quality.</p>

    <!-- Core Principles -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">The 7 Core Principles of a Scalable World-Class Process <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ol class="list-decimal pl-6 space-y-6 text-lg">
                <li><strong>Set Expectations Early & Often</strong> – Day 1 timeline + weekly updates eliminate surprises.</li>
                <li><strong>Over-Communicate</strong> – Clients/partners should never wonder "what's happening?"</li>
                <li><strong>Systematize Everything Repeatable</strong> – Checklists, templates, automation = consistency at scale.</li>
                <li><strong>Weekly Pipeline Reviews</strong> – Catch issues early; non-negotiable for growth.</li>
                <li><strong>Personal Touchpoints</strong> – Videos, handwritten notes, post-close follow-up create raving fans.</li>
                <li><strong>Delegate Without Dropping Quality</strong> – Clear roles for processor, TC, assistant.</li>
                <li><strong>Measure & Improve</strong> – NPS surveys, referral rates, close ratios — track what matters.</li>
            </ol>
        </div>
    </div>

    <!-- Communication System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scalable Communication System (Client + Partner) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">The #1 driver of referrals and 5-star reviews: proactive, predictable communication.</p>

            <h4 class="text-lg font-bold mb-4">Client Weekly Touchpoint Schedule</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li><strong>Day 1:</strong> Personal welcome video + detailed timeline email + needs list</li>
                <li><strong>Every Monday:</strong> 60-second status video/email ("Here's where we are, what's next, anything needed from you")</li>
                <li><strong>Major Milestones:</strong> Immediate personal call/video (pre-approval, appraisal ordered/received, CTC, funding)</li>
                <li><strong>48 Hours Pre-Closing:</strong> Personal call confirming time/location/docs/funds</li>
                <li><strong>Day After Closing:</strong> Thank-you video + request for review/referral</li>
                <li><strong>7 Days Post-Close:</strong> NPS survey + "settling in" check-in</li>
                <li><strong>30 Days & 1 Year:</strong> Anniversary touch with small gift</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Realtor Partner Weekly Updates</h4>
            <ul class="space-y-4 text-lg">
                <li><strong>Every Thursday:</strong> Quick text/email: "File update: Appraisal due X, targeting CTC Y — anything I can do to support?"</li>
                <li><strong>Milestones:</strong> Immediate notification (approval, clear to close)</li>
                <li><strong>Post-Closing:</strong> Thank-you note + "smooth close" highlight for their marketing</li>
            </ul>

            <p class="mt-6 font-semibold">Pro Tip: Use CRM automation for templates — you stay personal while scaling to 50+ files.</p>
        </div>
    </div>

    <!-- Weekly Pipeline Review -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Weekly Pipeline Review Meeting (Your Growth Engine) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">30-minute Monday meeting with processor/assistant. This single habit allows LOs to triple volume without chaos.</p>

            <h4 class="text-lg font-bold mb-4">Exact Agenda (Run Every Week)</h4>
            <ol class="list-decimal pl-6 space-y-4 mb-8">
                <li><strong>Celebrate Wins</strong> (2 min) – Closings, approvals, great feedback</li>
                <li><strong>Aging Files Review</strong> (10 min) – Anything >7 days in underwriting/appraisal/conditions</li>
                <li><strong>This Week's Milestones</strong> (5 min) – Upcoming appraisals, CTCs, closings</li>
                <li><strong>Stalled Files Deep Dive</strong> (10 min) – What's blocking? Who owns next action?</li>
                <li><strong>Communication Check</strong> (3 min) – Any clients/partners needing touch this week?</li>
                <li><strong>Capacity Forecast</strong> (3 min) – How many new files can we comfortably take?</li>
            </ol>

            <p class="font-semibold">Document in shared pipeline tool (Encompass dashboard, Google Sheet, or CRM). Assign owners and due dates.</p>
        </div>
    </div>

    <!-- Checklists & Templates -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Essential Checklists & Templates <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">Day 1 Borrower Needs List (Send Immediately)</h4>
            <ul class="list-disc pl-6 space-y-2 mb-8">
                <li>Last 2 years tax returns (all pages/schedules)</li>
                <li>Last 60 days pay stubs</li>
                <li>2 months all asset statements (all pages)</li>
                <li>Driver's license + SSN card</li>
                <li>Current mortgage/HOA/insurance statements</li>
                <li>Explanation letters for credit inquiries, employment gaps, large deposits</li>
                <li>Divorce decree/child support (if applicable)</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Clear-to-Close Final Checklist</h4>
            <ul class="list-disc pl-6 space-y-2 mb-8">
                <li>All conditions satisfied & approved</li>
                <li>Closing Disclosure signed + 3-day period complete</li>
                <li>Funding conditions met (wire instructions confirmed)</li>
                <li>Homeowners insurance binder received & correct</li>
                <li>Final walkthrough completed (purchase)</li>
                <li>Closing package reviewed for accuracy</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Post-Closing Follow-Up Template</h4>
            <p class="italic mb-4">"Hi [Client], hope you're settling in beautifully! A few quick things:</p>
            <ul class="list-disc pl-6 space-y-2">
                <li>Your final documents are attached</li>
                <li>Please let me know if any mail forwarding/tax questions arise</li>
                <li>I'd love an honest Google review when convenient — it helps other families</li>
                <li>Who do you know buying/refinancing soon? Happy to help them too!</li>
            </ul>
        </div>
    </div>

    <!-- Scaling to High Volume -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scaling to 50–100+ Loans/Year Without Losing Quality <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Team Structure:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>15–25 files/month → Add licensed assistant</li>
                        <li>30+ → Full-time processor</li>
                        <li>50+ → Transaction coordinator + junior LO</li>
                    </ul>
                </li>
                <li><strong>Automation Wins:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>CRM milestone triggers for emails/texts</li>
                        <li>Loom videos for common questions</li>
                        <li>Templated condition responses</li>
                    </ul>
                </li>
                <li><strong>White-Glove at Scale:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Personal video at application & approval (you record, assistant sends)</li>
                        <li>Handwritten thank-you notes (batch weekly)</li>
                        <li>Post-close gift program (systematized but personalized)</li>
                        <li>Annual client events (systematized invitation process)</li>
                    </ul>
                </li>
                <li><strong>Key Metrics to Track Monthly:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Average days from app to close</li>
                        <li>% of files with zero suspense extensions</li>
                        <li>NPS score (aim 90+)</li>
                        <li>Referral partner satisfaction feedback</li>
                    </ul>
                </li>
            </ul>

            <p class="mt-8 text-xl font-bold text-center text-[#00A89D]">The secret: Systems + personal touches. You can have both at any volume.</p>
        </div>
    </div>

    <!-- Final Motivation -->
    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center">
        <p class="text-2xl font-bold mb-4">Every client should feel like your ONLY client.</p>
        <p class="text-xl">When you deliver that consistently, referrals become automatic and your business becomes unstoppable.</p>
    </div>
</section>
    <section id="social-post" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Social Media Post Creator</h2>
    <p class="mb-8 text-lg">Generate ready-to-post content that builds relationships, sparks engagement, and grows your reach organically.</p>

    <!-- Unified Form Wrapper -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Post Type Dropdown -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Post Type / Goal</label>
            <select id="post-type" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value=" " selected class="font-bold">Use Custom Idea (type below)</option>
                <option value="" disabled>──────────────────</option>

                <optgroup label="Educational & Myth-Busting">
                    <option value="Myth: You need 20% down to buy a home">Myth: You need 20% down to buy a home</option>
                    <option value="Pre-qual vs pre-approval: What's the difference?">Pre-qual vs pre-approval: What's the difference?</option>
                    <option value="How temporary rate buydowns work">How temporary rate buydowns work</option>
                    <option value="5 hidden costs every buyer should know">5 hidden costs every buyer should know</option>
                    <option value="How to boost your credit score fast">How to boost your credit score fast</option>
                    <option value="The truth about closing costs">The truth about closing costs</option>
                    <option value="FHA vs Conventional: Which is better?">FHA vs Conventional: Which is better?</option>
                    <option value="Why PMI isn't as bad as you think">Why PMI isn't as bad as you think</option>
                    <option value="What lenders really look for beyond credit">What lenders really look for beyond credit</option>
                    <option value="Red flags to avoid in your Loan Estimate">Red flags to avoid in your Loan Estimate</option>
                </optgroup>

                <optgroup label="Market Updates">
                    <option value="Local inventory is up/down — what it means for buyers">Local inventory is up/down — what it means for buyers</option>
                    <option value="Are rates trending up or down this week?">Are rates trending up or down this week?</option>
                    <option value="Is now a good time to buy or should you wait?">Is now a good time to buy or should you wait?</option>
                    <option value="Local home prices: Year-over-year update">Local home prices: Year-over-year update</option>
                    <option value="Why buyer competition is easing">Why buyer competition is easing</option>
                    <option value="Refinance opportunity alert">Refinance opportunity alert</option>
                    <option value="What the latest Fed news means for rates">What the latest Fed news means for rates</option>
                    <option value="Spring 2026 market preview">Spring 2026 market preview</option>
                </optgroup>

                <optgroup label="Local Community">
                    <option value="Shoutout to my favorite local coffee shop">Shoutout to my favorite local coffee shop</option>
                    <option value="Upcoming weekend event in town">Upcoming weekend event in town</option>
                    <option value="Hidden gem park or trail">Hidden gem park or trail</option>
                    <option value="Spotlight on a great local business">Spotlight on a great local business</option>
                    <option value="Best farmers market finds this season">Best farmers market finds this season</option>
                    <option value="New restaurant opening downtown">New restaurant opening downtown</option>
                    <option value="Local school or team achievement">Local school or team achievement</option>
                    <option value="Holiday lights tour recommendations">Holiday lights tour recommendations</option>
                </optgroup>

                <optgroup label="Personal & Behind-the-Scenes">
                    <option value="A day in the life of a loan officer">A day in the life of a loan officer</option>
                    <option value="Weekend family adventure">Weekend family adventure</option>
                    <option value="What I'm grateful for this week">What I'm grateful for this week</option>
                    <option value="My morning routine for staying sharp">My morning routine for staying sharp</option>
                    <option value="Coffee run before the approvals come in">Coffee run before the approvals come in</option>
                    <option value="Celebrating X years in mortgage">Celebrating X years in mortgage</option>
                    <option value="Book or podcast I'm loving right now">Book or podcast I'm loving right now</option>
                    <option value="Home office setup tour">Home office setup tour</option>
                </optgroup>

                <optgroup label="Client Wins & Celebrations">
                    <option value="Just helped another family get their keys!">Just helped another family get their keys!</option>
                    <option value="First-time buyer success story">First-time buyer success story</option>
                    <option value="Overcame a tough credit challenge">Overcame a tough credit challenge</option>
                    <option value="Refinance that saved big monthly">Refinance that saved big monthly</option>
                    <option value="From pre-approval to closing fast">From pre-approval to closing fast</option>
                    <option value="Helped a family win in a competitive market">Helped a family win in a competitive market</option>
                    <option value="Celebrating a smooth closing today">Celebrating a smooth closing today</option>
                    <option value="Turning 'maybe' into 'yes'">Turning "maybe" into "yes"</option>
                </optgroup>

                <optgroup label="Value & Resources">
                    <option value="Free 2026 Home Buyer Checklist">Free 2026 Home Buyer Checklist</option>
                    <option value="Questions every buyer should ask their lender">Questions every buyer should ask their lender</option>
                    <option value="Download my moving checklist">Download my moving checklist</option>
                    <option value="Free credit review offer">Free credit review offer</option>
                    <option value="Home maintenance calendar">Home maintenance calendar</option>
                    <option value="Local vendor list for new homeowners">Local vendor list for new homeowners</option>
                    <option value="Rate buydown explainer">Rate buydown explainer</option>
                </optgroup>

                <optgroup label="Engagement & Fun">
                    <option value="Poll: Rent forever or own your home?">Poll: Rent forever or own your home?</option>
                    <option value="This or That: Beach vs mountain home?">This or That: Beach vs mountain home?</option>
                    <option value="Tag a friend who needs this tip">Tag a friend who needs this tip</option>
                    <option value="What's your dream home feature?">What's your dream home feature?</option>
                    <option value="Fixer-upper or move-in ready?">Fixer-upper or move-in ready?</option>
                    <option value="Relatable: When rates drop and everyone calls">Relatable: When rates drop and everyone calls</option>
                </optgroup>

                <optgroup label="Motivational">
                    <option value="Your dream home is worth the effort">Your dream home is worth the effort</option>
                    <option value="Homeownership builds wealth over time">Homeownership builds wealth over time</option>
                    <option value="Don't wait to buy real estate — buy and wait">Don't wait to buy real estate — buy and wait</option>
                    <option value="Small steps lead to big keys">Small steps lead to big keys</option>
                    <option value="Mindset: You deserve this">Mindset: You deserve this</option>
                </optgroup>

                <optgroup label="Holiday / Seasonal">
                    <option value="Favorite holiday tradition">Favorite holiday tradition</option>
                    <option value="New Year's home goals for 2026">New Year's home goals for 2026</option>
                    <option value="Grateful this holiday season">Grateful this holiday season</option>
                    <option value="Spring cleaning + refinance tip">Spring cleaning + refinance tip</option>
                </optgroup>

                <optgroup label="Realtor Partner Value">
                    <option value="How I support my realtor partners">How I support my realtor partners</option>
                    <option value="Fast pre-approvals for your buyers">Fast pre-approvals for your buyers</option>
                    <option value="Co-branded tools ready for you">Co-branded tools ready for you</option>
                    <option value="Shoutout to an amazing agent partner">Shoutout to an amazing agent partner</option>
                    <option value="Why agents love working with me">Why agents love working with me</option>
                </optgroup>
            </select>
        </div>

        <!-- Custom Details with Dynamic Helper -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">
                Custom Idea or Additional Details
                <span id="details-helper" class="block text-base font-normal text-gray-600 dark:text-gray-400 mt-2">
                    e.g., Shout out to my favorite local coffee shop, or quick tip on credit scores
                </span>
            </label>
            <textarea id="post-details" rows="4" 
                      placeholder="Be sure to include any additional details here to help shape or personalize your post" 
                      class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 resize-none"></textarea>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="generateSocialPost()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Generate My Post Now
            </button>
        </div>
        </div>
        
<div class="mt-16">
    <!-- Collapsible Trigger (Premium Expand Button) -->
    <button type="button" onclick="toggleCalendarSection()" class="w-full text-left focus:outline-none group">
        <div class="flex items-center justify-between bg-gradient-to-r from-[#002B5C]/50 to-[#00A89D]/30 rounded-3xl p-10 hover:from-[#002B5C]/70 hover:to-[#00A89D]/50 transition-all shadow-2xl cursor-pointer border border-[#00A89D]/20">
            <div class="flex items-center">
                <i class="fas fa-calendar-alt text-6xl text-[#F15A29] mr-8"></i>
                <div>
                    <h2 class="text-4xl font-bold text-[#F15A29]">Full-Year Social Media Calendar Planner</h2>
                    <p class="text-lg mt-3 text-gray-300 group-hover:text-white transition-colors">
                        Click to expand → Generate a complete Excel calendar with themed days + 3–4 ready-to-post ideas for every day of the year
                    </p>
                </div>
            </div>
            <i id="calendar-toggle-icon" class="fas fa-chevron-down text-5xl text-[#00A89D] transition-transform duration-500 group-hover:scale-110"></i>
        </div>
    </button>

    <!-- Collapsible Content (hidden by default) -->
    <div id="calendar-content" class="hidden mt-12 space-y-12">
        <!-- Intro Description -->
        <p class="text-lg text-gray-700 dark:text-gray-300 max-w-4xl">
            While you're creating individual posts, lock in consistency for the entire year. This planner gives you a downloadable Excel with themed days + 3–4 ready-to-post ideas every single day — 75% personal/engagement for real connections, 25% business for growth.
        </p>

        <!-- Why This Works Callouts -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 p-6 rounded-2xl text-center border border-[#00A89D]/20">
                <i class="fas fa-heart text-4xl text-[#F15A29] mb-4"></i>
                <p class="font-bold">Build Real Relationships</p>
                <p class="text-sm mt-2">Heavy on personal, local, and engagement content</p>
            </div>
            <div class="bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 p-6 rounded-2xl text-center border border-[#00A89D]/20">
                <i class="fas fa-chart-line text-4xl text-[#00A89D] mb-4"></i>
                <p class="font-bold">Grow Without Burning Out</p>
                <p class="text-sm mt-2">Know exactly what to post — no more blank-page stress</p>
            </div>
            <div class="bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 p-6 rounded-2xl text-center border border-[#00A89D]/20">
                <i class="fas fa-download text-4xl text-[#F15A29] mb-4"></i>
                <p class="font-bold">Ready-to-Use Excel</p>
                <p class="text-sm mt-2">Printable, editable, with holidays & hashtags included</p>
            </div>
        </div>

        <!-- Live Preview Sample -->
        <div class="p-8 bg-white/5 dark:bg-gray-800/50 rounded-3xl overflow-x-auto border border-[#00A89D]/30 shadow-lg">
            <h4 class="text-2xl font-bold mb-6 text-[#00A89D] text-center">Live Preview: Sample Week (January 2026)</h4>
            <table class="w-full text-left border-collapse min-w-[800px]">
                <thead>
                    <tr class="bg-gradient-to-r from-[#002B5C]/50 to-[#00A89D]/30">
                        <th class="p-4 border border-[#00A89D]/30 font-bold">Date</th>
                        <th class="p-4 border border-[#00A89D]/30 font-bold">Theme</th>
                        <th class="p-4 border border-[#00A89D]/30 font-bold">Idea 1</th>
                        <th class="p-4 border border-[#00A89D]/30 font-bold">Idea 2</th>
                        <th class="p-4 border border-[#00A89D]/30 font-bold">Idea 3</th>
                        <th class="p-4 border border-[#00A89D]/30 font-bold">Idea 4</th>
                    </tr>
                </thead>
                <tbody class="text-sm">
                    <tr class="bg-gray-50/50 dark:bg-gray-900/50">
                        <td class="p-4 border">January 1, 2026</td>
                        <td class="p-4 border">Personal & Relax Sunday</td>
                        <td class="p-4 border">New Year's morning coffee tradition ☕</td>
                        <td class="p-4 border">2026 goals I'm excited about</td>
                        <td class="p-4 border">Family NYE recap photo</td>
                        <td class="p-4 border">Poll: Your #1 resolution?</td>
                    </tr>
                    <tr>
                        <td class="p-4 border">January 5, 2026</td>
                        <td class="p-4 border">Motivational Monday</td>
                        <td class="p-4 border">Quote: "The best way to predict the future is to create it"</td>
                        <td class="p-4 border">My why: Helping Hoosier families buy homes</td>
                        <td class="p-4 border">Weekend hike in Indiana trails</td>
                        <td class="p-4 border">Small win from last week</td>
                    </tr>
                    <tr class="bg-gray-50/50 dark:bg-gray-900/50">
                        <td class="p-4 border">January 6, 2026</td>
                        <td class="p-4 border">Tip Tuesday</td>
                        <td class="p-4 border">Quick tip: How to boost credit 50+ points fast</td>
                        <td class="p-4 border">Morning walk in Auburn neighborhood</td>
                        <td class="p-4 border">Favorite local coffee spot shoutout</td>
                        <td class="p-4 border">This or That: FHA vs Conventional?</td>
                    </tr>
                </tbody>
            </table>
            <p class="text-center mt-6 text-gray-500 italic">Your full calendar will have 365 tailored days just like this →</p>
        </div>

        <!-- Inputs Card -->
        <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-12 rounded-3xl shadow-2xl border border-[#00A89D]/20">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-10">
                <div>
                    <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Year</label>
                    <input type="number" id="calendar-year" value="2026" min="2024" max="2030" 
                           class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all">
                </div>
                <div>
                    <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Week Starts On</label>
                    <select id="week-start" 
                            class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all">
                        <option value="Sun">Sunday</option>
                        <option value="Mon" selected>Monday</option>
                    </select>
                </div>
                <div>
                    <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Template</label>
                    <select id="calendar-template" 
                            class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all">
                        <option value="balanced">Balanced Loan Officer (Recommended)</option>
                        <option value="engagement">High Engagement Focus</option>
                        <option value="personal">Personal Brand Builder</option>
                        <option value="realtor">Realtor Partnership Focus</option>
                        <option value="custom">Custom (AI-Personalized)</option>
                    </select>
                </div>
            </div>

            <div id="custom-preferences" class="hidden mb-10">
                <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Customization Prompt</label>
                <textarea id="custom-prompt" rows="5" placeholder="e.g., Heavy Indiana/Auburn local focus, more family posts, include DeKalb County events, realtor partnership tips, motivational Mondays..."
                          class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all"></textarea>
            </div>

            <div class="text-center">
                <button onclick="generateCalendar()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl flex items-center justify-center">
                    <i class="fas fa-calendar-alt mr-4 text-3xl"></i> Generate & Download My Full-Year Calendar
                </button>
            </div>

            <div id="calendar-loading" class="hidden mt-12 text-center">
                <div class="w-full max-w-md mx-auto bg-gray-700 rounded-full h-6 mb-6 overflow-hidden">
                    <div id="progress-bar" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] h-6 rounded-full w-0 transition-all duration-700"></div>
                </div>
                <p class="text-xl">Building your personalized calendar... <span id="progress-text">0%</span></p>
                <i class="fas fa-spinner fa-spin text-4xl mt-6 text-[#00A89D]"></i>
            </div>

            <div id="calendar-success" class="hidden mt-12 p-8 bg-green-900/50 rounded-3xl text-center border border-green-500">
                <i class="fas fa-check-circle text-6xl text-green-400 mb-4"></i>
                <p class="text-2xl font-bold">Success! Your calendar is ready.</p>
                <p class="mt-4">Check your downloads folder — start posting with confidence all year!</p>
            </div>
        </div>
    </div>
</div>

    <!-- Output -->
    <div id="social-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96 hidden">
        <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
            <!-- Post content will appear here -->
        </div>
        <div class="text-center">
            <button onclick="copySocialPost()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                📋 Copy Post to Clipboard
            </button>
        </div>
    </div>

    <!-- Pro Tips Card -->
    <div class="mt-12 bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 rounded-3xl p-10 border-2 border-[#00A89D]/30">
        <h3 class="text-2xl font-bold mb-6 text-[#002B5C] dark:text-[#00A89D]">Pro Tips for Maximum Engagement</h3>
        <ul class="space-y-4 text-lg text-gray-700 dark:text-gray-300 list-disc pl-6">
            <li><strong>Educational + Local + Personal + Client Wins + Value</strong> — these are your 5 content pillars</li>
            <li><strong>Ask questions</strong> — polls, "What do you think?", tag friends</li>
            <li><strong>Post consistently</strong> — follow the weekly schedule (Motivation Monday, Tip Tuesday, etc.)</li>
            <li><strong>Use stories daily</strong> — behind-the-scenes, quick tips, polls</li>
            <li><strong>Tag local businesses/partners</strong> — increases reach exponentially</li>
            <li><strong>End with subtle CTA</strong> — "DM me", "Comment below", "Tag a friend who needs this"</li>
            <li><strong>Be human</strong> — share hobbies, family (with permission), wins, and lessons</li>
        </ul>
    </div>
  
</section>
                    
                <section id="sales-script" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Sales Script Generator</h2>
    <p class="mb-8 text-lg">Generate natural, relationship-focused scripts for any sales situation. Select a common scenario or type your own — get 3–5 warm, effective scripts instantly.</p>

    <!-- Unified Form Wrapper -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Sales Situation Dropdown -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Sales Situation</label>
            <select id="script-scenario-select" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value=" " selected class="font-bold">Use Custom Scenario (type below)</option>
                <option value="" disabled>──────────────────</option>
                
                <optgroup label="Borrower Objections">
                    <option value="Rates are too high right now">Borrower says: "Rates are too high right now"</option>
                    <option value="We're going to wait for rates to drop">Borrower says: "We're going to wait for rates to drop"</option>
                    <option value="I want to wait until after the election">Borrower says: "I want to wait until after the election"</option>
                    <option value="I don't have enough for a down payment">Borrower says: "I don't have enough for a down payment"</option>
                    <option value="My credit isn't good enough">Borrower says: "My credit isn't good enough"</option>
                    <option value="I'm happy renting / not ready to buy">Borrower says: "I'm happy renting / not ready to buy"</option>
                    <option value="I can get a better deal online">Borrower says: "I can get a better deal online"</option>
                    <option value="A friend/family member is a loan officer">Borrower says: "A friend/family member is a loan officer"</option>
                    <option value="I already have a lender">Borrower says: "I already have a lender"</option>
                    <option value="I'm just shopping around / getting info">Borrower says: "I'm just shopping around / getting info"</option>
                    <option value="Buying a home is too stressful">Borrower says: "Buying a home is too stressful"</option>
                    <option value="I don't want to pay PMI">Borrower says: "I don't want to pay PMI"</option>
                    <option value="I heard closing costs are really high">Borrower says: "I heard closing costs are really high"</option>
                </optgroup>
                
                <optgroup label="Realtor Partner Objections">
                    <option value="I'm happy with my current lender">Realtor says: "I'm happy with my current lender"</option>
                    <option value="I'm too busy right now">Realtor says: "I'm too busy right now"</option>
                    <option value="I have multiple lenders I use">Realtor says: "I have multiple lenders I use"</option>
                    <option value="Your rates aren't competitive">Realtor says: "Your rates aren't competitive"</option>
                    <option value="I only work with [big bank]">Realtor says: "I only work with [big bank]"</option>
                    <option value="My clients go direct to their bank">Realtor says: "My clients go direct to their bank"</option>
                </optgroup>
                
                <optgroup label="Asking for Business">
                    <option value="Ask a realtor for a 1:1 meeting">Ask a realtor for a 1:1 meeting</option>
                    <option value="Ask a borrower for an application call">Ask a borrower for an application call</option>
                    <option value="Encourage borrower to lock rate or move forward">Encourage borrower to lock rate or move forward</option>
                    <option value="Ask past client for referrals">Ask past client for referrals</option>
                    <option value="Offer to monitor rates for future refinance">Offer to monitor rates for future refinance</option>
                    <option value="Re-engage a borrower who went elsewhere">Re-engage a borrower who went elsewhere</option>
                    <option value="Invite realtor to lunch/coffee">Invite realtor to lunch/coffee</option>
                    <option value="Welcome a new real estate agent to the market">Welcome a new real estate agent to the market</option>
                    <option value="Support a realtor having a slow month">Support a realtor having a slow month</option>
                </optgroup>
                
                <optgroup label="Relationship Building">
                    <option value="Follow up after sending pre-approval or quote">Follow up after sending pre-approval or quote</option>
                    <option value="Offer value to a realtor partner">Offer value to a realtor partner</option>
                    <option value="Thank realtor partner after a closing">Thank realtor partner after a closing</option>
                    <option value="Birthday or home anniversary check-in">Birthday or home anniversary check-in</option>
                    <option value="Reinforce I'm your loan officer for life">Reinforce "I'm your loan officer for life"</option>
                    <option value="Reach out for annual equity review">Reach out for annual equity review</option>
                    <option value="Help past client who is relocating">Help past client who is relocating</option>
                    <option value="Talk to investor about next property purchase">Talk to investor about next property purchase</option>
                    <option value="Remind client to complete post-closing survey">Remind client to complete post-closing survey</option>
                </optgroup>
                
                <optgroup label="Special Situations">
                    <option value="Client moving out of state">Client moving out of state</option>
                    <option value="Client buying second home/vacation property">Client buying second home/vacation property</option>
                    <option value="Client going through divorce">Client going through divorce</option>
                    <option value="Client inheriting property">Client inheriting property</option>
                    <option value="Client with non-traditional income">Client with non-traditional income (self-employed, gig)</option>
                    <option value="Client with recent credit event">Client with recent credit event (bankruptcy, foreclosure)</option>
                </optgroup>
            </select>
        </div>

        <!-- Custom Scenario – Only visible when custom selected -->
        <div id="custom-scenario-wrapper" class="space-y-3">
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Custom Scenario (type your own)</label>
            <textarea id="custom-scenario" rows="3" placeholder="Describe the exact situation (e.g., Client wants to buy but has a recent short sale)" 
                      class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none"></textarea>
        </div>

        <!-- Additional Context -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Additional Context (optional – helps make scripts better)</label>
            <textarea id="script-context" rows="4" placeholder="e.g., first-time buyer, strong referral partner, move-up buyer, investor, self-employed" 
                      class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none"></textarea>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="generateSalesScript()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Generate Scripts
            </button>
        </div>

        <!-- Loading Spinner -->
        <div id="script-loading" class="text-center py-12 hidden">
            <i class="fas fa-spinner fa-spin text-6xl text-[#00A89D]"></i>
            <p class="mt-6 text-2xl text-gray-600 dark:text-gray-400 font-medium">
                Generating your scripts... this takes 10–20 seconds
            </p>
        </div>
    </div>

    <!-- Output -->
    <div id="script-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96 hidden">
        <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
            <!-- Scripts will be inserted here -->
        </div>
        <div class="text-center">
            <button onclick="copySalesScripts()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                📋 Copy All Scripts
            </button>
        </div>
    </div>
</section>
        <section id="eventplanning" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Event Planning – Build Relationships & Generate Referrals</h2>
    <p class="mb-8 text-lg">Events are one of the highest-ROI activities for loan officers. Done right, they strengthen relationships with past clients, impress referral partners, and create organic leads — all while being fun and memorable. This is your complete playbook for planning, executing, and following up on events that drive business.</p>

    <!-- Hero Quote -->
    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center mb-12">
        <p class="text-2xl italic mb-4">"People may forget what you said, but they’ll never forget how you made them feel."</p>
        <p class="text-xl font-semibold">Great events create emotional connections — and emotional connections create referrals.</p>
    </div>

    <!-- 1. Event Strategy & Mindset -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">1. Event Strategy & Mindset <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Value First:</strong> The event should feel like a gift — no hard selling.</li>
                <li><strong>Invite +1:</strong> Encourage guests to bring a friend — built-in lead generation.</li>
                <li><strong>Co-Host for Leverage:</strong> Partner with realtors, builders, or local businesses to share costs and expand reach.</li>
                <li><strong>Frequency Goal:</strong> 4–6 events/year (mix of client appreciation, partner education, community)</li>
                <li><strong>Budget Rule:</strong> $20–$50 per attendee is plenty for massive ROI</li>
                <li><strong>Measure Success:</strong> Attendance, social shares, referrals generated, partner feedback</li>
            </ul>
            <p class="mt-6 font-semibold text-center text-xl text-[#00A89D]">One well-executed event can generate 5–20+ referrals over the next 12 months.</p>
        </div>
    </div>

    <!-- 2. Client Appreciation Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">2. Client Appreciation Events (Turn Clients into Raving Fans) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-gray-50 dark:bg-gray-900 p-8 rounded-3xl">
                    <strong class="text-xl block mb-4">Low-Cost, High-Impact Ideas</strong>
                    <ul class="list-disc pl-6 space-y-4">
                        <li><strong>Pie Day (March 14)</strong> – Deliver pies to past clients (“Thanks for letting me be part of your home journey!”)</li>
                        <li><strong>Summer Ice Cream Social</strong> – Park or office, $300–500 budget</li>
                        <li><strong>Fall Pumpkin Giveaway</strong> – Porch drop-offs or pickup event</li>
                        <li><strong>Shredding Day</strong> – Partner with shred company (often free), add coffee/donuts</li>
                        <li><strong>Holiday Cookie Exchange</strong> – Clients bring cookies, you provide cocoa + photos</li>
                    </ul>
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-8 rounded-3xl">
                    <strong class="text-xl block mb-4">Premium Experiences</strong>
                    <ul class="list-disc pl-6 space-y-4">
                        <li><strong>Family Movie Night</strong> – Rent theater screen or outdoor projector</li>
                        <li><strong>Wine Tasting or Cooking Class</strong> – Partner with local venue</li>
                        <li><strong>Sporting Event Suite</strong> – For top 50 clients + partners</li>
                        <li><strong>Charity Gala or 5K Team</strong> – Give back together</li>
                    </ul>
                </div>
            </div>
            <p class="mt-6 font-semibold">Key: Invite past clients + one guest. Photos + social sharing = free marketing.</p>
        </div>
    </div>

    <!-- 3. Partner Education Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">3. Partner Education Events (Become Indispensable) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Position yourself as the expert — agents will send you business to avoid looking uninformed.</p>
            <ul class="space-y-6 text-lg">
                <li><strong>Lunch & Learns (30–45 min)</strong><br>Topics: Buydowns, renovation loans, DPA programs, non-QM, market updates<br>Cater lunch ($10–15/head) at their office</li>
                <li><strong>Happy Hour Education</strong><br>Casual venue, drinks + 20-min talk on “Winning Offers in 2026”</li>
                <li><strong>Quarterly Mastermind</strong><br>Invite top 20 agents for roundtable + your market insights</li>
                <li><strong>Virtual Webinars</strong><br>“First-Time Buyer Programs Update” — record for replay</li>
            </ul>
            <p class="mt-6 font-semibold">Pro Tip: End with Q&A and “Who do you have coming up I can pre-approve?”</p>
        </div>
    </div>

    <!-- 4. Community & Charity Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">4. Community & Charity Events (Build Local Reputation) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Sponsor Local Sports Team</strong> – Banner + team party invite</li>
                <li><strong>Host Food/Clothing Drive</strong> – Collection boxes at office, partner with realtors</li>
                <li><strong>Charity 5K or Golf Outing Team</strong> – Co-sponsor with partners</li>
                <li><strong>Back-to-School Supply Drive</strong> – Partner with title company or builder</li>
                <li><strong>Holiday Toy Drive</strong> – Partner with local fire department</li>
            </ul>
            <p class="mt-6 font-semibold">Share stories on social — authenticity builds trust and visibility.</p>
        </div>
    </div>

    <!-- 5. Event Planning Blueprint -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">5. Step-by-Step Event Planning Blueprint <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <table class="w-full text-left border-collapse mb-8">
                <thead>
                    <tr class="bg-[#002B5C] text-white">
                        <th class="p-4">Timeline</th>
                        <th class="p-4">Task</th>
                        <th class="p-4">Details</th>
                    </tr>
                </thead>
                <tbody class="bg-gray-50 dark:bg-gray-900">
                    <tr>
                        <td class="p-4 border-t">8–12 Weeks Out</td>
                        <td class="p-4 border-t">Choose Event & Date</td>
                        <td class="p-4 border-t">Align with season/holiday, check partner availability</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">6–8 Weeks Out</td>
                        <td class="p-4 border-t">Secure Venue & Partners</td>
                        <td class="p-4 border-t">Co-host to share costs, book early</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">4–6 Weeks Out</td>
                        <td class="p-4 border-t">Create Invite List & Design</td>
                        <td class="p-4 border-t">Past clients + partners + their guests, use Canva</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">3–4 Weeks Out</td>
                        <td class="p-4 border-t">Send Invites & RSVPs</td>
                        <td class="p-4 border-t">Email + text reminder, track responses</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">1–2 Weeks Out</td>
                        <td class="p-4 border-t">Final Logistics</td>
                        <td class="p-4 border-t">Food, signage, gifts, photo backdrop</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Day Of</td>
                        <td class="p-4 border-t">Execute & Capture Content</td>
                        <td class="p-4 border-t">Arrive early, take photos/videos, thank everyone</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">1–3 Days After</td>
                        <td class="p-4 border-t">Follow-Up</td>
                        <td class="p-4 border-t">Thank-you email + photos, request feedback/reviews</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 6. Budget Templates -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">6. Sample Budget Templates <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-3xl">
                    <strong class="text-xl block mb-4">Low Budget ($300–600)</strong>
                    <ul class="space-y-3">
                        <li>Pie Day delivery (50 pies @ $10)</li>
                        <li>Shredding day (shred partner free + coffee)</li>
                        <li>Pumpkin giveaway</li>
                    </ul>
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-3xl">
                    <strong class="text-xl block mb-4">Medium Budget ($800–1,500)</strong>
                    <ul class="space-y-3">
                        <li>Ice cream social (food truck)</li>
                        <li>Lunch & learn for 30 agents</li>
                        <li>Holiday cookie exchange</li>
                    </ul>
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-3xl">
                    <strong class="text-xl block mb-4">Premium ($2,000+)</strong>
                    <ul class="space-y-3">
                        <li>Movie night theater rental</li>
                        <li>Wine tasting venue</li>
                        <li>Sporting event suite</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 7. Follow-Up System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">7. Post-Event Follow-Up (Turn Events into Referrals) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Day 1:</strong> Thank-you email with photo collage + "Who should I invite next time?"</li>
                <li><strong>Day 3:</strong> Post event highlights on social (tag attendees)</li>
                <li><strong>Week 1:</strong> Personal thank-you call to top partners/guests</li>
                <li><strong>Week 2:</strong> Send printed photos or small thank-you gift</li>
                <li><strong>Month 1:</strong> "Saw this and thought of you" touch with event memory</li>
            </ul>
            <p class="mt-6 font-semibold">The follow-up is where the magic happens — this turns one event into years of referrals.</p>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#F15A29] text-white p-12 rounded-3xl text-center mt-16">
        <p class="text-3xl font-bold mb-6">Events aren't expenses — they're investments in relationships.</p>
        <p class="text-2xl">Plan 4–6 memorable events per year, execute flawlessly, and watch your referral business explode.</p>
    </div>
</section>
        <section id="resources" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Resources</h2>
            <p class="mb-4">Leverage these for growth.</p>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scripts or Word Tracks <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Rate Locking:</strong> "Based on current trends, locking now secures your rate – option 1: 'Let's protect against rises.' Option 2: 'What are your thoughts on timing?' Option 3: 'This gives peace of mind; ready?' Option 4: 'Market volatile; lock to avoid regret.' Option 5: 'Secure today, float down if rates drop.'"</li>
                        <li><strong>Asking for Lunch:</strong> "I'd love to catch up over lunch – when works? Option 2: 'Let's discuss co-marketing over lunch?' Option 3: 'Free lunch on me to brainstorm?' Option 4: 'How open to lunch next week?' Option 5: 'Lunch to share market insights?'"</li>
                        <li><strong>Asking for a Meeting:</strong> "When good for a quick meeting? Option 2: 'Let's meet to align on goals.' Option 3: 'Schedule a strategy session?' Option 4: 'Meeting to explore partnership?' Option 5: 'Chat over coffee about business?'"</li>
                        <li><strong>Survey:</strong> "You'll get a survey post-closing; my team strives for you to be comfortable rating us 5 stars. If not, call me – I want to improve. Your feedback helps us serve better and continue providing the smooth process we aim for."</li>
                        <li><strong>Referral:</strong> "Who do you know needing mortgage help? Option 2: 'Happy to help friends/family – intro?' Option 3: 'Referral your biggest compliment.' Option 4: 'Know anyone buying/refinancing?' Option 5: 'Share my name with network?'"</li>
                        <li><strong>Realtor Intro:</strong> "Have agent? If not, great intro. Option 2: 'Connect to top realtor?' Option 3: 'Partner with excellent agents – recommend?' Option 4: 'Need realtor suggestion?' Option 5: 'Let's team with proven realtor.'"</li>
                        <li><strong>For Agent:</strong> "What can I do to earn more of your business?"</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Potential Uses of Expense Report <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Business cards, signs, marketing materials.</li>
                        <li>Client/referral entertainment (lunches, events).</li>
                        <li>Gifts, pop-bys, appreciation parties.</li>
                        <li>Ads, sponsorships (golf, events).</li>
                        <li>Training, conferences.</li>
                    </ul>
                    <p class="mt-4"><a href="https://2759433.fs1.hubspotusercontent-na1.net/hubfs/2759433/Ruoff%20Expense%20Reimbursement%20Policy%206-1-2022.pdf" target="_blank" class="text-[#00A89D] hover:text-[#F15A29] underline">View Expense Policy</a></p>
                </div>
            
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Potential CRM Campaigns <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Prospect Realtor: Intro, value adds, meetings.</li>
                        <li>Past Client Nurture: Check-ins, equity reviews, events.</li>
                        <li>Referral Partner: Updates, co-marketing.</li>
                        <li>Lead Generation: Seminars, ads follow-up.</li>
                        <li>Automated Journeys: Status updates, birthdays, alerts.</li>
                        <li>Segment by rate/milestones.</li>
                    </ul>
                </div>
                       </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">How to Create Email Message Templates <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ol class="list-decimal pl-6 space-y-2">
                        <li>On Home menu, New E-mail (CTRL+SHIFT+M).</li>
                        <li>Enter content in body.</li>
                        <li>File > Save As > Outlook Template.</li>
                        <li>Name and save.</li>
                        <li>To use: New Items > More > Choose Form > User Templates > Select > Open > Edit > Send.</li>
                    </ol>
                    <p class="mt-4">Changes not saved to template; resave for updates.</p>
                </div>
            </div>
        </section>
                <section id="underwriting-search" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Underwriting Guideline Search</h2>
    <p class="mb-8 text-lg">Ask any underwriting question (Conventional, FHA, VA, USDA, Non-QM) and get a clear, accurate answer with confidence level.</p>

    <!-- Important Warning -->
    <div class="bg-red-50 dark:bg-red-900/30 border-2 border-red-500 dark:border-red-600 rounded-2xl p-6 mb-8 shadow-md">
        <p class="text-lg font-bold text-red-800 dark:text-red-200">
            <i class="fas fa-exclamation-triangle mr-2 text-red-600 dark:text-red-400 text-2xl"></i>
            Always verify final decisions with official guidelines and Ruoff overlays.
        </p>
    </div>

    <!-- Unified Form Wrapper -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Question Input -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Your Underwriting Question</label>
            <textarea id="uw-question" rows="4" placeholder="e.g., What are the minimum credit score requirements for FHA with compensating factors? Can a borrower with a recent bankruptcy qualify for Conventional? DTI limits for VA loans?"
                      class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 resize-none"></textarea>
        </div>

        <!-- Loan Type Dropdown -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Loan Type (optional)</label>
            <select id="uw-loan-type" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value="any">Any / General</option>
                <option value="conventional">Conventional</option>
                <option value="fha">FHA</option>
                <option value="va">VA</option>
                <option value="usda">USDA</option>
                <option value="non-qm">Non-QM / Jumbo</option>
            </select>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="searchUnderwriting()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Search Guidelines
            </button>
        </div>

        <!-- Loading Spinner (Large & Clear) -->
        <div id="uw-loading" class="text-center py-12 hidden">
            <i class="fas fa-spinner fa-spin text-6xl text-[#00A89D]"></i>
            <p class="mt-6 text-2xl text-gray-600 dark:text-gray-400 font-medium">
                Researching guidelines... this takes 10–20 seconds
            </p>
        </div>
    </div>

    <!-- Output -->
    <div id="uw-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96 hidden">
        <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
            <!-- Response will appear here -->
        </div>
        <div class="text-center">
            <button onclick="copyUwOutput()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                📋 Copy Response
            </button>
        </div>
    </div>
</section>
                <section id="blog" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Blog Creator – Authority-Building Content in Seconds</h2>
    <p class="mb-8 text-lg">Generate SEO + GEO-optimized blog posts that position you as the trusted expert. Select a topic from the list or type your own, choose your tone, and get a ready-to-publish post (800–1,200 words).</p>

    <!-- Unified Form Wrapper -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Tone Selector -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Blog Tone</label>
            <select id="blog-tone" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value="Friendly & Relatable" selected>Friendly & Relatable (Recommended)</option>
                <option value="Educational & Informative">Educational & Informative</option>
                <option value="Professional & Authoritative">Professional & Authoritative</option>
                <option value="Fun & Lighthearted">Fun & Lighthearted</option>
                <option value="Motivational & Inspiring">Motivational & Inspiring</option>
            </select>
        </div>

        <!-- Topic Dropdown + Custom Input -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Blog Topic</label>
            <select id="blog-topic-select" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 mb-4">
    <option value="" selected>Use Custom Topic (type below)</option>
    <option value="" disabled>──────────────────</option>
                
        <optgroup label="First-Time Home Buyers">
        <option>The Complete 2026 Guide to Buying Your First Home</option>
        <option>How Much Down Payment Do You Really Need in 2026?</option>
        <option>First-Time Buyer Programs: What’s Available and How to Qualify</option>
        <option>The Biggest Mistakes First-Time Buyers Make (and How to Avoid Them)</option>
        <option>Buying a Home with Student Loans: Yes, It’s Possible!</option>
        <option>How to Get Pre-Approved: What Lenders Really Look For</option>
        <option>Closing Costs Explained: What First-Time Buyers Should Budget</option>
        <option>Should You Buy Now or Wait for Lower Rates in 2026?</option>
        <option>The Truth About PMI: When You Need It and How to Cancel</option>
        <option>Building Equity as a First-Time Buyer: Strategies That Work</option>
        <option>Navigating Home Inspections: What Every First-Time Buyer Must Know</option>
        <option>Choosing the Right Neighborhood: Schools, Commute, and Resale Value</option>
        <option>HOA Fees Explained: Pros, Cons, and What to Watch For</option>
        <option>Buying a Condo vs. Single-Family Home: Which Is Right for You?</option>
        <option>First-Time Buyer Tax Credits and Incentives in 2026</option>
        <option>How to Win in a Competitive Market Without Overpaying</option>
        <option>Eco-Friendly Homes: Energy Incentives and Green Mortgage Options</option>
        <option>The Role of a Buyer’s Agent: Do You Really Need One?</option>
        <option>Is a Home Warranty Worth It for First-Time Buyers?</option>
        <option>Remote Work and Relocation: Financing Your Move in 2026</option>
    </optgroup>

    <optgroup label="Refinancing & Rates">
        <option>Should You Refinance in 2026? A Complete Guide</option>
        <option>When Is the Best Time to Refinance Your Mortgage?</option>
        <option>Temporary Rate Buydowns Explained: Lower Payments for the First Few Years</option>
        <option>Cash-Out Refinance: When It Makes Sense (and When It Doesn’t)</option>
        <option>Refinancing to Remove PMI: Step-by-Step</option>
        <option>How Much Can You Save by Refinancing? Real Examples</option>
        <option>Refinance Myths That Could Cost You Thousands</option>
        <option>ARMs vs Fixed: Which Is Better in Today’s Market?</option>
        <option>Rate-and-Term vs. Cash-Out: Which Refinance Is Right for You?</option>
        <option>No-Closing-Cost Refinance: Is It Really Free?</option>
        <option>Streamline Refinancing for FHA and VA Loans: Faster and Easier</option>
        <option>How Your Credit Score Impacts Refinance Rates in 2026</option>
        <option>Refinancing After a Recent Purchase: When It’s Allowed</option>
        <option>Locking Your Rate: Timing Tips to Save Money</option>
        <option>Refinancing Investment Properties: Special Rules and Benefits</option>
        <option>HELOC vs. Cash-Out Refinance: Which Is Better for Home Improvements?</option>
    </optgroup>

    <optgroup label="Credit & Qualification">
        <option>How to Improve Your Credit Score Before Buying a Home</option>
        <option>Can You Buy a Home with a Credit Score Under 620? The Truth</option>
        <option>Debt-to-Income Ratio Explained: How Lenders Really Look at It</option>
        <option>Common Credit Report Errors That Block Approvals</option>
        <option>Non-Traditional Credit: How to Qualify Without a FICO Score</option>
        <option>Rapid Rescoring: Boost Your Score in Days</option>
        <option>Hard vs. Soft Credit Inquiries: What Borrowers Need to Know</option>
        <option>Using Gift Funds for Down Payment: Rules and Documentation</option>
        <option>Asset Depletion Mortgages: Qualifying with Investments Instead of Income</option>
        <option>Compensating Factors That Help Lower Credit Scores Get Approved</option>
        <option>Employment Gaps: How to Explain Them to Lenders</option>
        <option>Co-Borrowers and Co-Signers: Pros, Cons, and Risks</option>
        <option>Bankruptcy and Foreclosure: How Long Until You Can Buy Again?</option>
    </optgroup>

    <optgroup label="Homeownership & Lifestyle">
        <option>The Hidden Costs of Homeownership (and How to Budget for Them)</option>
        <option>Rent vs Buy in 2026: The Math You Need to Know</option>
        <option>Home Renovation Loans: 203(k), HomeStyle, and More</option>
        <option>Is Homeownership Still Worth It in 2026?</option>
        <option>Moving Up: How to Buy Your Second Home</option>
        <option>Downsizing in Retirement: Financial and Emotional Considerations</option>
        <option>Turning Your Home into an Income Property</option>
        <option>Home Maintenance 101: Essential Costs New Owners Overlook</option>
        <option>Energy Efficiency Upgrades: Financing Options and Tax Credits</option>
        <option>Property Taxes and Assessments: What to Expect After Closing</option>
        <option>Multi-Generational Homes: Financing and Design Trends</option>
        <option>Pet-Friendly Home Buying: Features That Matter Most</option>
        <option>Home Insurance Basics: Coverage Every Homeowner Needs</option>
        <option>Sustainable Homeownership: Lowering Bills and Carbon Footprint</option>
    </optgroup>

    <optgroup label="Loan Programs">
        <option>FHA Loans in 2026: Lower MIP and New Guidelines</option>
        <option>VA Loans: The Best Benefit Most Veterans Don’t Use</option>
        <option>USDA Loans: Zero Down in Rural and Suburban Areas</option>
        <option>Jumbo Loans: What Changed in 2026 and How to Qualify</option>
        <option>Non-QM Loans: Options for Self-Employed and Investors</option>
        <option>Bank Statement Loans for Gig Workers and Entrepreneurs</option>
        <option>Reverse Mortgages: New Rules and Who Benefits</option>
        <option>Conventional 97% LTV Loans: Low Down Payment Options</option>
        <option>Physician and Medical Professional Loans: Special Benefits</option>
        <option>DSCR Loans: Investor Financing Based on Property Cash Flow</option>
        <option>Construction and Renovation-to-Permanent Loans</option>
        <option>ITIN Loans: Homeownership for Non-Citizens</option>
        <option>Bridge Loans: Short-Term Financing for Move-Up Buyers</option>
        <option>HELOCs and Home Equity Loans: Current Rates and Uses</option>
    </optgroup>

    <optgroup label="Market Trends & Insights">
        <option>Mortgage Rate Forecast for 2026: What Experts Are Saying</option>
        <option>Why Home Inventory Is Increasing (and What It Means for Buyers)</option>
        <option>The Truth About iBuyers and Instant Offers in 2026</option>
        <option>Investment Properties in 2026: Where the Opportunities Are</option>
        <option>How Inflation and Fed Policy Affect Mortgage Rates</option>
        <option>New Construction vs Resale: Pros, Cons, and Financing</option>
        <option>Affordable Housing Initiatives and Programs in 2026</option>
        <option>The Rise of Build-to-Rent Communities: Should You Buy or Rent?</option>
        <option>Climate Risk and Insurance: How It’s Changing Home Buying</option>
        <option>Immigration and Population Growth: Impact on Local Housing Demand</option>
        <option>Technology in Real Estate: Virtual Tours, Digital Closings, and More</option>
        <option>Regional Market Spotlight: Where Prices Are Rising/Falling in 2026</option>
    </optgroup>

    <optgroup label="The Mortgage Process">
        <option>Step-by-Step: The Mortgage Application Process in 2026</option>
        <option>What Happens at Closing? A Day-by-Day Breakdown</option>
        <option>Home Appraisal vs. Home Inspection: Key Differences</option>
        <option>Escrow Accounts Explained: Taxes and Insurance Made Simple</option>
        <option>Title Insurance: Why You Need It and What It Covers</option>
        <option>Underwriting: What Lenders Check Behind the Scenes</option>
        <option>Clear to Close: Final Steps Before Getting Your Keys</option>
        <option>Common Closing Delays and How to Avoid Them</option>
        <option>Digital Mortgages: Faster Approvals and E-Closing Options</option>
        <option>Contingencies Explained: Appraisal, Inspection, and Financing</option>
    </optgroup>

    <optgroup label="Investment Properties">
        <option>Financing Your First Rental Property in 2026</option>
        <option>DSCR Loans Explained: No Personal Income Required</option>
        <option>1031 Exchanges: Defer Taxes When Upgrading Investments</option>
        <option>BRRRR Strategy: How to Scale Your Portfolio with Financing</option>
        <option>Short-Term Rentals: Airbnb and VRBO Financing Options</option>
        <option>Portfolio Loans: Managing Multiple Investment Properties</option>
        <option>Cash-Out Refinance on Rentals: Pulling Equity for More Deals</option>
        <option>Fix-and-Flip Loans: Hard Money vs. Traditional Options</option>
        <option>Tax Benefits Every Real Estate Investor Should Know</option>
        <option>Multi-Family Properties: Financing 2–4 Units vs. Larger Complexes</option>
    </optgroup>
</select>

            <input type="text" id="blog-topic" placeholder="Or type your own custom topic here" 
                   class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Select or type a topic → choose tone → click Generate to create your blog post!</p>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="generateBlog()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Generate Blog Post
            </button>
        </div>

        <!-- Helpful Hints for Blog Content (add after Generate Blog button) -->
<div class="mt-8 bg-blue-50 dark:bg-blue-900/30 p-6 rounded-2xl shadow-inner border border-blue-200 dark:border-blue-700">
    <h3 class="text-xl font-bold text-[#00A89D] mb-4">Quick Tips for Creating Great Blog Content</h3>
    <ul class="list-disc pl-6 space-y-3 text-gray-700 dark:text-gray-300 text-base">
         <li>How to Use This Tool: Input your topic, tone (e.g., professional or conversational), and length. Click Generate — the AI creates a draft optimized for readability and SEO.</li>
         <li>Choose a Relevant Topic: Focus on timely mortgage issues like "Interest Rate Trends" or "First-Time Homebuyer Tips" to attract readers searching for real estate advice. Use keywords like "mortgage rates 2026" for SEO.</li>
        <li>Keep It Engaging and Short: Aim for 800-1200 words. Start with a hook question or statistic, use subheadings, and include calls-to-action like "Contact me for a free rate quote."</li>
        <li>Best Practices After Generation: Always read through the blog for accuracy (verify facts like rates or regulations). Edit to add personal anecdotes, like "In my 10 years as an LO, I've helped clients save thousands by refinancing early." This makes it authentic and builds trust.</li>
        <li>Publish and Promote: Once edited, post on your website or LinkedIn. Share on social media with a teaser and link back to your contact info. Track engagement to refine future posts.</li>
    </ul>
</div>
        <!-- Loading Spinner (Now Matches Social Post & Sales Script) -->
        <div id="blog-loading" class="text-center py-12 hidden">
            <i class="fas fa-spinner fa-spin text-6xl text-[#00A89D]"></i>
            <p class="mt-6 text-2xl text-gray-600 dark:text-gray-400 font-medium">
                Generating your blog post... this takes 20–40 seconds
            </p>
        </div>
    </div>

    <!-- Blog Output -->
    <div id="blog-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96">
               <h4 class="text-3xl font-bold text-[#F15A29] mb-6 mt-12">Suggested Social Media Caption</h4>
<div id="social-caption" class="bg-gray-100 dark:bg-gray-700 p-6 rounded-2xl text-lg mb-8 whitespace-pre-wrap"></div>

<!-- Copy Buttons -->
<div class="flex flex-col md:flex-row gap-6 justify-center">
    <button id="copy-blog-btn" class="bg-[#F15A29] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#F15A29]/80 flex items-center justify-center gap-3">
        <i class="fas fa-copy"></i> Copy Blog (with Formatting)
    </button>
    <button id="copy-caption-btn" class="bg-[#00A89D] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#00A89D]/80 flex items-center justify-center gap-3">
        <i class="fas fa-share-alt"></i> Copy Social Caption
    </button>
</div>
    </div>
</section>

 <section id="books" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Recommended Books</h2>
            <p class="mb-4">Explore these highly rated books to enhance your skills in sales, networking, and more.</p>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Sales <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Never Split the Difference by Chris Voss</strong>: Negotiation tactics from FBI hostage negotiator. Benefits: Improve closing deals. Link: <a href="https://www.amazon.com/Never-Split-Difference-Negotiating-Depended/dp/0062407805" target="_blank">Amazon</a></li>
                        <li><strong>The Laws of Human Nature by Robert Greene</strong>: Understand psychology for better sales. Benefits: Build stronger relationships. Link: <a href="https://www.amazon.com/Laws-Human-Nature-Robert-Greene/dp/0143110012" target="_blank">Amazon</a></li>
                        <li><strong>Fanatical Prospecting by Jeb Blount</strong>: Prospecting strategies. Benefits: Increase leads. Link: <a href="https://www.amazon.com/Fanatical-Prospecting-Conversations-Leveraging-Telephone/dp/1119144752" target="_blank">Amazon</a></li>
                        <li><strong>The ONE Thing by Gary Keller</strong>: Focus on key tasks. Benefits: Boost productivity. Link: <a href="https://www.amazon.com/ONE-Thing-Surprisingly-Extraordinary-Results/dp/1885167776" target="_blank">Amazon</a></li>
                        <li><strong>Crushing Call Reluctance for Loan Officers by Carl White</strong>: Overcome call fear. Benefits: Increase prospecting. Link: <a href="https://www.amazon.com/Crushing-Call-Reluctance-for-Loan-Officers/dp/B07Z8G5Y3G" target="_blank">Amazon</a></li>
                        <li><strong>Loan Officer Champions by Carl White</strong>: Case studies from top LOs. Benefits: Learn from success. Link: <a href="https://www.amazon.com/Loan-Officer-Champions-Studies-Producers/dp/173246555X" target="_blank">Amazon</a></li>
                        <li><strong>Be the Better Broker, Volume 1 by Dustan Woodhouse</strong>: Become top producer. Benefits: Practical LO tips. Link: <a href="https://www.amazon.com/Be-Better-Broker-Become-Producer/dp/1988344034" target="_blank">Amazon</a></li>
                        <li><strong>The Millionaire Loan Officer by Scott Hudspeth</strong>: Advanced strategies. Benefits: Scale business. Link: <a href="https://www.amazon.com/Millionaire-Loan-Officer-Scott-Hudspeth/dp/0971619409" target="_blank">Amazon</a></li>
                        <li><strong>The Mortgage 101 Bootcamp by David Dutton</strong>: Basics for new LOs. Benefits: Foundational knowledge. Link: <a href="https://www.amazon.com/Mortgage-101-Bootcamp-David-Dutton/dp/B07Z8G5Y3G" target="_blank">Amazon</a></li>
                        <li><strong>Pass the Mortgage Loan Originator Test by Real Estate Institute</strong>: Exam prep. Benefits: Certification success. Link: <a href="https://www.amazon.com/Pass-Mortgage-Loan-Originator-Test/dp/0997581808" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Networking <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Never Eat Alone by Keith Ferrazzi</strong>: Networking strategies. Benefits: Build connections. Link: <a href="https://www.amazon.com/Never-Eat-Alone-Expanded-Updated/dp/0385346654" target="_blank">Amazon</a></li>
                        <li><strong>The Connector's Advantage by Michelle Tillis Lederman</strong>: Grow network. Benefits: Referral growth. Link: <a href="https://www.amazon.com/Connectors-Advantage-7-Traits-Highly/dp/1989025358" target="_blank">Amazon</a></li>
                        <li><strong>How to Win Friends and Influence People by Dale Carnegie</strong>: Classic networking. Benefits: Relationship skills. Link: <a href="https://www.amazon.com/How-Win-Friends-Influence-People/dp/0671027034" target="_blank">Amazon</a></li>
                        <li><strong>Networking in the 21st Century by David J.P. Fisher</strong>: Modern networking. Benefits: Digital connections. Link: <a href="https://www.amazon.com/Networking-21st-Century-Professionals-Connections/dp/1944730036" target="_blank">Amazon</a></li>
                        <li><strong>The Go-Giver by Bob Burg</strong>: Giving for networking. Benefits: Value-based relationships. Link: <a href="https://www.amazon.com/Go-Giver-Expanded-Edition-Little-Story/dp/1591848288" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Prospecting <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Fanatical Prospecting by Jeb Blount</strong>: Prospecting techniques. Benefits: Consistent leads. Link: <a href="https://www.amazon.com/Fanatical-Prospecting-Conversations-Leveraging-Telephone/dp/1119144752" target="_blank">Amazon</a></li>
                        <li><strong>New Sales Simplified by Mike Weinberg</strong>: Prospecting focus. Benefits: Pipeline building. Link: <a href="https://www.amazon.com/New-Sales-Simplified-Prospecting-Development/dp/0814431771" target="_blank">Amazon</a></li>
                        <li><strong>Crushing Call Reluctance for Loan Officers by Carl White</strong>: Call strategies. Benefits: Overcome fear. Link: <a href="https://www.amazon.com/Crushing-Call-Reluctance-for-Loan-Officers/dp/B07Z8G5Y3G" target="_blank">Amazon</a></li>
                        <li><strong>Loan Officer Champions by Carl White</strong>: Prospecting case studies. Benefits: Proven methods. Link: <a href="https://www.amazon.com/Loan-Officer-Champions-Studies-Producers/dp/173246555X" target="_blank">Amazon</a></li>
                        <li><strong>Be the Better Broker, Volume 1 by Dustan Woodhouse</strong>: Prospecting for LOs. Benefits: Top producer tips. Link: <a href="https://www.amazon.com/Be-Better-Broker-Become-Producer/dp/1988344034" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Database <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Database Design for Mere Mortals by Michael J. Hernandez</strong>: Database basics. Benefits: Efficient client management. Link: <a href="https://www.amazon.com/Database-Design-Mere-Mortals-Hands/dp/0136788041" target="_blank">Amazon</a></li>
                        <li><strong>The Database Hacker's Handbook by David Litchfield</strong>: Security. Benefits: Protect data. Link: <a href="https://www.amazon.com/Database-Hackers-Handbook-Defending-Servers/dp/0764578014" target="_blank">Amazon</a></li>
                        <li><strong>Database Systems by Thomas Connolly</strong>: Implementation. Benefits: CRM optimization. Link: <a href="https://www.amazon.com/Database-Systems-Design-Implementation-Management/dp/1305866797" target="_blank">Amazon</a></li>
                        <li><strong>Cracking the CRM Code by Limesh Parekh</strong>: CRM strategies. Benefits: Sales database. Link: <a href="https://www.amazon.com/Cracking-CRM-Code-Limesh-Parekh/dp/B08L5S4K2H" target="_blank">Amazon</a></li>
                        <li><strong>Customer Relationship Management by V. Kumar</strong>: CRM best practices. Benefits: Retention. Link: <a href="https://www.amazon.com/Customer-Relationship-Management-Concept-Strategy/dp/3662553805" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Customer Service <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Raving Fans by Ken Blanchard</strong>: Exceptional service. Benefits: Client loyalty. Link: <a href="https://www.amazon.com/Raving-Fans-Revolutionary-Approach-Customer/dp/0688123163" target="_blank">Amazon</a></li>
                        <li><strong>The Customer Rules by Lee Cockerell</strong>: Service principles. Benefits: Mortgage client care. Link: <a href="https://www.amazon.com/Customer-Rules-Essential-Delivering-Sensational/dp/0770435602" target="_blank">Amazon</a></li>
                        <li><strong>Hug Your Customers by Jack Mitchell</strong>: Personalized service. Benefits: Relationship building. Link: <a href="https://www.amazon.com/Hug-Your-Customers-Proven-Customers/dp/1401303668" target="_blank">Amazon</a></li>
                        <li><strong>The Mortgage Professional's Handbook</strong>: Industry service. Benefits: LO-specific tips. Link: <a href="https://www.amazon.com/Mortgage-Professionals-Handbook-Volumes-III/dp/0997581808" target="_blank">Amazon</a></li>
                        <li><strong>Becoming the Successful Mortgage Broker by Jason C. Myers</strong>: Service in mortgages. Benefits: Client satisfaction. Link: <a href="https://www.amazon.com/Becoming-Successful-Mortgage-Broker-Myers/dp/1982220848" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Negotiations <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Never Split the Difference by Chris Voss</strong>: Negotiation tactics. Benefits: Better deals. Link: <a href="https://www.amazon.com/Never-Split-Difference-Negotiating-Depended/dp/0062407805" target="_blank">Amazon</a></li>
                        <li><strong>Getting to Yes by Roger Fisher</strong>: Principled negotiation. Benefits: Win-win outcomes. Link: <a href="https://www.amazon.com/Getting-Yes-Negotiating-Agreement-Without/dp/0143118757" target="_blank">Amazon</a></li>
                        <li><strong>The Art of Negotiation by Michael Wheeler</strong>: Dynamic negotiating. Benefits: Adapt in real-time. Link: <a href="https://www.amazon.com/Art-Negotiation-How-Get-Deals/dp/1451690428" target="_blank">Amazon</a></li>
                        <li><strong>Bargaining for Advantage by G. Richard Shell</strong>: Strategy. Benefits: Mortgage negotiations. Link: <a href="https://www.amazon.com/Bargaining-Advantage-Negotiation-Strategies-Reasonable/dp/0143036971" target="_blank">Amazon</a></li>
                        <li><strong>Ninja Selling by Larry Kendall</strong>: Subtle negotiation. Benefits: LO sales. Link: <a href="https://www.amazon.com/Ninja-Selling-Subtle-Skills-Results/dp/1626342849" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Financial Management <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Rich Dad Poor Dad by Robert Kiyosaki</strong>: Financial literacy. Benefits: Personal finance. Link: <a href="https://www.amazon.com/Rich-Dad-Poor-Teach-Middle/dp/1612680194" target="_blank">Amazon</a></li>
                        <li><strong>The Total Money Makeover by Dave Ramsey</strong>: Debt management. Benefits: Budgeting. Link: <a href="https://www.amazon.com/Total-Money-Makeover-Classic-Financial/dp/1400205298" target="_blank">Amazon</a></li>
                        <li><strong>Financial Intelligence for Entrepreneurs by Karen Berman</strong>: Business finance. Benefits: LO finances. Link: <a href="https://www.amazon.com/Financial-Intelligence-Entrepreneurs-Numbers-Really/dp/1422119122" target="_blank">Amazon</a></li>
                        <li><strong>Profit First by Mike Michalowicz</strong>: Profit-focused. Benefits: Sales finances. Link: <a href="https://upmetrics.co/template/mortgage-broker-business-plan" target="_blank">Amazon</a></li>
                        <li><strong>The Richest Man in Babylon by George S. Clason</strong>: Wealth building. Benefits: Timeless advice. Link: <a href="https://www.amazon.com/Richest-Man-Babylon-George-Clason/dp/0451205367" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Other Relevant Categories <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Leadership: The 21 Irrefutable Laws of Leadership by John C. Maxwell</strong>: Leadership skills. Benefits: Team management. Link: <a href="https://www.amazon.com/21-Irrefutable-Laws-Leadership-Anniversary/dp/0785288376" target="_blank">Amazon</a></li>
                        <li><strong>Productivity: Atomic Habits by James Clear</strong>: Habit building. Benefits: Daily efficiency. Link: <a href="https://www.amazon.com/Atomic-Habits-Proven-Build-Break/dp/0735211299" target="_blank">Amazon</a></li>
                        <li><strong>Mindset: Mindset by Carol S. Dweck</strong>: Growth mindset. Benefits: Personal development. Link: <a href="https://www.amazon.com/Mindset-Psychology-Carol-S-Dweck/dp/0345472322" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
        </section>
                <!-- AI Chat Section -->
        <section id="ai-chat" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">AI Chat Assistant</h2>
    <p class="mb-8 text-lg">Ask me anything — sales scripts, market updates, marketing ideas, motivation, or just chat. I'm here to help you win.</p>
    <div id="chat-messages" class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl mb-6 min-h-32 max-h-96 overflow-y-auto prose dark:prose-invert max-w-none transition-all duration-300">
    <!-- Messages appear here -->
</div>
    <div class="flex space-x-4">
        <textarea id="chat-input" rows="3" class="flex-grow p-4 rounded-lg border border-[#00A89D] focus:ring-[#F15A29] text-lg resize-none" placeholder="Type your message..."></textarea>
        <button onclick="sendChatMessage()" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-6 py-4 rounded-lg font-bold hover:opacity-90">Send</button>
    </div>
    <div id="chat-loading" class="text-center mt-6 hidden">
        <i class="fas fa-spinner fa-spin text-4xl text-[#00A89D]"></i>
        <p class="mt-4 text-xl">Thinking...</p>
    </div>
</section>
                <section id="calculator" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Advanced Payment Calculator</h2>
            <p class="mb-6">Estimate monthly payments with taxes, insurance, PMI, extra payments, and biweekly options. See lifetime interest, payoff timeline, and potential savings.</p>

            <form id="calc-form" class="space-y-4 calc-grid gap-4">
                <label class="block"><strong>Loan Amount ($):</strong> 
                    <input type="number" id="loanAmount" min="50000" value="300000" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Interest Rate (%):</strong> 
                    <input type="number" id="rate" min="0" step="0.001" value="6.5" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Loan Term (years):</strong> 
                    <input type="number" id="term" min="10" max="40" value="30" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Annual Property Taxes ($):</strong> 
                    <input type="number" id="taxes" value="3600" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Annual Homeowners Insurance ($):</strong> 
                    <input type="number" id="insurance" value="1500" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>PMI Rate (% of loan, if &lt;20% down):</strong> 
    <input type="number" id="pmi" step="0.01" value="0" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
</label>
                <label class="block"><strong>Extra Monthly Payment ($):</strong> 
                    <input type="number" id="extraMonthly" value="0" placeholder="e.g., 200" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block flex items-center">
                    <input type="checkbox" id="biweekly" class="mr-3 h-5 w-5 text-[#00A89D]">
                    <strong>Make Biweekly Payments (26 per year)</strong>
                </label>
            </form>

            <button type="button" onclick="calculateAdvanced()" class="mt-8 bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-8 py-4 rounded-full hover:opacity-90 w-full font-bold text-lg">
           
            <div id="calc-output" class="mt-8 space-y-6"></div>
        </section>
                <!-- MISSING SECTION: Value Vault -->
                <section id="value-vault" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Value Vault – Your Ultimate Resource Library</h2>
    <p class="mb-8 text-lg">Packed with client-facing guides, realtor partnership tools, objection handlers, pop-by ideas, social scripts, and more. Everything here is designed to help you deliver massive value first—building trust, generating referrals, and closing more loans naturally.</p>

    <!-- Referral Partners + Follow-Up -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Referral Partners: Building Lifelong Relationships <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6"><strong>Why Consistent Follow-Up Wins Referrals:</strong> Studies show 80% of sales require 5+ touches, yet most stop after 2. Value-first follow-up keeps you top-of-mind and turns partners into referral machines.</p>
            
            <h4 class="text-lg font-bold mb-3">Pro Follow-Up Cadence & Tips</h4>
            <ul class="list-disc pl-6 space-y-2 mb-6">
                <li>Top 10 partners → Weekly touch; others → Monthly.</li>
                <li>Mix mediums: Call → Text/Video → Pop-By → Email → Handwritten note.</li>
                <li>Always lead with value (market update, tool, client win story).</li>
                <li>Personalize heavily: Mention their recent listing, birthday, or mutual client.</li>
                <li>Track everything in CRM: Last touch + next planned action.</li>
                <li>Natural ask: “Who do you know moving or refinancing in the next 6 months?”</li>
            </ul>

            <h4 class="text-lg font-bold mb-3">Ready-to-Use Follow-Up Scripts</h4>
            <ul class="space-y-4">
                <li><strong>Quick Text/Video:</strong> “Hey [Name], just helped [Mutual Client] close smoothly—they loved working with you! Any buyers I can pre-approve this week?”</li>
                <li><strong>Value Email Opener:</strong> “Sharing this week’s rate watch + new buyer checklist. Happy to co-brand for your clients!”</li>
                <li><strong>Pop-By Delivery:</strong> “Quick drop-off to say thanks for the last referral—plus fresh open house tools for you!”</li>
                <li><strong>Phone Check-In:</strong> “How’s business treating you? Anything I can do to support your listings this month?”</li>
            </ul>
        </div>
    </div>

    <!-- Client-Facing Resources -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Client-Facing Resources & Guides <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Share these trusted, compliant resources instantly (all free public links—replace with Ruoff-branded versions when ready).</p>
            <ul class="space-y-6">
                <li><strong>First-Time Homebuyer Toolkit</strong> – Official CFPB guide (gold standard): <a href="https://files.consumerfinance.gov/f/201503_cfpb_your-home-loan-toolkit-web.pdf" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Download PDF</a></li>
                <li><strong>Home Inspection & Shopping Checklist</strong> – HUD official: <a href="https://www.hud.gov/sites/documents/checklist-en.pdf" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Download PDF</a></li>
                <li><strong>Rent vs. Own Calculator</strong> – Interactive tool: <a href="https://www.nytimes.com/interactive/2024/upshot/buy-rent-calculator.html" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">NYT Calculator</a></li>
                <li><strong>Refinance Breakeven Calculator</strong>: <a href="https://www.bankrate.com/mortgages/mortgage-refinance-break-even-calculator/" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Bankrate Tool</a></li>
                <li><strong>Credit Improvement Tips</strong> – Free annual report access: AnnualCreditReport.com</li>
                <li><strong>Moving Checklist</strong> – Comprehensive timeline (custom branded version coming).</li>
                <li><strong>Down Payment Assistance (Ruoff States)</strong>:
                    <ul class="list-disc pl-6 mt-2 space-y-1">
                        <li>Indiana (IHCDA) → Up to 6%: <a href="https://www.in.gov/ihcda/homeowners-and-renters/first-time-homebuyers/" target="_blank" class="text-[#00A89D]">Details</a></li>
                        <li>Ohio (OHFA) → 2.5–5%: <a href="https://ohiohome.org/ownwithohfa/" target="_blank" class="text-[#00A89D]">Details</a></li>
                        <li>Michigan (MSHDA) → Up to $10K: <a href="https://www.michigan.gov/mshda/homeownership" target="_blank" class="text-[#00A89D]">Details</a></li>
                        <li>Kentucky (KHC): <a href="https://www.kyhousing.org/Products/Pages/Down-Payment-Assistance.aspx" target="_blank" class="text-[#00A89D]">Details</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <!-- Realtor Partner Tools -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Realtor Co-Branded Tools & Ideas <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6">
                <li><strong>Co-Branded Flyers</strong> – Open house, 2-1 buydown, buyer presentations (use Canva/Etsy templates).</li>
                <li><strong>Ruoff Marketing Portal</strong> – Ready-made flyers, social graphics, videos: <a href="https://marketing.ruoff.com/" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Visit Site</a></li>
                <li><strong>Open House Support Kit</strong> – Pre-approval station signage, financing one-pagers, sign-in sheets.</li>
                <li><strong>Joint Value Adds</strong> – Co-host buyer seminars, lunch & learns, or virtual webinars (“Homebuyer 101”).</li>
                <li><strong>Weekly Market Snapshots</strong> – Share short rate + inventory updates (offer to co-brand for their clients).</li>
                <li><strong>Scripts for Realtors</strong>:
                    <ul class="list-disc pl-6 space-y-2">
                        <li>“Let’s get your buyer pre-approved today—it strengthens every offer.”</li>
                        <li>“I can run numbers on that listing—want a quick equity review for the seller?”</li>
                        <li>“If affordability is tight, I have buydown or DPA options—happy to jump on a call.”</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <!-- Objection Handlers -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Top Objection Handlers & Scripts <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">“Rates Are Too High” – 5 Responses</h4>
            <ol class="list-decimal pl-6 space-y-3 mb-8">
                <li>“I hear that often—rates feel higher than 2021. But home prices keep rising. Let’s compare buy now vs wait 12 months.”</li>
                <li>“We have 2-1 buydown options that lower your rate for the first two years—want to see numbers?”</li>
                <li>“What rate would feel good? I can show ARMs or lender credits that get us close.”</li>
                <li>“Rates cycle—many who waited paid more overall. Rent vs own comparison?”</li>
                <li>“With projected equity growth, owning still beats renting long-term for most.”</li>
            </ol>

            <h4 class="text-lg font-bold mb-4">“I’m Waiting for Rates to Drop”</h4>
            <ol class="list-decimal pl-6 space-y-3 mb-8">
                <li>“Totally understandable. But if rates drop 1%, prices often rise 10% from competition. Marry the house, date the rate—we can refi later at no cost.”</li>
                <li>“No one has a crystal ball. I’ve helped clients who waited 2 years and missed $50K+ in equity.”</li>
                <li>“Let’s get you approved now—when rates drop, we refinance seamlessly.”</li>
            </ol>

            <h4 class="text-lg font-bold mb-4">“My Credit Score Is Too Low”</h4>
            <ol class="list-decimal pl-6 space-y-3 mb-8">
                <li>“Many buyers start where you are. We have rapid-rescore programs and credit boost strategies—let’s review your report together.”</li>
                <li>“What score are you seeing? I’ve helped clients raise 50+ points in 3–6 months with simple steps.”</li>
                <li>“Good news—there are programs for scores as low as 580. Want to see what you qualify for today?”</li>
            </ol>

            <h4 class="text-lg font-bold mb-4">“I Don’t Have Enough for Down Payment”</h4>
            <ol class="list-decimal pl-6 space-y-3">
                <li>“You may not need 20%—many programs allow 3–5% or even 0% down. Let’s check state assistance options.”</li>
                <li>“Gift funds from family are allowed on most loans—have you considered that?”</li>
                <li>“We have down payment assistance in IN/OH/MI/KY—up to $10K forgiven. Want details?”</li>
            </ol>
        </div>
    </div>

    <!-- Pop-By & Giveaways -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Pop-By & Giveaway Ideas <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Budget $5–15. Attach tag with pun + contact info. Highest ROI marketing activity!</p>
            
            <h4 class="text-lg font-bold mb-3">Year-Round Favorites</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <li>Reusable tote → “Let’s BAG your dream home!”</li>
                <li>Coffee gift card → “Thanks a LATTE for the referral!”</li>
                <li>Lottery tickets → “You’re a WINNER in my book!”</li>
                <li>Sunscreen → “Protecting your biggest investment!”</li>
                <li>Candle → “You LIGHT up the market!”</li>
                <li>Popcorn → “Just POPPING by to say thanks!”</li>
                <li>Plant seeds → “Watching your business GROW!”</li>
                <li>Hand sanitizer → “We’ve got you COVERED!”</li>
                <li>Mints → “We’re MINT to work together!”</li>
                <li>Cookie mix → “You’re one SMART COOKIE!”</li>
                <li>Shout wipes → “I’ll SHOUT it from the rooftops when you send a referral!”</li>
                <li>Tape measure → “You always MEASURE up!”</li>
                <li>Flashlight → “You LIGHT the way for your clients!”</li>
                <li>Stress ball → “Squeezing in a quick thank you!”</li>
            </ul>

            <h4 class="text-lg font-bold mb-3">Seasonal & Holiday Hits (Perfect for December!)</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <li>Spring seeds/packets → “Putting down ROOTS this spring!”</li>
                <li>Summer spatula → “Ready to FLIP some houses?”</li>
                <li>Fall pumpkin spice → “You’re the PUMPKIN SPICE of real estate!”</li>
                <li>Winter hot cocoa → “WARM wishes from your lender!”</li>
                <li>Holiday whisk + kisses → “We WHISK you a Merry KISSmas!”</li>
                <li>New Year champagne poppers → “POP into the New Year with new goals!”</li>
                <li>Valentine candy → “You’re the KEY to my success!”</li>
                <li>St. Patrick’s shamrock → “LUCKY to work with you!”</li>
                <li>Ice scraper → “SCRAPING by to say thanks – stay safe this winter!”</li>
                <li>Hand warmers → “WARMING up our partnership this holiday season!”</li>
                <li>S’mores kit → “Let’s make S’MORE memories in your new home!”</li>
                <li>Mini snow globe → “You make my world SHAKE with great referrals!”</li>
            </ul>

            <h4 class="text-lg font-bold mb-3">More Creative Ideas</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <li>Local honey → “You’re the SWEETEST partner!”</li>
                <li>Bubble wrap → “I’ve got your BACK (no popping needed)!”</li>
                <li>Battery-powered fan → “I’m your biggest FAN!”</li>
                <li>Potted plant → “Our relationship is GROWING strong!”</li>
            </ul>
        </div>
    </div>

    <!-- Closing & Client Appreciation Gifts -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Closing & Client Appreciation Gifts <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Thoughtful closing gifts create raving fans and referral machines. Aim for useful, home-related items under $50.</p>
            <ul class="space-y-4">
                <li><strong>Personalized address stamper</strong> – They’ll use it forever and see your branding.</li>
                <li><strong>Custom cutting board</strong> – Engraved with new address + your logo on back.</li>
                <li><strong>House-shaped keychain or ornament</strong> – Sent on loan anniversary.</li>
                <li><strong>Welcome mat or doormat</strong> – “Home Sweet Home” with handwritten note.</li>
                <li><strong>Local restaurant gift card</strong> – “Enjoy a night out in your new neighborhood!”</li>
                <li><strong>Tool kit or picture hanging kit</strong> – Practical for new homeowners.</li>
                <li><strong>Scented candle set</strong> – “May your new home always smell amazing!”</li>
                <li><strong>Handwritten thank-you note</strong> – Always include—most remembered part!</li>
            </ul>
        </div>
    </div>

    <!-- Email & Communication Templates -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Email & Communication Templates <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-3">To Referral Partners (Weekly Value Touch)</h4>
            <p class="mb-4 font-italic">Subject: Quick Market Snapshot + Open House Tool for You</p>
            <p>Hey [Name],<br><br>Hope you're crushing it this week! Quick update: rates eased slightly, inventory up 8% locally.<br><br>Attached a fresh co-branded buyer checklist for your open houses—feel free to use or let me customize.<br><br>Any upcoming deals I can pre-approve?<br><br>Thanks for the partnership!<br>[Your Name]</p>

            <h4 class="text-lg font-bold mb-3 mt-6">Post-Closing Thank You to Client</h4>
            <p class="mb-4 font-italic">Subject: Congratulations Again on Your New Home!</p>
            <p>Congrats [Client]!<br><br>Officially a homeowner—huge milestone! Your closing went smoothly thanks to your preparation.<br><br>If any questions come up (taxes, insurance, etc.), I'm here. Also attached your final docs for reference.<br><br>Enjoy making memories!<br>[Your Name]</p>

            <h4 class="text-lg font-bold mb-3 mt-6">Refinance Check-In (6–12 Months Post-Close)</h4>
            <p class="mb-4 font-italic">Subject: Rates Dropped—Could Save You $X Monthly?</p>
            <p>Hi [Client],<br><br>Hope you're loving the new place! Rates have improved since your purchase—running numbers shows potential $287/month savings.<br><br>No obligation—just sharing. Want a quick refi quote?<br><br>Best,<br>[Your Name]</p>
        </div>
    </div>

    <!-- NEW: Short Social Media Video Ideas & Scripts -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Short Video Ideas & Scripts (Reels/TikTok – 15-60 sec) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Quick, engaging videos that educate + entertain. Use trending audio, text overlays, and end with CTA: “Comment your biggest mortgage question!”</p>

            <h4 class="text-lg font-bold mb-3">1. Myth Bust: “You Need 20% Down” (Humorous)</h4>
            <p><strong>Script:</strong> [You holding fake money] “Myth: You need 20% down to buy a home. Reality: Many programs let you put 3%, 5%, or even 0% down! FHA, VA, USDA, state assistance—options everywhere. Stop renting, start owning. DM me your down payment question!”</p>

            <h4 class="text-lg font-bold mb-3">2. Rates Too High Skit</h4>
            <p><strong>Script:</strong> [Act as client] “Rates are too high!” [Switch to you] “I get it—but waiting could cost more in home prices. Plus, buydowns lower your rate temporarily. Marry the house, date the rate. Want to see real numbers?”</p>

            <h4 class="text-lg font-bold mb-3">3. Closing Day Chaos (Funny Skits)</h4>
            <p><strong>Script:</strong> [Fast cuts: spilling coffee, losing keys] “What closing day feels like vs reality [smooth signing, happy family]. I handle the chaos so you don’t have to. Tag a friend buying soon!”</p>

            <h4 class="text-lg font-bold mb-3">4. Quick Tip: Credit Boost</h4>
            <p><strong>Script:</strong> “Want to raise your credit 50 points fast? Pay down cards below 30%, dispute errors, become authorized user. Free pull at AnnualCreditReport.com. Comment ‘CREDIT’ for my checklist!”</p>

            <h4 class="text-lg font-bold mb-3">5. “Karen” Borrower Skit (Viral Humor)</h4>
            <p><strong>Script:</strong> [Wig on as Karen] “I want a 3% rate or I’ll speak to your manager!” [Remove wig] “I AM the manager—and here’s why today’s rates still beat renting. Let’s talk options.”</p>

            <h4 class="text-lg font-bold mb-3">6. Rent vs Own in 2025</h4>
            <p><strong>Script:</strong> [Show rent check tearing up] “Average rent up 30% since 2020. Buying locks your payment + builds equity. Run your numbers free—link in bio!”</p>

            <h4 class="text-lg font-bold mb-3">7. Day in the Life</h4>
            <p><strong>Script:</strong> [Time-lapse: coffee, calls, approvals] “A day helping families buy homes. Coffee, crunch numbers, celebrate closings. Love what I do—ready for yours?”</p>

            <h4 class="text-lg font-bold mb-3">8. Local Market Update</h4>
            <p><strong>Script:</strong> [Point to map] “Inventory up 10% locally, rates dipping—perfect buyer window! Thinking of moving? Comment your neighborhood.”</p>
        </div>
    </div>
</section>
<!-- Full Updated Weekly Win Plan Section -->
<!-- Changes:
   - Expanded wizard with new optional fields (production, partners, past clients, prospecting time, hobbies)
   - Hobbies multi-select for easy choice + free text
   - Progress bar updates LIVE on checkbox click (fixed with delegation)
   - Name used in hero, messages, and tasks ("Adam's Monday Crush")
   - Goal tied to weekly target ("For your 10-loan goal: Aim for 75 touches this week")
   - Tasks clickable → sexy modal with execution help (script, timer start, tips)
   - AI personalization: Custom plans use Grok API for truly tailored tasks (falls back to local if fails)
   - Super sexy: More gradients, animations, hobby emojis in tasks, confetti upgrade
-->

<section id="weekly-win-plan" class="hidden">
    <div class="ai-tool-wrapper">
        <div class="text-center mb-12">
            <h2 class="text-5xl font-black mb-4 text-[#F15A29] tracking-tight" id="personalized-title">My Weekly Win Plan 🔥</h2>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                Your personal prospecting coach. Clear daily actions, built-in balance, and execution help to make winning feel effortless.
            </p>
        </div>

        <!-- Hero Motivation + Streak -->
        <div class="bg-gradient-to-br from-[#002B5C]/60 to-[#00A89D]/40 rounded-3xl p-10 mb-12 shadow-2xl border border-[#00A89D]/30">
            <div class="flex flex-col md:flex-row items-center justify-around gap-8 text-center">
                <div class="text-6xl animate-pulse">🔥</div>
                <div>
                    <p class="text-4xl font-bold text-[#F15A29]" id="streak-display">0 Week Streak</p>
                    <p class="text-2xl mt-2" id="streak-message">Let's start your fire today!</p>
                </div>
                <div class="text-6xl">💰</div>
                <div>
                    <p class="text-2xl font-bold">Monthly Goal: <span id="monthly-goal-display">8</span> Funded Loans</p>
                    <p class="text-lg mt-2" id="weekly-target">Aim for ~72 touches this week</p>
                </div>
                <div class="text-6xl">🏆</div>
            </div>
        </div>
<div class="text-center my-12">
    <button id="edit-setup-btn" class="w-full max-w-2xl mx-auto bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl">
        <i class="fas fa-eye mr-3"></i> View/Change Plan Details
    </button>
</div>
        <!-- Generate Button (ID added, onclick removed, full gradient for perfect match) -->
        <div class="text-center mb-20">
            <button id="generate-win-plan-btn" class="w-full max-w-2xl mx-auto bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl">
    <i class="fas fa-bolt-lightning mr-4 text-3xl"></i> Build My Personalized Win Plan
</button>
        </div>

        <!-- Weekly Task Cards -->
        <div id="weekly-tasks-container" class="space-y-12 hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                <!-- Tasks injected by JS -->
            </div>

            <!-- Progress Summary -->
            <div class="mt-20 text-center">
                <p class="text-4xl font-bold mb-8">
                    <span id="tasks-completed">0</span> / <span id="tasks-total">0</span> Tasks Complete
                </p>
                <div class="w-full max-w-3xl mx-auto bg-gray-800 rounded-full h-10 overflow-hidden shadow-2xl">
                    <div id="weekly-progress-bar" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] h-full w-0 transition-all duration-1000 rounded-full"></div>
                </div>
                <p class="text-3xl mt-10" id="completion-message">Keep going — you're building momentum!</p>
            </div>
        </div>

        <!-- Confetti Canvas -->
        <canvas id="confetti-canvas" class="fixed inset-0 pointer-events-none z-50 hidden"></canvas>

        <!-- Task Help Modal -->
        <div id="task-help-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
            <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-10 max-w-2xl shadow-2xl border border-[#00A89D]/50">
                <h3 class="text-3xl font-bold text-[#F15A29] mb-6" id="task-help-title">Task Help</h3>
                <div id="task-help-content" class="text-lg text-gray-200 space-y-4"></div>
                <div class="text-center mt-10">
                    <button onclick="closeTaskHelp()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-4 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                        Got It — Back to Winning
                    </button>
                </div>
            </div>
        </div>
    </div>

   <div id="setup-wizard" class="fixed inset-0 bg-black/90 z-50 flex items-center justify-center hidden">
    <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 md:p-12 max-w-4xl w-full mx-4 shadow-2xl border border-[#00A89D]/50 max-h-[95vh] overflow-y-auto">
        
        <h3 class="text-4xl md:text-5xl font-bold text-[#F15A29] text-center mb-6">Your Personalized Setup ⚡</h3>
        <p class="text-lg md:text-xl text-gray-300 text-center mb-12 max-w-3xl mx-auto">
            The more you share (all optional except goal), the smarter your weekly plan becomes — perfectly balanced with your production, schedule, and passions.
        </p>
        
        <div class="space-y-12">
            <!-- Row 1: Name & Goal (even spacing) -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4 flex items-center">
                        <i class="fas fa-user mr-3"></i> Your Name (for motivation)
                    </label>
                    <input type="text" id="setup-name" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4 flex items-center">
                        <i class="fas fa-chart-line mr-3"></i> Monthly Funded Loan Goal
                    </label>
                    <input type="number" id="setup-monthly-goal" min="1" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
            </div>

            <!-- Row 2: Production & Database (3 columns, even) -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4">Last Month's Funded Loans</label>
                    <input type="number" id="setup-last-month" min="0" placeholder="Optional" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4"># Active Referral Partners 🤝</label>
                    <input type="number" id="setup-partners" min="0" placeholder="Optional" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4">Number of Past Clients 🏡</label>
                    <input type="number" id="setup-past-clients" min="0" placeholder="Optional" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
            </div>

            <!-- Row 3: Schedule & Focus -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4 flex items-center">
                        <i class="fas fa-clock mr-3"></i> Weekly Prospecting Hours Available
                    </label>
                    <select id="setup-hours" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                        <option>Less than 10</option>
                        <option>10–15</option>
                        <option selected>15–20 (recommended)</option>
                        <option>20+</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4">Preferred Prospecting Focus (optional)</label>
                    <select id="setup-focus" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                        <option>Balanced (Realtors + Past Clients + Equity)</option>
                        <option>Heavy Realtor Partnerships</option>
                        <option>Past Client Refi Focus</option>
                        <option>Equity Scanner Leads</option>
                    </select>
                </div>
            </div>

            <!-- Hobbies Section -->
            <div>
                <label class="block text-2xl font-bold text-[#00A89D] mb-6 flex items-center">
                    <i class="fas fa-heart mr-4 text-[#F15A29]"></i> Your Passions & Hobbies (weave into plan for balance & better connections)
                </label>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Golf" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Golf</span>
                    </label>
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Cards/Poker" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Cards/Poker</span>
                    </label>
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Sports" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Sports</span>
                    </label>
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Crafts" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Crafts</span>
                    </label>
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Family Time" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Family Time</span>
                    </label>
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Outdoors" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Outdoors</span>
                    </label>
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Fitness" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Fitness</span>
                    </label>
                    <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
                        <input type="checkbox" value="Cooking" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Cooking</span>
                    </label>
                </div>
                <input type="text" id="setup-hobbies-other" placeholder="Other passions (e.g., pedicures, wine tasting, travel)" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
            </div>
        </div>
<!-- Preferred Prospecting Activities Section -->
<div>
    <label class="block text-2xl font-bold text-[#00A89D] mb-6 flex items-center">
        <i class="fas fa-bullhorn mr-4 text-[#F15A29]"></i> Preferred Prospecting Activities (check all you enjoy — we'll prioritize these)
    </label>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Coffee/Drink Appointments" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Coffee or Drink Appointments ☕</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Lunch Appointments" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Lunch Appointments 🍴</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Lunch and Learns" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Hosting Lunch & Learns 📊</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Personal Notes/Cards" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Writing Personal Notes/Cards ✍️</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Social Media Videos" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Creating Social Media Videos 📹</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Phone Calls" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Making Phone Calls ☎️</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Door Knocking" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Door Knocking 🚪</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Networking Events" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Attending Networking Events 🤝</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Video Messages" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Sending Video Messages 🎥</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Email Campaigns" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span>Sending Value Emails 📧</span>
        </label>
    </div>
</div>
        <div class="text-center mt-16">
            <button id="save-setup-btn" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl flex items-center justify-center">
    <i class="fas fa-rocket mr-4 text-3xl"></i> Save Preferences
</button>
        </div>
    </div>
</div>
</section>
       
</main>
    <script>
// Menu toggle
document.getElementById('menu-toggle').addEventListener('click', () => {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('left-0');
    sidebar.classList.toggle('left-[-300px]');
    sidebar.classList.toggle('open');
});

// Single Quote Display with Manual Arrows & Auto-Rotation
const quotes = [
    "The harder you work, the luckier you get.",
    "Your next loan is one call away.",
    "Success is rented, and the rent is due every day.",
    "Every “no” brings you closer to a “yes.”",
    "You don’t have to be great to start, but you have to start to be great.",
    "Turn obstacles into opportunities.",
    "Be so good they can’t ignore you.",
    "Hustle beats talent when talent doesn’t hustle.",
    "Make someone’s dream come true today!",
    "Doubt kills more dreams than failure ever will.",
    "The best way to predict the future is to create it.",
    "Winners never quit, and quitters never win.",
    "Your only limit is you.",
    "Small steps today, big wins tomorrow.",
    "Stay positive, work hard, make it happen.",
    "Dream big. Work hard. Stay focused.",
    "You’re one decision away from a totally different life.",
    "Good things come to those who hustle.",
    "Don’t wait for opportunity—create it.",
    "Believe you can and you’re halfway there.",
    "Push yourself because no one else is going to do it for you.",
    "Great things never come from comfort zones.",
    "Rise up and attack the day with enthusiasm.",
    "Turn “I wish” into “I will.”",
    "Make today count.",
    "Your future is created by what you do today.",
    "Excuses don’t build empires.",
    "Stay hungry, stay humble, keep working.",
    "The harder the battle, the sweeter the victory.",
    "You miss 100% of the shots you don’t take.",
    "Do something today your future self will thank you for.",
    "Success is the sum of small efforts repeated daily.",
    "Be the energy you want to attract.",
    "Fall seven times, stand up eight.",
    "Prove them wrong.",
    "Today’s grind = tomorrow’s shine.",
    "Limits exist only in the mind.",
    "Keep going—you’re closer than you think.",
    "One closed loan can change everything.",
    "Discipline is choosing between what you want now and what you want most.",
    "Wake up with purpose, go to bed with satisfaction.",
    "Don’t stop when you’re tired—stop when you’re done.",
    "The comeback is always stronger than the setback.",
    "You were born to win.",
    "Make it happen. Shock everyone.",
    "Every call counts. Make each one great.",
    "Loans don’t find themselves—go get yours.",
    "Your pipeline is your paycheck. Fill it.",
    "Close the day strong.",
    "Borrowers are waiting—be their hero today.",
    "Momentum is built one “yes” at a time.",
    "Outwork yesterday’s you.",
    "Average effort = average results. Be extraordinary.",
    "Grind now, glow later.",
    "The best loan officers don’t wait for the phone to ring.",
    "Confidence closes.",
    "Every “I’ll think about it” is a future “Where do I sign?”",
    "Pressure makes diamonds—thrive in it.",
    "Your next record-breaking month starts today.",
    "Stop wishing, start closing.",
    "Be the lender they brag about to their friends.",
    "One more call could change your year.",
    "Today’s effort = tomorrow’s commission check.",
    "Borrowers don’t care how much you know until they know how much you care.",
    "Speed + service = unstoppable.",
    "You’ve survived 100% of your worst days so far. Keep going.",
    "The magic you’re looking for is in the work you’re avoiding.",
    "Build relationships, not just files.",
    "Done is better than perfect.",
    "Lead with value, close with ease.",
    "Turn “I can’t afford it” into “How do I make this happen?”",
    "Make today so awesome yesterday gets jealous.",
    "The only bad call is the one you didn’t make.",
    "If you don’t own the day, the day owns you.",
    "Borrowers remember how you made them feel—make it amazing.",
    "Keep swinging—the home runs are coming.",
    "Success is a decision away. Decide now.",
    "Go out there and make someone’s dream happen.",
    "Be intentional with your hours or someone else will be.",
    "Small, consistent actions compound into massive results.",
    "Intentional effort today, dividends paid tomorrow.",
    "Winners are just people who stayed consistent when no one was watching.",
    "Show up on purpose—every single day.",
    "Consistency turns average loan officers into top producers.",
    "Intentional mornings create unstoppable months.",
    "Do the boring work consistently and the results will come.",
    "Consistency is louder than motivation ever will be.",
    "The loan you close tomorrow was built by what you did today—and yesterday.",
    "Consistent follow-up turns “maybe” into “money.”",
    "Intentional loan officers don’t wait for leads—they create them.",
    "Success loves preparation. Be consistent in yours.",
    "Consistency compounds faster than interest rates.",
    "The difference between good and great is one more intentional call.",
    "Consistency is the bridge between leads and legacy.",
    "Intentional effort feels like work; consistent effort feels like winning.",
    "Show up, suit up, follow up—every single day.",
    "Intentionality today keeps regret away tomorrow.",
    "Consistency isn’t sexy until you see the scoreboard.",
    "Be relentlessly intentional about the activities that pay.",
    "Consistency is the silent closer that never takes a day off"
];

let currentQuoteIndex = Math.floor(Math.random() * quotes.length);
const quoteDisplay = document.getElementById('quote-display');
const quotePrev = document.getElementById('quote-prev');
const quoteNext = document.getElementById('quote-next');

function showQuote(index) {
    if (!quoteDisplay) return;
    quoteDisplay.classList.add('fade');
    setTimeout(() => {
        quoteDisplay.textContent = quotes[index];
        quoteDisplay.classList.remove('fade');
    }, 400);
}

if (quoteDisplay) {
    showQuote(currentQuoteIndex);

    setInterval(() => {
        currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
        showQuote(currentQuoteIndex);
    }, 12500);

    if (quotePrev) {
        quotePrev.addEventListener('click', () => {
            currentQuoteIndex = (currentQuoteIndex - 1 + quotes.length) % quotes.length;
            showQuote(currentQuoteIndex);
        });
    }

    if (quoteNext) {
        quoteNext.addEventListener('click', () => {
            currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
            showQuote(currentQuoteIndex);
        });
    }
}

// Activities (full)
const activities = {
    daily: ["Write two personal notes or thank-you cards to clients, referral partners, or prospects.", "Make at least five outbound calls to past clients or referral partners.", "Send personalized birthday messages using video to your past clients.", "Engage on social media by commenting on or liking 10 posts from realtors, clients, and referral partners.", "Record and post one short-form video or story about mortgage tips, market updates, or client success stories.", "Follow up with any new online or social media leads received in the past 24 hours.", "Reach out to a past client just to check in—no sales pitch, just relationship-building.", "Send a text or video message to a referral partner to stay top of mind.", "Knock on one local business door to introduce yourself (title companies, insurance agents, CPAs, etc.).", "Spend time reviewing and updating CRM with notes, follow-ups, and next actions."],
    weekly: ["Pipeline review with referral partners—discuss upcoming deals and potential new clients.", "Pipeline review with active clients—touch base with a weekly update, even if nothing new.", "Host a 15-minute coaching call (Zoom or Teams) for realtors on mortgage trends or strategies.", "Attend at least one networking event (chamber of commerce, BNI, or real estate meetup).", "Send a “Who do you know?” text to 5+ referral partners asking for warm introductions.", "Create and send a value-packed email to your database (market updates, home tips, etc.).", "Record and send a personalized video email to new leads or referral partners.", "Reach out to 3 new real estate agents via social media or in person.", "Host a casual coffee meeting with a referral partner or past client.", "Review past closed loans and follow up with clients who may benefit from refinancing."],
    monthly: ["Deliver pop-by gifts to your top 10 referral partners or your A+ past clients.", "Host an Ask YOUR Lender Zoom call for realtors and referral partners.", "Host a first-time homebuyer seminar (online or in person).", "Send out handwritten birthday and anniversary cards to past clients.", "Record and post a long-form video covering a trending mortgage topic.", "Partner with a real estate agent for a co-branded marketing campaign.", "Run a targeted Facebook or Instagram ad to generate leads.", "Check in on past pre-approved clients who haven’t bought yet.", "Attend a local community event and network with homeowners and business owners.", "Review and update your Google Business Profile with new content and reviews."],
    quarterly: ["Host a Lunch & Learn for real estate agents and referral partners.", "Run a local market update webinar for homebuyers and realtors.", "Send a personalized video message to past clients about market trends.", "Organize a Realtor Mastermind event to discuss business growth strategies.", "Sponsor a local event or charity drive to gain visibility in the community.", "Mail out a homeowner equity review letter to past clients.", "Host a networking happy hour for realtors, attorneys, and financial planners.", "Run a contest or giveaway for clients and referral partners.", "Send a direct mail campaign targeting renters or move-up buyers.", "Set up a strategy session with a key referral partner to refine your co-marketing plan."],
    yearly: ["Host a Client Appreciation Party for past clients and referral partners.", "Review and optimize your annual marketing plan and business goals.", "Plan and execute a major branding campaign (e.g., billboards, radio ads, podcast sponsorship).", "Attend at least one national or regional mortgage conference for networking and education.", "Run a VIP dinner for your top referral partners. (Great around the holidays)", "Organize a major community service project under your brand.", "Launch an exclusive mastermind group for elite real estate agents.", "Record a professional brand video to use in marketing.", "Schedule a business planning retreat to evaluate and set goals for the next year.", "Build and refresh your contact database, ensuring all referral partners and clients are engaged."]
};

// Generate time block
function generateTimeBlock() {
    const freq = document.getElementById('frequency').value.toLowerCase();
    const list = activities[freq].map(act => `<li class="mb-2">${act}</li>`).join('');
    document.getElementById('time-block-output').innerHTML = `<h4 class="text-2xl font-medium mb-4 capitalize text-[#00A89D]">${freq} Schedule</h4><ul class="space-y-2">${list}</ul>`;
}
function showSection(id) {
    document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
    document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
    // Close mobile sidebar
    document.getElementById('sidebar').classList.add('left-[-300px]');
}
// Cycle activities
function cycleActivities() {
    const freq = document.getElementById('frequency').value.toLowerCase();
    const shuffled = [...activities[freq]].sort(() => 0.5 - Math.random());
    const selection = shuffled.slice(0, Math.floor(Math.random() * 6) + 5);
    const list = selection.map(act => `<li class="mb-2">${act}</li>`).join('');
    document.getElementById('time-block-output').innerHTML = `<h4 class="text-2xl font-medium mb-4 capitalize text-[#00A89D]">Cycled ${freq} Ideas</h4><ul class="space-y-2">${list}</ul>`;
}

async function generateSalesScript() {
    const dropdown = document.getElementById('script-scenario-select');
    const customTextarea = document.getElementById('custom-scenario');
    const context = document.getElementById('script-context').value.trim();

    let scenario = '';

    // Handle custom vs dropdown selection
    if (dropdown.value === ' ') {  // ' ' is your custom option value
        scenario = customTextarea.value.trim();
    } else {
        scenario = dropdown.value || customTextarea.value.trim();
    }

    if (!scenario) {
        alert('Please select a situation or type your own scenario');
        return;
    }

    const loading = document.getElementById('script-loading');
    const output = document.getElementById('script-output');

    loading.classList.remove('hidden');
    output.classList.add('hidden');

    let prompt = `You are an expert real estate communication coach helping realtors build better relationships.

Generate exactly 4 varied, natural scripts for this situation:

Situation: "${scenario}"

${context ? `Additional context: ${context}` : ''}

Requirements for each script:
- 3–6 sentences long
- Warm, curious, helpful — never salesy or pushy
- Use open-ended questions
- Include a soft next step
- End with a gentle call-to-action
- Tone: Friendly, relatable, professional, trustworthy

Formatting (very important):
- Start each script with "## Script 1", "## Script 2", etc.
- Use **bold** for light emphasis where it feels natural
- Use - bullet points when listing questions, benefits, or ideas
- Separate paragraphs with a blank line
- Do NOT use code blocks, backticks, or any other formatting

Focus on building connection and trust — not closing the deal.`;

    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [{ role: "user", content: prompt }],
                temperature: 0.8,
                max_tokens: 1400
            })
        });

        if (!response.ok) throw new Error('API error');

        const data = await response.json();
        const rawMarkdown = data.choices[0].message.content.trim();

        // Convert full markdown to HTML using marked
        const fullHtml = marked.parse(rawMarkdown);

        // Split into individual scripts by <h2> or <h3> headings (marked turns ## into <h2>)
        const scriptBlocks = fullHtml.split(/<h[23][^>]*>.*?<\/h[23]>/gi).filter(Boolean);
        const headings = [...fullHtml.matchAll(/<h[23][^>]*>(.*?)<\/h[23]>/gi)].map(m => m[1]);

        let outputHtml = '<div class="space-y-12">';

        headings.forEach((heading, i) => {
            const content = scriptBlocks[i] || '';
            const scriptNumber = i + 1;

            outputHtml += `
                <div class="bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl shadow-md border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center gap-5 mb-7">
                        <div class="flex-shrink-0 w-14 h-14 rounded-full bg-[#F15A29] flex items-center justify-center text-white font-bold text-2xl shadow-lg">
                            ${scriptNumber}
                        </div>
                        <h3 class="text-2xl font-bold text-[#F15A29]">${heading.trim()}</h3>
                    </div>
                    <div class="prose prose-lg dark:prose-invert max-w-none leading-relaxed text-gray-800 dark:text-gray-200">
                        ${content.trim()}
                    </div>
                </div>`;
        });

              // Final output structure
           output.classList.remove('hidden');
    } catch (error) {
        console.error(error);
        output.innerHTML = '<p class="text-red-600 text-center py-20 text-xl">Error generating scripts. Please try again.</p>';
        output.classList.remove('hidden');
    } finally {
        loading.classList.add('hidden');
    }
}

function copySalesScripts() {
    const proseDiv = document.querySelector('#script-output .prose');
    if (!proseDiv) return;

    // Get clean text (strip HTML, preserve line breaks)
    const temp = document.createElement('div');
    temp.innerHTML = proseDiv.innerHTML;

    // Remove the numbered circles for cleaner copy
    const circles = temp.querySelectorAll('.w-14.h-14.rounded-full');
    circles.forEach(el => el.remove());

    const text = temp.innerText || temp.textContent || '';
    navigator.clipboard.writeText(text).then(() => {
        alert('All scripts copied to clipboard!');
    });
}
// Accordion toggle
function toggleAccordion(button) {
    const content = button.nextElementSibling;
    content.classList.toggle('open');
}

// Show section on nav click
document.querySelectorAll('#sidebar a').forEach(link => {
    link.addEventListener('click', (e) => {
        e.preventDefault();
        document.querySelectorAll('section').forEach(sec => sec.classList.add('hidden'));
        const target = document.querySelector(link.getAttribute('href'));
        target.classList.remove('hidden');
        document.getElementById('sidebar').classList.remove('left-0');
        document.getElementById('sidebar').classList.add('left-[-300px]');
        document.getElementById('sidebar').classList.remove('open');
        // Reset accordions
        target.querySelectorAll('.accordion-content').forEach(content => content.classList.remove('open'));
    });
});
// Auto-fill custom textarea when selecting from dropdown (but allow override)
document.getElementById('script-scenario-select').addEventListener('change', function() {
    const selected = this.value;
    if (selected) {
        document.getElementById('custom-scenario').value = selected;
    } else {
        document.getElementById('custom-scenario').value = ''; // Reset to custom when "Use Custom" selected
    }
});
const uploadArea = document.getElementById('upload-area');
const fileInput = document.getElementById('database-upload');
const fileStatus = document.getElementById('file-status');
const fileNameDisplay = document.getElementById('file-name');
const loading = document.getElementById('equity-loading');
const dashboard = document.getElementById('equity-dashboard-output');

// === ADD THIS BLOCK HERE ===
uploadArea.addEventListener('click', (e) => {
    if (e.target.tagName === 'BUTTON') return;
    fileInput.click();
});

fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
        const file = e.target.files[0];
        fileStatus.textContent = 'File selected:';
        fileNameDisplay.textContent = file.name;
        fileNameDisplay.classList.remove('hidden');
    }
});

uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('border-[#F15A29]', 'bg-[#F15A29]/10');
});

uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('border-[#F15A29]', 'bg-[#F15A29]/10');
});

uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('border-[#F15A29]', 'bg-[#F15A29]/10');
    if (e.dataTransfer.files.length > 0) {
        fileInput.files = e.dataTransfer.files;
        const file = e.dataTransfer.files[0];
        fileStatus.textContent = 'File selected:';
        fileNameDisplay.textContent = file.name;
        fileNameDisplay.classList.remove('hidden');
    }
});

function pmt(rate, nper, pv) {
    const monthlyRate = rate / 12 / 100;
    if (monthlyRate === 0) return pv / nper;
    return monthlyRate * pv * Math.pow(1 + monthlyRate, nper) / (Math.pow(1 + monthlyRate, nper) - 1);
}
// Remaining balance (optimized closed-form formula)
function remainingBalance(originalBalance, originalRate, originalTermMonths, monthsPaid) {
    if (originalBalance <= 0 || originalTermMonths <= 0) return 0;
    const monthlyRate = originalRate / 12 / 100;
    if (monthlyRate === 0) {
        return originalBalance * (1 - monthsPaid / originalTermMonths);
    }
    const monthlyPayment = pmt(originalRate, originalTermMonths, originalBalance);
    const power = Math.pow(1 + monthlyRate, monthsPaid);
    const balance = originalBalance * power - monthlyPayment * (power - 1) / monthlyRate;
    return Math.max(0, Math.round(balance * 100) / 100);
}
// Chunk processor — prevents long-running script warning
// Chunk processor — steadier progress, faster overall
function processInChunks(items, chunkSize = 200, processItemCallback, completeCallback) {  // bumped to 200
    let index = 0;
    const total = items.length;
    const progressText = document.getElementById('progress-text');

    function doChunk() {
        const end = Math.min(index + chunkSize, total);

        for (; index < end; index++) {
            processItemCallback(items[index], index);
        }

        // Live progress update
        if (progressText) {
            progressText.textContent = `Processed ${index} of ${total} rows...`;
        }

        if (index < total) {
            setTimeout(doChunk, 0); // Yield to browser
        } else {
            if (completeCallback) completeCallback();
            if (progressText) {
                progressText.textContent = 'Complete! Building dashboard...';
            }
        }
    }

    doChunk();
}
// Excel serial to date (fixed for 1900 base)
function excelSerialToDate(serial) {
    if (!serial || isNaN(serial)) return null;
    var utc_days = Math.floor(serial - 25569);
    var utc_value = utc_days * 86400;
    var date_info = new Date(utc_value * 1000);
    return new Date(date_info.getFullYear(), date_info.getMonth(), date_info.getDate());
}
// Months elapsed
function calculateMonthsElapsed(closingDate) {
    const currentDate = new Date(2026, 0, 6); // January 6, 2026
    let months = (currentDate.getFullYear() - closingDate.getFullYear()) * 12;
    months += currentDate.getMonth() - closingDate.getMonth();
    if (currentDate.getDate() < closingDate.getDate()) months--;
    return Math.max(0, months);
}
// Render cards
function renderCards() {
    const container = document.getElementById('opportunity-cards');
    if (!container) return;

    const opps = window.filteredOpportunities || window.currentOpportunities;
    if (!opps || opps.length === 0) {
        document.getElementById('no-results')?.classList.remove('hidden');
        return;
    }
    document.getElementById('no-results')?.classList.add('hidden');

    const cardsHTML = [];

    opps.forEach((opp, index) => {
        const scoreColor = opp.score >= 70 ? 'bg-green-600' : opp.score >= 40 ? 'bg-orange-600' : 'bg-red-600';
        const typeColor = opp.type === 'Refi Ready' ? 'bg-teal-600' : opp.type === 'Cash-Out Goldmine' ? 'bg-green-600' : 'bg-blue-600';
        const pmiBadge = opp.pmiEligible ? `<span class="px-5 py-2.5 rounded-full text-white font-bold text-base shadow-md bg-green-600">PMI Removal Eligible</span>` : '';

       const cardHTML = `
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden hover:scale-105 hover:shadow-2xl transition-all duration-300 flex flex-col cursor-pointer border border-gray-200 dark:border-gray-700" onclick="openDetailModal(${index})">
                <div class="p-6 flex flex-col flex-grow">
                    <div class="flex justify-between items-start mb-6">
                        <div class="flex-1">
                            <h4 class="text-2xl font-bold text-[#002B5C] dark:text-white">${opp.fullName || 'Unknown'}</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm mt-1">${opp.fullAddress || 'Address not available'}</p>
                        </div>
                        <div class="w-16 h-16 ${scoreColor} rounded-full flex items-center justify-center text-white font-bold text-3xl shadow-lg flex-shrink-0">
                            ${opp.score}
                        </div>
                    </div>
                    <div class="space-y-4 flex-grow text-lg">
                        <p><strong>Estimated Monthly Savings:</strong>
                            <span class="font-bold ml-2 ${opp.monthlySavings > 0 ? 'text-green-600' : 'text-gray-500'}">
                                $${opp.monthlySavings.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}
                            </span>
                        </p>
                        <p><strong>Cash-Out Potential (80% LTV):</strong>
                            <span class="font-bold text-teal-600 ml-2">
                                $${opp.cashOut.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                            </span>
                        </p>
                        <p><strong>Move-Up Power:</strong>
                            <span class="font-bold text-blue-600 ml-2 text-2xl">
                                $${opp.moveUp.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                            </span>
                        </p>
                    </div>
                    <div class="mt-8 flex flex-wrap justify-center gap-4">
                        <span class="px-5 py-2.5 rounded-full text-white font-bold text-base shadow-md ${typeColor}">
                            ${opp.type}
                        </span>
                        ${pmiBadge}
                    </div>
                </div>
            </div>
        `;
        cardsHTML.push(cardHTML);
    });

    container.innerHTML = cardsHTML.join('');
    // Force browser to calculate grid/scroll height immediately after injection
setTimeout(() => {
    container.style.minHeight = container.offsetHeight + 'px';  // Nudge height read
    void container.offsetHeight;  // Force reflow
    container.style.minHeight = '';  // Clean up
}, 100);
}
// Sort & Filter
function sortAndRenderCards() {
    const filterType = document.getElementById('filter-type')?.value || 'All';
    const sortBy = document.getElementById('sort-by')?.value || 'score';

    let filtered = window.currentOpportunities.filter(opp => {
        if (filterType === 'All') return true;
        if (filterType === 'PMI Removal Eligible') return opp.pmiEligible;
        return opp.type === filterType;
    });

    filtered.sort((a, b) => b[sortBy] - a[sortBy]);

    window.filteredOpportunities = filtered;
    renderCards();
}
// Copy Dashboard
function copyDashboard() {
    const opps = window.filteredOpportunities || window.currentOpportunities;
    if (!opps || opps.length === 0) {
        alert('No data to copy');
        return;
    }
    let text = 'Equity Opportunity Report\n\n';
    text += 'Name\tAddress\tPhone\tEmail\tSavings\tCash-Out\tMove-Up\tScore\tType\n';
    opps.forEach(opp => {
        text += `${opp.fullName}\t${opp.fullAddress}\t${opp.phone}\t${opp.email}\t$${opp.monthlySavings}\t$${opp.cashOut}\t$${opp.moveUp}\t${opp.score}\t${opp.type}\n`;
    });
    navigator.clipboard.writeText(text).then(() => alert('Copied to clipboard!'));
}
// openDetailModal
function openDetailModal(index) {
    const opps = window.filteredOpportunities || window.currentOpportunities;
    const c = opps[index];
    if (!c) return;

    try {
        // Safe currency formatter
        const formatCurrency = (val) => {
            const num = parseFloat(val) || 0;
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        };

        // Basic info
        document.getElementById('modal-client-name').textContent = c.fullName || 'N/A';
        document.getElementById('modal-address').textContent = c.fullAddress || 'N/A';

        // Phone
        const phoneLink = document.getElementById('modal-phone-link');
        const phoneNa = document.getElementById('modal-phone-na');
        if (c.phone && c.phone.trim()) {
            phoneLink.href = 'tel:' + c.phone.replace(/[^\d]/g, '');
            phoneLink.textContent = c.phone;
            phoneLink.classList.remove('hidden');
            phoneNa.classList.add('hidden');
        } else {
            phoneLink.classList.add('hidden');
            phoneNa.classList.remove('hidden');
        }

        // Email
        const emailLink = document.getElementById('modal-email-link');
        const emailNa = document.getElementById('modal-email-na');
        if (c.email && c.email.trim()) {
            emailLink.href = 'mailto:' + c.email;
            emailLink.textContent = c.email;
            emailLink.classList.remove('hidden');
            emailNa.classList.add('hidden');
        } else {
            emailLink.classList.add('hidden');
            emailNa.classList.remove('hidden');
        }

        // Current Loan Details
        document.getElementById('modal-program').textContent = c.loanProgram || 'N/A';
        document.getElementById('modal-closing-date').textContent = c.closingDate || 'N/A';
        document.getElementById('modal-current-rate').textContent = (c.currentRate || 0).toFixed(3) + '%';
        document.getElementById('modal-term').textContent = c.currentTerm > 0 ? `${Math.round(c.currentTerm / 12)} years` : 'N/A';
        document.getElementById('modal-original-ltv').textContent = (c.originalLTV || 0).toFixed(2) + '%';
        document.getElementById('modal-balance').textContent = formatCurrency(c.estimatedBalance);
        document.getElementById('modal-value').textContent = formatCurrency(c.appraisedValue);
        document.getElementById('modal-original-pi').textContent = formatCurrency(c.originalPI);
        document.getElementById('modal-original-mi').textContent = formatCurrency(c.originalMI);
        document.getElementById('modal-original-insurance').textContent = formatCurrency(c.originalInsurance);
        document.getElementById('modal-original-taxes').textContent = formatCurrency(c.originalTaxes);

        // PMI Removal Alert
        const pmiAlert = document.getElementById('modal-pmi-alert'); // Add this ID to the HTML alert div
        pmiAlert.style.display = c.pmiEligible ? 'block' : 'none';

        // Buyer's Agent section
        const isPurchase = c.loanProgram.toLowerCase().includes('pur');
        const buyersAgentSection = document.getElementById('modal-buyers-agent-section');
        if (isPurchase && c.buyersAgent) {
            buyersAgentSection.style.display = 'block';
            document.getElementById('modal-transaction-type').textContent = 'Purchase';
            document.getElementById('modal-buyers-agent').textContent = c.buyersAgent;
        } else {
            buyersAgentSection.style.display = 'none';
        }

        // Refinance Comparison
        const balance = parseFloat(c.estimatedBalance) || 0;
        const value = parseFloat(c.appraisedValue) || 0;
        const equity = value - balance;
        const cashout = Math.max(0, value * 0.8 - balance);
        const moveup = equity * 0.95;

        let currentLTV = 'N/A';
        let currentLTVNum = 0;
        if (value > 0) {
            currentLTVNum = (balance / value) * 100;
            currentLTV = currentLTVNum.toFixed(2);
        }

        const originalLTVNum = parseFloat(c.originalLTV) || 0;
        const pmiDisplay = c.pmiEligible ? 'block' : 'none';

        const currentPI = parseFloat(c.originalPI) || 0;

        let remainingMonths = c.currentTerm || 360;
        if (c.closingDate && c.currentTerm) {
            const currentDate = new Date(2026, 0, 9); // January 9, 2026
            const closingDateObj = new Date(c.closingDate);
            if (!isNaN(closingDateObj.getTime())) {
                const monthsPassed = (currentDate.getFullYear() - closingDateObj.getFullYear()) * 12 + (currentDate.getMonth() - closingDateObj.getMonth());
                remainingMonths = Math.max(c.currentTerm - monthsPassed, 0);
            }
        }

        const newRate = parseFloat(document.getElementById('new-rate')?.value) || 5.0;
        const monthlyRate = newRate / 1200;
        const closingCosts = 4000;

        const paddedBalanceOpt1 = balance + closingCosts;
        const newPIOpt1 = remainingMonths <= 0 ? 0 : pmt(newRate, remainingMonths, paddedBalanceOpt1);
        const savingsOpt1 = currentPI - newPIOpt1;

        const paddedBalanceOpt2 = balance + closingCosts;
        const newPIOpt2 = c.currentTerm <= 0 ? 0 : pmt(newRate, c.currentTerm, paddedBalanceOpt2);
        const savingsOpt2 = currentPI - newPIOpt2;

        const comparisonSection = document.getElementById('refi-comparison-grid');
        comparisonSection.innerHTML = `
            <div class="space-y-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-300 dark:border-gray-600">
                <h5 class="text-2xl font-extrabold text-[#002B5C] dark:text-[#00A89D]">Option 1: Keep Remaining Term (${remainingMonths} months)</h5>
                <p class="text-lg"><strong>Current Estimated LTV:</strong> <span class="font-bold text-blue-600 text-xl">${currentLTV}%</span></p>
                <p class="bg-green-100 dark:bg-green-900 p-4 rounded-lg font-bold text-white-700 dark:text-white-700 flex items-center text-lg" style="display: ${pmiDisplay};">
                    <i class="fas fa-check-circle mr-2 text-green-600 text-xl"></i>Eligible for PMI Removal! (LTV ≤ 80%)
                </p>
                <p class="text-lg"><strong>Current P&I Payment:</strong> <span class="text-xl font-bold">${formatCurrency(currentPI)}</span></p>
                <p class="text-lg"><strong>Estimated New P&I (at ${newRate.toFixed(3)}%):</strong> <span class="text-xl font-bold text-green-600">${formatCurrency(newPIOpt1)}</span></p>
                <p class="text-lg"><strong>Estimated Monthly Savings:</strong> <span class="text-2xl font-extrabold ${savingsOpt1 > 0 ? 'text-green-600' : 'text-red-600'}">${formatCurrency(savingsOpt1)}</span></p>
                <p class="text-sm text-gray-600 dark:text-gray-400 italic">Savings calculated as: Current P&I (${formatCurrency(currentPI)}) - New P&I (${formatCurrency(newPIOpt1)}) based on current balance (${formatCurrency(balance)}), assuming $4,000 added for closing costs, new rate (${newRate}%), and remaining term (${remainingMonths} months).</p>
            </div>
            <div class="space-y-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-300 dark:border-gray-600">
                <h5 class="text-2xl font-extrabold text-[#002B5C] dark:text-[#00A89D]">Option 2: Reset to Original Term (${c.currentTerm} months)</h5>
                <p class="text-lg"><strong>Current Estimated LTV:</strong> <span class="font-bold text-blue-600 text-xl">${currentLTV}%</span></p>
                <p class="bg-green-100 dark:bg-green-900 p-4 rounded-lg font-bold text-white-700 dark:text-white-700 flex items-center text-lg" style="display: ${pmiDisplay};">
                    <i class="fas fa-check-circle mr-2 text-green-600 text-xl"></i>Eligible for PMI Removal! (LTV ≤ 80%)
                </p>
                <p class="text-lg"><strong>Current P&I Payment:</strong> <span class="text-xl font-bold">${formatCurrency(currentPI)}</span></p>
                <p class="text-lg"><strong>Estimated New P&I (at ${newRate.toFixed(3)}%):</strong> <span class="text-xl font-bold text-green-600">${formatCurrency(newPIOpt2)}</span></p>
                <p class="text-lg"><strong>Estimated Monthly Savings:</strong> <span class="text-2xl font-extrabold ${savingsOpt2 > 0 ? 'text-green-600' : 'text-red-600'}">${formatCurrency(savingsOpt2)}</span></p>
                <p class="text-sm text-gray-600 dark:text-gray-400 italic">Savings calculated as: Current P&I (${formatCurrency(currentPI)}) - New P&I (${formatCurrency(newPIOpt2)}) based on current balance (${formatCurrency(balance)}), assuming $4,000 added for closing costs, new rate (${newRate}%), and reset to original term (${c.currentTerm} months).</p>
            </div>
        `;

        // Opportunity Type
        const typeColor = c.type === 'Refi Ready' ? 'bg-teal-600' : c.type === 'Cash-Out Goldmine' ? 'bg-green-600' : 'bg-blue-600';
        const typeBadge = document.getElementById('modal-type-badge');
        typeBadge.className = `px-6 py-3 rounded-full text-white font-bold text-lg inline-block ${typeColor}`;
        typeBadge.textContent = c.type;

        // Personalized Script
        const script = `Hi ${c.fullName.split(' ')[0] || 'there'},

Hope you're doing great! Quick update — your home has built significant equity.

${c.monthlySavings > 0 ? `A refinance could save you ~$${c.monthlySavings.toLocaleString()}/month.` : ''}
${c.cashOut > 50000 ? `You may be able to access up to $${c.cashOut.toLocaleString()} cash-out.` : ''}
${c.moveUp > 100000 ? `That's enough for a strong down payment on your next home.` : ''}

No pressure — just wanted to offer a free equity review. When's a good time for a quick chat?

Best,
[Your Name]`;
        document.getElementById('modal-scripts').textContent = script;

        // Show modal
        const modal = document.getElementById('detail-modal');
        modal.style.display = 'flex';
        modal.style.opacity = '1';
        document.body.style.overflow = 'hidden';
        document.documentElement.style.overflow = 'hidden';

    } catch (error) {
        console.error('Modal error:', error);
    }
}
// closeDetailModal
function closeDetailModal() {
    const modal = document.getElementById('detail-modal');
    modal.style.opacity = '0';
    setTimeout(() => {
        modal.style.display = 'none';
        document.body.style.overflow = '';
        document.documentElement.style.overflow = '';
    }, 200);
}
// Single consolidated DOMContentLoaded
document.addEventListener('DOMContentLoaded', () => {
    // Force dark mode
    document.documentElement.classList.add('dark');
    document.body.classList.add('dark');
    
    // Start on AI chat
    document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
    const chatSection = document.getElementById('ai-chat-section') || document.querySelector('main section:first-child');
    if (chatSection) chatSection.classList.remove('hidden');
    // Choose File button
    const chooseButton = document.querySelector('#upload-area button[type="button"]');
    const fileInput = document.getElementById('database-upload');
    if (chooseButton && fileInput) {
        chooseButton.addEventListener('click', () => fileInput.click());
    }
    // Drag & Drop
    const uploadArea = document.getElementById('upload-area');
    if (uploadArea) {
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.add('border-[#F15A29]', 'bg-[#F15A29]/5');
        });
        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.remove('border-[#F15A29]', 'bg-[#F15A29]/5');
        });
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.remove('border-[#F15A29]', 'bg-[#F15A29]/5');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                document.getElementById('file-name').textContent = files[0].name;
                document.getElementById('file-name').classList.remove('hidden');
                document.getElementById('file-status').textContent = 'File loaded — click Generate';
            }
        });
    }
    // Initial render if data exists
    if (window.currentOpportunities) renderCards();
    // Add event listeners for sorting/filtering
    const filterType = document.getElementById('filter-type');
    const sortBy = document.getElementById('sort-by');
    if (filterType) filterType.addEventListener('change', sortAndRenderCards);
    if (sortBy) sortBy.addEventListener('change', sortAndRenderCards);
});
// Generate report locally
 function generateEquityReport(event) {
    if (event) event.stopPropagation();

    const fileInput = document.getElementById('database-upload');
    const loading = document.getElementById('equity-loading');
    const output = document.getElementById('equity-output');
    const inputArea = document.getElementById('equity-input-area');  // Wrapper for upload/input/generate

    if (!fileInput.files.length) {
        alert('Please upload your client database file first');
        return;
    }

    const file = fileInput.files[0];

    loading.classList.remove('hidden');
    document.getElementById('progress-text').textContent = 'Reading file...';
    output.classList.add('hidden');
    output.innerHTML = '';

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            let rawData = [];
            if (file.name.endsWith('.csv')) {
                const text = e.target.result;
                const rows = text.split('\n').map(r => r.split(',').map(c => c.trim()));
                const headers = rows[0].map(h => h.toLowerCase());
                rawData = rows.slice(1).filter(r => r.length > 1).map(row => {
                    const obj = {};
                    headers.forEach((h, i) => obj[h] = row[i] || '');
                    return obj;
                });
            } else if (file.name.match(/\.(xlsx|xls)$/)) {
                const workbook = XLSX.read(e.target.result, { type: 'binary' });
                const sheetName = workbook.SheetNames.find(name => name.toLowerCase() === 'table') || workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                rawData = XLSX.utils.sheet_to_json(sheet, { defval: '' });
                rawData = rawData.map(row => {
                    const normRow = {};
                    for (let key in row) {
                        normRow[key.toLowerCase().trim()] = row[key];
                    }
                    return normRow;
                });
            } else {
                throw new Error('Please upload a CSV or Excel file');
            }

            if (rawData.length === 0) throw new Error('No data found in file');

            // Dedupe (unchanged)
            rawData.sort((a, b) => {
                const dateA = parseFloat(a['closing date'] || 0);
                const dateB = parseFloat(b['closing date'] || 0);
                return dateB - dateA;
            });

            const uniqueMap = new Map();
            rawData.forEach(row => {
                const first = (row['borrower first name'] || '').trim();
                const last = (row['borrower last name'] || '').trim();
                const email = (row['borr email'] || '').trim();
                const address = (row['subject property address'] || '').trim();
                const key = `${first}_${last}_${email}_${address}`.toLowerCase();
                if (!uniqueMap.has(key)) {
                    uniqueMap.set(key, row);
                }
            });

            const dedupedData = Array.from(uniqueMap.values());

            const opportunities = [];
            const currentMarketRate = parseFloat(document.getElementById('market-rate')?.value) || 5.5;

            document.getElementById('progress-text').textContent = `Processing 0 of ${dedupedData.length} rows...`;

            processInChunks(
                dedupedData,
                200,
                (row) => {
    const firstName = (row['borrower first name'] || '').trim();
                    const lastName = (row['borrower last name'] || '').trim();
                    const fullName = `${firstName} ${lastName}`.trim() || 'Unknown Client';
                    const address = (row['subject property address'] || '').trim();
                    const city = (row['subject property city'] || '').trim();
                    const state = (row['subject property state'] || '').trim();
                    const zip = (row['subject property zip'] || '').trim();
                    const fullAddress = `${address}, ${city}, ${state} ${zip}`.trim();
                    const phone = (row['borr home phone'] || '').trim();
                    const email = (row['borr email'] || '').trim();
                    const closingStr = row['closing date'] || '';
                    const loanProgram = (row['loan program'] || 'N/A').trim();
                    const loanAmount = parseFloat(row['loan amount'] || 0) || 0;
                    const rate = parseFloat(row['note rate'] || 0) || 0;
                    const term = parseInt(row['loan term'] || 360) || 360;
                    const appraisedValue = parseFloat(row['appraised value'] || 0) || 0;
                    const purchasePrice = parseFloat(row['subject property purchase price'] || 0) || appraisedValue;
                    const buyersAgent = (row['buyers agent contact name'] || '').trim();

                    const valueAtClosing = purchasePrice > 0 ? purchasePrice : appraisedValue;
                    const originalLTV = valueAtClosing > 0 ? (loanAmount / valueAtClosing) * 100 : 0;

                    const originalPI = pmt(rate, term, loanAmount);

                    const estimatedAnnualInsurance = appraisedValue * 0.0035;
                    const originalInsurance = estimatedAnnualInsurance / 12;

                    const estimatedAnnualTaxes = appraisedValue * 0.011;
                    const originalTaxes = estimatedAnnualTaxes / 12;

                    const originalMI = originalLTV > 80 ? (loanAmount * 0.008 / 12) : 0;

                    let closingDate;
                    const serialNum = parseFloat(closingStr);
                    if (!isNaN(serialNum) && serialNum > 10000) {
                        closingDate = excelSerialToDate(serialNum);
                    } else {
                        closingDate = new Date(closingStr);
                    }

                    let monthsPaid = 0;
                    let closingDateFormatted = 'N/A';
                    if (!isNaN(closingDate.getTime())) {
                        monthsPaid = calculateMonthsElapsed(closingDate);
                        closingDateFormatted = closingDate.toLocaleDateString('en-US', { year: 'numeric', month: '2-digit', day: '2-digit' });
                    }

                    let estimatedBalance = remainingBalance(loanAmount, rate, term, monthsPaid);
                    if (isNaN(estimatedBalance)) estimatedBalance = loanAmount;

                    let equity = Math.max(0, appraisedValue - estimatedBalance);

                    let cashOut = Math.max(0, appraisedValue * 0.8 - estimatedBalance);

                    let moveUp = Math.max(0, appraisedValue * 0.95 - estimatedBalance);

                    const newPI = pmt(currentMarketRate, term, estimatedBalance);
                    let monthlySavings = rate > currentMarketRate ? Math.round(originalPI - newPI) : 0;
                    monthlySavings = Math.max(0, monthlySavings);

                    const type = monthlySavings > 100 ? 'Refi Ready' : cashOut > 50000 ? 'Cash-Out Goldmine' : 'Move-Up Ready';

                    let score = Math.round((monthlySavings / 5) + (moveUp / 4000) + (cashOut / 4000));
                    if (isNaN(score)) score = 0;

                    const currentLTV = appraisedValue > 0 ? (estimatedBalance / appraisedValue) * 100 : 0;
                    const pmiEligible = originalLTV > 80 && currentLTV <= 80;

                    opportunities.push({
                        fullName,
                        fullAddress,
                        phone,
                        email,
                        loanProgram,
                        closingDate: closingDateFormatted,
                        currentRate: rate,
                        currentTerm: term,
                        estimatedBalance,
                        appraisedValue,
                        equity,
                        monthlySavings,
                        cashOut,
                        moveUp,
                        type,
                        score,
                        originalPI,
                        originalLTV,
                        originalMI,
                        originalInsurance,
                        originalTaxes,
                        buyersAgent,
                        pmiEligible
                    });
                },
                () => {
                    // === ALL ROWS PROCESSED — NOW SORT AND BUILD DASHBOARD ===
                    opportunities.sort((a, b) => b.score - a.score);

                    window.currentOpportunities = opportunities;

                    let dashboardHTML = `
                        <div class="max-w-7xl mx-auto">
                            <div class="bg-gradient-to-r from-[#F15A29] to-[#7c3aed] text-white p-12 rounded-3xl shadow-2xl mb-12 text-center relative">
                                <!-- New Scan button -->
                                <button onclick="resetEquityTool()" class="absolute top-6 left-6 bg-white/20 hover:bg-white/30 text-white px-6 py-3 rounded-full font-bold transition-all shadow-md">
                                    ← New Scan
                                </button>
                                <h3 class="text-5xl font-bold mb-6">Equity Opportunity Dashboard</h3>
                                <p class="text-2xl mb-10">Analyzed ${opportunities.length} clients</p>
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                                    <div class="bg-white/20 p-8 rounded-2xl">
                                        <p class="text-6xl font-bold">$${ (opportunities.reduce((sum, o) => sum + o.equity, 0) / 1000000).toFixed(1) }M</p>
                                        <p class="text-2xl mt-2">Total Equity</p>
                                    </div>
                                    <div class="bg-white/20 p-8 rounded-2xl">
                                        <p class="text-6xl font-bold">${opportunities.filter(o => o.score > 70).length}</p>
                                        <p class="text-2xl mt-2">High-Priority</p>
                                    </div>
                                    <div class="bg-white/20 p-8 rounded-2xl">
                                        <p class="text-6xl font-bold">$${ opportunities.reduce((sum, o) => sum + o.monthlySavings, 0).toLocaleString() }</p>
                                        <p class="text-2xl mt-2">Monthly Savings</p>
                                    </div>
                                    <div class="bg-white/20 p-8 rounded-2xl">
                                        <p class="text-6xl font-bold">${opportunities.length}</p>
                                        <p class="text-2xl mt-2">Clients</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Sorting and Filtering -->
                            <div class="flex gap-6 mb-8 justify-center">
    <select id="filter-type" class="py-4 px-8 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-xl font-semibold shadow-md border border-gray-300 dark:border-gray-600 focus:ring-4 focus:ring-[#F15A29]/50 focus:outline-none">
        <option>All</option>
        <option>Refi Ready</option>
        <option>Cash-Out Goldmine</option>
        <option>Move-Up Ready</option>
        <option>PMI Removal Eligible</option>
    </select>
    <select id="sort-by" class="py-4 px-8 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-xl font-semibold shadow-md border border-gray-300 dark:border-gray-600 focus:ring-4 focus:ring-[#F15A29]/50 focus:outline-none">
        <option value="score">Score (High to Low)</option>
        <option value="equity">Equity (High to Low)</option>
        <option value="monthlySavings">Savings (High to Low)</option>
    </select>
</div>

                            <div id="opportunity-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mb-12"></div>

                            <div class="text-center mt-12 space-x-8">
                                <button onclick="copyDashboard()" class="bg-[#002B5C] text-white px-12 py-6 rounded-full font-bold text-xl shadow-2xl">
                                    📋 Copy All Data
                                </button>
                                <button onclick="window.print()" class="bg-[#00A89D] text-white px-12 py-6 rounded-full font-bold text-xl shadow-2xl">
                                    🖨️ Print Dashboard
                                </button>
                            </div>
                        </div>
                    `;

                    output.innerHTML = dashboardHTML;
                    output.classList.remove('hidden');

                    // Re-attach sort/filter listeners
                    document.getElementById('filter-type').addEventListener('change', sortAndRenderCards);
                    document.getElementById('sort-by').addEventListener('change', sortAndRenderCards);

                    renderCards();

// === AUTO-SCROLL TO DASHBOARD ===
setTimeout(() => {
    const dashboardContainer = document.getElementById('equity-output');
    if (dashboardContainer) {
        dashboardContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}, 400);

loading.classList.add('hidden');
                }
            );

        } catch (error) {
            console.error(error);
            output.innerHTML = `<p class="text-red-600 text-center py-20 text-xl font-bold">Error: ${error.message}</p>`;
            output.classList.remove('hidden');
            loading.classList.add('hidden');
        }
    };

    if (file.name.match(/\.(xlsx|xls)$/)) {
        reader.readAsBinaryString(file);
    } else {
        reader.readAsText(file);
    }
}
function calculateMonthlyPayment(principal, monthlyRate, months) {
    if (monthlyRate === 0) return principal / months;
    return principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
}
function resetEquityTool() {
    const output = document.getElementById('equity-output');
    const inputArea = document.getElementById('equity-input-area');
    if (output) {
        output.classList.add('hidden');
        output.innerHTML = '';
    }
    if (inputArea) {
        inputArea.classList.remove('hidden');
    }
    window.currentOpportunities = null;
    window.filteredOpportunities = null;

    // Clear file
    document.getElementById('database-upload').value = '';
    document.getElementById('file-name').classList.add('hidden');
    document.getElementById('file-status').textContent = 'No file chosen';

    const equitySection = document.getElementById('equity-scanner');
    if (equitySection) {
        equitySection.scrollIntoView({ behavior: 'smooth' });
    }
}
async function generateSocialPost() {
    const type = document.getElementById('post-type').value;
    const details = document.getElementById('post-details').value.trim();
    const loading = document.getElementById('social-loading');
    const output = document.getElementById('social-output');
    loading.classList.remove('hidden');
    output.classList.add('hidden');
    output.innerHTML = '';
    let prompt = `Create a ready-to-post social media caption for a mortgage loan officer.
Post type/goal: ${type === 'custom' ? 'Custom idea' : type.replace('-', ' ')}
${details ? `Specific details/idea: ${details}` : ''}
Requirements:
- Warm, authentic, relationship-focused
- Engaging and conversational
- Never salesy — focus on value and trust
- Include relevant emojis
- End with subtle CTA (question, "Comment below", "DM me", "Tag a friend")
- Add 8–10 relevant hashtags at the end
Make it feel like it comes from a trusted friend who happens to be a mortgage expert.`;
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [{ role: "user", content: prompt }],
                temperature: 0.7,
                max_tokens: 800
            })
        });
        if (!response.ok) throw new Error('API error');
        const data = await response.json();
        const post = data.choices[0].message.content.trim();
        output.innerHTML = `
            <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
                ${marked.parse(post)}
            </div>
            <div class="text-center">
                <button onclick="copySocialPost()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                    📋 Copy Post to Clipboard
                </button>
            </div>
        `;
        output.classList.remove('hidden');
    } catch (error) {
        output.innerHTML = '<p class="text-red-600 text-center py-20">Error generating post. Check console or try again.</p>';
        output.classList.remove('hidden');
    } finally {
        loading.classList.add('hidden');
    }
}
function copySocialPost() {
    const text = document.querySelector('#social-output .prose')?.innerText || '';
    navigator.clipboard.writeText(text).then(() => alert('Post copied!'));
}
function showSocialPostCreator() {
    // Hide all sections
    document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
   
    // Show the AI post creator
    const target = document.getElementById('social-post');
    if (target) {
        target.classList.remove('hidden');
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
       
        // Close mobile sidebar
        document.getElementById('sidebar').classList.add('left-[-300px]');
    } else {
        console.error("Social Post Creator section (#social-post) not found!");
    }
}
// Dynamic helper text and placeholder for post details
// Dynamic helper/placeholder for post details based on selected type
document.getElementById('post-type').addEventListener('change', function() {
    const type = this.value;
    const helper = document.getElementById('details-helper');
    const textarea = document.getElementById('post-details');
    let helperText = '';
    let placeholder = '';
    switch(type) {
        case 'educational':
            helperText = "e.g., Explain rate buydowns, credit tips, or down payment myths";
            placeholder = "e.g., How temporary rate buydowns can lower payments for the first 2 years";
            break;
        case 'local':
            helperText = "e.g., Local event, favorite business, community story";
            placeholder = "e.g., Loved the holiday lights downtown last night!";
            break;
        case 'personal':
            helperText = "e.g., Family updates, hobbies, behind-the-scenes";
            placeholder = "e.g., Weekend hiking with the family — nature recharge!";
            break;
        case 'client-win':
        case 'just-closed':
        case 'client-story':
            helperText = "e.g., Client challenge overcome (keep anonymous or with permission)";
            placeholder = "e.g., Helped a first-time buyer close despite credit challenges";
            break;
        case 'market':
        case 'market-update':
            helperText = "e.g., Local stats, rate trends, inventory insight";
            placeholder = "e.g., Inventory up 12% locally — great time for buyers!";
            break;
        case 'reel':
            helperText = "e.g., Fun skit, day-in-the-life, myth-bust idea";
            placeholder = "e.g., 'Marry the house, date the rate' wedding skit";
            break;
        case 'engagement':
            helperText = "e.g., Poll or question to spark comments";
            placeholder = "e.g., Rent forever or own your home? Vote!";
            break;
        case 'value':
            helperText = "e.g., Free resource you're giving away";
            placeholder = "e.g., Sharing my 2026 Home Buyer Checklist — link in bio";
            break;
        case 'rate-myth':
            helperText = "e.g., Common rate misconception";
            placeholder = "e.g., 'You need 20% down' — here's the truth";
            break;
        case 'holiday':
            helperText = "e.g., Holiday tradition or seasonal tie-in";
            placeholder = "e.g., Favorite holiday recipe from our family";
            break;
        case 'realtor-value':
            helperText = "e.g., Tool or support for realtor partners";
            placeholder = "e.g., New co-branded open house flyer ready!";
            break;
        case 'motivational':
            helperText = "e.g., Inspirational message or quote";
            placeholder = "e.g., 'Your dream home is worth the effort'";
            break;
        case 'fun':
            helperText = "e.g., Relatable humor or light moment";
            placeholder = "e.g., When rates drop and everyone calls at once...";
            break;
        case 'referral-ask':
            helperText = "e.g., Soft way to ask for referrals";
            placeholder = "e.g., Know someone thinking about moving? Happy to help";
            break;
        case 'local-spotlight':
            helperText = "e.g., Local business or community feature";
            placeholder = "e.g., Shoutout to [Local Bakery] — best donuts in town!";
            break;
        default:
            helperText = "e.g., Describe what you'd like the post to say";
            placeholder = "e.g., Tell me your idea and I'll craft it";
    }
    helper.textContent = helperText;
    textarea.placeholder = placeholder;
});
// Modal functions
function openModal(category) {
    document.getElementById('modal-title').innerText = category;
    document.getElementById('modal-suggestions').innerHTML = getSuggestions(category);
    document.getElementById('post-modal').style.display = 'block';
}
function closeModal() {
    document.getElementById('post-modal').style.display = 'none';
}
// Click outside modal to close
window.onclick = function(event) {
    const modal = document.getElementById('post-modal');
    if (event.target === modal) {
        closeModal();
    }
}
function getSuggestions(category) {
    const suggestions = {
        "Educational": [
            "Myth-bust a common mortgage misconception (e.g., 'You need 20% down')",
            "Explain the difference between pre-qualification and pre-approval",
            "Share '5 costs to expect when buying a home'",
            "Break down how interest rates are determined",
            "Post a quick tip on improving credit score before applying",
            "Explain escrow and why it matters",
            "Share the benefits of a 15-year vs 30-year mortgage",
            "Talk about current FHA or VA loan advantages",
            "Demystify closing costs with a simple infographic idea",
            "Highlight red flags to watch for in a loan estimate"
        ],
        "Local": [
            "Spotlight a local small business or restaurant",
            "Share an upcoming community event or festival",
            "Post about a neighborhood market update or new development",
            "Celebrate a local school's achievement or sports win",
            "Recommend a hidden gem park or trail in the area",
            "Talk about seasonal local activities (e.g., holiday lights tour)",
            "Shout out a local charity or volunteer opportunity",
            "Share fun facts about your city's history",
            "Highlight a new local shop opening",
            "Post about farmers market or seasonal produce tips"
        ],
        "Personal": [
            "Behind-the-scenes of your day (e.g., 'Coffee run before approvals')",
            "Share a non-work hobby or weekend activity",
            "Post a family-friendly outing you enjoyed (with permission)",
            "Talk about a book/podcast you're loving right now",
            "Share your morning routine for staying productive",
            "Celebrate a personal milestone (e.g., years in the industry)",
            "Post a fun 'day in the life' reel",
            "Share what you're grateful for this week",
            "Talk about a lesson learned from a recent challenge",
            "Show your workspace or home office setup"
        ],
        "Client Wins": [
            "'Just helped another family into their dream home!' (with permission/photo)",
            "Share a client testimonial or success story",
            "Celebrate a 'Just Closed' with balloons or keys photo",
            "Post about overcoming a tough approval for a client",
            "Highlight a first-time buyer closing milestone",
            "Share 'From pre-approval to keys in hand' timeline",
            "Celebrate a refinance that saved a client money",
            "Post a fun closing table photo or signing moment",
            "Talk about helping a client buy in a competitive market",
            "Share an anonymous win: 'Helped a family lower their rate by X%'"
        ],
        "Value": [
            "Free downloadable homebuyer checklist",
            "Share a 'First-time buyer guide' link or PDF",
            "Post a mortgage calculator tip or tool",
            "Offer a free credit review or consultation",
            "Share a seasonal home maintenance checklist",
            "Provide a 'Questions to ask your lender' list",
            "Post a refinance breakeven calculator explanation",
            "Share a budget worksheet for homebuyers",
            "Offer a 'Moving checklist' resource",
            "Give away a local vendor list for new homeowners"
        ],
        "Engagement": [
            "Poll: 'What's your dream home feature?'",
            "This or That: 'Beach house or mountain cabin?'",
            "Tag a friend who needs to see this rate tip",
            "Question: 'What's stopping you from buying right now?'",
            "Poll: 'Rent or own — what's your plan?'",
            "Ask: 'What's your favorite part of homeownership?'",
            "Tag a friend you'd love to help buy a home",
            "Question: 'How long have you lived in your current home?'",
            "Poll: 'Fixer-upper or move-in ready?'",
            "Ask followers to share their home buying stories"
        ]
    };
    return suggestions[category].map(s => `<li>${s}</li>`).join('');
}
async function searchUnderwriting() {
    const questionInput = document.getElementById('uw-question');
    const loanTypeSelect = document.getElementById('uw-loan-type');
    const output = document.getElementById('uw-output');
    const loading = document.getElementById('uw-loading');
    const question = questionInput.value.trim();
    const loanType = loanTypeSelect.options[loanTypeSelect.selectedIndex].text;
    if (!question) {
        alert("Please enter an underwriting question.");
        return;
    }
    output.classList.add('hidden');
    loading.classList.remove('hidden');
    output.innerHTML = '';
    let userPrompt = `You are a senior mortgage underwriting compliance expert with 20+ years experience.
Your answers must be extremely accurate, conservative, and based solely on official published guidelines
(FNMA Selling Guide, FHLMC Seller/Servicer Guide, FHA 4000.1, VA PAM 26-7, USDA HB-1-3555) and known lender overlays. ${question}.
Loan type (if specified): ${loanType}
Include:
- Clear answer based on standard guidelines (FNMA, FHLMC, FHA, VA, USDA as relevant)
- Confidence level: High (95%+), Medium (70-94%), Low (<70%) — based on how definitive the guidelines are
- If applicable, mention any Ruoff-specific overlays from the following summary:
- Be accurate and conservative. If unsure, say so.
- Provide a precise, well-reasoned answer following the strict rules above.
- Double-check your logic before finalizing. Accuracy is paramount.
Ruoff Overlays Summary (effective 06/18/25):
- Conventional: No Leaseholds. Tribal Areas require CPB 25-04 eligibility. No Manual Underwrites (A/E required). CU score 5 requires second appraisal (use lower value). No business entity gifts. Investment: VOD required. Credit 620-639: 70% Max LTV (HPML review for >70%). Max DTI: Agency guidelines. Manufactured: FNMA/FHLMC direct, no repair escrows (grade/seed only for new), no ARMs, ATRE required (or alternative 50-day lock + title letter + ALTA 7). IL: ALTA 7 for insurability. Single-wide: Primary only, no cash-out, Agency guidelines.
- USDA: No Future Income. Tribal: CPB 25-04. No Leasehold. Min Credit 620. No No Credit Score loans. Manufactured: ATRE (or alternative), IL ALTA 7, Single-wide eligible.
- VA: No State Bond (except KHC). No Leasehold. Tribal: CPB 25-04. No No Credit Score. AUS: Min 600, Cash-Out 100% LTV (600+), 90% (600-619). Manual: Min 600, DTI 41%, Education for Purchase, No Double BK, Cash-Out 90%. High Balance: Min 700, Cash-Out 90%. IRRRL: Max LTV 105%, Exempt DTI. Manufactured: No Manual, No IRRRL, Cash-Out 75%, ATRE, IL ALTA 7, Single-wide: Primary, No Cash-Out.
- FHA: No Leasehold. Tribal: CPB 25-04. 203(k) separate. Manufactured: No Manual, No Non-Credit Streamline, No $100 Down, Cash-Out 75%, ATRE, IL ALTA 7, Single-wide: Primary, No Cash-Out, No HomeNow. AUS: <580 Not Eligible, 580-599 Education for housing lates/rent free, 600-619 Education for rent free/DTI >=40%. Manual: No Credit: Education, No Pre-Approval, No Cash-Out, No Double BK, Zero lates 24mo housing/installment, 12mo revolving, Max LTV 90% or with reserves, No MFH, GNMA direct. <600 Not Eligible, 600-619 No Cash-Out, DTI 31/43, Zero lates. 620-639 Education, Zero lates. >=640 No overlays.
- State Bond HFA: No VA (except KHC), No Manual, Check Encompass, MCC for Conv/FHA, Earnest money verified, Manufactured: Allowed per state, No single-wide, ATRE, IL ALTA 7, Alternative: 50-day lock, etc.
- 2-1 Buydown: Eligible Conv/FHA/VA/USDA, Ineligible State Bond/renov/construction, Purchase only, Fixed rate, 1-2 units, No Manufactured, Occupancy: Gov Primary, Conv Primary/Second, Contract: Buydown fee in concessions, Fee: Seller/builder, No borrower pay, Locked direct FNMA/FHLMC/GNMA.
Confidence Levels:
- High (95%+): Clear, unambiguous rule in primary guideline source
- Medium (70–94%): Generally accepted practice or overlay, minor ambiguity
- Low (<70%): Unclear, varies significantly, or no definitive source
Structure every response:
1. Direct, concise main answer
2. Supporting guideline reference (if applicable)
3. Ruoff Overlays Check: List any relevant overlays
4. Confidence level (emphasize) + brief explanation
4. Final disclaimer: Double check all answers and be cautious before relying strictly on this response.`;
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [
                    { role: "system", content: "You are an expert in mortgage underwriting guidelines. Provide accurate, concise answers based on standard agency rules and the provided Ruoff overlays. Always include confidence level and remind to verify." },
                    { role: "user", content: userPrompt }
                ],
                temperature: 0.5,
                max_tokens: 1000
            })
        });
        if (!response.ok) throw new Error('API error');
        const data = await response.json();
        const answer = data.choices[0].message.content.trim();
        output.innerHTML = `
            <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
                ${marked.parse(answer)}
            </div>
            <div class="text-center">
                <button onclick="copyUwOutput()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                    📋 Copy Response
                </button>
            </div>
        `;
        output.classList.remove('hidden');
    } catch (error) {
        console.error(error);
        output.innerHTML = `
            <div class="text-center text-red-600 dark:text-red-400 p-8 bg-red-50 dark:bg-red-900/30 rounded-2xl">
                <p class="font-bold text-xl">Error generating response</p>
                <p>Check console or try again.</p>
            </div>
        `;
        output.classList.remove('hidden');
    } finally {
        loading.classList.add('hidden');
    }
}
function copyUwOutput() {
    const text = document.querySelector('#uw-output .prose')?.innerText || '';
    navigator.clipboard.writeText(text).then(() => alert('Response copied!'));
}
let chatHistory = [
    {
        role: "system",
        content: `You are Grok, the ultimate AI Sales Coach for loan officers. This app is packed with powerful AI tools designed to help LOs close more loans, build stronger relationships, and grow their business.
When asked what the tool does or about its features, ALWAYS highlight the AI TOOLS first — they are the coolest and most valuable part:
• Sales Script Generator – Instant objection handlers and conversation scripts
• Social Media Post Creator – Ready-to-post content that builds trust and engagement
• Blog Creator – Full SEO-optimized blog posts in seconds
• Business Plan Creator
• AI Chat Assistant – Ask anything: motivation, marketing ideas, scenario help
Other key sections:
• Prospecting strategies
• Event planning ideas
• Referral partner systems
• Database nurturing
• Underwriting Guideline Search – Fast, accurate answers with confidence levels
Be enthusiastic, encouraging, and focus on how these tools save time and help win more business. Use bullet points for clarity.
Never lead with underwriting — it's one tool among many amazing features.`
    }
];
async function sendChatMessage() {
    const input = document.getElementById('chat-input');
    const messagesDiv = document.getElementById('chat-messages');
    const loading = document.getElementById('chat-loading');
    const userMessage = input.value.trim();
    if (!userMessage) return;
    // === SMART ROUTING: Check if it's an underwriting question ===
    if (smartRouteChat(userMessage)) {
        // If routed to underwriting tool, add message to chat and exit
        messagesDiv.innerHTML += `
            <div class="text-right mb-4">
                <div class="inline-block bg-[#F15A29] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                    ${userMessage}
                </div>
            </div>
            <div class="text-left mb-4">
                <div class="inline-block bg-[#002B5C] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                    <p class="italic">I've moved you to the <strong>Underwriting Guideline Search</strong> tool for the most accurate answer. Your question is pre-filled — just hit "Search Guidelines" or review the result!</p>
                </div>
            </div>
        `;
        input.value = '';
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
        return; // Stop here — don't send to general Grok
    }
    // === END SMART ROUTING ===
    // Normal chat flow continues below
    messagesDiv.innerHTML += `
        <div class="text-right mb-4">
            <div class="inline-block bg-[#F15A29] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                ${userMessage}
            </div>
        </div>
    `;
    input.value = '';
    loading.classList.remove('hidden');
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
    chatHistory.push({ role: "user", content: userMessage });
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: chatHistory,
                temperature: 0.7,
                max_tokens: 1000
            })
        });
        if (!response.ok) throw new Error(`API Error: ${response.status}`);
        const data = await response.json();
        const aiReply = data.choices[0].message.content;
        messagesDiv.innerHTML += `
            <div class="text-left mb-4">
                <div class="inline-block bg-[#002B5C] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                    ${marked.parse(aiReply)}
                </div>
            </div>
        `;
        chatHistory.push({ role: "assistant", content: aiReply });
    } catch (error) {
        console.error(error);
        messagesDiv.innerHTML += `
            <div class="text-center text-red-600 font-bold p-4 bg-red-50 dark:bg-red-900/30 rounded-2xl">
                Error: Could not get response. Check console or try again.
            </div>
        `;
    } finally {
        loading.classList.add('hidden');
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
}
// Allow Enter to send
document.getElementById('chat-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendChatMessage();
});
// Calculator JS
function calculateAdvanced() {
    const loanAmount = parseFloat(document.getElementById('loanAmount').value) || 0;
    const annualRate = parseFloat(document.getElementById('rate').value) || 0;
    const termYears = parseFloat(document.getElementById('term').value) || 30;
    const annualTaxes = parseFloat(document.getElementById('taxes').value) || 0;
    const annualInsurance = parseFloat(document.getElementById('insurance').value) || 0;
    const pmiRate = parseFloat(document.getElementById('pmi').value) || 0;
    const extraMonthly = parseFloat(document.getElementById('extraMonthly').value) || 0;
    const biweekly = document.getElementById('biweekly').checked;
    if (loanAmount <= 0 || annualRate <= 0 || termYears <= 0) {
        document.getElementById('calc-output').innerHTML = '<p class="text-red-600 font-bold">Invalid inputs.</p>';
        return;
    }
    const monthlyRate = annualRate / 100 / 12;
    const totalPayments = termYears * 12;
    // Standard P&I for the selected term
    const standardPI = loanAmount * monthlyRate * Math.pow(1 + monthlyRate, totalPayments) /
                      (Math.pow(1 + monthlyRate, totalPayments) - 1);
    const monthlyTaxes = annualTaxes / 12;
    const monthlyInsurance = annualInsurance / 12;
    const monthlyPMI = pmiRate > 0 ? loanAmount * pmiRate / 100 / 12 : 0;
    const basePITI = standardPI + monthlyTaxes + monthlyInsurance + monthlyPMI;
    // Standard interest over full selected term
    const standardInterest = standardPI * totalPayments - loanAmount;
    // Custom principal payment
    let principalPayment = standardPI + extraMonthly;
    let userMonthlyCost = basePITI + extraMonthly;
    if (biweekly) {
        principalPayment = (standardPI + extraMonthly) * 13 / 12;
        userMonthlyCost = userMonthlyCost / 2 * 26 / 12;
    }
    // Exact months to payoff (no extra month bug)
    let monthsToPayoff = totalPayments;
    if (principalPayment > loanAmount * monthlyRate + 0.01) { // safety for floating point
        const ratio = principalPayment / (principalPayment - loanAmount * monthlyRate);
        monthsToPayoff = Math.log(ratio) / Math.log(1 + monthlyRate);
        monthsToPayoff = Math.round(monthsToPayoff); // round to nearest month
    }
    const yearsToPayoff = Math.floor(monthsToPayoff / 12);
    const remainingMonths = monthsToPayoff % 12;
    const customInterest = principalPayment * monthsToPayoff - loanAmount;
    const interestSavings = standardInterest - customInterest;
    // Output with full breakdown and high-contrast text
    document.getElementById('calc-output').innerHTML = `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
            <div class="p-8 bg-white dark:bg-gray-800 rounded-3xl shadow-2xl border-4 border-[#002B5C]">
                <h4 class="text-2xl font-bold mb-8 text-[#002B5C] dark:text-[#00A89D]">Standard ${termYears}-Year Schedule</h4>
                <div class="space-y-4 text-gray-800 dark:text-gray-200 text-lg">
                    <p><strong>Principal & Interest:</strong> $${standardPI.toFixed(2)}/mo</p>
                    <p><strong>Property Taxes:</strong> $${monthlyTaxes.toFixed(2)}/mo</p>
                    <p><strong>Homeowners Insurance:</strong> $${monthlyInsurance.toFixed(2)}/mo</p>
                    <p><strong>PMI:</strong> $${monthlyPMI.toFixed(2)}/mo</p>
                    <p class="text-xl font-bold pt-4 border-t-2 border-[#002B5C]/30 text-[#002B5C] dark:text-[#00A89D]">
                        <strong>Total Monthly Payment:</strong> $${basePITI.toFixed(2)}
                    </p>
                    <p class="mt-6"><strong>Total Interest Over Term:</strong> $${standardInterest.toFixed(0)}</p>
                </div>
            </div>
            <div class="p-8 bg-white dark:bg-gray-800 rounded-3xl shadow-2xl border-4 border-[#F15A29]">
                <h4 class="text-2xl font-bold mb-8 text-[#F15A29]">Your Custom Schedule</h4>
                <div class="space-y-4 text-gray-800 dark:text-gray-200 text-lg">
                    <p><strong>Principal & Interest Applied:</strong> $${(standardPI + extraMonthly).toFixed(2)}/mo${biweekly ? ' (biweekly)' : ''}</p>
                    <p><strong>Property Taxes:</strong> $${monthlyTaxes.toFixed(2)}/mo</p>
                    <p><strong>Homeowners Insurance:</strong> $${monthlyInsurance.toFixed(2)}/mo</p>
                    <p><strong>PMI:</strong> $${monthlyPMI.toFixed(2)}/mo</p>
                    <p><strong>Extra Principal:</strong> $${extraMonthly.toFixed(2)}/mo</p>
                    <p class="text-xl font-bold pt-4 border-t-2 border-[#F15A29]/30 text-[#F15A29]">
                        <strong>Your Total Monthly Cost:</strong> $${userMonthlyCost.toFixed(2)}
                    </p>
                    <p class="mt-6"><strong>Payoff Time:</strong> ${yearsToPayoff} years${remainingMonths > 0 ? ', ' + remainingMonths + ' months' : ''}</p>
                    <p><strong>Total Interest Paid:</strong> $${customInterest.toFixed(0)}</p>
                    <p class="text-3xl font-bold ${interestSavings > 0 ? 'text-green-600' : 'text-red-600'} mt-8">
                        You Save: $${interestSavings.toFixed(0)} in interest
                    </p>
                </div>
            </div>
        </div>
    `;
}
// Auto-calculate on any input change (including checkbox)
document.querySelectorAll('#calculator input, #calculator input[type="checkbox"]').forEach(input => {
    input.addEventListener('input', calculateAdvanced);
    input.addEventListener('change', calculateAdvanced);
});
// Search with highlights
const searchInput = document.getElementById('search');
const searchWrapper = searchInput.parentElement;

if (searchInput) {
    let resultsDropdown = null;

    searchInput.addEventListener('input', (e) => {
        const query = e.target.value.trim().toLowerCase();
        
        // Clear previous
        if (resultsDropdown) {
            resultsDropdown.remove();
            resultsDropdown = null;
        }

        if (query === '') return;

        const sections = Array.from(document.querySelectorAll('main section'));
        const matches = [];

        sections.forEach(sec => {
            const titleEl = sec.querySelector('h2');
            const title = titleEl ? titleEl.textContent.toLowerCase() : '';
            const content = sec.textContent.toLowerCase();

            if (title.includes(query) || content.includes(query)) {
                // Score: title match = higher priority
                const score = title.includes(query) ? 2 : 1;
                // Snippet: find context around match
                const idx = content.indexOf(query);
                const start = Math.max(0, idx - 50);
                const snippetText = sec.textContent.slice(start, idx + query.length + 100);
                const highlighted = snippetText.replace(new RegExp(`(${query})`, 'gi'), '<strong class="font-bold text-[#F15A29]">$1</strong>');

                matches.push({
                    id: sec.id,
                    title: titleEl ? titleEl.textContent : 'Untitled',
                    snippet: highlighted + (snippetText.length < sec.textContent.length ? '...' : ''),
                    score
                });
            }
        });

        // Sort: title matches first, then relevance
        matches.sort((a, b) => b.score - a.score);

        // Limit to 6
        const limitedMatches = matches.slice(0, 6);

        if (limitedMatches.length === 0) {
            return;  // Or add "No results" div
        }

        // Build dropdown
        resultsDropdown = document.createElement('div');
        resultsDropdown.className = 'absolute top-full left-0 right-0 mt-2 bg-white/95 dark:bg-gray-800/95 backdrop-blur-md rounded-2xl shadow-2xl max-h-96 overflow-y-auto z-50 border border-white/20';
        resultsDropdown.innerHTML = `
            <ul class="py-2">
                ${limitedMatches.map(match => `
                    <li class="px-6 py-4 hover:bg-[#F15A29]/10 dark:hover:bg-[#F15A29]/20 cursor-pointer flex items-center justify-between border-b border-gray-200/50 dark:border-gray-700/50 last:border-0 transition-all" onclick="showSection('${match.id}'); searchInput.value = ''; resultsDropdown.remove(); dashboardHeader?.scrollIntoView({ behavior: 'smooth', block: 'start' });">
                        <div>
                            <p class="font-bold text-[#002B5C] dark:text-white text-lg">${match.title}</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1" innerHTML="${match.snippet}"></p>
                        </div>
                        <i class="fas fa-arrow-right text-[#F15A29] ml-4"></i>
                    </li>
                `).join('')}
                ${matches.length > 6 ? '<li class="px-6 py-3 text-center text-gray-500 text-sm">+ ${matches.length - 6} more results — refine search</li>' : ''}
            </ul>
        `;
        searchWrapper.appendChild(resultsDropdown);
    });

    // Close on outside click
    document.addEventListener('click', (e) => {
        if (!searchWrapper.contains(e.target)) {
            if (resultsDropdown) resultsDropdown.remove();
        }
    });
}
// KEEP THIS — this is the good one
document.getElementById('script-scenario-select').addEventListener('change', function() {
    const customWrapper = document.getElementById('custom-scenario-wrapper');
    const customTextarea = document.getElementById('custom-scenario');
    if (this.value === ' ') {
        customWrapper.classList.remove('hidden');
        customTextarea.value = '';
        customTextarea.focus();
    } else {
        customWrapper.classList.add('hidden');
        customTextarea.value = '';
    }
});
// Page load: show Prospecting, initial calc, and quote
// Page load: show AI Chat Assistant by default
// Page load: show AI Chat Assistant by default (no auto-scroll)
document.addEventListener('DOMContentLoaded', () => {
    // Hide all sections
    document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
    const chatInput = document.getElementById('chat-input');
    if (chatInput) {
        chatInput.value = "Tell me how this tool can help me as a loan officer. What are all the features?";
    }
    // Show AI Chat Assistant
    const aiChat = document.querySelector('#ai-chat');
    if (aiChat) {
        aiChat.classList.remove('hidden');
        // REMOVED: aiChat.scrollIntoView({ behavior: 'smooth' }); <-- Delete this line
    } else {
        // Fallback: show first section if AI Chat not found
        document.querySelector('main section')?.classList.remove('hidden');
    }
    // Initial calculation and quote (keep if needed)
    calculateAdvanced();
    generateQuote();
});
   // === DATABASE NURTURING CATEGORY MODALS ===
function openDatabaseModal(category) {
    const modal = document.getElementById('db-modal');
    const title = document.getElementById('db-modal-title');
    const content = document.getElementById('db-modal-content');
    modal.style.display = 'block';
    let html = '';
    if (category === 'Past Clients') {
        title.textContent = 'Past Clients – Your Gold Mine';
        html = `
            <p class="font-semibold mb-6">Highest referral potential — treat them like family.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Home Anniversary:</strong> Personalized gift + equity review call</li>
                <li><strong>Birthday:</strong> Handwritten card + small meaningful gift</li>
                <li><strong>Life Events:</strong> Track marriages, babies — send thoughtful congrats + help</li>
                <li><strong>Quarterly Touch:</strong> Personal video: "Just checking in — anything I can help with?"</li>
                <li><strong>Referral Ask:</strong> Only after value: "Who do you know buying/refinancing?"</li>
            </ul>
            <p class="mt-6 font-semibold">Goal: 2–3 referrals per 100 past clients/year</p>
        `;
    } else if (category === 'Sphere of Influence') {
        title.textContent = 'Sphere of Influence – Friends & Family';
        html = `
            <p class="font-semibold mb-6">They already trust you — nurture authentically.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Share real life updates (vacations, kids, hobbies)</li>
                <li>Help without asking: "Saw you're moving — need lender insights?"</li>
                <li>Host casual gatherings (BBQ, game night) — no pitch</li>
                <li>Remember personal details and follow up</li>
            </ul>
        `;
    } else if (category === 'Referral Partners') {
        title.textContent = 'Referral Partners – Realtors & Professionals';
        html = `
            <p class="font-semibold mb-6">Become indispensable — value first.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Weekly value: Market stats, co-branded tools</li>
                <li>Co-host events (buyer seminars, happy hours)</li>
                <li>Fast communication & smooth closings</li>
                <li>Monthly personal check-in: "How can I support your business?"</li>
                <li>Celebrate their wins publicly</li>
            </ul>
        `;
    } else if (category === 'Community Connections') {
        title.textContent = 'Community Connections – Local Network';
        html = `
            <p class="font-semibold mb-6">Become the go-to mortgage expert locally.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Join chamber, BNI, rotary</li>
                <li>Sponsor local events (sports, 5Ks)</li>
                <li>Host free workshops at library</li>
                <li>Cross-promote with local businesses</li>
                <li>Volunteer and share stories</li>
            </ul>
        `;
    } else if (category === 'Prospects') {
        title.textContent = 'Prospects – Warm Leads';
        html = `
            <p class="font-semibold mb-6">They said "not yet" — stay helpful until "yes".</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Monthly value drip (tips, updates)</li>
                <li>Bi-monthly video check-in</li>
                <li>Invite to events/seminars</li>
                <li>Share success stories of similar buyers</li>
            </ul>
        `;
    } else if (category === 'A+ VIPs') {
        title.textContent = 'A+ VIPs – Top 50 Influencers';
        html = `
            <p class="font-semibold mb-6">Highest ROI relationships — platinum treatment.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Quarterly personal lunch/dinner</li>
                <li>Exclusive event invites</li>
                <li>Premium hand-delivered gifts</li>
                <li>Proactive annual reviews</li>
                <li>Facilitate introductions</li>
            </ul>
        `;
    }
    content.innerHTML = html;
}
// Auto-fill text input when selecting from dropdown
document.getElementById('blog-topic-select').addEventListener('change', function() {
    if (this.value) {
        document.getElementById('blog-topic').value = this.value;
    }
});
// ... other functions
async function generateBlog() {
    const topicInput = document.getElementById('blog-topic').value.trim();
    const tone = document.getElementById('blog-tone').value;
    if (!topicInput) {
        alert('Please select or type a blog topic');
        return;
    }
    const output = document.getElementById('blog-output');
    const loading = document.getElementById('blog-loading');
    // Show loading spinner, hide output
    output.classList.add('hidden');
    loading.classList.remove('hidden');
    output.innerHTML = '';
    const systemPrompt = `You are an expert mortgage content writer creating high-quality, GEO-optimized blog posts for loan officers.
Key Requirements:
- Length: 600–1,000 words
- Tone: ${tone}
- Structure:
  - Engaging, clickable title
  - Strong intro hook
  - H2 subheadings
  - Short paragraphs
  - Bullet points where helpful
  - Bold key phrases
  - FAQ section near end
  - Soft CTA at end: "Ready to explore your options? Reach out — I’m here to help."
- SEO/GEO: Natural keywords, reader-first, local relevance
- Avoid: Any "trigger terms"that could lead to compliance issues. 
- Voice: Helpful, trustworthy, never salesy
- At the end of the blog post, add a clear separator (---) followed by a short, clearly labeled social media caption (e.g., **Suggested Social Media Caption:**) to post with a link to the blog. Keep the caption 100-200 characters (but do NOT include the character count in your response), engaging, and include relevant hashtags.
Write a complete blog post on: ${topicInput}`;
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [{ role: "user", content: systemPrompt }],
                temperature: 0.7,
                max_tokens: 3000
            })
        });
        if (!response.ok) throw new Error('API error');
        const data = await response.json();
        let fullContent = data.choices[0].message.content.trim();

        // Split blog and caption at separator
        let blogMarkdown = fullContent;
        let captionText = '';
        const separatorIndex = fullContent.lastIndexOf('---');
        if (separatorIndex !== -1) {
            blogMarkdown = fullContent.substring(0, separatorIndex).trim();
            captionText = fullContent.substring(separatorIndex + 3).trim();
            // Clean caption label if present
            captionText = captionText.replace(/^\*\*Suggested Social Media Caption:\*\*\s*/i, '').trim();
        }

        const wordCount = blogMarkdown.split(/\s+/).length;

        output.innerHTML = `
            <div class="prose prose-lg dark:prose-invert max-w-none mb-12">
                ${marked.parse(blogMarkdown)}
            </div>

            <h4 class="text-3xl font-bold text-[#F15A29] mb-6">Suggested Social Media Caption</h4>
            <div id="social-caption" class="bg-gray-100 dark:bg-gray-700 p-8 rounded-2xl text-lg mb-12 whitespace-pre-wrap font-medium">
                ${captionText || 'No caption generated — try regenerating!'}
            </div>

            <div class="flex flex-col md:flex-row gap-6 justify-center">
                <button id="copy-blog-btn" class="bg-[#F15A29] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#F15A29]/80 flex items-center justify-center gap-3">
                    <i class="fas fa-copy"></i> Copy Blog (with Formatting)
                </button>
                <button id="copy-caption-btn" class="bg-[#00A89D] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#00A89D]/80 flex items-center justify-center gap-3">
                    <i class="fas fa-share-alt"></i> Copy Social Caption
                </button>
            </div>

            <div class="flex justify-between items-center pt-8 mt-12 border-t border-gray-300 dark:border-gray-700">
                <p class="text-gray-600 dark:text-gray-400 text-lg">Word count: ${wordCount}</p>
            </div>
        `;
        output.classList.remove('hidden');

        // Attach copy handlers (must be after DOM insertion)
        document.getElementById('copy-blog-btn').onclick = copyBlogWithFormatting;
        document.getElementById('copy-caption-btn').onclick = copySocialCaption;

    } catch (error) {
        output.innerHTML = '<p class="text-red-600 text-center py-20 text-xl font-bold">Error generating blog. Check console or API key.</p>';
        output.classList.remove('hidden');
        console.error(error);
    } finally {
        loading.classList.add('hidden');
    }
}

// Rich copy for blog (preserves formatting)
function copyBlogWithFormatting() {
    const blogContent = document.querySelector('#blog-output .prose');
    if (!blogContent) {
        alert('No blog content to copy!');
        return;
    }
    const html = blogContent.innerHTML;
    const plainText = blogContent.innerText;

    const clipboardItem = new ClipboardItem({
        'text/html': new Blob([html], { type: 'text/html' }),
        'text/plain': new Blob([plainText], { type: 'text/plain' })
    });

    navigator.clipboard.write([clipboardItem]).then(() => {
        alert('Blog copied with formatting! Paste into WordPress, email, Google Docs, etc.');
    }).catch(err => {
        console.error('Rich copy failed:', err);
        navigator.clipboard.writeText(plainText).then(() => {
            alert('Copied as plain text (rich formatting not supported)');
        });
    });
}

// Plain text copy for caption
function copySocialCaption() {
    const captionEl = document.getElementById('social-caption');
    if (!captionEl || !captionEl.textContent.trim()) {
        alert('No caption to copy!');
        return;
    }
    const caption = captionEl.textContent.trim();
    navigator.clipboard.writeText(caption).then(() => {
        alert('Social caption copied! Ready for LinkedIn, Facebook, Instagram, etc.');
    }).catch(err => {
        console.error('Copy failed:', err);
        alert('Copy failed — select and copy manually');
    });
}
function closeDatabaseModal() {
    document.getElementById('db-modal').style.display = 'none';
}
// Close database modal when clicking outside
window.addEventListener('click', (event) => {
    const dbModal = document.getElementById('db-modal');
    if (event.target === dbModal) {
        dbModal.style.display = 'none';
    }
});
// === REFERRAL PARTNERS CATEGORY MODALS ===
function openReferralModal(type) {
    const modal = document.getElementById('referral-modal');
    const title = document.getElementById('referral-modal-title');
    const content = document.getElementById('referral-modal-content');
    modal.style.display = 'block';
    let html = '';
    if (type === 'Realtors') {
        title.textContent = 'Realtors – Your Core Referral Engine';
        html = `
            <p class="font-semibold mb-6">Realtors drive 60–80% of purchase business. Become their trusted financing partner.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Ideal Targets:</strong> Rising stars (2–6 years), established producers open to new lenders, team leaders</li>
                <li><strong>Outreach:</strong> Open house pop-bys with treats + pre-approval station, genuine social engagement → value DM → coffee invite</li>
                <li><strong>Value Offers:</strong> Co-branded buyer guides, listing presentation inserts ("My Preferred Lender"), fast pre-approvals, buydown explanations</li>
                <li><strong>Events:</strong> Lunch & learns ("Winning Offers in 2026"), happy hours, co-hosted buyer seminars</li>
                <li><strong>Transaction Excellence:</strong> Weekly agent updates, immediate milestone calls, celebrate their wins</li>
                <li><strong>Retention:</strong> Public social shoutouts, quarterly personal gifts, annual partnership review</li>
            </ul>
            <p class="mt-6 font-bold">Proven Result: Top LOs get 80%+ of business from 10–20 core realtor partners.</p>
        `;
    } else if (type === 'Builders') {
        title.textContent = 'Builders – New Construction Goldmine';
        html = `
            <p class="font-semibold mb-6">Preferred lender status = steady, high-volume pipeline.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> Attend model home openings, offer on-site financing station</li>
                <li><strong>Value Offers:</strong> Construction-to-perm loans, builder incentives, spec home financing</li>
                <li><strong>Events:</strong> Builder appreciation lunches, model home buyer seminars</li>
                <li><strong>Co-Marketing:</strong> Co-branded spec sheets, community signage</li>
                <li><strong>Retention:</strong> Quarterly builder meetings, exclusive rate incentives</li>
            </ul>
        `;
    } else if (type === 'Financial Planners') {
        title.textContent = 'Financial Planners & CPAs';
        html = `
            <p class="font-semibold mb-6">High-net-worth clients — perfect for jumbo, investment, and refi business.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> Joint seminars: "Homeownership in Wealth Planning"</li>
                <li><strong>Value Offers:</strong> Jumbo expertise, cash-out for investments, reverse mortgage education</li>
                <li><strong>Co-Marketing:</strong> Co-branded client reports, shared educational content</li>
                <li><strong>Retention:</strong> Annual joint client reviews, reciprocal referrals</li>
            </ul>
        `;
    } else if (type === 'Attorneys') {
        title.textContent = 'Attorneys – Sensitive Situations';
        html = `
            <p class="font-semibold mb-6">Divorce, probate, estate clients need compassionate, fast solutions.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> CLE presentations on mortgage implications in divorce/probate</li>
                <li><strong>Value Offers:</strong> Quick approvals for time-sensitive sales, cash-out for legal fees</li>
                <li><strong>Approach:</strong> Empathy first — "I'm here to make this transition as smooth as possible"</li>
                <li><strong>Retention:</strong> Quarterly lunch, charity donation thank-yous</li>
            </ul>
        `;
    } else if (type === 'Insurance Agents') {
        title.textContent = 'Insurance Agents – Natural Cross-Sell';
        html = `
            <p class="font-semibold mb-6">Bundle home + auto = easy referrals.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> Co-branded "Home Buyer Protection Package"</li>
                <li><strong>Value Offers:</strong> Joint quotes, shared client events</li>
                <li><strong>Events:</strong> Client appreciation insurance + mortgage reviews</li>
                <li><strong>Retention:</strong> Monthly referral lunch, shared marketing</li>
            </ul>
        `;
    } else if (type === 'Other') {
        title.textContent = 'Other Professionals';
        html = `
            <p class="font-semibold mb-6">Niche goldmines that others overlook.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>HR Directors — Corporate relocation programs</li>
                <li>Relocation Companies — Employee move financing</li>
                <li>Title Agents — Joint marketing & education</li>
                <li>Chamber/Networking Groups — Visibility & warm intros</li>
                <li>Approach: Find their pain point (speed, communication) and solve it</li>
            </ul>
        `;
    }
    content.innerHTML = html;
}
function closeReferralModal() {
    document.getElementById('referral-modal').style.display = 'none';
}
function copyOutput(outputId) {
    const prose = document.querySelector(`#${outputId} .prose`);
    if (!prose) {
        alert('No content to copy yet');
        return;
    }
    navigator.clipboard.writeText(prose.innerText).then(() => {
        alert('Copied to clipboard!');
    });
}
// Close referral modal when clicking outside
window.addEventListener('click', (event) => {
    const referralModal = document.getElementById('referral-modal');
    if (event.target === referralModal) {
        referralModal.style.display = 'none';
    }
});
// Smart routing for AI Chat Assistant — more flexible
// Smart routing for AI Chat Assistant – optimized for your exact IDs
function smartRouteChat(message) {
    const lowerMessage = message.toLowerCase();

    // First, detect if user is asking ABOUT the tool/features — do NOT route
    const aboutToolPhrases = [
        'what is this tool', 'what does this tool do', 'what can this tool do',
        'tell me about this app', 'what features', 'how does this help',
        'what are the tools', 'ai tools', 'features of this app'
    ];
    if (aboutToolPhrases.some(phrase => lowerMessage.includes(phrase))) {
        return false; // Let general chat handle it
    }

    // Underwriting keywords — route on ANY match (removed 2-keyword and ? requirement)
    const underwritingKeywords = [
        'fha', 'va', 'usda', 'conventional', 'dti', 'credit score',
        'guideline', 'overlay', 'qualify', 'eligible', 'minimum', 'maximum',
        'bankruptcy', 'foreclosure', 'manual underwrite', 'compensating factor',
        '203k', 'buydown', 'irr rl', 'cash out', 'lpmi', 'manufactured', 'lender overlay',
        'debt to income', 'credit report', 'aus', 'du', 'lp', 'manual underwriting'
    ];

    const hasUnderwritingKeyword = underwritingKeywords.some(keyword => 
        lowerMessage.includes(keyword)
    );

    if (hasUnderwritingKeyword) {
        // Route to underwriting tool
        document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
        const uwSection = document.getElementById('underwriting-search');
        if (uwSection) {
            uwSection.classList.remove('hidden');
        }
        const uwInput = document.getElementById('uw-question');
        if (uwInput) {
            uwInput.value = message;
            uwInput.focus();
            uwInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        setTimeout(() => {
            if (typeof searchUnderwriting === 'function') {
                searchUnderwriting();
            }
        }, 800);
        return true;
    }

    return false;
}
</script>
<script>
// Toggle custom preferences visibility
document.getElementById('calendar-template').addEventListener('change', function() {
    document.getElementById('custom-preferences').classList.toggle('hidden', this.value !== 'custom');
});

// Large idea pools (varied, no repetition across year) — kept your original + slight expansions for variety
const ideaPools = {
    personal: [
        "Morning coffee routine with a view of the backyard", "Weekend hike photo and what you love about Indiana trails",
        "Family game night snapshot", "Favorite local coffee shop visit", "Book I'm reading this week",
        "My dog's funny morning zoomies", "Garden update — first tomatoes of the season!", "Throwback to my first home purchase",
        "Gratitude post: Thankful for great clients and teammates", "Sunday meal prep — what's your go-to recipe?",
        "Kids' sports game highlight", "Favorite podcast episode this week", "Home office setup tour", "Pet playing in the snow/rain",
        "Weekend BBQ with friends", "Hobby share: Golf swing at local course", "Simple pleasure: Fresh baked cookies",
        "Throwback vacation memory", "Morning walk in the neighborhood", "What I'm watching on Netflix",
        "Favorite seasonal drink recipe", "Family tradition we love", "Home project progress pic", "Sunset from the porch",
        "Weekend farmer's market haul", "Cozy reading nook photo", "My why: Helping families achieve homeownership",
        "Quick life hack I use daily", "Favorite quote on my desk", "Behind-the-scenes: My daily planner",
        "Local Auburn park visit", "Favorite Indiana festival memory", "Home workout routine share"
    ],
    engagement: [
        "Poll: Coffee or tea person?", "This or That: City living or suburbs?", "What's your dream home feature?",
        "Biggest home-buying fear — comment below!", "Favorite local restaurant in your area?", "Buy now or wait for rates — thoughts?",
        "Share your best moving tip", "Beach house or mountain cabin?", "Rate your credit knowledge 1–10",
        "What's one home upgrade on your wish list?", "Cats or dogs as the ultimate home companion?", "Favorite season for house hunting?",
        "Would you rather renovate or buy new?", "Best advice you ever got about money?", "Share a home DIY win or fail!",
        "Favorite Auburn spot?", "Winter or summer in Indiana?"
    ],
    motivational: [
        "Monday motivation: Ziglar quote about attitude", "Your why matters — quick story about why I love this industry",
        "Small steps lead to big wins — client example", "Mindset tip: Start the week with gratitude",
        "Quote: 'Success is 80% mindset, 20% strategy'", "Overcoming obstacles — my biggest lesson learned",
        "Gratitude changes everything", "Focus on progress, not perfection"
    ],
    tips: [
        "Quick tip: How escrow accounts work", "Myth: You need 20% down to buy — here's the truth",
        "3 ways to boost your credit score fast", "Closing costs explained in plain English",
        "Should you lock your rate now? Factors to consider", "FHA vs Conventional — quick comparison",
        "How to remove PMI early", "Debt-to-income ratio basics"
    ],
    wins: [
        "Just helped another family close on their dream home! 🏡", "Client testimonial Thursday (with permission)",
        "Recent closing table celebration photo", "Saved a client $250/month on their refi — love these wins!",
        "Another smooth approval — teamwork makes the dream work!"
    ],
    community: [
        "Local business spotlight: Amazing Auburn/Fort Wayne spot", "Upcoming community event worth checking out",
        "Support local — share your favorite small business!", "Volunteer day recap — giving back feels great",
        "Shoutout to a great DeKalb County business"
    ],
    fun: [
        "Fun fact: The average American moves 11.7 times!", "Real estate myth busted with humor",
        "Friday funny: Mortgage meme that hits home", "Poll: What's the weirdest home feature you've seen?",
        "Weekend laugh: Funny home renovation fail"
    ]
};

// Weekly themes
const weeklyThemes = {
    Sun: "Personal & Relax Sunday – Family, hobbies, weekend vibes",
    Mon: "Motivational Monday – Inspiration & mindset",
    Tue: "Tip Tuesday – Quick mortgage/finance value",
    Wed: "Wins Wednesday – Testimonials & celebrations",
    Thu: "Community Thursday – Local spotlight & support",
    Fri: "Fun Friday – Polls, facts & humor",
    Sat: "Engagement Saturday – Questions & personal stories"
};

const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

function getDaysInMonth(year, month) {
    return new Date(year, month + 1, 0).getDate();
}

function pickRandom(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function generateLocalMonths(year, weekStart, template) {
    const weekdays = weekStart === 'Sun' ? ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'] : ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    let months = [];

    for (let m = 0; m < 12; m++) {
        const daysInMonth = getDaysInMonth(year, m);
        let monthDays = [];

        for (let d = 1; d <= daysInMonth; d++) {
            const dateObj = new Date(year, m, d);
            const wdIndex = dateObj.getDay();
            const weekday = weekdays[wdIndex === 0 ? 6 : wdIndex - (weekStart === 'Sun' ? 0 : 1)];
            const theme = weeklyThemes[weekday] || "General Day";

            let ideas = [];
            // Always 2 personal/engagement base
            ideas.push(pickRandom(ideaPools.personal));
            ideas.push(pickRandom([...ideaPools.personal, ...ideaPools.engagement]));

            // Template-specific weighting
            if (template === 'engagement') {
                ideas.push(pickRandom(ideaPools.engagement));
                ideas.push(pickRandom(ideaPools.engagement));
            } else if (template === 'personal') {
                ideas.push(pickRandom(ideaPools.personal));
                ideas.push(pickRandom(ideaPools.personal));
            } else if (template === 'realtor') {
                ideas.push("Value for agents: Fast pre-approvals & smooth closings");
                ideas.push(pickRandom([...ideaPools.personal, ...ideaPools.engagement]));
            } else {
                // Balanced — add 1 themed business + 1 mixed
                const themedPool = weekday === 'Mon' ? ideaPools.motivational :
                                  weekday === 'Tue' ? ideaPools.tips :
                                  weekday === 'Wed' ? ideaPools.wins :
                                  weekday === 'Thu' ? ideaPools.community :
                                  weekday === 'Fri' ? ideaPools.fun :
                                  ideaPools.tips;
                ideas.push(pickRandom(themedPool));
                ideas.push(pickRandom([...ideaPools.personal, ...ideaPools.engagement]));
            }

            monthDays.push({
                date: d.toString(),
                weekday,
                theme,
                ideas
            });
        }
        months.push({ name: monthNames[m], days: monthDays });
    }
    return months;
}

// New: Branded Overview Cover Sheet
function createOverviewSheet(year) {
    const data = [
        [`Your ${year} Social Media Success Plan`, "", "", "", "", "", "", ""],
        ["Built for Loan Officers in Auburn & Beyond — Consistency Made Simple", "", "", "", "", "", "", ""],
        [],
        ["Core Strategy", "", "", "", "", "", "", ""],
        ["75% Personal/Engagement/Community → Build authentic relationships", "", "", "", "", "", "", ""],
        ["25% Business/Educational → Position yourself as the go-to expert", "", "", "", "", "", "", ""],
        [],
        ["Weekly Themes", "", "", "", "", "", "", ""],
        ["Sunday: Personal & Relax", "Monday: Motivational", "Tuesday: Tip", "Wednesday: Wins", "", "", "", ""],
        ["Thursday: Community/Local", "Friday: Fun", "Saturday: Engagement", "", "", "", "", ""],
        [],
        ["Pro Tips for Maximum Results", "", "", "", "", "", "", ""],
        ["• Post 3–5 times per week minimum", "", "", "", "", "", "", ""],
        ["• Engage daily: Like/comment/share on others' posts", "", "", "", "", "", "", ""],
        ["• Use Stories/Reels for behind-the-scenes", "", "", "", "", "", "", ""],
        ["• Track engagement & double down on what works", "", "", "", "", "", "", ""],
        ["• Always add value — never hard sell", "", "", "", "", "", "", ""],
        [],
        ["You've got this! Start posting today and watch your business grow.", "", "", "", "", "", "", ""]
    ];

    const ws = XLSX.utils.aoa_to_sheet(data);
    ws['!merges'] = [
        { s: { r: 0, c: 0 }, e: { r: 0, c: 7 } },
        { s: { r: 1, c: 0 }, e: { r: 1, c: 7 } },
        { s: { r: 3, c: 0 }, e: { r: 3, c: 7 } },
        { s: { r: 7, c: 0 }, e: { r: 7, c: 7 } },
        { s: { r: 11, c: 0 }, e: { r: 11, c: 7 } },
        { s: { r: 18, c: 0 }, e: { r: 18, c: 7 } }
    ];
    ws['!cols'] = [{ wch: 60 }, { wch: 40 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }];

    // Styling for title
    if (ws['A1']) {
        ws['A1'].s = { font: { bold: true, sz: 24, color: { rgb: "F15A29" } }, alignment: { horizontal: 'center' } };
    }
    if (ws['A2']) {
        ws['A2'].s = { font: { bold: true, sz: 18 }, alignment: { horizontal: 'center' } };
    }

    return ws;
}

// Updated createMonthSheet with holidays, hashtags, local flavor
function createMonthSheet(month, year, monthIndex, weekStart) {
    const data = [];

    data.push([`${month.name} ${year}`]);
    data.push([]); data.push([]);

    data.push(['Weekly Themes Recap']);
    data.push(['Day', 'Theme Description']);
    const weekdayOrder = weekStart === 'Sun' ? ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'] : ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    weekdayOrder.forEach(wd => {
        data.push([wd, weeklyThemes[wd] || 'General Day']);
    });
    data.push([]); data.push([]);

    data.push(['Daily Post Ideas']);
    data.push(['Date', 'Weekday', 'Theme', 'Post Idea 1', 'Post Idea 2', 'Post Idea 3', 'Post Idea 4', 'Suggested Hashtags']);

    // 2026 US Holidays (major ones)
    const holidays = {
        'January 1': '🎉 New Year’s Day – Share your goals!',
        'January 19': 'MLK Day – Inspiration & equality post',
        'February 16': 'Presidents’ Day',
        'May 25': 'Memorial Day',
        'June 19': 'Juneteenth',
        'July 4': 'Independence Day 🇺🇸',
        'September 7': 'Labor Day',
        'November 26': 'Thanksgiving 🦃',
        'December 25': 'Christmas 🎄'
    };

    month.days.forEach(day => {
        const fullDateKey = `${month.name} ${day.date}`;
        const holidayNote = holidays[fullDateKey] || '';

        let hashtags = '#LoanOfficerLife #IndianaRealEstate #AuburnIN';
        if (day.weekday === 'Mon') hashtags += ' #MotivationMonday';
        if (day.weekday === 'Tue') hashtags += ' #TipTuesday';
        if (day.weekday === 'Wed') hashtags += ' #WinsWednesday';
        if (day.weekday === 'Thu') hashtags += ' #SupportLocal';
        if (day.weekday === 'Fri') hashtags += ' #FunFriday';
        if (holidayNote) hashtags += ' #HappyHolidays';

        data.push([
            `${month.name} ${day.date}, ${year}${holidayNote ? ' 🎉' : ''}`,
            day.weekday,
            day.theme + (holidayNote ? ' (Holiday!)' : ''),
            ...day.ideas.slice(0,4).map(idea => idea || ''),
            hashtags
        ]);

        if (holidayNote) {
            data[data.length-1][3] = holidayNote; // Override first idea with holiday suggestion
        }
    });

    const ws = XLSX.utils.aoa_to_sheet(data);

    ws['!merges'] = [
        { s: { r: 0, c: 0 }, e: { r: 0, c: 7 } },
        { s: { r: 3, c: 0 }, e: { r: 3, c: 7 } },
        { s: { r: data.length - month.days.length - 2, c: 0 }, e: { r: data.length - month.days.length - 2, c: 7 } }
    ];

    ws['!cols'] = [
        { wch: 24 }, { wch: 12 }, { wch: 55 },
        { wch: 55 }, { wch: 55 }, { wch: 55 }, { wch: 55 },
        { wch: 70 }
    ];

    // Wrap text + holiday highlighting
    const ideasStartRow = 11 + weekdayOrder.length;
    for (let r = ideasStartRow; r < data.length; r++) {
        for (let c = 2; c <= 7; c++) {
            const cell = XLSX.utils.encode_cell({ r, c });
            if (ws[cell]) {
                ws[cell].s = { 
                    alignment: { wrapText: true, vertical: 'top', horizontal: 'left' },
                    font: { sz: 11 }
                };
                if (data[r][2].includes('Holiday')) {
                    ws[cell].s.fill = { fgColor: { rgb: "E8F5E9" } }; // Light green
                }
            }
        }
    }

    // Bold headers + title styling (your original retained)
    const headerRows = [3, 4, data.length - month.days.length - 1];
    headerRows.forEach(rowIdx => {
        for (let c = 0; c < 8; c++) {
            const cell = XLSX.utils.encode_cell({ r: rowIdx, c });
            if (ws[cell]) {
                ws[cell].s = ws[cell].s || {};
                ws[cell].s.font = { bold: true, sz: 12 };
            }
        }
    });

    if (ws['A1']) {
        ws['A1'].s = { font: { bold: true, sz: 18 }, alignment: { horizontal: 'center' } };
    }

    return ws;
}

// Your createTipsSheet (kept as-is — it's solid)
function createTipsSheet() {
    const data = [
        ["Social Media Success Tips for Loan Officers", "", "", "", "", "", "", ""],
        [],
        ["Key Principle: ~75% personal/community/engagement — people connect with YOU first.", "", "", "", "", "", "", ""],
        ["~25% business/educational — provide genuine value.", "", "", "", "", "", "", ""],
        [],
        ["Frequency Guidelines"],
        ["Daily:", "Like/comment/share on followers' posts + 1–3 personal posts"],
        ["Weekly:", "Motivational Monday, Tip Tuesday, Wins Wednesday, Community Thursday, Fun Friday"],
        ["Monthly:", "Market update, local spotlight, deeper educational reel"],
        ["As they occur:", "Testimonials, closing pics, just-listed/sold (with permission)"],
        [],
        ["Idea Bank – Steal These Anytime"],
        ["Personal Ideas:", ...ideaPools.personal.slice(0,20).join(", ").split(", ")],
        [],
        ["Engagement Prompts:", ...ideaPools.engagement.slice(0,15).join(", ").split(", ")],
        [],
        ["Mortgage Tips:", ...ideaPools.tips],
        ["Fun/Community:", ...ideaPools.fun.concat(ideaPools.community)]
    ];

    const ws = XLSX.utils.aoa_to_sheet(data);
    ws['!cols'] = [
        { wch: 30 }, { wch: 50 }, { wch: 50 }, { wch: 50 }, 
        { wch: 50 }, { wch: 50 }, { wch: 50 }, { wch: 50 }
    ];
    ws['!merges'] = [{ s: { r: 0, c: 0 }, e: { r: 0, c: 7 } }];

    return ws;
}

// Full generateCalendar with your AI fetch, progress, overview sheet, etc.
async function generateCalendar() {
    const year = parseInt(document.getElementById('calendar-year').value) || 2026;
    const weekStart = document.getElementById('week-start').value;
    const template = document.getElementById('calendar-template').value;
    const loading = document.getElementById('calendar-loading');
    const success = document.getElementById('calendar-success');
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');

    // Reset UI
    if (success) success.classList.add('hidden');
    loading.classList.remove('hidden');
    progressBar.style.width = '0%';
    progressText.textContent = '0%';

    await new Promise(resolve => requestAnimationFrame(() => resolve()));

    let monthsData = [];

    if (template === 'custom') {
        const userPrompt = document.getElementById('custom-prompt').value.trim() || "Standard loan officer in Auburn, Indiana";

        const systemPrompt = `You are a social media strategist for mortgage loan officers. Create a full ${year} 12-month posting calendar.
Week starts on ${weekStart === 'Sun' ? 'Sunday' : 'Monday'}.
User preferences: ${userPrompt}

Follow these guidelines strictly:
- 75% personal/lifestyle/community/engagement content (build real connections)
- 25% business/educational (mortgage tips, wins, market insights)
- Use consistent themed days: Motivational Monday, Tip Tuesday, Wins Wednesday, Community Thursday, Fun Friday, Engagement Saturday, Personal & Relax Sunday
- Include major holidays with special post ideas when applicable
- Vary ideas — no repetition across the year
- Make ideas specific to Auburn/Indiana when possible

Output ONLY valid JSON in this exact structure (no extra text):
{
  "months": [
    {
      "name": "January",
      "days": [
        {
          "date": "1",
          "weekday": "Wednesday",
          "theme": "Motivational Monday",
          "ideas": ["Idea 1...", "Idea 2...", "Idea 3...", "Idea 4..."]
        }
        // ... all days
      ]
    }
    // ... all 12 months
  ]
}`;

        try {
            const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                    messages: [{ role: "user", content: systemPrompt }],
                    temperature: 0.7,
                    max_tokens: 3000
                })
            });

            if (!response.ok) throw new Error(`API error: ${response.status}`);

            const data = await response.json();
            const content = data.choices[0].message.content.trim();

            const jsonString = content.replace(/^```json\n?|```$/g, '').trim();
            const parsed = JSON.parse(jsonString);
            monthsData = parsed.months;

        } catch (err) {
            console.error('Custom AI generation failed:', err);
            alert('Custom generation failed — using Balanced template instead');
            monthsData = generateLocalMonths(year, weekStart, 'balanced');
        }
    } else {
        monthsData = generateLocalMonths(year, weekStart, template);
        await new Promise(resolve => setTimeout(resolve, 50));
    }

    await new Promise(resolve => setTimeout(resolve, 100));

    let progress = 0;
    const progressInterval = setInterval(() => {
        progress += Math.random() * 12 + 5;
        if (progress >= 95) {
            progress = 95;
            clearInterval(progressInterval);
        }
        progressBar.style.width = progress + '%';
        progressText.textContent = Math.round(progress) + '%';
    }, 600);

    const wb = XLSX.utils.book_new();

    const overviewWs = createOverviewSheet(year);
    XLSX.utils.book_append_sheet(wb, overviewWs, "Overview");

    for (const [mIdx, month] of monthsData.entries()) {
        const ws = createMonthSheet(month, year, mIdx, weekStart);
        XLSX.utils.book_append_sheet(wb, ws, month.name.substring(0, 31));
        if ((mIdx + 1) % 3 === 0) await new Promise(resolve => setTimeout(resolve, 50));
    }

    const tipsWs = createTipsSheet();
    XLSX.utils.book_append_sheet(wb, tipsWs, "Tips & Ideas");

    XLSX.writeFile(wb, `My_${year}_Social_Media_Calendar.xlsx`);

    clearInterval(progressInterval);
    progressBar.style.width = '100%';
    progressText.textContent = '100%';

    setTimeout(() => {
        loading.classList.add('hidden');
        if (success) success.classList.remove('hidden');
    }, 800);
}
// Toggle function — add this to your existing <script> block (or create a new one if needed)
function toggleCalendarSection() {
    const content = document.getElementById('calendar-content');
    const icon = document.getElementById('calendar-toggle-icon');
    
    content.classList.toggle('hidden');
    icon.classList.toggle('rotate-180');
}

document.addEventListener('DOMContentLoaded', () => {
    // Weekly Win Plan — FULL AI VERSION WITH SAFE LOCAL FALLBACK
    // - Tries personalized AI plan first (works when served over http/https)
    // - Silently falls back to local balanced plan if AI unavailable (e.g., file:// or bad key)
    // - No alerts, no duplication, spinner always hides

    const dailyActivities = [
        "Write two personal notes or thank-you cards to clients, referral partners, or prospects.",
        "Make at least five outbound calls to past clients or referral partners.",
        "Send personalized birthday messages using video to your past clients.",
        "Engage on social media by commenting on or liking 10 posts from realtors, clients, and referral partners.",
        "Record and post one short-form video or story about mortgage tips, market updates, or client success stories.",
        "Follow up with any new online or social media leads received in the past 24 hours.",
        "Reach out to a past client just to check in—no sales pitch, just relationship-building.",
        "Send a text or video message to a referral partner to stay top of mind.",
        "Knock on one local business door to introduce yourself (title companies, insurance agents, CPAs, etc.).",
        "Spend time reviewing and updating CRM with notes, follow-ups, and next actions."
    ];

    const weeklyActivities = [
        "Pipeline review with referral partners—discuss upcoming deals and potential new clients.",
        "Pipeline review with active clients—touch base with a weekly update, even if nothing new.",
        "Host a 15-minute coaching call (Zoom or Teams) for realtors on mortgage trends or strategies.",
        "Attend at least one networking event (chamber of commerce, BNI, or real estate meetup).",
        "Send a “Who do you know?” text to 5+ referral partners asking for warm introductions.",
        "Create and send a value-packed email to your database (market updates, home tips, etc.).",
        "Record and send a personalized video email to new leads or referral partners.",
        "Reach out to 3 new real estate agents via social media or in person.",
        "Host a casual coffee meeting with a referral partner or past client.",
        "Review past closed loans and follow up with clients who may benefit from refinancing."
    ];

    const weekendActivities = [
        "Post a personal social media update (family, hobby, local Auburn spot, or fun weekend vibe)",
        "Check and respond to any weekend inquiries, messages, or new leads",
        "Engage lightly on social: Like/comment on 5–10 posts from realtors/clients (no heavy prospecting)",
        "Quick Sunday prep: Review your calendar and pick Monday's top 10 calls",
        "Plan your social posts for the upcoming week (use your Social Calendar tool)",
        "Light CRM check: Flag any hot weekend leads for Monday follow-up",
        "Relax & recharge — share a weekend inspiration quote or gratitude post",
        "Family/fun time post — keep it authentic and relationship-focused",
        "Quick win: Send 3 'just checking in' texts to warm past clients",
        "Prepare one value video (market tip or fun fact) to post Monday"
    ];

    // Confetti function
    function launchConfetti() {
        const canvas = document.getElementById('confetti-canvas');
        if (!canvas) return;
        canvas.classList.remove('hidden');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const confetti = [];
        const colors = ['#F15A29', '#00A89D', '#FFD700', '#FF69B4'];

        for (let i = 0; i < 400; i++) {
            confetti.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                r: Math.random() * 8 + 3,
                d: Math.random() * 12 + 6,
                color: colors[Math.floor(Math.random() * colors.length)],
                tilt: Math.random() * 10 - 5,
                tiltAngle: 0
            });
        }

        let animationFrame;
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((c, i) => {
                c.tiltAngle += 0.1;
                c.y += c.d;
                c.tilt = Math.sin(c.tiltAngle) * 20;

                ctx.beginPath();
                ctx.lineWidth = c.r;
                ctx.strokeStyle = c.color;
                ctx.moveTo(c.x + c.tilt + c.r, c.y);
                ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r);
                ctx.stroke();

                if (c.y > canvas.height) confetti.splice(i, 1);
            });

            if (confetti.length > 0) animationFrame = requestAnimationFrame(draw);
            else canvas.classList.add('hidden');
        }
        draw();
    }

    // Setup & Persistence
    let userSetup = JSON.parse(localStorage.getItem('winPlanSetup')) || {
    name: "Loan Officer",
    monthlyGoal: 8,
    focus: "Balanced",
    lastMonth: 0,
    partners: 0,
    pastClients: 0,
    hours: "15–20",
    hobbies: [],
    hobbiesOther: "",
    preferredActivities: []  // NEW: Initialize as empty array
};
    let streak = parseInt(localStorage.getItem('winPlanStreak')) || 0;

    function updateSetupDisplays() {
        const name = userSetup.name.trim() || "Loan Officer";
        const titleEl = document.getElementById('personalized-title');
        if (titleEl) titleEl.textContent = `${name}'s Weekly Win Plan 🔥`;
        const goalEl = document.getElementById('monthly-goal-display');
        if (goalEl) goalEl.textContent = userSetup.monthlyGoal;

        const touchesNeeded = userSetup.monthlyGoal * 9;
        const targetEl = document.getElementById('weekly-target');
        if (targetEl) targetEl.textContent = `For ${userSetup.monthlyGoal} loans: Aim for ~${touchesNeeded} touches this week`;

        const streakEl = document.getElementById('streak-display');
        if (streakEl) streakEl.textContent = `${streak} Week Streak`;
        const messageEl = document.getElementById('streak-message');
        if (messageEl) messageEl.textContent = streak > 0 ? `${name}, you're on fire!` : `${name}, let's build your streak!`;
    }

    updateSetupDisplays();

    // Wizard functions
    function openSetupWizard() {
        const wizard = document.getElementById('setup-wizard');
        if (!wizard) return;
        document.getElementById('setup-name').value = userSetup.name;
        document.getElementById('setup-monthly-goal').value = userSetup.monthlyGoal;
        document.getElementById('setup-focus').value = userSetup.focus;
        document.getElementById('setup-last-month').value = userSetup.lastMonth || '';
        document.getElementById('setup-partners').value = userSetup.partners || '';
        document.getElementById('setup-past-clients').value = userSetup.pastClients || '';
        document.getElementById('setup-hours').value = userSetup.hours;
        document.getElementById('setup-hobbies-other').value = userSetup.hobbiesOther || '';
        wizard.classList.remove('hidden');
    }

    function saveSetup() {
    const wizard = document.getElementById('setup-wizard');
    if (!wizard) return;

    // Capture and save all values (exactly as you had it)
    userSetup.name = document.getElementById('setup-name').value.trim() || "Loan Officer";
    userSetup.monthlyGoal = parseInt(document.getElementById('setup-monthly-goal').value) || 8;
    userSetup.focus = document.getElementById('setup-focus').value;
    userSetup.lastMonth = parseInt(document.getElementById('setup-last-month').value) || 0;
    userSetup.partners = parseInt(document.getElementById('setup-partners').value) || 0;
    userSetup.pastClients = parseInt(document.getElementById('setup-past-clients').value) || 0;
    userSetup.hours = document.getElementById('setup-hours').value;
    userSetup.hobbies = Array.from(document.querySelectorAll('.hobby-checkbox:checked')).map(cb => cb.value);
    userSetup.hobbiesOther = document.getElementById('setup-hobbies-other').value.trim();
    userSetup.preferredActivities = Array.from(document.querySelectorAll('.activity-checkbox:checked')).map(cb => cb.value);

    // Save to localStorage
    localStorage.setItem('winPlanSetup', JSON.stringify(userSetup));

    // Close the modal
    wizard.classList.add('hidden');

    // Update any live displays (e.g., name/goal in header)
    updateSetupDisplays();

    // Show the big green confirmation toast
    const toast = document.getElementById('save-toast');
    if (toast) {
        toast.classList.remove('hidden');
        setTimeout(() => {
            toast.classList.add('hidden');
        }, 4000); // Auto-hide after 4 seconds
    }
}

    // Task Help
    function showTaskHelp(task) {
        const modal = document.getElementById('task-help-modal');
        if (!modal) return;
        document.getElementById('task-help-title').textContent = task;
        let content = `<p class="text-xl mb-6 font-bold">How to crush this:</p>`;

        if (task.includes("calls") || task.includes("outbound")) {
            content += `<p><strong>Script:</strong> "Hey [Name], it's ${userSetup.name} — rates are great right now, who do you know thinking about buying/refi?"</p>`;
            content += `<p class="mt-4">Tip: Smile when you dial — they hear it!</p>`;
        } else if (task.includes("social") || task.includes("post")) {
            content += `<p>Use your Social Post Creator → grab today's idea and post it now</p>`;
        } else if (userSetup.hobbies.length > 0) {
            content += `<p>Pro move: Tie this to your passion (${userSetup.hobbies[0]}) — invite a partner to join!</p>`;
        }

        content += `<p class="mt-6 text-2xl font-bold">⏱ Start a 25-min timer and go!</p>`;
        document.getElementById('task-help-content').innerHTML = content;
        modal.classList.remove('hidden');
    }

    function closeTaskHelp() {
        const modal = document.getElementById('task-help-modal');
        if (!modal) return;
        modal.classList.add('hidden');
    }

    // Build cards — single source of truth, safe
    function buildPlanCards(dayTasksArray) {
        const container = document.getElementById('weekly-tasks-container');
        if (!container) {
            console.error('ERROR: #weekly-tasks-container missing in HTML');
            return;
        }

        const grid = container.querySelector('.grid');
        if (!grid) return;

        let allTasks = 0;
        const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];

        dayTasksArray.forEach((dayObj, i) => {
            const day = days[i];
            const card = document.createElement('div');
            card.className = 'bg-gradient-to-br from-gray-800/90 to-gray-900 rounded-3xl p-8 shadow-2xl hover:scale-105 transition-all border border-[#00A89D]/30';

            let taskHTML = '<ul class="space-y-6">';
            dayObj.tasks.forEach(task => {
                taskHTML += `
                    <li onclick="showTaskHelp('${task.replace(/'/g, "\\'")}')" class="flex items-start gap-5 text-lg hover:bg-white/10 p-4 rounded-2xl transition-all cursor-pointer">
                        <input type="checkbox" class="w-8 h-8 mt-1 text-[#F15A29] rounded-lg focus:ring-[#00A89D] flex-shrink-0">
                        <span class="text-gray-200 leading-relaxed">${task}</span>
                    </li>`;
                allTasks++;
            });
            taskHTML += '</ul>';

            const dayEmoji = day === "Saturday" || day === "Sunday" 
                ? ['🌴','☀️','🛋️','📱','🌙'][i - 5] || '🌟'
                : ['💪','☎️','🤝','📈','☕'][i];

            card.innerHTML = `
                <h3 class="text-3xl font-bold mb-6 flex items-center ${
                    day === "Saturday" || day === "Sunday" ? 'text-[#F15A29]/80' : 'text-[#00A89D]'
                }">
                    <span class="text-5xl mr-4">${dayEmoji}</span> ${day} ${day === "Saturday" || day === "Sunday" ? '(Recharge Mode)' : ''}
                </h3>
                ${taskHTML}
            `;

            grid.appendChild(card);
        });

        const tasksTotalEl = document.getElementById('tasks-total');
        if (tasksTotalEl) tasksTotalEl.textContent = allTasks;

        updateProgress();

        streak++;
        localStorage.setItem('winPlanStreak', streak);
        updateSetupDisplays();
    }

    // Generate Plan — AI first, silent local fallback
    async function generateWeeklyPlan() {
    const loading = document.getElementById('generate-loading');
    const generateBtn = document.getElementById('generate-win-plan-btn');
    const originalBtnText = generateBtn ? generateBtn.textContent.trim() : 'Generate My Weekly Win Plan';

    if (loading) loading.classList.remove('hidden');
    if (generateBtn) {
        generateBtn.disabled = true;
        generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-3"></i>Generating...';
    }

    const container = document.getElementById('weekly-tasks-container');
    if (!container) {
        if (loading) loading.classList.add('hidden');
        if (generateBtn) {
            generateBtn.disabled = false;
            generateBtn.textContent = originalBtnText;
        }
        return;
    }

    // Unhide the container (this shows tasks + the progress summary section below)
    container.classList.remove('hidden');

    // CRITICAL FIX: Target ONLY the grid to clear old cards — do NOT overwrite the entire container
    let grid = container.querySelector('.grid');
    if (!grid) {
        // Safety: if grid missing, create it in the correct spot (before progress summary)
        grid = document.createElement('div');
        grid.className = 'grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8';
        const progressSection = container.querySelector('.mt-20'); // reference to progress block
        container.insertBefore(grid, progressSection);
    }
    grid.innerHTML = ''; // Clear only old task cards

    let dayTasks = [];

    if (userSetup.focus !== "Balanced") {
        try {
            const systemPrompt = `You are a world-class, elite loan officer sales coach with 20+ years of experience coaching top-producing loan officers to 7-figure incomes. Your style is direct, motivational, strategic, and deeply personalized—you speak like a high-energy mentor who truly cares about the loan officer's success, work-life balance, and authentic relationships.

Create an ultra-personalized, high-impact 7-day prospecting and relationship-building plan for ${userSetup.name}. This plan must feel custom-built for them, incorporating every detail they shared to maximize production while protecting their energy and personal life.

Key Personal Details:
- Name: ${userSetup.name}
- Monthly funded loan goal: ${userSetup.monthlyGoal} loans
- Last month's funded loans: ${userSetup.lastMonth > 0 ? userSetup.lastMonth : 'not provided / starting fresh'}
- Active referral partners: ${userSetup.partners}
- Past client database size: ${userSetup.pastClients} clients
- Weekly prospecting hours available: ${userSetup.hours}
- Primary prospecting focus: ${userSetup.focus}
- Passions & hobbies: ${[...userSetup.hobbies, userSetup.hobbiesOther].filter(Boolean).join(", ") || 'none shared—focus on professional growth and family time'}
- Preferred prospecting activities: ${userSetup.preferredActivities.length > 0 ? userSetup.preferredActivities.join(", ") : 'no strong preferences — mix it up'}

Prioritize tasks involving these activities when possible, while keeping balance.

Strategic Guidelines:
- Scale task volume and intensity to fit their available prospecting hours (${userSetup.hours}). Do not overload—aim for focused, high-leverage actions that drive results without burnout.
- Leverage their database size: With ${userSetup.pastClients} past clients and ${userSetup.partners} active partners, prioritize warm outreach (past clients, partners) when possible, especially if focus is Balanced or Past Client/Realtor heavy.
- Honor their primary focus (${userSetup.focus})—weight tasks accordingly while keeping overall balance.
- Weave in their passions/hobbies naturally for authentic connections and work-life balance (e.g., invite a partner to golf, share a family-oriented post, tie a hobby to relationship building).
- Weekdays: Heavy but focused prospecting—drive pipeline growth, referrals, and touches toward the ${userSetup.monthlyGoal}-loan monthly goal.
- Weekends: Light recharge mode—relationship nurturing, light social engagement, personal posts, and quick prep for Monday. Include recovery and family/hobby time.
- Reference last month's performance motivationally (e.g., build on momentum or "let's crush last month").
- Tasks must be specific, actionable, time-bound when possible, and motivating. Include relevant emojis for energy and scannability.
- Draw exclusively from these proven activity pools, but vary wording and make them feel fresh/personal:
  Daily activities: ${dailyActivities.join("; ")}
  Weekly activities: ${weeklyActivities.join("; ")}
  Weekend/light activities: ${weekendActivities.join("; ")}

Make every task feel achievable and exciting—use encouraging language like "Crush 5 warm calls" or "Build genuine connections."

Output ONLY valid, perfectly formatted JSON—no extra text, explanations, or markdown:
{
  "days": [
    {
      "day": "Monday",
      "tasks": ["🎯 Specific task 1", "☎️ Specific task 2", "..."]
    },
    // ... continue for all 7 days
  ]
}`;

            const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                    messages: [{ role: "user", content: systemPrompt }],
                    temperature: 0.8,
                    max_tokens: 2000
                })
            });

            if (!response.ok) throw new Error('API error');

            const data = await response.json();
            const content = data.choices[0].message.content.trim();
            const jsonString = content.replace(/^```json\n?|```$/g, '').trim();
            dayTasks = JSON.parse(jsonString).days;

        } catch (err) {
            console.log('AI plan unavailable — using local balanced plan');
            dayTasks = generateLocalDayTasks();
        }
    } else {
        dayTasks = generateLocalDayTasks();
    }

    // Build the cards (your existing buildPlanCards function will append to the cleared grid)
    buildPlanCards(dayTasks);

    // Force initial progress update (in case checks were restored or something)
    updateProgress();

    if (loading) loading.classList.add('hidden');
    if (generateBtn) {
        generateBtn.disabled = false;
        generateBtn.textContent = originalBtnText;
    }
}

function generateLocalDayTasks() {
    const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
    return days.map((day, i) => {
        let tasks = [];
        if (day === "Saturday" || day === "Sunday") {
            for (let j = 0; j < 4; j++) tasks.push(pickRandom(weekendActivities));
        } else {
            for (let j = 0; j < 6; j++) tasks.push(pickRandom(dailyActivities));
            if (i < weeklyActivities.length) tasks.push(weeklyActivities[i]);
        }
        return { day, tasks };
    });
}

function updateProgress() {
    const checkboxes = document.querySelectorAll('#weekly-tasks-container input[type="checkbox"]');
    const completed = Array.from(checkboxes).filter(cb => cb.checked).length;
    const total = checkboxes.length;

    const tasksCompletedEl = document.getElementById('tasks-completed');
    if (tasksCompletedEl) tasksCompletedEl.textContent = completed;

    const tasksTotalEl = document.getElementById('tasks-total');
    if (tasksTotalEl) tasksTotalEl.textContent = total;

    const progressBar = document.getElementById('weekly-progress-bar');
    if (progressBar) {
        const percent = total > 0 ? (completed / total) * 100 : 0;
        progressBar.style.width = percent + '%';
    }

    const completionMsg = document.getElementById('completion-message');
    if (!completionMsg) return;

    const name = userSetup.name.trim() || "Champion"; // pulls your saved name
    const percent = total > 0 ? (completed / total) * 100 : 0;

    if (percent === 100) {
        completionMsg.innerHTML = `
            <span class="text-5xl animate-bounce">🎉 ${name}, YOU CRUSHED THIS WEEK! 🎉</span><br>
            <span class="text-3xl mt-6 block">Top-tier performance — you're unstoppable!</span>
        `;
        launchConfetti();
    } else if (percent >= 80) {
        completionMsg.textContent = `${name}, almost there — finish like a boss! 🔥`;
    } else if (percent >= 50) {
        completionMsg.textContent = `Great momentum, ${name} — keep winning!`;
    } else {
        completionMsg.textContent = `Solid start, ${name} — you've got this!`;
    }
}

// FIXED: Event delegation — works on all checkboxes, even new ones
const tasksContainer = document.getElementById('weekly-tasks-container');
if (tasksContainer) {
    tasksContainer.addEventListener('change', (e) => {
        if (e.target.type === 'checkbox') {
            updateProgress();
        }
    });
}

function pickRandom(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

// Button listeners (unchanged)
const editBtn = document.getElementById('edit-setup-btn');
if (editBtn) editBtn.addEventListener('click', openSetupWizard);

const generateBtn = document.getElementById('generate-win-plan-btn');
if (generateBtn) generateBtn.addEventListener('click', generateWeeklyPlan);

const saveBtn = document.getElementById('save-setup-btn');
if (saveBtn) saveBtn.addEventListener('click', saveSetup);

updateSetupDisplays();
updateProgress();
    // Scrolling Quote Arrows + Auto-Scroll
    const scroller = document.getElementById('quote-scroller');
    const scrollLeft = document.getElementById('scroll-left');
    const scrollRight = document.getElementById('scroll-right');

    if (scroller && scrollLeft && scrollRight) {
        // Manual scroll on arrow click
        scrollLeft.addEventListener('click', () => {
            scroller.scrollBy({ left: -400, behavior: 'smooth' });
        });

        scrollRight.addEventListener('click', () => {
            scroller.scrollBy({ left: 400, behavior: 'smooth' });
        });

        // Auto-scroll forward every 12 seconds if not hovered
        setInterval(() => {
            if (!scroller.matches(':hover')) {
                scroller.scrollBy({ left: 400, behavior: 'smooth' });
            }
        }, 12000);
    }
});
</script>

<!-- Loading Overlay -->
<div id="generate-loading" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
    <div class="bg-white dark:bg-gray-800 p-12 rounded-3xl shadow-2xl text-center max-w-lg mx-4">
        <i class="fas fa-spinner fa-spin text-8xl text-[#00A89D] mb-8"></i>
        <p class="text-3xl font-bold text-[#002B5C] dark:text-white">Building Your Weekly Win Plan...</p>
        <p class="text-xl mt-6 text-gray-600 dark:text-gray-400">Preparing your personalized plan, it may take 45–60 seconds...
    </div>
</div>

<!-- Post Ideas Modal -->
<div id="post-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <div class="modal-header">
            <h3 id="modal-title" class="text-3xl font-bold"></h3>
            <p class="text-xl mt-4 text-gray-600 dark:text-gray-400">Feel free to copy any idea, or use it as inspiration for the AI generator!</p>
        </div>
        <ul id="modal-suggestions" class="modal-suggestions list-disc pl-8 space-y-4 text-lg">
            <!-- Filled by JS -->
        </ul>
    </div>
</div>
<!-- Database Nurturing Category Modals -->
<div id="db-modal" class="modal">
    <div class="modal-content max-w-4xl">
        <span class="close-modal" onclick="closeDatabaseModal()">&times;</span>
        <div class="modal-header">
            <h3 id="db-modal-title" class="text-4xl"></h3>
        </div>
        <div id="db-modal-content" class="space-y-8 text-lg">
            <!-- Filled dynamically by JS -->
        </div>
    </div>
</div>
<!-- Referral Partners Category Modals -->
<div id="referral-modal" class="modal">
    <div class="modal-content max-w-4xl">
        <span class="close-modal" onclick="closeReferralModal()">&times;</span>
        <div class="modal-header">
            <h3 id="referral-modal-title" class="text-4xl"></h3>
        </div>
        <div id="referral-modal-content" class="space-y-8 text-lg">
            <!-- Filled dynamically by JS -->
        </div>
    </div>
</div>

<!-- Detail Modal for Equity Scanner -->
<div id="detail-modal" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4" style="display: none;" onclick="closeDetailModal()">
    <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
        <!-- Close button -->
        <button onclick="closeDetailModal()" class="absolute top-6 right-6 text-4xl text-gray-500 hover:text-gray-700 z-10 bg-white/90 dark:bg-gray-800/90 rounded-full w-14 h-14 flex items-center justify-center shadow-lg">&times;</button>

        <!-- Content -->
        <div class="p-10 pt-20 pb-12">
            <h3 class="text-4xl font-black text-[#F15A29] mb-4" id="modal-client-name"></h3>
            <p class="text-2xl text-gray-700 dark:text-gray-300 mb-10" id="modal-address"></p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10 mb-10">
                <div class="space-y-6 text-lg">
                    <p><strong>Phone:</strong> 
                        <a id="modal-phone-link" href="" class="text-green-600 font-bold hover:underline text-xl"></a>
                        <span id="modal-phone-na" class="text-gray-500 ml-3 hidden">Not available</span>
                    </p>
                    <p><strong>Email:</strong> 
                        <a id="modal-email-link" href="" class="text-blue-600 font-bold hover:underline text-xl"></a>
                        <span id="modal-email-na" class="text-gray-500 ml-3 hidden">Not available</span>
                    </p>
                </div>
                <div class="space-y-6 text-lg" id="modal-buyers-agent-section" style="display: none;">
                    <p><strong>Transaction Type:</strong> <span id="modal-transaction-type"></span></p>
                    <p><strong>Buyer's Agent:</strong> <span id="modal-buyers-agent" class="font-bold text-purple-600"></span></p>
                </div>
            </div>

            <!-- Original Loan Details Section -->
            <div class="mt-10 p-8 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-900 dark:to-gray-800 rounded-2xl shadow-inner">
                <h4 class="text-2xl font-bold text-[#002B5C] dark:text-[#00A89D] mb-6 flex items-center"><i class="fas fa-file-invoice-dollar mr-3 text-[#F15A29]"></i>Original Loan Details</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-lg">
                    <p><strong>Program:</strong> <span id="modal-program"></span></p>
                    <p><strong>Closing Date:</strong> <span id="modal-closing-date"></span></p>
                    <p><strong>Rate:</strong> <span id="modal-current-rate"></span></p>
                    <p><strong>Term:</strong> <span id="modal-term"></span></p>
                    <p><strong>Original LTV:</strong> <span id="modal-original-ltv"></span></p>
                    <p><strong>Est. Balance:</strong> <span id="modal-balance"></span></p>
                    <p><strong>Estimated Home Value:</strong> <span id="modal-value"></span></p>
                    <p><strong>P&I Payment:</strong> <span id="modal-original-pi"></span></p>
                    <p><strong>Monthly MI:</strong> <span id="modal-original-mi"></span></p>
                    <p><strong>Homeowners Insurance:</strong> <span id="modal-original-insurance"></span></p>
                    <p><strong>Property Taxes:</strong> <span id="modal-original-taxes"></span></p>
                </div>
                <p id="modal-pmi-alert" class="bg-green-600 text-green p-6 rounded-xl font-bold flex items-center justify-center text-lg shadow-lg mt-6" style="display: none;">
    <i class="fas fa-check-circle mr-3 text-2xl"></i>Eligible for PMI Removal! (Current LTV ≤ 80%)
</p>
            </div>

                     <!-- Current Estimates & Comparison Section -->
<div class="mt-10 p-8 bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 rounded-2xl shadow-inner">
    <h4 class="text-3xl font-bold text-[#002B5C] dark:text-[#00A89D] mb-8 flex items-center"><i class="fas fa-chart-line mr-3 text-[#00A89D] text-2xl"></i>Current Estimates & Refinance Comparison</h4>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10" id="refi-comparison-grid">
        <!-- This will be populated dynamically by JS -->
    </div>
</div>

            <p class="mt-6"><strong>Opportunity Type(s):</strong> <span id="modal-type-badge"></span></p>

            <!-- Score Breakdown -->
            <div class="mt-10 p-8 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-900 dark:to-gray-800 rounded-2xl shadow-inner">
                <h4 class="text-2xl font-bold text-[#002B5C] dark:text-[#00A89D] mb-4 flex items-center"><i class="fas fa-star mr-3 text-[#F15A29]"></i>Score Breakdown</h4>
                <p class="text-lg">The overall score ranks clients based on new loan potential: (Monthly Savings / 5) + (Equity / 5000) + (Cash-Out Potential / 5000). Higher scores indicate stronger opportunities for refinance, cash-out, or move-up.</p>
            </div>

            <!-- Personalized Scripts Section -->
            <div id="modal-scripts" class="mt-12"></div>

            <!-- Call to Action Buttons -->
            <div class="mt-10 text-center">
                <button onclick="closeDetailModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-10 py-4 rounded-full font-bold text-xl">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>
</div>
<div id="save-toast" class="hidden fixed bottom-8 left-1/2 -translate-x-1/2 bg-green-600 text-white px-10 py-6 rounded-full shadow-2xl text-2xl font-bold z-50 flex items-center gap-4 animate-pulse transition-all">
    <i class="fas fa-check-circle text-4xl"></i>
    Settings Saved Successfully!
</div>
</body>
</html>
