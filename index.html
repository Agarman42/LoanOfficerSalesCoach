<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Ultimate Loan Officer Sales Coach</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
          <!-- SWITCH TO CLASS MODE -->
    <script>
      tailwind.config = {
        darkMode: 'class'
      }
    </script>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#002B5C">
    <style>
        
     .dark { 
        background: linear-gradient(to bottom, #1a202c, #0f172a); 
        color: #e2e8f0; 
    }

    .card { 
        transition: transform 0.2s, box-shadow 0.2s; 
    }
    .card:hover { 
    transform: translateY(-8px) !important;  /* Lighter than scale ‚Äî fixes GPU delay, keeps lift effect */
    box-shadow: 0 20px 40px rgba(0,168,157,0.5); 
}

    .accordion-content { 
        max-height: 0; 
        overflow: hidden; 
        transition: max-height 0.3s ease; 
    }
    .accordion-content.open { 
        max-height: 3000px; 
    }

    /* === HEADER - BOLDER & DARKER === */
    header {
        background: linear-gradient(to right, #001429, #002b5c) !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
    }

    /* === SIDEBAR - BOLDER & DARKER === */
    #sidebar {
        background: linear-gradient(to bottom, #001429, #001f3f) !important;
        box-shadow: 12px 0 40px rgba(0, 0, 0, 0.7);
    }

    /* === SIDEBAR GROUP BUTTONS - MORE IMPACT === */
    .sidebar-group {
        font-weight: 900;
        color: white;
        padding: 20px 28px;
        text-transform: uppercase;
        font-size: 1.1rem;
        letter-spacing: 2.2px;
        background-color: rgba(0, 31, 63, 0.9);
        border-radius: 20px;
        margin: 20px 24px 16px 24px;
        text-align: center;
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(12px);
        border: 3px solid rgba(0, 168, 157, 0.9);
        transition: all 0.4s ease;
    }

    .sidebar-group:hover {
        background-color: rgba(0, 43, 92, 1);
        border-color: #00A89D;
        transform: translateY(-6px) scale(1.03);
        box-shadow: 0 20px 50px rgba(0, 168, 157, 0.5);
    }

    .accordion button[aria-expanded="true"] i.fa-chevron-down,
    .accordion-content.open + button i.fa-chevron-down,
    .accordion button .fa-chevron-down {
        transition: transform 0.3s ease;
    }
    .accordion button[aria-expanded="true"] .fa-chevron-down {
        transform: rotate(180deg);
    }

    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.6);
        backdrop-filter: blur(8px);
    }

    .modal-content {
        background-color: #ffffff;
        color: #1f2937;
        margin: 10% auto;
        padding: 32px;
        border-radius: 24px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        max-width: 800px;
        max-height: 80vh;
        overflow-y: auto;
        border: 2px solid #00A89D;
    }

    .dark .modal-content {
        background-color: #1f2937;
        color: #f3f4f6;
    }

    .modal-content p,
    .modal-content ul,
    .modal-content li,
    .modal-content h1,
    .modal-content h2,
    .modal-content h3,
    .modal-content h4 {
        color: inherit;
    }

    .modal-header {
        text-align: center;
        margin-bottom: 24px;
    }
    .modal-header h3 {
        font-size: 2.5rem;
        font-weight: bold;
        color: #F15A29;
    }
    .close-modal {
        color: #aaa;
        float: right;
        font-size: 48px;
        font-weight: bold;
        cursor: pointer;
        position: absolute;
        top: 16px;
        right: 32px;
    }
    .close-modal:hover { color: #F15A29; }
    .dark .close-modal { color: #cbd5e1; }
    .dark .close-modal:hover { color: #F15A29; }

    /* Fixed: Use @apply correctly */
    .modal-suggestions {
        @apply space-y-6;
    }

    .modal-suggestions li {
        padding: 16px;
        background: linear-gradient(to right, #002B5C/5, #00A89D/5);
        border-radius: 16px;
        border-left: 6px solid #00A89D;
        font-size: 1.1rem;
    }

    /* === DETAIL MODAL: Most reliable repaint method === */
        /* === DETAIL MODAL: Most reliable repaint method === */
    #detail-modal {
        opacity: 0;
        transition: opacity 0.2s ease;
        position: fixed;
        inset: 0;
        /* ADD THIS LINE - forces GPU layer and fixes offset/repaint bug */
        transform: translateZ(0);
        backface-visibility: hidden;
    }

    #detail-modal[style*="flex"] {
        opacity: 1;
    }

    /* Eliminate top gap */
    main {
        padding-top: 0 !important;
        margin-top: 0 !important;
    }
    main > section {
        margin-top: 0 !important;
        padding-top: 1.5rem !important;
    }
    main section > *:first-child {
        margin-top: 0 !important;
    }

    /* Input readability */
    input[type="text"],
    input[type="number"],
    input[type="search"],
    textarea,
    select {
        background-color: #ffffff !important;
        color: #1f2937 !important;
    }

    .dark input[type="text"],
    .dark input[type="number"],
    .dark input[type="search"],
    .dark textarea,
    .dark select {
        background-color: #1f2937 !important;
        color: #f3f4f6 !important;
        border-color: #4b5563 !important;
    }

    input::placeholder,
    textarea::placeholder {
        color: #9ca3af !important;
        opacity: 1;
    }
    .dark input::placeholder,
    .dark textarea::placeholder {
        color: #9ca3af !important;
    }

    /* Unified AI Tool Styling */
    .ai-tool-wrapper {
        @apply bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12;
    }

    .ai-tool-wrapper label {
        @apply block text-lg font-semibold mb-3 text-[#00A89D];
    }

    .ai-tool-wrapper select,
    .ai-tool-wrapper input[type="text"],
    .ai-tool-wrapper textarea {
        @apply w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all;
    }

    .ai-tool-wrapper .generate-btn {
        @apply w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl mt-8;
    }

    .ai-tool-wrapper .copy-btn {
        @apply bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md;
    }

    .ai-tool-wrapper .loading-spinner {
        @apply text-center py-12;
    }

    .ai-tool-wrapper .loading-spinner i {
        @apply fas fa-spinner fa-spin text-6xl text-[#00A89D];
    }

    .ai-tool-output {
        @apply bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96;
    }

    /* Mobile safe area */
    @supports (padding-top: env(safe-area-inset-top)) {
        body {
            padding-top: env(safe-area-inset-top);
        }
    }
    
    header, 
    #sidebar, 
    main {
        padding-top: env(safe-area-inset-top);
    }

    .tab-btn {
        @apply px-10 py-4 font-bold text-xl bg-gray-300 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-t-lg transition-all;
    }

    .tab-btn.active {
        @apply bg-[#F15A29] text-white;
    }
    /* Nuclear fix for Chrome fixed modal offset + repaint delay */
#detail-modal {
    opacity: 0;
    transition: opacity 0.2s ease;
    position: fixed !important;
    inset: 0 !important;
    transform: translateZ(0);           /* Promote to GPU layer */
    backface-visibility: hidden;        /* Stabilize fixed positioning */
    will-change: opacity;               /* Hint to browser */
}

#detail-modal[style*="flex"] {
    opacity: 1;
}
#detail-modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 50;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    overflow: auto;
}
#detail-modal.flex {
    display: flex;
}
.force-reflow {
    opacity: 0.99;  /* Tiny change forces repaint without visual flicker */
}
main, #equity-scanner, #equity-output, #opportunity-cards {
    overflow: visible !important;
    overscroll-behavior: auto !important;
}

/* Reduce GPU aggression on detail modal (keeps fixes but less repaint bugs) */
#detail-modal {
    transform: none !important;  /* Remove translateZ(0) ‚Äî it's often the repaint offender */
    will-change: auto !important;
}
.animate-scroll {
    animation: scroll 45s linear infinite; /* Adjust 45s for faster/slower scroll */
}

@keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); } /* -50% because quotes are duplicated */
}

#quote-display {
    opacity: 1;
    transition: opacity 0.8s ease-in-out;
}

#quote-display.fade {
    opacity: 0;
}
/* Better looking range slider */
input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    height: 12px;
    background: #e5e7eb;
    border-radius: 9999px;
    outline: none;
    opacity: 0.9;
    transition: opacity .2s;
}

input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 28px;
    height: 28px;
    background: #00A89D;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(241,90,41,0.4);
    border: 3px solid white;
    transition: transform 0.15s ease;
}

input[type="range"]::-webkit-slider-thumb:hover {
    transform: scale(1.15);
}

input[type="range"]::-moz-range-thumb {
    width: 28px;
    height: 28px;
    background: #F15A29;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(241,90,41,0.4);
    border: 3px solid white;
    transition: transform 0.15s ease;
}

input[type="range"]::-moz-range-thumb:hover {
    transform: scale(1.15);
}

input[type="range"]:active::-webkit-slider-thumb,
input[type="range"]:active::-moz-range-thumb {
    transform: scale(1.3);
}
#new-rate-slider {
    pointer-events: auto !important;
    user-select: none;
}
.headshot { 
    width:140px; 
    height:140px; 
    border-radius:50%; 
    border:5px solid #00A89D; 
    object-fit:cover;  /* Critical ‚Äî prevents squish/distortion */
    display:block;
}
/* ADD TO YOUR <style> BLOCK: Bigger, Bolder Script Headers */
.prose h2 {
    font-size: 2rem !important;
    font-weight: 900 !important;
    color: #F15A29 !important;
    margin: 2rem 0 1rem !important;
    padding-bottom: 0.5rem;
    border-bottom: 3px solid #00A89D;
}
/* Prevent sidebar underlines forever ‚Äî no leakage from newsletter preview */
#sidebar,
#sidebar * {
    text-decoration: none !important;
}

#sidebar a,
#sidebar li,
.sidebar-item,
.sidebar-item span,
.sidebar-item i {
    text-decoration: none !important;
    border-bottom: none !important;
}

#sidebar a:hover,
#sidebar li:hover,
.sidebar-item:hover {
    text-decoration: none !important;
}
</style>
</head>
<body class="bg-gradient-to-br from-gray-100 to-white dark:from-gray-900 dark:to-gray-800 text-gray-900 dark:text-gray-100 min-h-screen font-sans">

<header class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white py-8 shadow-2xl relative">
    <div class="max-w-7xl mx-auto px-6">
        <!-- Top Row: Hamburger (left with padding) + Title (perfectly centered) -->
        <div class="flex items-center justify-between mb-6">
            <!-- Hamburger Menu: Safe left padding, no edge bleed -->
            <button id="menu-toggle" class="text-white text-3xl focus:outline-none md:hidden ml-2">
                <i class="fas fa-bars"></i>
            </button>

            <!-- Title: Centered -->
            <h1 class="text-3xl md:text-5xl font-bold text-center flex-1">
                Ultimate Loan Officer Sales Coach
            </h1>

            <!-- Invisible spacer: Balances hamburger for perfect title centering -->
            <div class="w-12 md:hidden"></div>
        </div>

        <!-- Dark/Light Toggle: Centered, evenly spaced below title and above search -->
        <div class="flex justify-center mb-8">
            <button id="theme-toggle" class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white px-6 py-3 rounded-full font-bold flex items-center gap-3 shadow-lg hover:shadow-xl transition-all">
                <i id="theme-icon" class="fas fa-moon text-xl text-gray-800 dark:text-yellow-400"></i>
                <span class="text-lg">Dark Mode</span>
            </button>
        </div>

        <!-- Search Bar: Centered, full-width on mobile -->
        <div class="max-w-2xl mx-auto mb-6">
            <div class="relative">
                <input type="text" id="search" placeholder="Search for tips, scripts, or tools..." 
                       class="w-full p-4 pr-14 rounded-full bg-white/20 backdrop-blur-md border border-white/30 text-white placeholder-white/70 focus:outline-none focus:ring-4 focus:ring-white/50 text-lg">
                <i class="fas fa-search absolute right-5 top-1/2 -translate-y-1/2 text-white text-xl"></i>
            </div>
        </div>

        <!-- Single Quote Display with Manual Arrows & Auto-Rotation ‚Äì Compact Size -->
        <div class="relative bg-gradient-to-r from-[#002B5C]/80 to-[#00A89D]/80 py-3 my-8 rounded-3xl shadow-2xl text-center overflow-hidden max-w-3xl mx-auto">
            <!-- Quote Container ‚Äì reduced padding & height -->
            <div id="quote-display" class="text-xl md:text-2xl font-bold text-white opacity-90 min-h-[60px] flex items-center justify-center px-6 transition-opacity duration-800">
                "The harder you work, the luckier you get."
            </div>

            <!-- Left Arrow (smaller & positioned tighter) -->
            <button id="quote-prev" class="absolute left-4 top-1/2 -translate-y-1/2 text-white/50 hover:text-white text-4xl font-light transition-all duration-300 z-10 opacity-70 hover:opacity-100">
                ‚Äπ
            </button>

            <!-- Right Arrow -->
            <button id="quote-next" class="absolute right-4 top-1/2 -translate-y-1/2 text-white/50 hover:text-white text-4xl font-light transition-all duration-300 z-10 opacity-70 hover:opacity-100">
                ‚Ä∫
            </button>
        </div>
    </div>
</header>
             <aside id="sidebar" class="fixed left-[-300px] top-0 bottom-0 w-72 bg-gradient-to-b from-[#002B5C] to-[#00A89D] text-white overflow-y-auto transition-left duration-300 ease-in-out z-50 shadow-2xl rounded-r-xl md:left-0 md:w-64 lg:w-72">
        <ul class="p-6 space-y-3">
            <li class="sidebar-group">A.I. Tools</li>
            <li><a href="#weekly-win-plan" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-fire mr-3"></i> Weekly Win Plan
</a></li>
            <li><a href="#equity-scanner" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-comment-dots mr-3"></i> Equity & Opportunity Scanner
</a></li>
<li><a href="#social-post" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-share-alt mr-3"></i> Social Media Post/Plan Creator
</a></li>
<li><a href="#blog" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-pen-fancy mr-3"></i> Blog Creator
</a></li>
<!-- <li class="py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center cursor-pointer" onclick="showSection('newsletter-generator')">
    <i class="fas fa-envelope mr-3 text-xl"></i>
    <span>Newsletter Generator</span> 
</li> -->
<li><a href="#sales-script" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-comment-dots mr-3"></i> Sales Script Generator
</a></li>
<li><a href="#planning" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-chart-line mr-3"></i>Business Planning</a></li>
<li><a href="#underwriting-search" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-search-dollar mr-3"></i> Underwriting Guideline Search
</a></li>
                      <li><a href="#ai-chat" class="block py-3 px-6 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center">
    <i class="fas fa-robot mr-3"></i> AI Chat Assistant
</a></li>
                       <!-- <li class="sidebar-group">Marketing</li>
            <li><a href="#prospecting" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-search mr-3"></i>Prospecting</a></li>
            <li><a href="#social" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-share-alt mr-3"></i>Social Media</a></li>
            <li><a href="#eventplanning" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-search mr-3"></i>Event Planning</a></li>
            <li class="sidebar-group">Partners & Nurturing</li>
            <li><a href="#referrals" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-handshake mr-3"></i>Referral Partners</a></li>
            <li><a href="#value-vault" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-gem mr-3"></i>Value Vault</a></li>
            <li><a href="#database" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-database mr-3"></i>Database Nurturing</a></li>
            <li class="sidebar-group">Planning & Process</li>
            <li><a href="#process" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-cogs mr-3"></i>Loan Process</a></li>
            <li class="sidebar-group">Tools & Resources</li>
            <li><a href="#resources" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-tools mr-3"></i>Resources</a></li>
            <li><a href="#mindset-motivation" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-brain mr-3"></i>Mindset & Motivation</a></li>
            <li><a href="#books" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-book mr-3"></i>Book Recommendations</a></li>
            <li><a href="#calculator" class="block py-3 px-4 hover:bg-[#F15A29]/20 rounded-lg transition-colors flex items-center"><i class="fas fa-calculator mr-3"></i>Calculator</a></li>
            </ul> -->
    </aside>
    <!-- AI Chat Assistant - Persistent on every page -->
<div class="fixed bottom-4 right-4 z-50">
    <button onclick="showSection('ai-chat')" 
            class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white p-4 rounded-full shadow-2xl hover:scale-110 transition-all text-2xl">
        <i class="fas fa-robot"></i>
    </button>
</div>

<!-- The full AI Chat section remains where it is, but now accessible from anywhere -->
<main 
class="p-6 space-y-8 md:ml-64 lg:ml-72 pt-12 bg-gray-50 dark:bg-gray-900 min-h-screen">
    <!-- pt-48 = tight but comfortable spacing below fixed quote bar -->
    <!-- pt-64 gives breathing room below the fixed quote bar -->
                 <section id="mindset-motivation" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Mindset & Motivation</h2>
            <p class="mb-4">Build resilience and stay fired up with principles, quotes, stats, and tips.</p>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Core Pillars & Tips <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Relationship-Building:</strong> Treat interactions as chances to build trust; prioritize care for lasting referrals.</li>
                        <li><strong>Curiosity:</strong> Ask open questions to understand needs: "What challenges are you facing?" Listen 80%, speak 20%.</li>
                        <li><strong>Value-First:</strong> "Help others get what they want." Share resources without expectation.</li>
                        <li><strong>Embrace Challenges:</strong> Overcome to build perseverance; success comes from persistence.</li>
                        <li><strong>Learn from Mistakes:</strong> See errors as growth opportunities: "I‚Äôve found 10,000 ways that won‚Äôt work."</li>
                        <li><strong>Encourage Feedback:</strong> Seek from mentors; frame as insights, not criticism.</li>
                        <li><strong>Fill Mind with Positivity:</strong> Consume uplifting content like podcasts/biographies.</li>
                        <li><strong>Attitude Adjustment:</strong> Positive thinking outperforms negative.</li>
                        <li><strong>Persistence:</strong> "Failure is a detour, not dead-end." Bounce back higher.</li>
                        <li><strong>Daily Habits:</strong> Start with gratitude, visualize success, reflect nightly.</li>
                        <li><strong>Self-Belief:</strong> Celebrate wins, reflect on achievements, reward yourself, share to inspire.</li>
                        <li><strong>Enthusiasm:</strong> "For every sale missed from too much enthusiasm, miss 100 from too little."</li>
                        <li><strong>Motivation Daily:</strong> "Motivation doesn‚Äôt last, neither does bathing ‚Äì recommend daily."</li>
                        <li><strong>Helping Over Selling:</strong> "Stop selling. Start helping." Focus on pain points/solutions.</li>
                        <li><strong>Prospecting Mindset:</strong> "Prospecting is the lifeblood of sales; do it daily."</li>
                        <li><strong>Growth:</strong> "Success is 80% mindset, 20% strategy."</li>
                        <li><strong>Giving Value:</strong> "Givers gain; focus on serving first."</li>
                        <li><strong>Word Tracks for Influence:</strong> Use precise language to guide conversations.</li>
                        <li><strong>Authenticity in Prospecting:</strong> Be genuine to build trust quickly.</li>
                        <li><strong>Vision Planning:</strong> "A goal without a plan is just a wish."</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Buffini Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>People do business with those they know, like, and trust.</li>
                        <li>Build relationships first, business second.</li>
                        <li>Embrace challenges for growth.</li>
                        <li>Learn from mistakes as opportunities.</li>
                        <li>Encourage feedback for insights.</li>
                        <li>Fill mind with positivity.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Ziglar Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Your attitude determines your direction.</li>
                        <li>Success is maximum utilization of ability.</li>
                        <li>Stop selling. Start helping.</li>
                        <li>It‚Äôs not how far you fall but how high you bounce.</li>
                        <li>Attitude, not aptitude, determines altitude.</li>
                        <li>Make failure your teacher, not undertaker.</li>
                        <li>You don‚Äôt have to be great to start, but start to be great.</li>
                        <li>For every sale missed from enthusiasm, miss hundred from lack.</li>
                        <li>People buy for emotional reasons.</li>
                        <li>Top salesperson missed more sales but made more calls.</li>
                        <li>Get all you want by helping others.</li>
                        <li>Learn from defeat, haven‚Äôt lost.</li>
                        <li>If not winner in mind, can‚Äôt perform as winner.</li>
                        <li>Born to win: plan, prepare, expect.</li>
                        <li>Positive thinking better than negative.</li>
                        <li>Problem-solving key in maturity.</li>
                        <li>Want to earn more, learn more.</li>
                        <li>Motivation gets going, habit gets there.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Phil M. Jones Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>How open-minded are you to exploring options?</li>
                        <li>Just one more thing before you go...</li>
                        <li>When would be a good time to...?</li>
                        <li>If I could, would you...?</li>
                        <li>What makes you say that?</li>
                        <li>How do you mean?</li>
                        <li>Just imagine...</li>
                        <li>The good news is...</li>
                        <li>What happens next is...</li>
                        <li>What do you know about...?</li>
                        <li>Most people in your situation...</li>
                        <li>What would success look like for you?</li>
                        <li>Would it help if...?</li>
                        <li>What's the best outcome for you?</li>
                        <li>How would you feel if...?</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Tom Ferry Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Success is 80% mindset, 20% strategy.</li>
                        <li>Prospect daily or become obsolete.</li>
                        <li>Focus on revenue-generating activities.</li>
                        <li>Build a business, not just a job.</li>
                        <li>Time block for success.</li>
                        <li>Leverage technology for efficiency.</li>
                        <li>Consistent marketing builds brand.</li>
                        <li>Be the knowledge broker.</li>
                        <li>Scale your business with systems.</li>
                        <li>Focus on relationships for referrals.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Mike Ferry Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Prospecting is the lifeblood of your business.</li>
                        <li>Do the work others won't to have what others don't.</li>
                        <li>Scripts are tools for success.</li>
                        <li>Practice daily to master.</li>
                        <li>Own listings for leverage.</li>
                        <li>Call until you connect.</li>
                        <li>Focus on high-payoff activities.</li>
                        <li>Be disciplined in prospecting.</li>
                        <li>Build your database daily.</li>
                        <li>Consistency creates champions.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Ricky Carruth Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Relationships over transactions.</li>
                        <li>Give value freely.</li>
                        <li>Consistency wins.</li>
                        <li>Build your sphere.</li>
                        <li>Follow up relentlessly.</li>
                        <li>Be the go-to expert.</li>
                        <li>Focus on serving.</li>
                        <li>Network with purpose.</li>
                        <li>Personal branding matters.</li>
                        <li>Grow through giving.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Bob Burg Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Givers gain.</li>
                        <li>Focus on serving others.</li>
                        <li>Value first, success follows.</li>
                        <li>Build network through giving.</li>
                        <li>Authenticity key to relationships.</li>
                        <li>The more you give, the more you receive.</li>
                        <li>Success through value creation.</li>
                        <li>Be a go-giver, not go-taker.</li>
                        <li>Compensation determined by value provided.</li>
                        <li>Relationships built on trust.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Brian Tracy Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Successful people are always looking for opportunities to help others.</li>
                        <li>Develop an attitude of gratitude.</li>
                        <li>Goals are the fuel in the furnace of achievement.</li>
                        <li>The key to success is to focus our conscious mind on things we desire not things we fear.</li>
                        <li>Disciplined planning leads to success.</li>
                        <li>Invest in yourself.</li>
                        <li>Continuous learning is key.</li>
                        <li>Time management is life management.</li>
                        <li>Success is getting what you want, happiness is wanting what you get.</li>
                        <li>Leaders think and talk about solutions.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Jeffrey Gitomer Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>People don't like to be sold, but they love to buy.</li>
                        <li>Value first, sales second.</li>
                        <li>Trust is the foundation of sales.</li>
                        <li>Ask questions to uncover needs.</li>
                        <li>Be a resource, not a salesperson.</li>
                        <li>Sales success comes from helping.</li>
                        <li>Build relationships for loyalty.</li>
                        <li>Consistency in follow-up.</li>
                        <li>Learn from every no.</li>
                        <li>Attitude drives sales.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Jill Konrath Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Sell to busy buyers by being concise.</li>
                        <li>Focus on buyer problems.</li>
                        <li>Use agility in sales.</li>
                        <li>Research before calling.</li>
                        <li>Create urgency.</li>
                        <li>Be relevant to needs.</li>
                        <li>Build credibility fast.</li>
                        <li>Avoid pitch, start conversations.</li>
                        <li>Adapt to change.</li>
                        <li>Innovate sales approaches.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Mike Weinberg Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Prospecting is essential; do it authentically.</li>
                        <li>Focus on new business.</li>
                        <li>Be proactive in sales.</li>
                        <li>Avoid excuses, take action.</li>
                        <li>Build pipeline consistently.</li>
                        <li>Sales truth over myths.</li>
                        <li>Own your results.</li>
                        <li>Prospect with purpose.</li>
                        <li>Relationships through value.</li>
                        <li>Discipline in daily activities.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Antoine de Saint-Exup√©ry Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>A goal without a plan is just a wish.</li>
                        <li>Perfection achieved not when nothing more to add, but nothing left to take away.</li>
                        <li>Love does not consist in gazing at each other, but outward together same direction.</li>
                        <li>What saves a man is to take a step. Then another step.</li>
                        <li>Build a ship, teach longing for sea.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Additional Powerful Quotes <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>The harder you work, the luckier you get.</li>
                        <li>Your next loan is one call away.</li>
                        <li>Success is rented, rent due every day.</li>
                        <li>Every ‚Äúno‚Äù closer to ‚Äúyes.‚Äù</li>
                        <li>Start to be great.</li>
                        <li>Turn obstacles into opportunities.</li>
                        <li>Be so good they can‚Äôt ignore you.</li>
                        <li>Hustle beats talent.</li>
                        <li>Make someone‚Äôs dream come true today.</li>
                        <li>Doubt kills more dreams than failure.</li>
                        <!-- Full 100+ from XLS, grouped -->
                        <li>Consistency the silent closer.</li>
                        <li>Prospecting daily is key to growth.</li>
                        <li>Relationships are currency of sales.</li>
                        <li>Value creates loyalty.</li>
                        <li>Discipline bridges goals and accomplishments.</li>
                        <li>Action cures fear.</li>
                        <li>Success is a journey, not destination.</li>
                        <li>Be the change you wish to see.</li>
                        <li>Failure is success in progress.</li>
                        <li>Believe and act as if impossible to fail.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Success Stats <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-3">
                        <li>67% forget lender in 18 months without follow-up.</li>
                        <li>12% LOs follow up after year, but 89% clients would reuse if contacted.</li>
                        <li>No nurture loses 75% referral business.</li>
                        <li>80% sales require 5‚Äì12 follow-ups.</li>
                        <li>48% never follow up; 44% quit after one.</li>
                        <li>Clients 3X likely to switch if neglected.</li>
                        <li>Video converts 80% more; 300% email clicks; 1200% shares.</li>
                        <li>Viewers retain 95% via video vs 10% text.</li>
                        <li>83% say under 1 min video ideal.</li>
                        <li>90%+ marketers say video ROI positive; 87% increases sales; 91% lead gen.</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Motivational Tips <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-3">
                        <li>Small consistent actions compound into results.</li>
                        <li>Turn obstacles into opportunities; hustle beats talent.</li>
                        <li>Stay positive, work hard, make it happen.</li>
                        <li>Excuses don‚Äôt build empires‚Äîgrind now, glow later.</li>
                        <li>Confidence closes deals.</li>
                        <li>Pressure makes diamonds‚Äîthrive in it.</li>
                        <li>Outwork yesterday‚Äôs you.</li>
                        <li>Build relationships, not files.</li>
                        <li>Lead with value, close with ease.</li>
                        <li>Done better than perfect.</li>
                        <li>Be relentless about paying activities.</li>
                        <li>Intentional mornings create unstoppable months.</li>
                        <li>Consistency louder than motivation.</li>
                        <li>Show up on purpose daily.</li>
                        <li>Winners stay consistent unseen.</li>
                        <li>Do boring work consistently for results.</li>
                        <li>Prospect daily or become obsolete.</li>
                        <li>Focus on revenue-generating activities.</li>
                        <li>Time block for success.</li>
                        <li>Leverage technology for efficiency.</li>
                        <li>Consistent marketing builds brand.</li>
                    </ul>
                </div>
            </div>
            
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="p-6 bg-gradient-to-br from-[#00A89D]/20 to-[#F15A29]/20 rounded-2xl shadow-md">
        <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-chart-bar mr-2 text-[#00A89D]"></i>Success Stats</h3>
        <ul class="space-y-3">
            <li>67% forget lender in 18 months without follow-up.</li>
            <li>12% LOs follow up after year, but 89% clients would reuse if contacted.</li>
            <li>No nurture loses 75% referral business.</li>
            <li>80% sales require 5‚Äì12 follow-ups.</li>
            <li>48% never follow up; 44% quit after one.</li>
            <li>Clients 3X likely to switch if neglected.</li>
            <li>Video converts 80% more; 300% email clicks; 1200% shares.</li>
            <li>Viewers retain 95% via video vs 10% text.</li>
            <li>83% say under 1 min video ideal.</li>
            <li>90%+ marketers say video ROI positive; 87% increases sales; 91% lead gen.</li>
        </ul>
    </div>
    <div class="p-6 bg-gradient-to-br from-[#F15A29]/20 to-[#00A89D]/20 rounded-2xl shadow-md">
        <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-lightbulb mr-2 text-[#F15A29]"></i>Motivational Tips</h3>
        <ul class="space-y-3">
            <li>Small consistent actions compound into results.</li>
            <li>Turn obstacles into opportunities; hustle beats talent.</li>
            <li>Stay positive, work hard, make it happen.</li>
            <li>Excuses don‚Äôt build empires‚Äîgrind now, glow later.</li>
            <li>Confidence closes deals.</li>
            <li>Pressure makes diamonds‚Äîthrive in it.</li>
            <li>Outwork yesterday‚Äôs you.</li>
            <li>Build relationships, not files.</li>
            <li>Lead with value, close with ease.</li>
            <li>Done better than perfect.</li>
            <li>Be relentless about paying activities.</li>
            <li>Intentional mornings create unstoppable months.</li>
            <li>Consistency louder than motivation.</li>
            <li>Show up on purpose daily.</li>
            <li>Winners stay consistent unseen.</li>
            <li>Do boring work consistently for results.</li>
            <li>Prospect daily or become obsolete.</li>
            <li>Focus on revenue-generating activities.</li>
            <li>Time block for success.</li>
            <li>Leverage technology for efficiency.</li>
            <li>Consistent marketing builds brand.</li>
        </ul>
    </div>
</div>
        </section>
                
        <section id="planning" class="hidden">
    <div class="max-w-5xl mx-auto px-6 py-12">
        <h2 class="text-4xl md:text-5xl font-bold text-center text-[#F15A29] mb-6">üìà Your Custom 2026 Business Plan</h2>
        <p class="text-xl text-center text-gray-700 dark:text-gray-300 mb-12 max-w-3xl mx-auto">
            Build a powerful, personalized roadmap for 2026. The more details you share, the smarter and more actionable your plan becomes.
        </p>

        <!-- Loading Overlay -->
        <div id="plan-loading" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
            <div class="bg-white dark:bg-gray-800 p-12 rounded-3xl shadow-2xl text-center max-w-lg mx-4">
                <i class="fas fa-spinner fa-spin text-8xl text-[#00A89D] mb-8"></i>
                <p class="text-3xl font-bold text-[#002B5C] dark:text-white">Building Your Custom 2026 Plan...</p>
                <p class="text-xl mt-6 text-gray-600 dark:text-gray-400">This takes 45‚Äì60 seconds ‚Äî worth the wait!</p>
            </div>
        </div>

        <!-- Inputs Card -->
        <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-12 mb-12">
            <!-- Plan Style -->
            <div class="mb-10">
                <label class="block text-xl font-semibold text-[#00A89D] mb-4">Choose Your Primary Focus Style</label>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <label class="bg-gradient-to-br from-[#002B5C] to-[#00A89D] text-white p-6 rounded-2xl cursor-pointer hover:opacity-90 transition-all">
                        <input type="radio" name="plan-style" value="Referral Mastery" checked class="mr-3">
                        <strong>Referral Mastery</strong><br>
                        <span class="text-sm opacity-90">80%+ from realtors & partners</span>
                    </label>
                    <label class="bg-gradient-to-br from-[#00A89D] to-[#F15A29] text-white p-6 rounded-2xl cursor-pointer hover:opacity-90 transition-all">
                        <input type="radio" name="plan-style" value="Database Reactor" class="mr-3">
                        <strong>Database Reactor</strong><br>
                        <span class="text-sm opacity-90">Mine past clients & sphere</span>
                    </label>
                    <label class="bg-gradient-to-br from-[#F15A29] to-[#002B5C] text-white p-6 rounded-2xl cursor-pointer hover:opacity-90 transition-all">
                        <input type="radio" name="plan-style" value="Balanced Growth" class="mr-3">
                        <strong>Balanced Growth</strong><br>
                        <span class="text-sm opacity-90">Multiple sources + social/prospecting</span>
                    </label>
                    </div>
            </div>

            <!-- Goals & Stats -->
            <label class="block text-xl font-semibold text-[#00A89D] mb-6">Your Goals & Current Stats (All Optional)</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                <div class="space-y-6">
                    <div>
                        <label class="block text-lg font-medium mb-2">Target Annual Income ($)</label>
                        <input type="number" id="target-income" placeholder="e.g., 300000" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                    <div>
                        <label class="block text-lg font-medium mb-2">Target Funded Loans</label>
                        <input type="number" id="target-closings" placeholder="e.g., 80" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                    <div>
                        <label class="block text-lg font-medium mb-2">Average Commission per Loan ($)</label>
                        <input type="number" id="avg-commission" placeholder="e.g., 6500" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                    <div>
                        <label class="block text-lg font-medium mb-2">Average Loan Amount ($)</label>
                        <input type="number" id="avg-loan" placeholder="e.g., 400000" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                </div>
                <div class="space-y-6">
                    <div>
                        <label class="block text-lg font-medium mb-2">Closing Ratio from Leads (%)</label>
                        <input type="number" id="closing-ratio" placeholder="e.g., 30" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                    <div>
                        <label class="block text-lg font-medium mb-2">Current Active Referral Partners</label>
                        <input type="number" id="current-partners" placeholder="e.g., 25" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                    <div>
                        <label class="block text-lg font-medium mb-2">New Partners Goal for 2026</label>
                        <input type="number" id="new-partners" placeholder="e.g., 20" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                    <div>
                        <label class="block text-lg font-medium mb-2">Current Database Size (Past Clients + Sphere)</label>
                        <input type="number" id="database-size" placeholder="e.g., 800" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                    </div>
                </div>
            </div>

            <!-- Hobbies & Passions -->
            <div class="mb-10">
                <label class="block text-xl font-semibold text-[#00A89D] mb-4">Favorite Hobbies & Passions (Optional ‚Äî for personalized motivation)</label>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-6">
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-golf" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Golf</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-poker" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Cards/Poker</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-sports" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Sports</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-crafts" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Crafts</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-family" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Family Time</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-outdoors" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Outdoors</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-fitness" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Fitness</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="hobby-cooking" class="hobby-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Cooking</span>
                    </label>
                </div>
                <input type="text" id="hobby-other" placeholder="Other passions (e.g., wine tasting, travel)" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
            </div>

            <!-- Preferred Prospecting Activities -->
            <div class="mb-10">
                <label class="block text-xl font-semibold text-[#00A89D] mb-4">Preferred Prospecting Activities (Optional ‚Äî Grok prioritizes these)</label>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-coffee" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Coffee/Drink Appointments ‚òï</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-lunch" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Lunch Appointments üç¥</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-lunchlearn" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Hosting Lunch & Learns üìä</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-notes" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Personal Notes/Cards ‚úçÔ∏è</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-video" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Social Media Videos üìπ</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-calls" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Phone Calls ‚òéÔ∏è</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-popby" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Pop-By Gifts üéÅ</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-events" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Networking Events ü§ù</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-videomsg" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Video Messages üé•</span>
                    </label>
                    <label class="flex items-center gap-3 text-lg cursor-pointer">
                        <input type="checkbox" id="activity-email" class="activity-checkbox w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                        <span>Value Emails üìß</span>
                    </label>
                </div>
            </div>

            <!-- Additional Notes -->
            <div class="mb-10">
                <label class="block text-xl font-semibold text-[#00A89D] mb-3">Additional Notes & Priorities (Marketing budget, team plans, challenges, etc.)</label>
                <textarea id="plan-notes" rows="6" placeholder="e.g., Want to grow realtor partnerships, hire an assistant, focus on social video, overcome lead flow issues..." class="w-full p-5 rounded-2xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50"></textarea>
            </div>
<!-- Generate Button -->
<div class="text-center mt-12">
    <button id="generate-plan-btn" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 px-16 rounded-full font-bold text-2xl shadow-2xl hover:opacity-90 transition-all">
        <i class="fas fa-magic mr-4"></i> Generate My Custom 2026 Plan
    </button>
</div>
<!-- Output Preview -->
<div id="plan-output" class="hidden mt-12"></div>
           </section>
              
        <section id="prospecting" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Prospecting Tools</h2>
            <p class="mb-4">Make time for prospecting consistently to build your pipeline.</p>
            <h3 class="text-2xl font-semibold mb-4">Time Blocking Generator</h3>
            <form id="time-block-form" class="space-y-4">
                <label class="block text-lg">Frequency: <select id="frequency" class="p-3 rounded-lg border border-[#00A89D] bg-white dark:bg-gray-800 w-full focus:ring-[#F15A29]">
                    <option>Daily</option><option>Weekly</option><option>Monthly</option><option>Quarterly</option><option>Yearly</option>
                </select></label>
                <button type="button" onclick="generateTimeBlock()" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-6 py-3 rounded-full hover:opacity-90 w-full font-semibold">Generate Full List</button>
                <button type="button" onclick="cycleActivities()" class="bg-gradient-to-r from-[#F15A29] to-[#00A89D] text-white px-6 py-3 rounded-full hover:opacity-90 w-full font-semibold">Cycle New Ideas (Random 5-10)</button>
            </form>
            <div id="time-block-output" class="mt-6 p-6 bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 rounded-2xl shadow-inner"></div>
            <div class="mt-6 p-6 bg-gradient-to-br from-[#F15A29]/10 to-[#00A89D]/10 rounded-2xl shadow-md">
                <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-clock mr-2 text-[#F15A29]"></i>Time Blocking Tips & Strategies</h3>
                <ul class="list-disc pl-6 space-y-2">
                    <li>Do prospecting early in the day to ensure it happens.</li>
                    <li>Block smaller windows when you can in the event an emergency comes up and you need to shift it to a new part of your day.</li>
                    <li>Only 2 things more important than prospecting: Deals literally coming in the door at that moment, and loans in jeopardy of walking out the door at that moment.</li>
                    <li>Protect your blocks like appointments.</li>
                    <li>Use color-coding for prospecting blocks.</li>
                    <li>Review blocks weekly to adjust.</li>
                    <li>Time Blocking Calendar Spreadsheet <a href="https://2759433.fs1.hubspotusercontent-na1.net/hubfs/2759433/Adam%20Images%20to%20Host/Time%20Blocking%20Calendar%20with%20Clear%20All%20and%20ICS%20Export.xlsm" target="_blank" class="text-[#00A89D] hover:text-[#F15A29] underline">Click Here to Download</a></p></li>
                </ul>
            </div>
        </section>
        <!-- MAIN SOCIAL MEDIA TIPS PAGE -->
<!-- MAIN SOCIAL MEDIA TIPS PAGE -->
<section id="social" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-8 text-[#F15A29]">Social Media Strategy for Loan Officers</h2>
    <p class="text-lg mb-12 leading-relaxed">Build genuine relationships, grow your reach organically, and turn followers into referral partners ‚Äî without ever being salesy. Build strong personal connections by sharing your passions, hobbies, family, pets, vacations, and interests in life.</p>

    <!-- Content Pillars ‚Äì Visual Boxes (UNCHANGED) -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">
        <div onclick="openModal('Personal')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Personal</h3>
            <p class="text-gray-700 dark:text-gray-300">Behind-the-scenes, hobbies, family (with permission)</p>
        </div>
        <div onclick="openModal('Local')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Local</h3>
            <p class="text-gray-700 dark:text-gray-300">Community events, spotlights, neighborhood insights</p>
        </div>
        <div onclick="openModal('Educational')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Educational</h3>
            <p class="text-gray-700 dark:text-gray-300">Mortgage tips, rate myths, homebuying process</p>
        </div>
        <div onclick="openModal('Client Wins')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Client Wins</h3>
            <p class="text-gray-700 dark:text-gray-300">Just closed stories, testimonials</p>
        </div>
        <div onclick="openModal('Value')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Value</h3>
            <p class="text-gray-700 dark:text-gray-300">Checklists, guides, free resources</p>
        </div>
        <div onclick="openModal('Engagement')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
            <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Engagement</h3>
            <p class="text-gray-700 dark:text-gray-300">Polls, questions, "tag a friend"</p>
        </div>
    </div>

    <!-- Big CTA Button to AI Creator (UNCHANGED) -->
    <div class="text-center my-16">
        <div class="inline-block bg-gradient-to-br from-[#002B5C]/5 to-[#00A89D]/10 rounded-3xl p-12 border-4 border-dashed border-[#00A89D]/50 shadow-xl">
            <button onclick="showSocialPostCreator()" 
                    class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-14 py-8 rounded-3xl hover:scale-105 transition-all font-bold text-3xl shadow-2xl inline-flex items-center">
                <i class="fas fa-bolt mr-5 text-4xl"></i> Instantly Generate a Post with AI
            </button>
            <p class="mt-8 text-xl text-gray-700 dark:text-gray-300 font-medium max-w-2xl">
                Ready-to-post, authentic, relationship-focused content ‚Äî tailored in seconds
            </p>
        </div>
    </div>

    <!-- 1. Proven Content Pillars -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">1. Your 5 Proven Content Pillars (80/20 Rule) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Top LOs post 80% personal or value, 20% business. Follow this mix for trust + leads without being salesy.</p>
            <div class="grid grid-cols-1 md:grid-cols-5 gap-6">
                <div class="text-center p-6 bg-[#002B5C]/10 dark:bg-[#002B5C]/30 rounded-2xl">
                    <div class="text-4xl mb-4">40%</div>
                    <strong>{Personal}</strong><br>Market updates, tips, myth-busts
                </div>
                <div class="text-center p-6 bg-[#00A89D]/10 dark:bg-[#00A89D]/30 rounded-2xl">
                    <div class="text-4xl mb-4">20%</div>
                    <strong>Value</strong><br>Testimonials, closing stories
                </div>
                <div class="text-center p-6 bg-[#F15A29]/10 dark:bg-[#F15A29]/30 rounded-2xl">
                    <div class="text-4xl mb-4">15%</div>
                    <strong>Engagement</strong><br>Behind-the-scenes, family, hobbies
                </div>
                <div class="text-center p-6 bg-[#002B5C]/10 dark:bg-[#002B5C]/30 rounded-2xl">
                    <div class="text-4xl mb-4">15%</div>
                    <strong>Local</strong><br>Community events, spotlights
                </div>
                <div class="text-center p-6 bg-[#00A89D]/10 dark:bg-[#00A89D]/30 rounded-2xl">
                    <div class="text-4xl mb-4">10%</div>
                    <strong>Educational</strong><br>Polls, questions, this-or-that
                </div>
            </div>
            <p class="mt-6 font-semibold">Post 4‚Äì5 times/week using this mix ‚Üí consistent leads without burnout.</p>
        </div>
    </div>

    <!-- 2. Weekly Posting Calendar -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">2. Done-For-You Weekly Posting Schedule <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Batch create on Sunday ‚Üí schedule all week. Takes 45 minutes, delivers results.</p>
            <table class="w-full text-left border-collapse mb-6">
                <thead>
                    <tr class="bg-[#002B5C] text-white">
                        <th class="p-4">Day</th>
                        <th class="p-4">Pillar</th>
                        <th class="p-4">Content Idea</th>
                        <th class="p-4">Best Time</th>
                    </tr>
                </thead>
                <tbody class="bg-gray-50 dark:bg-gray-900">
                    <tr>
                        <td class="p-4 border-t">Monday</td>
                        <td class="p-4 border-t">Educational</td>
                        <td class="p-4 border-t">Market Update Monday (rates, inventory)</td>
                        <td class="p-4 border-t">8‚Äì9 AM</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Tuesday</td>
                        <td class="p-4 border-t">Value Tip</td>
                        <td class="p-4 border-t">Quick mortgage tip or myth-bust</td>
                        <td class="p-4 border-t">10 AM</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Wednesday</td>
                        <td class="p-4 border-t">Engagement</td>
                        <td class="p-4 border-t">Poll or question (‚ÄúRent or own in 2026?‚Äù)</td>
                        <td class="p-4 border-t">7 PM</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Thursday</td>
                        <td class="p-4 border-t">Client Win</td>
                        <td class="p-4 border-t">Testimonial or closing story</td>
                        <td class="p-4 border-t">11 AM</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Friday</td>
                        <td class="p-4 border-t">Personal/Local</td>
                        <td class="p-4 border-t">Weekend plans or local spotlight</td>
                        <td class="p-4 border-t">3 PM</td>
                    </tr>
                </tbody>
            </table>
            <p class="font-semibold">Bonus: Add 1 Reel/week (use templates below) ‚Üí massive reach boost.</p>
        </div>
    </div>

    <!-- 3. High-Engagement Reel Ideas -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">3. 12 Proven Reel/Video Scripts (15‚Äì60 sec) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Film one per week ‚Äî these consistently get 5‚Äì20x views vs static posts.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>1. Rate Myth Bust</strong><br>‚ÄúEveryone thinks you need 20% down ‚Äî reality? Many programs are 3‚Äì5% or even 0%. Stop waiting!‚Äù (Show text overlays)
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>2. Closing Day Chaos vs Reality</strong><br>Fast cuts of stress ‚Üí calm signing ‚Üí happy family. ‚ÄúI handle the chaos so you don‚Äôt have to.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>3. ‚ÄúMarry the House, Date the Rate‚Äù</strong><br>Wedding analogy skit ‚Äî ‚ÄúYou can refinance the rate later for free.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>4. Local Market Snapshot</strong><br>Point at screen with stats: ‚ÄúInventory up 12% ‚Äî best buyer window in years.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>5. Day in the Life</strong><br>Time-lapse: coffee ‚Üí calls ‚Üí approvals ‚Üí celebration. ‚ÄúLove helping families win.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>6. Credit Boost Quick Tip</strong><br>‚ÄúRaise score 50 points: Pay cards to under 30%, dispute errors, authorized user.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>7. Buydown Explained</strong><br>‚ÄúTemporary rate reduction ‚Äî lower payment first 2 years while building equity.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>8. Client Testimonial Skit</strong><br>Act out before/after: ‚ÄúStressed renter ‚Üí happy homeowner in 45 days.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>9. DPA Spotlight</strong><br>‚ÄúUp to $10k forgiven in MI ‚Äî who qualifies? Comment below!‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>10. Behind the Scenes</strong><br>Show your desk, team, ‚ÄúReal day helping families buy homes.‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>11. Quick Poll Reel</strong><br>Use trending audio + text: ‚ÄúRent forever or own your home? Vote!‚Äù
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl">
                    <strong>12. Holiday Tie-In</strong><br>‚ÄúCozy home for the holidays? Let‚Äôs make it happen in 2026.‚Äù
                </div>
            </div>
        </div>
    </div>

    <!-- 4. Hashtag Strategy -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">4. Hashtag Strategy That Actually Works <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Use 8‚Äì12 hashtags per post. Mix high-reach + local/niche.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <strong>High-Reach (rotate 3‚Äì4)</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>#Mortgage</li>
                        <li>#HomeBuying</li>
                        <li>#RealEstate</li>
                        <li>#FirstTimeHomeBuyer</li>
                        <li>#MortgageTips</li>
                        <li>#HomeLoans</li>
                    </ul>
                </div>
                <div>
                    <strong>Ruoff Market Specific</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>#IndianaRealEstate #IndianapolisHomes</li>
                        <li>#OhioRealEstate #ColumbusHomes</li>
                        <li>#MichiganRealEstate #GrandRapidsHomes</li>
                        <li>#KentuckyRealEstate #LouisvilleHomes</li>
                        <li>#DownPaymentAssistance</li>
                        <li>#RefinanceNow</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 5. Engagement Blueprint -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">5. Engagement Blueprint (Turn Likes into Leads) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Every interaction is an opportunity. Respond fast and personally.</p>
            <ul class="space-y-6 text-lg">
                <li><strong>Comment Formula:</strong> Thank + Relate + Soft CTA<br>‚ÄúLove that! We just helped a family in [area] save $300/mo ‚Äî want to see if it works for you?‚Äù</li>
                <li><strong>DM Script:</strong> ‚ÄúThanks for the comment on rates! Happy to send a quick personalized quote ‚Äî no pressure. When works?‚Äù</li>
                <li><strong>Story Replies:</strong> Reply to every partner/realtor story view with value (market stat, article, ‚ÄúGreat listing!‚Äù)</li>
                <li><strong>Weekly Goal:</strong> 50 meaningful engagements ‚Üí consistent warm leads</li>
            </ul>
        </div>
    </div>

    <!-- 6. Content Batch System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">6. 45-Minute Weekly Batch System <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Create a full week‚Äôs content in one sitting ‚Äî no daily stress.</p>
            <ol class="list-decimal pl-6 space-y-4">
                <li>Sunday evening: Open Canva + phone</li>
                <li>Film 1 Reel (pick from scripts above)</li>
                <li>Create 4 static posts using Instant Generator</li>
                <li>Add hashtags + captions</li>
                <li>Schedule in Meta Business Suite</li>
                <li>Set daily reminder: 10 min replying to comments</li>
            </ol>
            <p class="mt-6 font-semibold">Tools: Canva (graphics), CapCut (Reels), Meta Business Suite (scheduling)</p>
        </div>
    </div>

    <!-- 7. Idea Bank: Holiday Polls, Questions & Topics -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">7. Massive Idea Bank: Holidays, Polls, Topics & More <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Your full evergreen idea vault ‚Äî never run out of content.</p>

            <h4 class="text-xl font-bold mb-4">Holiday "This or That" Polls</h4>
            <ul class="columns-1 md:columns-2 gap-8 space-y-2 mb-8 text-lg">
                <li>Real Tree vs. Artificial Tree</li>
                <li>White Lights vs. Multi-Colored Lights</li>
                <li>Tinsel vs. Garland</li>
                <li>Classic Christmas Songs vs. Modern Holiday Hits</li>
                <li>Red Ornaments vs. Gold Ornaments</li>
                <li>Hot Chocolate with Marshmallows vs. Whipped Cream</li>
                <li>Ugly Sweater Party vs. Formal Christmas Dinner</li>
                <li>Open Presents Christmas Eve vs. Christmas Morning</li>
                <li>Christmas Shopping: Black Friday vs. Cyber Monday</li>
                <li>Rudolph vs. Frosty the Snowman</li>
                <li>Elf on the Shelf vs. Christmas Elf</li>
                <li>Baking Cookies vs. Decorating Gingerbread Houses</li>
                <li>Mistletoe vs. Holly</li>
                <li>White Christmas vs. Warm Christmas</li>
                <li>Christmas Market vs. Indoor Shopping</li>
                <li>Christmas in the Mountains vs. Christmas at the Beach</li>
                <li>Snowy Cabin Retreat vs. City Christmas Adventure</li>
                <li>Sleigh Ride vs. Horse Carriage Ride</li>
                <li>Silent Night Indoors vs. Festive Caroling Outside</li>
                <li>Decorating the Outside vs. Inside of Your Home, or BOTH</li>
                <li>Pumpkin Pie vs. Apple Pie</li>
                <li>Eggnog vs. Apple Cider vs. Hot Chocolate</li>
                <li>Roast Turkey vs. Honey-Glazed Ham</li>
                <li>Mashed Potatoes vs. Sweet Potato Casserole</li>
                <li>Sugar Cookies vs. Shortbread</li>
                <li>Hot Toddy vs. Spiked Eggnog</li>
                <li>Peppermint Bark vs. Fudge</li>
                <li>Traditional Fruitcake vs. Yule Log Cake</li>
                <li>Candy Canes vs. Chocolate Truffles</li>
                <li>Gingerbread Cookies vs. Snickerdoodles</li>
                <li>Christmas Movies: Animated vs. Live Action</li>
                <li>Secret Santa vs. White Elephant Gift Exchange</li>
                <li>Caroling vs. Watching Christmas Movies</li>
                <li>Festive Pajamas vs. Regular PJs</li>
                <li>Holiday Movie Marathon vs. Game Night</li>
                <li>Family Gathering at Home vs. Vacation Getaway</li>
                <li>Attending Christmas Markets vs. Shopping Online</li>
                <li>Stocking Stuffers vs. Big Presents</li>
                <li>Driving to See Lights vs. Lighting the Tree at Home</li>
                <li>Making Holiday Crafts vs. Watching Christmas Specials</li>
                <li>Morning Pajamas vs. Matching Sweaters</li>
                <li>Ice Skating vs. Sledding</li>
                <li>Snowman Building vs. Snowball Fight</li>
                <li>Snow Angel vs. Sitting by the Fireplace</li>
                <li>Skiing Vacation vs. Cozy Cabin Stay</li>
                <li>Gift Cards vs. Handmade Gifts</li>
                <li>Traditional Holiday Music vs. Modern Christmas Hits</li>
                <li>Making New Year‚Äôs Resolutions: Yes or No</li>
            </ul>

            <h4 class="text-xl font-bold mb-4">Open-Ended Engagement Questions</h4>
            <ul class="columns-1 md:columns-2 gap-8 space-y-2 mb-8 text-lg">
                <!-- All 50+ questions from your original list here ‚Äî fully preserved -->
                <li>Best gift you've ever received?</li>
                <li>One wish granted this holiday?</li>
                <li>Most memorable Christmas?</li>
                <li>Favorite movie to watch yearly?</li>
                <li>Favorite holiday song?</li>
                <li>Funny/embarrassing holiday stories?</li>
                <li>Worst gift received?</li>
                <li>Dream holiday location?</li>
                <li>Favorite holiday food?</li>
                <li>Favorite New Year's Eve drink?</li>
                <li>Proudest resolution achieved?</li>
                <li>Three dinner guests (living/dead)?</li>
                <li>Unique family tradition?</li>
                <li>Favorite snowy day activity?</li>
                <li>How celebrate New Year?</li>
                <li>Most creative gift given?</li>
                <li>Funny holiday movie scene?</li>
                <li>Prefer giving or receiving gifts?</li>
                <li>Strategy for family gatherings?</li>
                <li>Best holiday party attended?</li>
                <li>New tradition to start?</li>
                <li>Choose your Christmas name?</li>
                <li>Ideal Christmas Day?</li>
                <li>First gift bought with own money?</li>
                <li>Favorite carol and why?</li>
                <li>Surprising place for decoration?</li>
                <li>One irresistible cookie?</li>
                <li>Favorite childhood memory?</li>
                <li>One holiday meal forever?</li>
                <li>Funniest thing at holiday event?</li>
                <li>Holiday activity as Olympic sport?</li>
                <li>Best holiday play/performance?</li>
                <li>Secret Santa story?</li>
                <li>Wish for someone else?</li>
                <li>Holiday miracle?</li>
                <li>Holiday gadget wish?</li>
                <li>Quirky traditions?</li>
                <li>Favorite way to ring in New Year?</li>
                <li>Resolutions worth it?</li>
                <li>Most thoughtful non-physical gift?</li>
                <li>Favorite quote/saying?</li>
                <li>Go-to comfort food?</li>
                <li>Favorite part of season?</li>
                <li>If Santa real?</li>
                <li>Holiday book recommendation?</li>
                <li>Holiday dish from around world?</li>
                <li>Memorable holiday away from home?</li>
                <li>Keep spirit alive in tough times?</li>
                <li>One thing never gets old?</li>
            </ul>

            <h4 class="text-xl font-bold mb-4">Educational & Value Topics</h4>
            <ul class="columns-1 md:columns-2 gap-8 space-y-2 mb-8 text-lg">
                <!-- All your original educational topics fully preserved -->
                <li>What Not to Do Before Buy Home</li>
                <li>How Prepare Home Ownership</li>
                <li>Mortgage Basics Beginners</li>
                <li>3 Myths Getting Mortgage</li>
                <li>Benefits Home Ownership</li>
                <li>5 Steps Secure Dream Home</li>
                <li>What Know Apply Mortgage</li>
                <li>3 Tips Simplify Buying Process</li>
                <li>First-Time Buyer Know</li>
                <li>FICO Credit Score Mean</li>
                <li>Qualify Low Credit Score</li>
                <li>Own Best Long-Term Wealth</li>
                <li>Mortgage Investment Not Debt</li>
                <li>Pre-Approved When</li>
                <li>5 Questions Ask Lender</li>
                <li>Choose Best Mortgage</li>
                <li>10 First-Time Buyer Mistakes Avoid</li>
                <li>Where How Get Mortgage</li>
                <li>Type Loan Right You</li>
                <li>Financing Basics Homebuyers</li>
                <li>Mortgage Mistakes Selling Home</li>
                <li>Buy Sell Same Time</li>
                <li>Own Did Mortgage</li>
                <li>Escrow Know</li>
                <li>Bank vs Broker Mortgage</li>
                <li>Mistakes Apply Mortgage</li>
                <li>Improve Credit Pay Down Cards</li>
                <li>Credit Tips Not Do</li>
                <li>Dos Don'ts Loan Process</li>
                <li>Rent vs Own</li>
                <li>VA Financing Benefits</li>
                <li>DTI Calculate</li>
                <li>LTV Important</li>
                <li>Conforming Jumbo Diff</li>
                <li>Payment History Effects Credit</li>
                <li>Market Updates Trends</li>
                <li>First-Time Homebuyer Tips Credit Down Payment</li>
                <li>Loan Program Spotlights Types Benefits</li>
                <li>Home Equity Basics Benefits Cash-Out</li>
                <li>Own First Investment Property Research Financing ROI</li>
                <li>Pre-Approval vs Pre-Qualification</li>
                <li>Behind-Scenes Closings</li>
                <li>Did You Know Rate History Closing Costs</li>
                <li>Myth-Buster 30 Sec e.g. 20% Down Not True</li>
                <li>Market Pulse Weekly Local Rates</li>
                <li>Client Wins e.g. Teacher 3% Down</li>
                <li>FAQ Common Questions</li>
                <li>Mortgage Process Infographics</li>
                <li>Homeownership Milestones Anniversaries</li>
                <li>Myth Fact e.g. 20% Down</li>
                <li>Industry Data MBA Sources</li>
                <li>Home Maintenance Seasonal</li>
                <li>Mortgage Humor Professional</li>
                <li>Holiday Recognition Fun</li>
                <li>Polls Quizzes e.g. Rent Buy</li>
                <li>Terms Defined Graphics</li>
                <li>Local Housing Snapshots Trends</li>
                <li>5 Mistakes Buyers</li>
                <li>5 Reasons Love Neighborhood</li>
                <li>Buy Now?</li>
                <li>Favorite Transaction Story</li>
                <li>Funniest Strategy</li>
                <li>Worst Transaction</li>
                <li>Reasons Love Referrals</li>
                <li>5 FAQs</li>
            </ul>

            <h4 class="text-xl font-bold mb-4">Recipes, Drinks, Fun Facts, Local & Repeatable Topics</h4>
            <p class="mb-4">All your original creative banks ‚Äî perfect for personal + value posts.</p>
            <!-- Recipes, Drinks, Fun Facts, Local Spotlights, Repeatable Topics fully preserved in columns for readability -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <strong>Recipes & Drinks</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Holiday Treats Home Tie-In: "Bake these cookies for open houses!"</li>
                        <li>Easy Appetizers Client Events</li>
                        <li>Seasonal Smoothies Home Wellness</li>
                        <li>Mortgage-Themed Cocktails Fun Posts</li>
                        <li>Quick Dinners Busy LOs</li>
                        <li>Budget-Friendly Meals Homebuyers</li>
                        <li>Festive Desserts Client Gifts</li>
                        <li>Healthy Snacks Prospecting Energy</li>
                        <li>Co-branded Recipe Cards Partners</li>
                        <li>Seasonal Soups Cozy Homes</li>
                        <li>Festive Cocktails Client Parties</li>
                        <li>Non-Alcoholic Punches Events</li>
                        <li>Coffee Recipes Morning Motivation</li>
                        <li>Smoothie Ideas Health Homeownership</li>
                        <li>Seasonal Hot Drinks Cozy Homes</li>
                        <li>Mocktails First-Time Buyers</li>
                        <li>Energy Drinks Prospecting Boost</li>
                        <li>Wine Pairings Home Closings</li>
                        <li>Healthy Juices Wellness Tips</li>
                        <li>Themed Drinks Holiday Posts</li>
                    </ul>
                </div>
                <div>
                    <strong>Fun Facts, Local & Repeatable</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Mortgage Trivia: "Average loan term 30 years?"</li>
                        <li>Real Estate Oddities: "World's smallest house?"</li>
                        <li>Finance Fun: "Origin 'mortgage' word?"</li>
                        <li>Home History: "Famous homes facts"</li>
                        <li>LO Life: "Average LO closes X loans/year"</li>
                        <li>Rate Facts: "Lowest historical rate?"</li>
                        <li>Credit Myths: "Checking score hurts it?"</li>
                        <li>Home Value Trivia: "Factors affecting appraisal?"</li>
                        <li>Industry Milestones: "First mortgage date?"</li>
                        <li>Buyer Stats: "Average age first-time buyer?"</li>
                        <li>Restaurant Feature: "Best spot for client lunches"</li>
                        <li>Business Partnership: "Team up with local coffee shop"</li>
                        <li>Community Event: "Upcoming festival ‚Äì great networking"</li>
                        <li>Neighborhood Highlight: "Why this area hot for buyers"</li>
                        <li>Local Pro Shoutout: "Featured realtor/builder"</li>
                        <li>Fun Fact Friday</li>
                        <li>Tip Tuesday</li>
                        <li>Motivation Monday</li>
                        <li>Throwback Thursday</li>
                        <li>Weekend Wins</li>
                        <li>Question Wednesday</li>
                        <li>Spotlight Saturday</li>
                        <li>Self-Care Sunday</li>
                        <li>Market Monday</li>
                        <li>Testimonial Tuesday</li>
                        <li>Wisdom Wednesday</li>
                        <li>Fun Friday</li>
                        <li>Success Saturday</li>
                        <li>Sunday Setup</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#F15A29] text-white p-10 rounded-3xl text-center mt-12">
        <p class="text-2xl font-bold mb-4">Consistency + Authentic Value = Massive Trust & Referrals</p>
        <p class="text-xl">Follow this system for 90 days. You'll never run out of ideas again.</p>
    </div>
</section>
        <section id="referrals" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Referral Partners ‚Äì Your Primary Growth Engine</h2>
    <p class="mb-8 text-lg">For most top-producing loan officers, 70‚Äì90% of business comes from referral partners (realtors, builders, financial planners, attorneys, insurance agents). This section is your complete playbook for finding, winning, nurturing, and scaling lifelong partnerships that send consistent, high-quality referrals ‚Äî without ever being transactional.</p>

    <!-- Core Mindset -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">1. The Referral Partner Mindset <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Be a True Partner, Not a Vendor:</strong> Your goal is to make their business easier and more successful ‚Äî referrals are the byproduct.</li>
                <li><strong>Value First, Always:</strong> Every interaction should give more than it takes.</li>
                <li><strong>Consistency Wins:</strong> One great touch per week beats 12 touches in January.</li>
                <li><strong>Become Indispensable:</strong> Fast pre-approvals, smooth closings, co-marketing, education ‚Äî make them think, ‚ÄúI can‚Äôt succeed without this LO.‚Äù</li>
                <li><strong>Track & Celebrate:</strong> Measure referrals, thank publicly, reward generously (compliantly).</li>
            </ul>
            <p class="mt-6 font-semibold text-center text-xl text-[#00A89D]">Great partners don‚Äôt send referrals ‚Äî they send their best clients because they trust you with their reputation.</p>
        </div>
    </div>

    <!-- Finding New Partners -->
    <div class="accordion mb-8">
    <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">2. Partner Types ‚Äì Click for Detailed Strategies & Examples <i class="fas fa-chevron-down"></i></button>
    <div class="accordion-content">
        <p class="mb-6">Every partner type has unique needs and opportunities. Click each for specific outreach ideas, value offers, scripts, event examples, and nurturing strategies.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div onclick="openReferralModal('Realtors')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Realtors</h3>
                <p class="text-gray-700 dark:text-gray-300">Your primary source ‚Äî agents with active buyers & listings</p>
            </div>
            <div onclick="openReferralModal('Builders')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Builders</h3>
                <p class="text-gray-700 dark:text-gray-300">New construction & preferred lender status</p>
            </div>
            <div onclick="openReferralModal('Financial Planners')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Financial Planners / CPAs</h3>
                <p class="text-gray-700 dark:text-gray-300">High-net-worth, refi, and investment property referrals</p>
            </div>
            <div onclick="openReferralModal('Attorneys')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Attorneys</h3>
                <p class="text-gray-700 dark:text-gray-300">Divorce, probate, estate planning clients</p>
            </div>
            <div onclick="openReferralModal('Insurance Agents')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Insurance Agents</h3>
                <p class="text-gray-700 dark:text-gray-300">Home + auto bundle opportunities</p>
            </div>
            <div onclick="openReferralModal('Other')" class="cursor-pointer bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 p-8 rounded-2xl border border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
                <h3 class="text-2xl font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Other Professionals</h3>
                <p class="text-gray-700 dark:text-gray-300">HR directors, relocation companies, title agents, etc.</p>
            </div>
        </div>

            <h4 class="text-lg font-bold mb-4">Proven Prospecting Strategies</h4>
            <ul class="space-y-4 text-lg">
                <li><strong>Open House Approach:</strong> ‚ÄúI‚Äôm [Name] with Ruoff ‚Äî happy to run quick pre-approvals on-site to strengthen offers.‚Äù (Bring branded signage + treats)</li>
                <li><strong>Value-First Intro Script:</strong> ‚ÄúI specialize in making offers stand out with fast approvals and creative financing ‚Äî would love to grab coffee and explore how I can support your listings.‚Äù</li>
                <li><strong>Social Media Warm Outreach:</strong> Comment genuinely on their posts ‚Üí DM value (market update, co-branded tool)</li>
                <li><strong>Host Educational Events:</strong> ‚ÄúLunch & Learn: Buydowns in Today‚Äôs Market‚Äù ‚Äî invite targeted agents</li>
                <li><strong>Referral from Existing Partners:</strong> ‚ÄúWho‚Äôs one agent you respect that I should meet?‚Äù</li>
            </ul>
        </div>
    </div>

    <!-- Partner Tiers & Nurturing -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">3. Tiered Partner System (Scale Your Effort) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Segment partners so top producers get white-glove treatment.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-[#002B5C]/5 dark:bg-[#002B5C]/20 p-6 rounded-2xl">
                    <strong>A+ Partners (Top 10‚Äì20)</strong><br>5+ referrals/year
                    <ul class="list-disc pl-6 mt-4 space-y-2">
                        <li>Weekly personal touch</li>
                        <li>Monthly lunch/coffee</li>
                        <li>Co-branded marketing</li>
                        <li>Exclusive event invites</li>
                        <li>Premium gifts</li>
                    </ul>
                </div>
                <div class="bg-[#00A89D]/5 dark:bg-[#00A89D]/20 p-6 rounded-2xl">
                    <strong>B Partners (Growing)</strong><br>1‚Äì4 referrals/year
                    <ul class="list-disc pl-6 mt-4 space-y-2">
                        <li>Bi-weekly value touch</li>
                        <li>Quarterly personal check-in</li>
                        <li>Co-marketing offers</li>
                        <li>Event invites</li>
                    </ul>
                </div>
                <div class="bg-[#F15A29]/5 dark:bg-[#F15A29]/20 p-6 rounded-2xl">
                    <strong>C Partners (New/Prospects)</strong><br>Potential
                    <ul class="list-disc pl-6 mt-4 space-y-2">
                        <li>Weekly automated value</li>
                        <li>Monthly personal outreach</li>
                        <li>Educational event invites</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Weekly Partner Touch System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">4. Weekly Partner Touch System <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Consistent, value-first touches = top-of-mind status.</p>
            <table class="w-full text-left border-collapse mb-6">
                <thead>
                    <tr class="bg-[#002B5C] text-white">
                        <th class="p-4">Touch Type</th>
                        <th class="p-4">Frequency</th>
                        <th class="p-4">Example</th>
                    </tr>
                </thead>
                <tbody class="bg-gray-50 dark:bg-gray-900">
                    <tr>
                        <td class="p-4 border-t">Market Update</td>
                        <td class="p-4 border-t">Weekly</td>
                        <td class="p-4 border-t">Short video/email: rates, inventory, buydown spotlight</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Personal Check-In</td>
                        <td class="p-4 border-t">A+: Weekly, B: Bi-weekly</td>
                        <td class="p-4 border-t">Text/call: ‚ÄúHow‚Äôs business? Anything I can support?‚Äù</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Value Drop</td>
                        <td class="p-4 border-t">Weekly</td>
                        <td class="p-4 border-t">Co-branded flyer, buyer guide, social graphic</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Pop-By</td>
                        <td class="p-4 border-t">A+: Monthly, B: Quarterly</td>
                        <td class="p-4 border-t">Treats + open house tools</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">Event Invite</td>
                        <td class="p-4 border-t">Monthly</td>
                        <td class="p-4 border-t">Lunch & learn, happy hour, seminar</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Co-Marketing & Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">5. Co-Marketing & Joint Events <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">Proven Co-Marketing Ideas</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li>Co-branded buyer guides & checklists</li>
                <li>Open house pre-approval station (branded signage)</li>
                <li>Joint social media posts/Reels</li>
                <li>Co-hosted client appreciation events</li>
                <li>Shared email campaigns to their database</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Event Ideas That Generate Referrals</h4>
            <ul class="space-y-4 text-lg">
                <li><strong>Lunch & Learns:</strong> ‚ÄúCreative Financing in Today‚Äôs Market‚Äù (cater lunch)</li>
                <li><strong>Happy Hours:</strong> Casual networking for their sphere</li>
                <li><strong>Buyer Seminars:</strong> ‚ÄúHome Buying 101‚Äù co-hosted at local venue</li>
                <li><strong>Shredding/Pumpkin Events:</strong> Community service + branding</li>
                <li><strong>Charity Partnerships:</strong> Joint fundraising (builds goodwill)</li>
            </ul>
        </div>
    </div>

    <!-- Partner Communication During Transactions -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">6. Transaction Communication (Build Trust) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-4 text-lg">
                <li><strong>Day 1:</strong> Intro call/email to agent: timeline, your role</li>
                <li><strong>Weekly Updates:</strong> Thursday status text/email</li>
                <li><strong>Milestones:</strong> Immediate notification (approval, appraisal, CTC)</li>
                <li><strong>Issues:</strong> Call agent first ‚Äî never surprise</li>
                <li><strong>Post-Closing:</strong> Thank-you note + highlight for their marketing</li>
            </ul>
        </div>
    </div>

    <!-- Tracking & Accountability -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">7. Track Progress & Celebrate Wins <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">Key Metrics</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li>Number of active partners</li>
                <li>Referrals per partner per year</li>
                <li>Conversion rate from referral to close</li>
                <li>Partner satisfaction (quarterly survey)</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Celebration Ideas (Compliant)</h4>
            <ul class="space-y-4 text-lg">
                <li>Public social shoutouts</li>
                <li>Referral milestone gifts (branded items)</li>
                <li>Annual partner appreciation event</li>
                <li>Handwritten thank-you notes</li>
            </ul>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center mt-12">
        <p class="text-2xl font-bold mb-4">Referral partners aren‚Äôt sources ‚Äî they‚Äôre true business partners.</p>
        <p class="text-xl">Invest in them like your business depends on it... because it does.</p>
    </div>
</section>
        <section id="database" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Database Nurturing ‚Äì Your Most Valuable Asset</h2>
    <p class="mb-8 text-lg">Your database is not a list ‚Äî it's a living network of real people who already know, like, and trust you. Nurture it intentionally and it will become your #1 source of repeat business, referrals, and lifelong income. This section is your complete playbook for building and maintaining genuine, profitable relationships at scale.</p>

    <!-- Core Philosophy -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">The Mindset: Beyond "Know, Like, Trust" <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Top producers don‚Äôt just ‚Äústay top of mind‚Äù ‚Äî they become part of their clients‚Äô lives.</p>
            <ul class="space-y-6 text-lg">
                <li><strong>Genuine Care First:</strong> Every touch should feel like it comes from a friend, not a salesperson. Ask about their kids, pets, new kitchen ‚Äî remember details.</li>
                <li><strong>Give 10x More Than You Ask:</strong> Provide value freely. The referrals come naturally when people feel you genuinely want them to win.</li>
                <li><strong>Consistency Compounds:</strong> One thoughtful touch per month for 10 years beats 12 touches in one year.</li>
                <li><strong>They‚Äôre People, Not Leads:</strong> Celebrate their wins, acknowledge life events, show up when it matters ‚Äî not just when you need business.</li>
                <li><strong>Your Database = Your Net Worth:</strong> A nurtured past client is worth 5‚Äì10x more over their lifetime than a new lead.</li>
            </ul>
            <p class="mt-6 font-semibold text-xl text-center text-[#00A89D]">The goal: Make every person in your database say, ‚ÄúI‚Äôd never use anyone else ‚Äî and I tell everyone about them.‚Äù</p>
        </div>
    </div>

    <!-- Database Growth & Organization -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Build & Organize Your Database Like a Pro <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Start small, grow intentionally. Aim for quality over quantity.</p>

            <h4 class="text-lg font-bold mb-4">Core Categories (Tag Everyone ‚Äì Click for Nurturing Strategies)</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <div onclick="openDatabaseModal('Past Clients')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Past Clients</h5>
        <p class="text-gray-600 dark:text-gray-400">Your gold mine (highest referral rate)</p>
    </div>
    <div onclick="openDatabaseModal('Sphere of Influence')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Sphere of Influence</h5>
        <p class="text-gray-600 dark:text-gray-400">Friends, family, social circle</p>
    </div>
    <div onclick="openDatabaseModal('Referral Partners')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Referral Partners</h5>
        <p class="text-gray-600 dark:text-gray-400">Realtors, builders, financial planners</p>
    </div>
    <div onclick="openDatabaseModal('Community Connections')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Community Connections</h5>
        <p class="text-gray-600 dark:text-gray-400">Local business owners, neighbors, groups</p>
    </div>
    <div onclick="openDatabaseModal('Prospects')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">Prospects</h5>
        <p class="text-gray-600 dark:text-gray-400">Leads who didn‚Äôt close (yet)</p>
    </div>
    <div onclick="openDatabaseModal('A+ VIPs')" class="cursor-pointer bg-gray-50 dark:bg-gray-900 p-8 rounded-2xl border-2 border-[#00A89D]/30 text-center shadow-md hover:shadow-xl hover:scale-105 transition-all">
        <h5 class="text-xl font-bold mb-2">A+ VIPs</h5>
        <p class="text-gray-600 dark:text-gray-400">Top 50 most connected/influential people</p>
    </div>
</div>

            <h4 class="text-lg font-bold mb-4">Growth Targets</h4>
            <ul class="space-y-4 text-lg">
                <li>Year 1: 300‚Äì500 contacts</li>
                <li>Year 3: 1,000+</li>
                <li>Year 5: 2,000+ (where the magic happens)</li>
                <li>Add 10‚Äì20 new people every month (events, referrals, social)</li>
            </ul>

            <p class="mt-6 font-semibold">Tool Tip: Use tags + custom fields in your CRM (birthdays, home anniversary, kids‚Äô names, hobbies) ‚Äî personalization at scale.</p>
        </div>
    </div>

    <!-- The 33-Touch System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">The Legendary 33-Touch Annual System <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">The proven formula: 33 meaningful touches per year = 1‚Äì3 referrals per 100 contacts.</p>

            <h4 class="text-lg font-bold mb-4">Your Annual Touch Calendar</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-[#002B5C]/5 dark:bg-[#002B5C]/20 p-6 rounded-2xl">
                    <strong>12 High-Value Touches</strong>
                    <ul class="list-disc pl-6 space-y-2 mt-4">
                        <li>Home Anniversary Card + Gift</li>
                        <li>Birthday Call/Card</li>
                        <li>Holiday Gift (pop-by or mailed)</li>
                        <li>Client Appreciation Event Invite</li>
                        <li>Personal Video Check-In (2x/year)</li>
                        <li>Equity Review Offer (annual)</li>
                        <li>Handwritten Note (3x/year)</li>
                        <li>Referral Partner Lunch</li>
                    </ul>
                </div>
                <div class="bg-[#00A89D]/5 dark:bg-[#00A89D]/20 p-6 rounded-2xl">
                    <strong>21 Low-Effort Touches</strong>
                    <ul class="list-disc pl-6 space-y-2 mt-4">
                        <li>Monthly Email Newsletter</li>
                        <li>Market Update Post (shared)</li>
                        <li>Social Media Engagement</li>
                        <li>Text Check-In (quarterly)</li>
                        <li>Event Photos Tagged</li>
                        <li>Quick Value Share (article, tip)</li>
                    </ul>
                </div>
            </div>

            <p class="font-semibold text-center text-xl">Do this consistently ‚Üí 80%+ of your business will come from your database.</p>
        </div>
    </div>

    <!-- Life Event Nurturing -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Life Event Nurturing (The Referral Goldmine) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Major life events trigger moves. Be the first person they think of.</p>

            <h4 class="text-lg font-bold mb-4">Track & Respond to These Events</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Marriage</strong> ‚Üí ‚ÄúCongrats! Thinking bigger home?‚Äù</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>New Baby</strong> ‚Üí ‚ÄúNeed more space? Let‚Äôs chat options.‚Äù</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Job Change/Promotion</strong> ‚Üí Equity review or upgrade opportunity</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Empty Nest</strong> ‚Üí Downsizing conversation</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Retirement</strong> ‚Üí Reverse mortgage or cash-out options</li>
                <li class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl"><strong>Divorce/Inheritance</strong> ‚Üí Sensitive support + solutions</li>
            </ul>

            <p class="mt-6 font-semibold">Pro Move: Set calendar reminders for known events ‚Äî show up when it matters most.</p>
        </div>
    </div>

    <!-- Client Appreciation & Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Client Appreciation Events & Touches <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Make your clients feel celebrated ‚Äî this turns them into referral machines.</p>

            <h4 class="text-lg font-bold mb-4">Annual Event Ideas</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li><strong>Pie Day (March 14)</strong> ‚Äì Deliver pies + ‚ÄúThanks for letting me be part of your home journey‚Äù</li>
                <li><strong>Summer Picnic or Shred Day</strong> ‚Äì Family-friendly, useful</li>
                <li><strong>Fall Pumpkin Giveaway</strong> ‚Äì Porch drop-offs</li>
                <li><strong>Holiday Party or Cookie Exchange</strong> ‚Äì Invite past clients + one guest</li>
                <li><strong>Home Anniversary Gift</strong> ‚Äì Personalized (cutting board, doormat, ornament)</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Low-Cost High-Impact Touches</h4>
            <ul class="space-y-4 text-lg">
                <li>Handwritten anniversary card</li>
                <li>Birthday video message</li>
                <li>‚ÄúJust Sold‚Äù postcard when their neighbor sells</li>
                <li>Equity position update (annual)</li>
                <li>Referral thank-you gift when they send business</li>
            </ul>
        </div>
    </div>

    <!-- Scalable Systems -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scaling Nurturing to 1,000+ Contacts <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Segment & Prioritize:</strong> A+ VIPs get personal calls, B‚Äôs get videos, C‚Äôs get automated value</li>
                <li><strong>Automate the Basics:</strong> Email sequences, birthday triggers, anniversary campaigns</li>
                <li><strong>Batch Personal Touches:</strong> Record 20 videos in one sitting, handwrite notes weekly</li>
                <li><strong>Outsource Execution:</strong> VA for scheduling, mailing, event planning</li>
                <li><strong>Track Engagement:</strong> Who opens emails? Who attends events? Double down on responders</li>
            </ul>

            <p class="mt-8 text-xl font-bold text-center text-[#00A89D]">You don‚Äôt need more leads. You need better relationships with the people you already know.</p>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center mt-12">
        <p class="text-2xl font-bold mb-4">Your database is your legacy.</p>
        <p class="text-xl">Nurture it like the gold mine it is ‚Äî and it will take care of you for decades.</p>
    </div>
</section>
<section id="equity-scanner" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Equity & Opportunity Scanner</h2>
    <p class="mb-8 text-lg">Upload your past client spreadsheet ‚Üí get a prioritized, interactive dashboard showing equity built, refi savings, cash-out potential, move-up power, and personalized outreach scripts. Turn your database into your #1 lead source.</p>

    <!-- Compact Upload Area -->
    <div id="upload-area" class="border-4 border-dashed border-[#00A89D] rounded-2xl p-8 text-center hover:border-[#F15A29] transition-all cursor-pointer mb-8 max-w-3xl mx-auto">
        <i class="fas fa-file-upload text-5xl text-[#00A89D] mb-4"></i>
        <p class="text-2xl mb-4">Drag & drop your spreadsheet here</p>
        <p class="text-lg text-gray-600 dark:text-gray-400 mb-6">or click to browse (CSV or Excel files only)</p>
        <input type="file" id="database-upload" accept=".csv,.xlsx,.xls" class="hidden">
        <button type="button" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-10 py-4 rounded-full font-bold shadow-lg hover:opacity-90 transition-all text-xl">
            Choose File
        </button>
        <p id="file-status" class="text-sm text-gray-600 dark:text-gray-400 mt-6">No file chosen</p>
        <p id="file-name" class="mt-2 font-bold text-[#F15A29] hidden"></p>
    </div>
    
    <!-- Generate Button -->
    <div class="text-center mb-12">
        <button onclick="generateEquityReport(event)" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-20 py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl">
            Generate Equity Report
        </button>
    </div>

    <!-- Compact Ideal Columns -->
    <div class="bg-blue-50 dark:bg-blue-900/30 p-6 rounded-2xl mb-8 max-w-4xl mx-auto">
        <p class="text-lg leading-relaxed">
            <strong>Ideal columns (at minimum):</strong> Borrower's Name, Borrower's Phone, Borrower's Email, Property Address, Existing P&I Payment, Monthly MI at Closing, Property Taxes and Insurance at Closing, Closed Date, Current Rate (or Original Rate), Current Balance (or Original Loan Amount), Current Term (in months), Appraised Value or Purchase Price, Loan Program, and Loan Purpose.
        </p>
        <p class="text-sm mt-4 text-gray-500 dark:text-gray-400 italic">The tool works best with these ‚Äî extras are ignored.</p>
    </div>

    <!-- Loading -->
    <div id="equity-loading" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl text-center max-w-md">
            <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-[#F15A29] mx-auto mb-6"></div>
            <p class="text-2xl font-bold text-[#F15A29]">Processing Spreadsheet...</p>
            <p class="text-lg mt-4">This may take a few seconds for large files</p>
            <p id="progress-text" class="text-xl mt-6 text-[#00A89D] font-semibold">Starting...</p>
        </div>
    </div>

<div class="mb-6">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-2">
        <label for="new-rate-slider" class="text-base font-medium text-[#002B5C] dark:text-[#00A89D]">
            New Refinance Rate
        </label>
        
        <!-- Editable number input -->
        <div class="flex items-center gap-1">
            <input 
                id="new-rate-input" 
                type="number" 
                step="0.125" 
                min="3.0" 
                max="8.0" 
                value="6.000" 
                class="w-20 p-1.5 text-center text-lg font-bold border-2 border-[#00A89D] rounded-lg bg-white dark:bg-gray-800 text-[#F15A29] focus:outline-none focus:ring-2 focus:ring-[#F15A29]"
            >
            <span class="text-lg font-bold text-[#F15A29]">%</span>
        </div>
    </div>

    <!-- Slider -->
    <input 
        id="new-rate-slider" 
        type="range" 
        min="3.0" 
        max="8.0" 
        step="0.125" 
        value="6.0" 
        class="w-full h-2.5 bg-gray-200 rounded-full appearance-none cursor-pointer dark:bg-gray-700"  
        style="accent-color: #F15A29;"
    >

    <!-- Condensed ticks: every 0.5%, smaller font, less mt -->
    <div class="flex justify-between text-[10px] text-gray-400 dark:text-gray-500 font-medium mt-1 px-1">
        <span>3.0</span><span>3.5</span><span>4.0</span><span>4.5</span><span>5.0</span>
        <span>5.5</span><span>6.0</span><span>6.5</span><span>7.0</span><span>7.5</span><span>8.0</span>
    </div>
</div>
<div class="flex items-center justify-center space-x-6 mb-8 mt-4">
    <span class="text-lg font-semibold text-gray-700 dark:text-gray-300">Savings Mode:</span>
    <button id="savings-mode-toggle" class="relative inline-flex h-10 w-20 items-center rounded-full bg-gray-300 dark:bg-gray-700 transition-colors focus:outline-none focus:ring-4 focus:ring-[#00A89D]/50">
        <span id="toggle-thumb" class="inline-block h-8 w-8 transform rounded-full bg-white shadow-lg transition-translate duration-300 ease-in-out translate-x-1"></span>
    </button>
    <span id="mode-label" class="text-lg font-bold text-[#00A89D]">Full Term Reset</span>
</div>
<!-- Equity Report Output Container (was missing ‚Äî JS injects everything here) -->
<div id="equity-output" class="hidden mt-12">
    <!-- Dashboard summary, filters, and opportunity-cards grid will be injected here by JS -->
    <div id="no-results" class="hidden text-center text-4xl font-bold text-gray-500 dark:text-gray-400 py-32">
        No opportunities found matching current filters.
    </div>
</div>
    
</section>
                        <section id="process" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">The Loan Process ‚Äì World-Class, Scalable, White-Glove</h2>
    <p class="mb-8 text-lg">This is your complete playbook for delivering an extraordinary, consistent client and referral partner experience ‚Äî no matter if you're at 20 loans/month or 60. Over-communicate, systematize everything, and build processes that scale without sacrificing quality.</p>

    <!-- Core Principles -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">The 7 Core Principles of a Scalable World-Class Process <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ol class="list-decimal pl-6 space-y-6 text-lg">
                <li><strong>Set Expectations Early & Often</strong> ‚Äì Day 1 timeline + weekly updates eliminate surprises.</li>
                <li><strong>Over-Communicate</strong> ‚Äì Clients/partners should never wonder "what's happening?"</li>
                <li><strong>Systematize Everything Repeatable</strong> ‚Äì Checklists, templates, automation = consistency at scale.</li>
                <li><strong>Weekly Pipeline Reviews</strong> ‚Äì Catch issues early; non-negotiable for growth.</li>
                <li><strong>Personal Touchpoints</strong> ‚Äì Videos, handwritten notes, post-close follow-up create raving fans.</li>
                <li><strong>Delegate Without Dropping Quality</strong> ‚Äì Clear roles for processor, TC, assistant.</li>
                <li><strong>Measure & Improve</strong> ‚Äì NPS surveys, referral rates, close ratios ‚Äî track what matters.</li>
            </ol>
        </div>
    </div>

    <!-- Communication System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scalable Communication System (Client + Partner) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">The #1 driver of referrals and 5-star reviews: proactive, predictable communication.</p>

            <h4 class="text-lg font-bold mb-4">Client Weekly Touchpoint Schedule</h4>
            <ul class="space-y-4 text-lg mb-8">
                <li><strong>Day 1:</strong> Personal welcome video + detailed timeline email + needs list</li>
                <li><strong>Every Monday:</strong> 60-second status video/email ("Here's where we are, what's next, anything needed from you")</li>
                <li><strong>Major Milestones:</strong> Immediate personal call/video (pre-approval, appraisal ordered/received, CTC, funding)</li>
                <li><strong>48 Hours Pre-Closing:</strong> Personal call confirming time/location/docs/funds</li>
                <li><strong>Day After Closing:</strong> Thank-you video + request for review/referral</li>
                <li><strong>7 Days Post-Close:</strong> NPS survey + "settling in" check-in</li>
                <li><strong>30 Days & 1 Year:</strong> Anniversary touch with small gift</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Realtor Partner Weekly Updates</h4>
            <ul class="space-y-4 text-lg">
                <li><strong>Every Thursday:</strong> Quick text/email: "File update: Appraisal due X, targeting CTC Y ‚Äî anything I can do to support?"</li>
                <li><strong>Milestones:</strong> Immediate notification (approval, clear to close)</li>
                <li><strong>Post-Closing:</strong> Thank-you note + "smooth close" highlight for their marketing</li>
            </ul>

            <p class="mt-6 font-semibold">Pro Tip: Use CRM automation for templates ‚Äî you stay personal while scaling to 50+ files.</p>
        </div>
    </div>

    <!-- Weekly Pipeline Review -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Weekly Pipeline Review Meeting (Your Growth Engine) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">30-minute Monday meeting with processor/assistant. This single habit allows LOs to triple volume without chaos.</p>

            <h4 class="text-lg font-bold mb-4">Exact Agenda (Run Every Week)</h4>
            <ol class="list-decimal pl-6 space-y-4 mb-8">
                <li><strong>Celebrate Wins</strong> (2 min) ‚Äì Closings, approvals, great feedback</li>
                <li><strong>Aging Files Review</strong> (10 min) ‚Äì Anything >7 days in underwriting/appraisal/conditions</li>
                <li><strong>This Week's Milestones</strong> (5 min) ‚Äì Upcoming appraisals, CTCs, closings</li>
                <li><strong>Stalled Files Deep Dive</strong> (10 min) ‚Äì What's blocking? Who owns next action?</li>
                <li><strong>Communication Check</strong> (3 min) ‚Äì Any clients/partners needing touch this week?</li>
                <li><strong>Capacity Forecast</strong> (3 min) ‚Äì How many new files can we comfortably take?</li>
            </ol>

            <p class="font-semibold">Document in shared pipeline tool (Encompass dashboard, Google Sheet, or CRM). Assign owners and due dates.</p>
        </div>
    </div>

    <!-- Checklists & Templates -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Essential Checklists & Templates <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">Day 1 Borrower Needs List (Send Immediately)</h4>
            <ul class="list-disc pl-6 space-y-2 mb-8">
                <li>Last 2 years tax returns (all pages/schedules)</li>
                <li>Last 60 days pay stubs</li>
                <li>2 months all asset statements (all pages)</li>
                <li>Driver's license + SSN card</li>
                <li>Current mortgage/HOA/insurance statements</li>
                <li>Explanation letters for credit inquiries, employment gaps, large deposits</li>
                <li>Divorce decree/child support (if applicable)</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Clear-to-Close Final Checklist</h4>
            <ul class="list-disc pl-6 space-y-2 mb-8">
                <li>All conditions satisfied & approved</li>
                <li>Closing Disclosure signed + 3-day period complete</li>
                <li>Funding conditions met (wire instructions confirmed)</li>
                <li>Homeowners insurance binder received & correct</li>
                <li>Final walkthrough completed (purchase)</li>
                <li>Closing package reviewed for accuracy</li>
            </ul>

            <h4 class="text-lg font-bold mb-4">Post-Closing Follow-Up Template</h4>
            <p class="italic mb-4">"Hi [Client], hope you're settling in beautifully! A few quick things:</p>
            <ul class="list-disc pl-6 space-y-2">
                <li>Your final documents are attached</li>
                <li>Please let me know if any mail forwarding/tax questions arise</li>
                <li>I'd love an honest Google review when convenient ‚Äî it helps other families</li>
                <li>Who do you know buying/refinancing soon? Happy to help them too!</li>
            </ul>
        </div>
    </div>

    <!-- Scaling to High Volume -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scaling to 50‚Äì100+ Loans/Year Without Losing Quality <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Team Structure:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>15‚Äì25 files/month ‚Üí Add licensed assistant</li>
                        <li>30+ ‚Üí Full-time processor</li>
                        <li>50+ ‚Üí Transaction coordinator + junior LO</li>
                    </ul>
                </li>
                <li><strong>Automation Wins:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>CRM milestone triggers for emails/texts</li>
                        <li>Loom videos for common questions</li>
                        <li>Templated condition responses</li>
                    </ul>
                </li>
                <li><strong>White-Glove at Scale:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Personal video at application & approval (you record, assistant sends)</li>
                        <li>Handwritten thank-you notes (batch weekly)</li>
                        <li>Post-close gift program (systematized but personalized)</li>
                        <li>Annual client events (systematized invitation process)</li>
                    </ul>
                </li>
                <li><strong>Key Metrics to Track Monthly:</strong>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Average days from app to close</li>
                        <li>% of files with zero suspense extensions</li>
                        <li>NPS score (aim 90+)</li>
                        <li>Referral partner satisfaction feedback</li>
                    </ul>
                </li>
            </ul>

            <p class="mt-8 text-xl font-bold text-center text-[#00A89D]">The secret: Systems + personal touches. You can have both at any volume.</p>
        </div>
    </div>

    <!-- Final Motivation -->
    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center">
        <p class="text-2xl font-bold mb-4">Every client should feel like your ONLY client.</p>
        <p class="text-xl">When you deliver that consistently, referrals become automatic and your business becomes unstoppable.</p>
    </div>
</section>
    <section id="social-post" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Social Media Post Creator</h2>
    <p class="mb-8 text-lg">Generate ready-to-post content that builds relationships, sparks engagement, and grows your reach organically.</p>

    <!-- Loading Popup -->
    <div id="social-loading" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-800 p-12 rounded-3xl shadow-2xl text-center max-w-lg mx-4">
            <i class="fas fa-spinner fa-spin text-8xl text-[#00A89D] mb-8"></i>
            <p class="text-3xl font-bold text-[#002B5C] dark:text-white">Crafting Your Perfect Post...</p>
            <p class="text-xl mt-6 text-gray-600 dark:text-gray-400">This takes 30-60 seconds ‚Äî worth it!</p>
        </div>
    </div>

    <!-- Form -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Post Type Dropdown -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Post Type / Goal</label>
            <select id="post-type" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value=" " selected class="font-bold">Use Custom Idea (type below)</option>
                <option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</option>

                <optgroup label="Educational & Myth-Busting">
                    <option value="Myth: You need 20% down to buy a home">Myth: You need 20% down to buy a home</option>
                    <option value="Pre-qual vs pre-approval: What's the difference?">Pre-qual vs pre-approval: What's the difference?</option>
                    <option value="How temporary rate buydowns work">How temporary rate buydowns work</option>
                    <option value="5 hidden costs every buyer should know">5 hidden costs every buyer should know</option>
                    <option value="How to boost your credit score fast">How to boost your credit score fast</option>
                    <option value="The truth about closing costs">The truth about closing costs</option>
                    <option value="FHA vs Conventional: Which is better?">FHA vs Conventional: Which is better?</option>
                    <option value="Why PMI isn't as bad as you think">Why PMI isn't as bad as you think</option>
                    <option value="What lenders really look for beyond credit">What lenders really look for beyond credit</option>
                    <option value="Red flags to avoid in your Loan Estimate">Red flags to avoid in your Loan Estimate</option>
                </optgroup>

                <optgroup label="Market Updates">
                    <option value="Local inventory is up/down ‚Äî what it means for buyers">Local inventory is up/down ‚Äî what it means for buyers</option>
                    <option value="Are rates trending up or down this week?">Are rates trending up or down this week?</option>
                    <option value="Is now a good time to buy or should you wait?">Is now a good time to buy or should you wait?</option>
                    <option value="Local home prices: Year-over-year update">Local home prices: Year-over-year update</option>
                    <option value="Why buyer competition is easing">Why buyer competition is easing</option>
                    <option value="Refinance opportunity alert">Refinance opportunity alert</option>
                    <option value="What the latest Fed news means for rates">What the latest Fed news means for rates</option>
                    <option value="Spring 2026 market preview">Spring 2026 market preview</option>
                </optgroup>

                <optgroup label="Local Community">
                    <option value="Shoutout to my favorite local coffee shop">Shoutout to my favorite local coffee shop</option>
                    <option value="Upcoming weekend event in town">Upcoming weekend event in town</option>
                    <option value="Hidden gem park or trail">Hidden gem park or trail</option>
                    <option value="Spotlight on a great local business">Spotlight on a great local business</option>
                    <option value="Best farmers market finds this season">Best farmers market finds this season</option>
                    <option value="New restaurant opening downtown">New restaurant opening downtown</option>
                    <option value="Local school or team achievement">Local school or team achievement</option>
                    <option value="Holiday lights tour recommendations">Holiday lights tour recommendations</option>
                </optgroup>

                <optgroup label="Personal & Behind-the-Scenes">
                    <option value="A day in the life of a loan officer">A day in the life of a loan officer</option>
                    <option value="Weekend family adventure">Weekend family adventure</option>
                    <option value="What I'm grateful for this week">What I'm grateful for this week</option>
                    <option value="My morning routine for staying sharp">My morning routine for staying sharp</option>
                    <option value="Coffee run before the approvals come in">Coffee run before the approvals come in</option>
                    <option value="Celebrating X years in mortgage">Celebrating X years in mortgage</option>
                    <option value="Book or podcast I'm loving right now">Book or podcast I'm loving right now</option>
                    <option value="Home office setup tour">Home office setup tour</option>
                </optgroup>

                <optgroup label="Client Wins & Celebrations">
                    <option value="Just helped another family get their keys!">Just helped another family get their keys!</option>
                    <option value="First-time buyer success story">First-time buyer success story</option>
                    <option value="Overcame a tough credit challenge">Overcame a tough credit challenge</option>
                    <option value="Refinance that saved big monthly">Refinance that saved big monthly</option>
                    <option value="From pre-approval to closing fast">From pre-approval to closing fast</option>
                    <option value="Helped a family win in a competitive market">Helped a family win in a competitive market</option>
                    <option value="Celebrating a smooth closing today">Celebrating a smooth closing today</option>
                    <option value="Turning 'maybe' into 'yes'">Turning "maybe" into "yes"</option>
                </optgroup>

                <optgroup label="Value & Resources">
                    <option value="Free 2026 Home Buyer Checklist">Free 2026 Home Buyer Checklist</option>
                    <option value="Questions every buyer should ask their lender">Questions every buyer should ask their lender</option>
                    <option value="Download my moving checklist">Download my moving checklist</option>
                    <option value="Free credit review offer">Free credit review offer</option>
                    <option value="Home maintenance calendar">Home maintenance calendar</option>
                    <option value="Local vendor list for new homeowners">Local vendor list for new homeowners</option>
                    <option value="Rate buydown explainer">Rate buydown explainer</option>
                </optgroup>

                <optgroup label="Engagement & Fun">
                    <option value="Poll: Rent forever or own your home?">Poll: Rent forever or own your home?</option>
                    <option value="This or That: Beach vs mountain home?">This or That: Beach vs mountain home?</option>
                    <option value="Tag a friend who needs this tip">Tag a friend who needs this tip</option>
                    <option value="What's your dream home feature?">What's your dream home feature?</option>
                    <option value="Fixer-upper or move-in ready?">Fixer-upper or move-in ready?</option>
                    <option value="Relatable: When rates drop and everyone calls">Relatable: When rates drop and everyone calls</option>
                </optgroup>

                <optgroup label="Motivational">
                    <option value="Your dream home is worth the effort">Your dream home is worth the effort</option>
                    <option value="Homeownership builds wealth over time">Homeownership builds wealth over time</option>
                    <option value="Don't wait to buy real estate ‚Äî buy and wait">Don't wait to buy real estate ‚Äî buy and wait</option>
                    <option value="Small steps lead to big keys">Small steps lead to big keys</option>
                    <option value="Mindset: You deserve this">Mindset: You deserve this</option>
                </optgroup>

                <optgroup label="Holiday / Seasonal">
                    <option value="Favorite holiday tradition">Favorite holiday tradition</option>
                    <option value="New Year's home goals for 2026">New Year's home goals for 2026</option>
                    <option value="Grateful this holiday season">Grateful this holiday season</option>
                    <option value="Spring cleaning + refinance tip">Spring cleaning + refinance tip</option>
                </optgroup>

                <optgroup label="Realtor Partner Value">
                    <option value="How I support my realtor partners">How I support my realtor partners</option>
                    <option value="Fast pre-approvals for your buyers">Fast pre-approvals for your buyers</option>
                    <option value="Co-branded tools ready for you">Co-branded tools ready for you</option>
                    <option value="Shoutout to an amazing agent partner">Shoutout to an amazing agent partner</option>
                    <option value="Why agents love working with me">Why agents love working with me</option>
                </optgroup>
            </select>
        </div>

        <!-- Custom Details with Dynamic Helper -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">
                Custom Idea or Additional Details
                <span id="details-helper" class="block text-base font-normal text-gray-600 dark:text-gray-400 mt-2">
                    e.g., Shout out to my favorite local coffee shop
                </span>
            </label>
            <textarea id="post-details" rows="4" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 resize-none"></textarea>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="generateSocialPost()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Generate My Post Now
            </button>
        </div>
    </div>

    <!-- Output -->
    <div id="social-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96 hidden">
        <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
            <!-- Post content -->
        </div>
        <div class="text-center">
            <button onclick="copySocialPost()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                üìã Copy Post to Clipboard
            </button>
        </div>
    </div>

        
<div class="mt-16">
    <!-- Collapsible Trigger (Premium Expand Button) -->
    <button type="button" onclick="toggleCalendarSection()" class="w-full text-left focus:outline-none group">
        <div class="flex items-center justify-between bg-gradient-to-r from-[#002B5C]/50 to-[#00A89D]/30 rounded-3xl p-10 hover:from-[#002B5C]/70 hover:to-[#00A89D]/50 transition-all shadow-2xl cursor-pointer border border-[#00A89D]/20">
            <div class="flex items-center">
                <i class="fas fa-calendar-alt text-6xl text-[#F15A29] mr-8"></i>
                <div>
                    <h2 class="text-4xl font-bold text-[#F15A29]">30-Day Social Media Calendar Planner</h2>
                    <p class="text-lg mt-3 text-gray-900 dark:text-white group-hover:text-white transition-colors">
                        Click to expand ‚Üí Generate a complete interactive calendar with themed days + 3‚Äì5 ready-to-post ideas for every day of the month
                    </p>
                </div>
            </div>
            <i id="calendar-toggle-icon" class="fas fa-chevron-down text-5xl text-[#00A89D] transition-transform duration-500 group-hover:scale-110"></i>
        </div>
    </button>

    <!-- Collapsible Content (hidden by default) -->
    <div id="calendar-content" class="hidden mt-12 space-y-12">
        <!-- Intro Description -->
        <p class="text-lg text-gray-900 dark:dark:text-white max-w-4xl">
            Build consistency with a fresh, localized 30-day plan every month. Get 3‚Äì5 ready-to-post ideas per day ‚Äî educational, personal, local, and promotional ‚Äî tailored to your region and goals. No more blank-page stress.
        </p>

        <!-- Why This Works Callouts -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 p-6 rounded-2xl text-center border border-[#00A89D]/20">
                <i class="fas fa-heart text-4xl text-[#F15A29] mb-4"></i>
                <p class="font-bold">Build Real Relationships</p>
                <p class="text-sm mt-2">Heavy on personal, local, and engagement content</p>
            </div>
            <div class="bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 p-6 rounded-2xl text-center border border-[#00A89D]/20">
                <i class="fas fa-chart-line text-4xl text-[#00A89D] mb-4"></i>
                <p class="font-bold">Grow Consistently</p>
                <p class="text-sm mt-2">Know exactly what to post every day ‚Äî no guesswork</p>
            </div>
            <div class="bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 p-6 rounded-2xl text-center border border-[#00A89D]/20">
                <i class="fas fa-copy text-4xl text-[#F15A29] mb-4"></i>
                <p class="font-bold">Copy Ready</p>
                <p class="text-sm mt-2">Instantly review and copy!</p>
            </div>
        </div>

        <!-- Generator Form -->
<div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-12 rounded-3xl shadow-2xl border border-[#00A89D]/20">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
        <!-- Month & Year -->
        <div class="flex gap-4 items-center">
            <label class="text-xl font-semibold text-[#00A89D]">Month & Year</label>
            <div class="flex gap-4">
                <select id="plan-month" class="p-3 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
                    <option value="1">January</option>
                    <option value="2">February</option>
                    <option value="3">March</option>
                    <option value="4">April</option>
                    <option value="5">May</option>
                    <option value="6">June</option>
                    <option value="7">July</option>
                    <option value="8">August</option>
                    <option value="9">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                </select>
                <input type="number" id="plan-year" value="2026" min="2024" max="2030" class="p-3 w-32 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
            </div>
        </div>

        <!-- Primary Area(s) -->
        <div>
            <label class="text-xl font-semibold text-[#00A89D] block mb-3">Primary City/County/Area(s)</label>
            <textarea id="plan-areas" rows="3" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 resize-none" placeholder="e.g., Fort Wayne, Allen County, Auburn, Northeast Indiana..."></textarea>
        </div>

        <!-- Hobbies & Passions -->
        <div>
            <label class="text-xl font-semibold text-[#00A89D] block mb-3">Your Hobbies, Passions & Interests</label>
            <textarea id="plan-hobbies" rows="3" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 resize-none" placeholder="e.g., golf, side-by-side trails, spending time with family and friends, live sporting events and concerts, local restaurants, cards with friends..."></textarea>
        </div>

        <!-- Family -->
        <div>
            <label class="text-xl font-semibold text-[#00A89D] block mb-3">Family Info (share what you're comfortable with)</label>
            <textarea id="plan-family" rows="3" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 resize-none" placeholder="e.g., married with two kids, pets, love family game nights, weekend trips to the lake..."></textarea>
        </div>
    </div>

    <!-- Themes to Weave In -->
    <div class="mb-10">
        <label class="text-xl font-semibold text-[#00A89D] block mb-4">Weave in these themes throughout the month (check all that apply)</label>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-family" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Family Moments</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-hobbies" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Hobbies & Interests</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-local" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Local Events & Spots</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-fun" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Fun & Humor</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-polls" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Polls & Engagement</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-refi" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Refi & Rate Tips</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-cashout" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Cash-Out Ideas</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-purchase" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Purchase Tips</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-equity" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Equity & Move-Up</span>
            </label>
            <label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-equity" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Recipe Ideas</span>
            </label><label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-equity" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Trivia and Fun Facts</span>
            </label><label class="flex items-center gap-3 text-lg">
                <input type="checkbox" id="theme-equity" class="w-6 h-6 rounded border-[#00A89D] text-[#00A89D] focus:ring-[#00A89D]">
                <span>Local Business Spotlights</span>
            </label>
        </div>
    </div>

    <!-- Custom Instructions -->
    <div class="mb-10">
        <label class="text-xl font-semibold text-[#00A89D] block mb-3">Additional Custom Instructions</label>
        <textarea id="custom-plan-prompt" rows="6" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800" placeholder="e.g., More video ideas, focus on first-time buyers, include calls-to-action for appointments, lighter tone..."></textarea>
    </div>

    <div class="text-center">
        <button onclick="generateMonthlyPlan()" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-16 py-6 rounded-full font-bold text-2xl shadow-2xl hover:opacity-90 transition-all">
            Generate My 30-Day Plan
        </button>
    </div>

            <div id="social-plan-loading" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
    <div class="bg-white dark:bg-gray-800 p-12 rounded-3xl shadow-2xl text-center max-w-lg mx-4">
        <i class="fas fa-spinner fa-spin text-8xl text-[#00A89D] mb-8"></i>
        <p class="text-3xl font-bold text-[#002B5C] dark:text-white">Building Your Custom Plan...</p>
        <p class="text-xl mt-6 text-gray-600 dark:text-gray-400">This takes 45-60 seconds ‚Äî worth the wait!</p>
    </div>
</div>

            <div id="social-plan-output" class="mt-12"></div>
        </div>
    </div>
</div>

    
    <!-- Pro Tips Card -->
    <div class="mt-12 bg-gradient-to-br from-[#002B5C]/10 to-[#00A89D]/10 rounded-3xl p-10 border-2 border-[#00A89D]/30">
        <h3 class="text-2xl font-bold mb-6 text-[#002B5C] dark:text-[#00A89D]">Pro Tips for Maximum Engagement</h3>
        <ul class="space-y-4 text-lg text-gray-700 dark:text-gray-300 list-disc pl-6">
            <li><strong>Educational + Local + Personal + Client Wins + Value</strong> ‚Äî these are your 5 content pillars</li>
            <li><strong>Ask questions</strong> ‚Äî polls, "What do you think?", tag friends</li>
            <li><strong>Post consistently</strong> ‚Äî follow the weekly schedule (Motivation Monday, Tip Tuesday, etc.)</li>
            <li><strong>Use stories daily</strong> ‚Äî behind-the-scenes, quick tips, polls</li>
            <li><strong>Tag local businesses/partners</strong> ‚Äî increases reach exponentially</li>
            <li><strong>End with subtle CTA</strong> ‚Äî "DM me", "Comment below", "Tag a friend who needs this"</li>
            <li><strong>Be human</strong> ‚Äî share hobbies, family (with permission), wins, and lessons</li>
        </ul>
    </div>
  
</section>
                    
                <section id="sales-script" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Sales Script Generator</h2>
    <p class="mb-8 text-lg">Generate natural, relationship-focused scripts for any sales situation. Select a common scenario or type your own ‚Äî get 3‚Äì5 warm, effective scripts instantly.</p>

    <!-- Unified Form Wrapper -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Sales Situation Dropdown -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Sales Situation</label>
            <select id="script-scenario-select" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value=" " selected class="font-bold">Use Custom Scenario (type below)</option>
                <option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</option>
                
                <optgroup label="Borrower Objections">
                    <option value="Rates are too high right now">Borrower says: "Rates are too high right now"</option>
                    <option value="We're going to wait for rates to drop">Borrower says: "We're going to wait for rates to drop"</option>
                    <option value="I want to wait until after the election">Borrower says: "I want to wait until after the election"</option>
                    <option value="I don't have enough for a down payment">Borrower says: "I don't have enough for a down payment"</option>
                    <option value="My credit isn't good enough">Borrower says: "My credit isn't good enough"</option>
                    <option value="I'm happy renting / not ready to buy">Borrower says: "I'm happy renting / not ready to buy"</option>
                    <option value="I can get a better deal online">Borrower says: "I can get a better deal online"</option>
                    <option value="A friend/family member is a loan officer">Borrower says: "A friend/family member is a loan officer"</option>
                    <option value="I already have a lender">Borrower says: "I already have a lender"</option>
                    <option value="I'm just shopping around / getting info">Borrower says: "I'm just shopping around / getting info"</option>
                    <option value="Buying a home is too stressful">Borrower says: "Buying a home is too stressful"</option>
                    <option value="I don't want to pay PMI">Borrower says: "I don't want to pay PMI"</option>
                    <option value="I heard closing costs are really high">Borrower says: "I heard closing costs are really high"</option>
                </optgroup>
                
                <optgroup label="Realtor Partner Objections">
                    <option value="I'm happy with my current lender">Realtor says: "I'm happy with my current lender"</option>
                    <option value="I'm too busy right now">Realtor says: "I'm too busy right now"</option>
                    <option value="I have multiple lenders I use">Realtor says: "I have multiple lenders I use"</option>
                    <option value="Your rates aren't competitive">Realtor says: "Your rates aren't competitive"</option>
                    <option value="I only work with [big bank]">Realtor says: "I only work with [big bank]"</option>
                    <option value="My clients go direct to their bank">Realtor says: "My clients go direct to their bank"</option>
                </optgroup>
                
                <optgroup label="Asking for Business">
                    <option value="Ask a realtor for a 1:1 meeting">Ask a realtor for a 1:1 meeting</option>
                    <option value="Ask a borrower for an application call">Ask a borrower for an application call</option>
                    <option value="Encourage borrower to lock rate or move forward">Encourage borrower to lock rate or move forward</option>
                    <option value="Ask past client for referrals">Ask past client for referrals</option>
                    <option value="Offer to monitor rates for future refinance">Offer to monitor rates for future refinance</option>
                    <option value="Re-engage a borrower who went elsewhere">Re-engage a borrower who went elsewhere</option>
                    <option value="Invite realtor to lunch/coffee">Invite realtor to lunch/coffee</option>
                    <option value="Welcome a new real estate agent to the market">Welcome a new real estate agent to the market</option>
                    <option value="Support a realtor having a slow month">Support a realtor having a slow month</option>
                </optgroup>
                
                <optgroup label="Relationship Building">
                    <option value="Follow up after sending pre-approval or quote">Follow up after sending pre-approval or quote</option>
                    <option value="Offer value to a realtor partner">Offer value to a realtor partner</option>
                    <option value="Thank realtor partner after a closing">Thank realtor partner after a closing</option>
                    <option value="Birthday or home anniversary check-in">Birthday or home anniversary check-in</option>
                    <option value="Reinforce I'm your loan officer for life">Reinforce "I'm your loan officer for life"</option>
                    <option value="Reach out for annual equity review">Reach out for annual equity review</option>
                    <option value="Help past client who is relocating">Help past client who is relocating</option>
                    <option value="Talk to investor about next property purchase">Talk to investor about next property purchase</option>
                    <option value="Remind client to complete post-closing survey">Remind client to complete post-closing survey</option>
                </optgroup>
                
                <optgroup label="Special Situations">
                    <option value="Client moving out of state">Client moving out of state</option>
                    <option value="Client buying second home/vacation property">Client buying second home/vacation property</option>
                    <option value="Client going through divorce">Client going through divorce</option>
                    <option value="Client inheriting property">Client inheriting property</option>
                    <option value="Client with non-traditional income">Client with non-traditional income (self-employed, gig)</option>
                    <option value="Client with recent credit event">Client with recent credit event (bankruptcy, foreclosure)</option>
                </optgroup>
            </select>
        </div>

        <!-- Custom Scenario ‚Äì Only visible when custom selected -->
        <div id="custom-scenario-wrapper" class="space-y-3">
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Custom Scenario (type your own)</label>
            <textarea id="custom-scenario" rows="3" placeholder="Describe the exact situation (e.g., Client wants to buy but has a recent short sale)" 
                      class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none"></textarea>
        </div>

        <!-- Additional Context -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Additional Context (optional ‚Äì helps make scripts better)</label>
            <textarea id="script-context" rows="4" placeholder="e.g., first-time buyer, strong referral partner, move-up buyer, investor, self-employed" 
                      class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none"></textarea>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="generateSalesScript()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Generate Scripts
            </button>
        </div>

        <!-- Loading Spinner -->
        <div id="script-loading" class="text-center py-12 hidden">
            <i class="fas fa-spinner fa-spin text-6xl text-[#00A89D]"></i>
            <p class="mt-6 text-2xl text-gray-600 dark:text-gray-400 font-medium">
                Generating your scripts... this takes 10‚Äì20 seconds
            </p>
        </div>
    </div>

    <!-- Output -->
    <div id="script-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96 hidden">
        <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
            <!-- Scripts will be inserted here -->
        </div>
        <div class="text-center">
            <button onclick="copySalesScripts()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                üìã Copy All Scripts
            </button>
        </div>
    </div>
</section>
        <section id="eventplanning" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Event Planning ‚Äì Build Relationships & Generate Referrals</h2>
    <p class="mb-8 text-lg">Events are one of the highest-ROI activities for loan officers. Done right, they strengthen relationships with past clients, impress referral partners, and create organic leads ‚Äî all while being fun and memorable. This is your complete playbook for planning, executing, and following up on events that drive business.</p>

    <!-- Hero Quote -->
    <div class="bg-gradient-to-r from-[#002B5C] to-[#00A89D] text-white p-10 rounded-3xl text-center mb-12">
        <p class="text-2xl italic mb-4">"People may forget what you said, but they‚Äôll never forget how you made them feel."</p>
        <p class="text-xl font-semibold">Great events create emotional connections ‚Äî and emotional connections create referrals.</p>
    </div>

    <!-- 1. Event Strategy & Mindset -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">1. Event Strategy & Mindset <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Value First:</strong> The event should feel like a gift ‚Äî no hard selling.</li>
                <li><strong>Invite +1:</strong> Encourage guests to bring a friend ‚Äî built-in lead generation.</li>
                <li><strong>Co-Host for Leverage:</strong> Partner with realtors, builders, or local businesses to share costs and expand reach.</li>
                <li><strong>Frequency Goal:</strong> 4‚Äì6 events/year (mix of client appreciation, partner education, community)</li>
                <li><strong>Budget Rule:</strong> $20‚Äì$50 per attendee is plenty for massive ROI</li>
                <li><strong>Measure Success:</strong> Attendance, social shares, referrals generated, partner feedback</li>
            </ul>
            <p class="mt-6 font-semibold text-center text-xl text-[#00A89D]">One well-executed event can generate 5‚Äì20+ referrals over the next 12 months.</p>
        </div>
    </div>

    <!-- 2. Client Appreciation Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">2. Client Appreciation Events (Turn Clients into Raving Fans) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-gray-50 dark:bg-gray-900 p-8 rounded-3xl">
                    <strong class="text-xl block mb-4">Low-Cost, High-Impact Ideas</strong>
                    <ul class="list-disc pl-6 space-y-4">
                        <li><strong>Pie Day (March 14)</strong> ‚Äì Deliver pies to past clients (‚ÄúThanks for letting me be part of your home journey!‚Äù)</li>
                        <li><strong>Summer Ice Cream Social</strong> ‚Äì Park or office, $300‚Äì500 budget</li>
                        <li><strong>Fall Pumpkin Giveaway</strong> ‚Äì Porch drop-offs or pickup event</li>
                        <li><strong>Shredding Day</strong> ‚Äì Partner with shred company (often free), add coffee/donuts</li>
                        <li><strong>Holiday Cookie Exchange</strong> ‚Äì Clients bring cookies, you provide cocoa + photos</li>
                    </ul>
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-8 rounded-3xl">
                    <strong class="text-xl block mb-4">Premium Experiences</strong>
                    <ul class="list-disc pl-6 space-y-4">
                        <li><strong>Family Movie Night</strong> ‚Äì Rent theater screen or outdoor projector</li>
                        <li><strong>Wine Tasting or Cooking Class</strong> ‚Äì Partner with local venue</li>
                        <li><strong>Sporting Event Suite</strong> ‚Äì For top 50 clients + partners</li>
                        <li><strong>Charity Gala or 5K Team</strong> ‚Äì Give back together</li>
                    </ul>
                </div>
            </div>
            <p class="mt-6 font-semibold">Key: Invite past clients + one guest. Photos + social sharing = free marketing.</p>
        </div>
    </div>

    <!-- 3. Partner Education Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">3. Partner Education Events (Become Indispensable) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6">Position yourself as the expert ‚Äî agents will send you business to avoid looking uninformed.</p>
            <ul class="space-y-6 text-lg">
                <li><strong>Lunch & Learns (30‚Äì45 min)</strong><br>Topics: Buydowns, renovation loans, DPA programs, non-QM, market updates<br>Cater lunch ($10‚Äì15/head) at their office</li>
                <li><strong>Happy Hour Education</strong><br>Casual venue, drinks + 20-min talk on ‚ÄúWinning Offers in 2026‚Äù</li>
                <li><strong>Quarterly Mastermind</strong><br>Invite top 20 agents for roundtable + your market insights</li>
                <li><strong>Virtual Webinars</strong><br>‚ÄúFirst-Time Buyer Programs Update‚Äù ‚Äî record for replay</li>
            </ul>
            <p class="mt-6 font-semibold">Pro Tip: End with Q&A and ‚ÄúWho do you have coming up I can pre-approve?‚Äù</p>
        </div>
    </div>

    <!-- 4. Community & Charity Events -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">4. Community & Charity Events (Build Local Reputation) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Sponsor Local Sports Team</strong> ‚Äì Banner + team party invite</li>
                <li><strong>Host Food/Clothing Drive</strong> ‚Äì Collection boxes at office, partner with realtors</li>
                <li><strong>Charity 5K or Golf Outing Team</strong> ‚Äì Co-sponsor with partners</li>
                <li><strong>Back-to-School Supply Drive</strong> ‚Äì Partner with title company or builder</li>
                <li><strong>Holiday Toy Drive</strong> ‚Äì Partner with local fire department</li>
            </ul>
            <p class="mt-6 font-semibold">Share stories on social ‚Äî authenticity builds trust and visibility.</p>
        </div>
    </div>

    <!-- 5. Event Planning Blueprint -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">5. Step-by-Step Event Planning Blueprint <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <table class="w-full text-left border-collapse mb-8">
                <thead>
                    <tr class="bg-[#002B5C] text-white">
                        <th class="p-4">Timeline</th>
                        <th class="p-4">Task</th>
                        <th class="p-4">Details</th>
                    </tr>
                </thead>
                <tbody class="bg-gray-50 dark:bg-gray-900">
                    <tr>
                        <td class="p-4 border-t">8‚Äì12 Weeks Out</td>
                        <td class="p-4 border-t">Choose Event & Date</td>
                        <td class="p-4 border-t">Align with season/holiday, check partner availability</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">6‚Äì8 Weeks Out</td>
                        <td class="p-4 border-t">Secure Venue & Partners</td>
                        <td class="p-4 border-t">Co-host to share costs, book early</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">4‚Äì6 Weeks Out</td>
                        <td class="p-4 border-t">Create Invite List & Design</td>
                        <td class="p-4 border-t">Past clients + partners + their guests, use Canva</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">3‚Äì4 Weeks Out</td>
                        <td class="p-4 border-t">Send Invites & RSVPs</td>
                        <td class="p-4 border-t">Email + text reminder, track responses</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">1‚Äì2 Weeks Out</td>
                        <td class="p-4 border-t">Final Logistics</td>
                        <td class="p-4 border-t">Food, signage, gifts, photo backdrop</td>
                    </tr>
                    <tr class="bg-white dark:bg-gray-800">
                        <td class="p-4 border-t">Day Of</td>
                        <td class="p-4 border-t">Execute & Capture Content</td>
                        <td class="p-4 border-t">Arrive early, take photos/videos, thank everyone</td>
                    </tr>
                    <tr>
                        <td class="p-4 border-t">1‚Äì3 Days After</td>
                        <td class="p-4 border-t">Follow-Up</td>
                        <td class="p-4 border-t">Thank-you email + photos, request feedback/reviews</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 6. Budget Templates -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">6. Sample Budget Templates <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-3xl">
                    <strong class="text-xl block mb-4">Low Budget ($300‚Äì600)</strong>
                    <ul class="space-y-3">
                        <li>Pie Day delivery (50 pies @ $10)</li>
                        <li>Shredding day (shred partner free + coffee)</li>
                        <li>Pumpkin giveaway</li>
                    </ul>
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-3xl">
                    <strong class="text-xl block mb-4">Medium Budget ($800‚Äì1,500)</strong>
                    <ul class="space-y-3">
                        <li>Ice cream social (food truck)</li>
                        <li>Lunch & learn for 30 agents</li>
                        <li>Holiday cookie exchange</li>
                    </ul>
                </div>
                <div class="bg-gray-50 dark:bg-gray-900 p-6 rounded-3xl">
                    <strong class="text-xl block mb-4">Premium ($2,000+)</strong>
                    <ul class="space-y-3">
                        <li>Movie night theater rental</li>
                        <li>Wine tasting venue</li>
                        <li>Sporting event suite</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 7. Follow-Up System -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">7. Post-Event Follow-Up (Turn Events into Referrals) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6 text-lg">
                <li><strong>Day 1:</strong> Thank-you email with photo collage + "Who should I invite next time?"</li>
                <li><strong>Day 3:</strong> Post event highlights on social (tag attendees)</li>
                <li><strong>Week 1:</strong> Personal thank-you call to top partners/guests</li>
                <li><strong>Week 2:</strong> Send printed photos or small thank-you gift</li>
                <li><strong>Month 1:</strong> "Saw this and thought of you" touch with event memory</li>
            </ul>
            <p class="mt-6 font-semibold">The follow-up is where the magic happens ‚Äî this turns one event into years of referrals.</p>
        </div>
    </div>

    <div class="bg-gradient-to-r from-[#002B5C] to-[#F15A29] text-white p-12 rounded-3xl text-center mt-16">
        <p class="text-3xl font-bold mb-6">Events aren't expenses ‚Äî they're investments in relationships.</p>
        <p class="text-2xl">Plan 4‚Äì6 memorable events per year, execute flawlessly, and watch your referral business explode.</p>
    </div>
</section>
        <section id="resources" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Resources</h2>
            <p class="mb-4">Leverage these for growth.</p>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Scripts or Word Tracks <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Rate Locking:</strong> "Based on current trends, locking now secures your rate ‚Äì option 1: 'Let's protect against rises.' Option 2: 'What are your thoughts on timing?' Option 3: 'This gives peace of mind; ready?' Option 4: 'Market volatile; lock to avoid regret.' Option 5: 'Secure today, float down if rates drop.'"</li>
                        <li><strong>Asking for Lunch:</strong> "I'd love to catch up over lunch ‚Äì when works? Option 2: 'Let's discuss co-marketing over lunch?' Option 3: 'Free lunch on me to brainstorm?' Option 4: 'How open to lunch next week?' Option 5: 'Lunch to share market insights?'"</li>
                        <li><strong>Asking for a Meeting:</strong> "When good for a quick meeting? Option 2: 'Let's meet to align on goals.' Option 3: 'Schedule a strategy session?' Option 4: 'Meeting to explore partnership?' Option 5: 'Chat over coffee about business?'"</li>
                        <li><strong>Survey:</strong> "You'll get a survey post-closing; my team strives for you to be comfortable rating us 5 stars. If not, call me ‚Äì I want to improve. Your feedback helps us serve better and continue providing the smooth process we aim for."</li>
                        <li><strong>Referral:</strong> "Who do you know needing mortgage help? Option 2: 'Happy to help friends/family ‚Äì intro?' Option 3: 'Referral your biggest compliment.' Option 4: 'Know anyone buying/refinancing?' Option 5: 'Share my name with network?'"</li>
                        <li><strong>Realtor Intro:</strong> "Have agent? If not, great intro. Option 2: 'Connect to top realtor?' Option 3: 'Partner with excellent agents ‚Äì recommend?' Option 4: 'Need realtor suggestion?' Option 5: 'Let's team with proven realtor.'"</li>
                        <li><strong>For Agent:</strong> "What can I do to earn more of your business?"</li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Potential Uses of Expense Report <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Business cards, signs, marketing materials.</li>
                        <li>Client/referral entertainment (lunches, events).</li>
                        <li>Gifts, pop-bys, appreciation parties.</li>
                        <li>Ads, sponsorships (golf, events).</li>
                        <li>Training, conferences.</li>
                    </ul>
                    <p class="mt-4"><a href="https://2759433.fs1.hubspotusercontent-na1.net/hubfs/2759433/Ruoff%20Expense%20Reimbursement%20Policy%206-1-2022.pdf" target="_blank" class="text-[#00A89D] hover:text-[#F15A29] underline">View Expense Policy</a></p>
                </div>
            
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Potential CRM Campaigns <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="list-disc pl-6 space-y-2">
                        <li>Prospect Realtor: Intro, value adds, meetings.</li>
                        <li>Past Client Nurture: Check-ins, equity reviews, events.</li>
                        <li>Referral Partner: Updates, co-marketing.</li>
                        <li>Lead Generation: Seminars, ads follow-up.</li>
                        <li>Automated Journeys: Status updates, birthdays, alerts.</li>
                        <li>Segment by rate/milestones.</li>
                    </ul>
                </div>
                       </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">How to Create Email Message Templates <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ol class="list-decimal pl-6 space-y-2">
                        <li>On Home menu, New E-mail (CTRL+SHIFT+M).</li>
                        <li>Enter content in body.</li>
                        <li>File > Save As > Outlook Template.</li>
                        <li>Name and save.</li>
                        <li>To use: New Items > More > Choose Form > User Templates > Select > Open > Edit > Send.</li>
                    </ol>
                    <p class="mt-4">Changes not saved to template; resave for updates.</p>
                </div>
            </div>
        </section>
                <section id="underwriting-search" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Underwriting Guideline Search</h2>
    <p class="mb-8 text-lg">Ask any underwriting question (Conventional, FHA, VA, USDA, Non-QM) and get a clear, accurate answer with confidence level.</p>

    <!-- Important Warning -->
    <div class="bg-red-50 dark:bg-red-900/30 border-2 border-red-500 dark:border-red-600 rounded-2xl p-6 mb-8 shadow-md">
        <p class="text-lg font-bold text-red-800 dark:text-red-200">
            <i class="fas fa-exclamation-triangle mr-2 text-red-600 dark:text-red-400 text-2xl"></i>
            Always verify final decisions with official guidelines and Ruoff overlays.
        </p>
    </div>

    <!-- Unified Form Wrapper -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Question Input -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Your Underwriting Question</label>
            <textarea id="uw-question" rows="4" placeholder="e.g., What are the minimum credit score requirements for FHA with compensating factors? Can a borrower with a recent bankruptcy qualify for Conventional? DTI limits for VA loans?"
                      class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 resize-none"></textarea>
        </div>

        <!-- Loan Type Dropdown -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Loan Type (optional)</label>
            <select id="uw-loan-type" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value="any">Any / General</option>
                <option value="conventional">Conventional</option>
                <option value="fha">FHA</option>
                <option value="va">VA</option>
                <option value="usda">USDA</option>
                <option value="non-qm">Non-QM / Jumbo</option>
            </select>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="searchUnderwriting()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Search Guidelines
            </button>
        </div>

        <!-- Loading Spinner (Large & Clear) -->
        <div id="uw-loading" class="text-center py-12 hidden">
            <i class="fas fa-spinner fa-spin text-6xl text-[#00A89D]"></i>
            <p class="mt-6 text-2xl text-gray-600 dark:text-gray-400 font-medium">
                Researching guidelines... this takes 10‚Äì20 seconds
            </p>
        </div>
    </div>

    <!-- Output -->
    <div id="uw-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96 hidden">
        <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
            <!-- Response will appear here -->
        </div>
        <div class="text-center">
            <button onclick="copyUwOutput()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                üìã Copy Response
            </button>
        </div>
    </div>
</section>
                <section id="blog" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Blog Creator ‚Äì Authority-Building Content in Seconds</h2>
    <p class="mb-8 text-lg">Generate SEO + GEO-optimized blog posts that position you as the trusted expert. Select a topic from the list or type your own, choose your tone, and get a ready-to-publish post (800‚Äì1,200 words).</p>

    <!-- Unified Form Wrapper -->
    <div class="bg-gray-50 dark:bg-gray-900 p-8 md:p-10 rounded-3xl mb-12 space-y-8">
        <!-- Tone Selector -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Blog Tone</label>
            <select id="blog-tone" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
                <option value="Friendly & Relatable" selected>Friendly & Relatable (Recommended)</option>
                <option value="Educational & Informative">Educational & Informative</option>
                <option value="Professional & Authoritative">Professional & Authoritative</option>
                <option value="Fun & Lighthearted">Fun & Lighthearted</option>
                <option value="Motivational & Inspiring">Motivational & Inspiring</option>
            </select>
        </div>

        <!-- Topic Dropdown + Custom Input -->
        <div>
            <label class="block text-lg font-semibold mb-3 text-[#00A89D]">Blog Topic</label>
            <select id="blog-topic-select" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50 mb-4">
    <option value="" selected>Use Custom Topic (type below)</option>
    <option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</option>
                
        <optgroup label="First-Time Home Buyers">
        <option>The Complete 2026 Guide to Buying Your First Home</option>
        <option>How Much Down Payment Do You Really Need in 2026?</option>
        <option>First-Time Buyer Programs: What‚Äôs Available and How to Qualify</option>
        <option>The Biggest Mistakes First-Time Buyers Make (and How to Avoid Them)</option>
        <option>Buying a Home with Student Loans: Yes, It‚Äôs Possible!</option>
        <option>How to Get Pre-Approved: What Lenders Really Look For</option>
        <option>Closing Costs Explained: What First-Time Buyers Should Budget</option>
        <option>Should You Buy Now or Wait for Lower Rates in 2026?</option>
        <option>The Truth About PMI: When You Need It and How to Cancel</option>
        <option>Building Equity as a First-Time Buyer: Strategies That Work</option>
        <option>Navigating Home Inspections: What Every First-Time Buyer Must Know</option>
        <option>Choosing the Right Neighborhood: Schools, Commute, and Resale Value</option>
        <option>HOA Fees Explained: Pros, Cons, and What to Watch For</option>
        <option>Buying a Condo vs. Single-Family Home: Which Is Right for You?</option>
        <option>First-Time Buyer Tax Credits and Incentives in 2026</option>
        <option>How to Win in a Competitive Market Without Overpaying</option>
        <option>Eco-Friendly Homes: Energy Incentives and Green Mortgage Options</option>
        <option>The Role of a Buyer‚Äôs Agent: Do You Really Need One?</option>
        <option>Is a Home Warranty Worth It for First-Time Buyers?</option>
        <option>Remote Work and Relocation: Financing Your Move in 2026</option>
    </optgroup>

    <optgroup label="Refinancing & Rates">
        <option>Should You Refinance in 2026? A Complete Guide</option>
        <option>When Is the Best Time to Refinance Your Mortgage?</option>
        <option>Temporary Rate Buydowns Explained: Lower Payments for the First Few Years</option>
        <option>Cash-Out Refinance: When It Makes Sense (and When It Doesn‚Äôt)</option>
        <option>Refinancing to Remove PMI: Step-by-Step</option>
        <option>How Much Can You Save by Refinancing? Real Examples</option>
        <option>Refinance Myths That Could Cost You Thousands</option>
        <option>ARMs vs Fixed: Which Is Better in Today‚Äôs Market?</option>
        <option>Rate-and-Term vs. Cash-Out: Which Refinance Is Right for You?</option>
        <option>No-Closing-Cost Refinance: Is It Really Free?</option>
        <option>Streamline Refinancing for FHA and VA Loans: Faster and Easier</option>
        <option>How Your Credit Score Impacts Refinance Rates in 2026</option>
        <option>Refinancing After a Recent Purchase: When It‚Äôs Allowed</option>
        <option>Locking Your Rate: Timing Tips to Save Money</option>
        <option>Refinancing Investment Properties: Special Rules and Benefits</option>
        <option>HELOC vs. Cash-Out Refinance: Which Is Better for Home Improvements?</option>
    </optgroup>

    <optgroup label="Credit & Qualification">
        <option>How to Improve Your Credit Score Before Buying a Home</option>
        <option>Can You Buy a Home with a Credit Score Under 620? The Truth</option>
        <option>Debt-to-Income Ratio Explained: How Lenders Really Look at It</option>
        <option>Common Credit Report Errors That Block Approvals</option>
        <option>Non-Traditional Credit: How to Qualify Without a FICO Score</option>
        <option>Rapid Rescoring: Boost Your Score in Days</option>
        <option>Hard vs. Soft Credit Inquiries: What Borrowers Need to Know</option>
        <option>Using Gift Funds for Down Payment: Rules and Documentation</option>
        <option>Asset Depletion Mortgages: Qualifying with Investments Instead of Income</option>
        <option>Compensating Factors That Help Lower Credit Scores Get Approved</option>
        <option>Employment Gaps: How to Explain Them to Lenders</option>
        <option>Co-Borrowers and Co-Signers: Pros, Cons, and Risks</option>
        <option>Bankruptcy and Foreclosure: How Long Until You Can Buy Again?</option>
    </optgroup>

    <optgroup label="Homeownership & Lifestyle">
        <option>The Hidden Costs of Homeownership (and How to Budget for Them)</option>
        <option>Rent vs Buy in 2026: The Math You Need to Know</option>
        <option>Home Renovation Loans: 203(k), HomeStyle, and More</option>
        <option>Is Homeownership Still Worth It in 2026?</option>
        <option>Moving Up: How to Buy Your Second Home</option>
        <option>Downsizing in Retirement: Financial and Emotional Considerations</option>
        <option>Turning Your Home into an Income Property</option>
        <option>Home Maintenance 101: Essential Costs New Owners Overlook</option>
        <option>Energy Efficiency Upgrades: Financing Options and Tax Credits</option>
        <option>Property Taxes and Assessments: What to Expect After Closing</option>
        <option>Multi-Generational Homes: Financing and Design Trends</option>
        <option>Pet-Friendly Home Buying: Features That Matter Most</option>
        <option>Home Insurance Basics: Coverage Every Homeowner Needs</option>
        <option>Sustainable Homeownership: Lowering Bills and Carbon Footprint</option>
    </optgroup>

    <optgroup label="Loan Programs">
        <option>FHA Loans in 2026: Lower MIP and New Guidelines</option>
        <option>VA Loans: The Best Benefit Most Veterans Don‚Äôt Use</option>
        <option>USDA Loans: Zero Down in Rural and Suburban Areas</option>
        <option>Jumbo Loans: What Changed in 2026 and How to Qualify</option>
        <option>Non-QM Loans: Options for Self-Employed and Investors</option>
        <option>Bank Statement Loans for Gig Workers and Entrepreneurs</option>
        <option>Reverse Mortgages: New Rules and Who Benefits</option>
        <option>Conventional 97% LTV Loans: Low Down Payment Options</option>
        <option>Physician and Medical Professional Loans: Special Benefits</option>
        <option>DSCR Loans: Investor Financing Based on Property Cash Flow</option>
        <option>Construction and Renovation-to-Permanent Loans</option>
        <option>ITIN Loans: Homeownership for Non-Citizens</option>
        <option>Bridge Loans: Short-Term Financing for Move-Up Buyers</option>
        <option>HELOCs and Home Equity Loans: Current Rates and Uses</option>
    </optgroup>

    <optgroup label="Market Trends & Insights">
        <option>Mortgage Rate Forecast for 2026: What Experts Are Saying</option>
        <option>Why Home Inventory Is Increasing (and What It Means for Buyers)</option>
        <option>The Truth About iBuyers and Instant Offers in 2026</option>
        <option>Investment Properties in 2026: Where the Opportunities Are</option>
        <option>How Inflation and Fed Policy Affect Mortgage Rates</option>
        <option>New Construction vs Resale: Pros, Cons, and Financing</option>
        <option>Affordable Housing Initiatives and Programs in 2026</option>
        <option>The Rise of Build-to-Rent Communities: Should You Buy or Rent?</option>
        <option>Climate Risk and Insurance: How It‚Äôs Changing Home Buying</option>
        <option>Immigration and Population Growth: Impact on Local Housing Demand</option>
        <option>Technology in Real Estate: Virtual Tours, Digital Closings, and More</option>
        <option>Regional Market Spotlight: Where Prices Are Rising/Falling in 2026</option>
    </optgroup>

    <optgroup label="The Mortgage Process">
        <option>Step-by-Step: The Mortgage Application Process in 2026</option>
        <option>What Happens at Closing? A Day-by-Day Breakdown</option>
        <option>Home Appraisal vs. Home Inspection: Key Differences</option>
        <option>Escrow Accounts Explained: Taxes and Insurance Made Simple</option>
        <option>Title Insurance: Why You Need It and What It Covers</option>
        <option>Underwriting: What Lenders Check Behind the Scenes</option>
        <option>Clear to Close: Final Steps Before Getting Your Keys</option>
        <option>Common Closing Delays and How to Avoid Them</option>
        <option>Digital Mortgages: Faster Approvals and E-Closing Options</option>
        <option>Contingencies Explained: Appraisal, Inspection, and Financing</option>
    </optgroup>

    <optgroup label="Investment Properties">
        <option>Financing Your First Rental Property in 2026</option>
        <option>DSCR Loans Explained: No Personal Income Required</option>
        <option>1031 Exchanges: Defer Taxes When Upgrading Investments</option>
        <option>BRRRR Strategy: How to Scale Your Portfolio with Financing</option>
        <option>Short-Term Rentals: Airbnb and VRBO Financing Options</option>
        <option>Portfolio Loans: Managing Multiple Investment Properties</option>
        <option>Cash-Out Refinance on Rentals: Pulling Equity for More Deals</option>
        <option>Fix-and-Flip Loans: Hard Money vs. Traditional Options</option>
        <option>Tax Benefits Every Real Estate Investor Should Know</option>
        <option>Multi-Family Properties: Financing 2‚Äì4 Units vs. Larger Complexes</option>
    </optgroup>
</select>

            <input type="text" id="blog-topic" placeholder="Or type your own custom topic here" 
                   class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-4 focus:ring-[#F15A29]/50">
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Select or type a topic ‚Üí choose tone ‚Üí click Generate to create your blog post!</p>
        </div>

        <!-- Generate Button -->
        <div class="text-center">
            <button onclick="generateBlog()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-5 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                Generate Blog Post
            </button>
        </div>

        <!-- Helpful Hints for Blog Content (add after Generate Blog button) -->
<div class="mt-8 bg-blue-50 dark:bg-blue-900/30 p-6 rounded-2xl shadow-inner border border-blue-200 dark:border-blue-700">
    <h3 class="text-xl font-bold text-[#00A89D] mb-4">Quick Tips for Creating Great Blog Content</h3>
    <ul class="list-disc pl-6 space-y-3 text-gray-700 dark:text-gray-300 text-base">
         <li>How to Use This Tool: Input your topic, tone (e.g., professional or conversational), and length. Click Generate ‚Äî the AI creates a draft optimized for readability and SEO.</li>
         <li>Choose a Relevant Topic: Focus on timely mortgage issues like "Interest Rate Trends" or "First-Time Homebuyer Tips" to attract readers searching for real estate advice. Use keywords like "mortgage rates 2026" for SEO.</li>
        <li>Keep It Engaging and Short: Aim for 800-1200 words. Start with a hook question or statistic, use subheadings, and include calls-to-action like "Contact me for a free rate quote."</li>
        <li>Best Practices After Generation: Always read through the blog for accuracy (verify facts like rates or regulations). Edit to add personal anecdotes, like "In my 10 years as an LO, I've helped clients save thousands by refinancing early." This makes it authentic and builds trust.</li>
        <li>Publish and Promote: Once edited, post on your website or LinkedIn. Share on social media with a teaser and link back to your contact info. Track engagement to refine future posts.</li>
    </ul>
</div>
        <!-- Loading Spinner (Now Matches Social Post & Sales Script) -->
        <div id="blog-loading" class="text-center py-12 hidden">
            <i class="fas fa-spinner fa-spin text-6xl text-[#00A89D]"></i>
            <p class="mt-6 text-2xl text-gray-600 dark:text-gray-400 font-medium">
                Generating your blog post... this takes 20‚Äì40 seconds
            </p>
        </div>
    </div>

    <!-- Blog Output -->
    <div id="blog-output" class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-inner border border-gray-200 dark:border-gray-700 min-h-96">
               <h4 class="text-3xl font-bold text-[#F15A29] mb-6 mt-12">Suggested Social Media Caption</h4>
<div id="social-caption" class="bg-gray-100 dark:bg-gray-700 p-6 rounded-2xl text-lg mb-8 whitespace-pre-wrap"></div>

<!-- Copy Buttons -->
<div class="flex flex-col md:flex-row gap-6 justify-center">
    <button id="copy-blog-btn" class="bg-[#F15A29] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#F15A29]/80 flex items-center justify-center gap-3">
        <i class="fas fa-copy"></i> Copy Blog (with Formatting)
    </button>
    <button id="copy-caption-btn" class="bg-[#00A89D] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#00A89D]/80 flex items-center justify-center gap-3">
        <i class="fas fa-share-alt"></i> Copy Social Caption
    </button>
</div>
    </div>
</section>

 <section id="books" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Recommended Books</h2>
            <p class="mb-4">Explore these highly rated books to enhance your skills in sales, networking, and more.</p>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Sales <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Never Split the Difference by Chris Voss</strong>: Negotiation tactics from FBI hostage negotiator. Benefits: Improve closing deals. Link: <a href="https://www.amazon.com/Never-Split-Difference-Negotiating-Depended/dp/0062407805" target="_blank">Amazon</a></li>
                        <li><strong>The Laws of Human Nature by Robert Greene</strong>: Understand psychology for better sales. Benefits: Build stronger relationships. Link: <a href="https://www.amazon.com/Laws-Human-Nature-Robert-Greene/dp/0143110012" target="_blank">Amazon</a></li>
                        <li><strong>Fanatical Prospecting by Jeb Blount</strong>: Prospecting strategies. Benefits: Increase leads. Link: <a href="https://www.amazon.com/Fanatical-Prospecting-Conversations-Leveraging-Telephone/dp/1119144752" target="_blank">Amazon</a></li>
                        <li><strong>The ONE Thing by Gary Keller</strong>: Focus on key tasks. Benefits: Boost productivity. Link: <a href="https://www.amazon.com/ONE-Thing-Surprisingly-Extraordinary-Results/dp/1885167776" target="_blank">Amazon</a></li>
                        <li><strong>Crushing Call Reluctance for Loan Officers by Carl White</strong>: Overcome call fear. Benefits: Increase prospecting. Link: <a href="https://www.amazon.com/Crushing-Call-Reluctance-for-Loan-Officers/dp/B07Z8G5Y3G" target="_blank">Amazon</a></li>
                        <li><strong>Loan Officer Champions by Carl White</strong>: Case studies from top LOs. Benefits: Learn from success. Link: <a href="https://www.amazon.com/Loan-Officer-Champions-Studies-Producers/dp/173246555X" target="_blank">Amazon</a></li>
                        <li><strong>Be the Better Broker, Volume 1 by Dustan Woodhouse</strong>: Become top producer. Benefits: Practical LO tips. Link: <a href="https://www.amazon.com/Be-Better-Broker-Become-Producer/dp/1988344034" target="_blank">Amazon</a></li>
                        <li><strong>The Millionaire Loan Officer by Scott Hudspeth</strong>: Advanced strategies. Benefits: Scale business. Link: <a href="https://www.amazon.com/Millionaire-Loan-Officer-Scott-Hudspeth/dp/0971619409" target="_blank">Amazon</a></li>
                        <li><strong>The Mortgage 101 Bootcamp by David Dutton</strong>: Basics for new LOs. Benefits: Foundational knowledge. Link: <a href="https://www.amazon.com/Mortgage-101-Bootcamp-David-Dutton/dp/B07Z8G5Y3G" target="_blank">Amazon</a></li>
                        <li><strong>Pass the Mortgage Loan Originator Test by Real Estate Institute</strong>: Exam prep. Benefits: Certification success. Link: <a href="https://www.amazon.com/Pass-Mortgage-Loan-Originator-Test/dp/0997581808" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Networking <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Never Eat Alone by Keith Ferrazzi</strong>: Networking strategies. Benefits: Build connections. Link: <a href="https://www.amazon.com/Never-Eat-Alone-Expanded-Updated/dp/0385346654" target="_blank">Amazon</a></li>
                        <li><strong>The Connector's Advantage by Michelle Tillis Lederman</strong>: Grow network. Benefits: Referral growth. Link: <a href="https://www.amazon.com/Connectors-Advantage-7-Traits-Highly/dp/1989025358" target="_blank">Amazon</a></li>
                        <li><strong>How to Win Friends and Influence People by Dale Carnegie</strong>: Classic networking. Benefits: Relationship skills. Link: <a href="https://www.amazon.com/How-Win-Friends-Influence-People/dp/0671027034" target="_blank">Amazon</a></li>
                        <li><strong>Networking in the 21st Century by David J.P. Fisher</strong>: Modern networking. Benefits: Digital connections. Link: <a href="https://www.amazon.com/Networking-21st-Century-Professionals-Connections/dp/1944730036" target="_blank">Amazon</a></li>
                        <li><strong>The Go-Giver by Bob Burg</strong>: Giving for networking. Benefits: Value-based relationships. Link: <a href="https://www.amazon.com/Go-Giver-Expanded-Edition-Little-Story/dp/1591848288" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Prospecting <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Fanatical Prospecting by Jeb Blount</strong>: Prospecting techniques. Benefits: Consistent leads. Link: <a href="https://www.amazon.com/Fanatical-Prospecting-Conversations-Leveraging-Telephone/dp/1119144752" target="_blank">Amazon</a></li>
                        <li><strong>New Sales Simplified by Mike Weinberg</strong>: Prospecting focus. Benefits: Pipeline building. Link: <a href="https://www.amazon.com/New-Sales-Simplified-Prospecting-Development/dp/0814431771" target="_blank">Amazon</a></li>
                        <li><strong>Crushing Call Reluctance for Loan Officers by Carl White</strong>: Call strategies. Benefits: Overcome fear. Link: <a href="https://www.amazon.com/Crushing-Call-Reluctance-for-Loan-Officers/dp/B07Z8G5Y3G" target="_blank">Amazon</a></li>
                        <li><strong>Loan Officer Champions by Carl White</strong>: Prospecting case studies. Benefits: Proven methods. Link: <a href="https://www.amazon.com/Loan-Officer-Champions-Studies-Producers/dp/173246555X" target="_blank">Amazon</a></li>
                        <li><strong>Be the Better Broker, Volume 1 by Dustan Woodhouse</strong>: Prospecting for LOs. Benefits: Top producer tips. Link: <a href="https://www.amazon.com/Be-Better-Broker-Become-Producer/dp/1988344034" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Database <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Database Design for Mere Mortals by Michael J. Hernandez</strong>: Database basics. Benefits: Efficient client management. Link: <a href="https://www.amazon.com/Database-Design-Mere-Mortals-Hands/dp/0136788041" target="_blank">Amazon</a></li>
                        <li><strong>The Database Hacker's Handbook by David Litchfield</strong>: Security. Benefits: Protect data. Link: <a href="https://www.amazon.com/Database-Hackers-Handbook-Defending-Servers/dp/0764578014" target="_blank">Amazon</a></li>
                        <li><strong>Database Systems by Thomas Connolly</strong>: Implementation. Benefits: CRM optimization. Link: <a href="https://www.amazon.com/Database-Systems-Design-Implementation-Management/dp/1305866797" target="_blank">Amazon</a></li>
                        <li><strong>Cracking the CRM Code by Limesh Parekh</strong>: CRM strategies. Benefits: Sales database. Link: <a href="https://www.amazon.com/Cracking-CRM-Code-Limesh-Parekh/dp/B08L5S4K2H" target="_blank">Amazon</a></li>
                        <li><strong>Customer Relationship Management by V. Kumar</strong>: CRM best practices. Benefits: Retention. Link: <a href="https://www.amazon.com/Customer-Relationship-Management-Concept-Strategy/dp/3662553805" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Customer Service <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Raving Fans by Ken Blanchard</strong>: Exceptional service. Benefits: Client loyalty. Link: <a href="https://www.amazon.com/Raving-Fans-Revolutionary-Approach-Customer/dp/0688123163" target="_blank">Amazon</a></li>
                        <li><strong>The Customer Rules by Lee Cockerell</strong>: Service principles. Benefits: Mortgage client care. Link: <a href="https://www.amazon.com/Customer-Rules-Essential-Delivering-Sensational/dp/0770435602" target="_blank">Amazon</a></li>
                        <li><strong>Hug Your Customers by Jack Mitchell</strong>: Personalized service. Benefits: Relationship building. Link: <a href="https://www.amazon.com/Hug-Your-Customers-Proven-Customers/dp/1401303668" target="_blank">Amazon</a></li>
                        <li><strong>The Mortgage Professional's Handbook</strong>: Industry service. Benefits: LO-specific tips. Link: <a href="https://www.amazon.com/Mortgage-Professionals-Handbook-Volumes-III/dp/0997581808" target="_blank">Amazon</a></li>
                        <li><strong>Becoming the Successful Mortgage Broker by Jason C. Myers</strong>: Service in mortgages. Benefits: Client satisfaction. Link: <a href="https://www.amazon.com/Becoming-Successful-Mortgage-Broker-Myers/dp/1982220848" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Negotiations <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Never Split the Difference by Chris Voss</strong>: Negotiation tactics. Benefits: Better deals. Link: <a href="https://www.amazon.com/Never-Split-Difference-Negotiating-Depended/dp/0062407805" target="_blank">Amazon</a></li>
                        <li><strong>Getting to Yes by Roger Fisher</strong>: Principled negotiation. Benefits: Win-win outcomes. Link: <a href="https://www.amazon.com/Getting-Yes-Negotiating-Agreement-Without/dp/0143118757" target="_blank">Amazon</a></li>
                        <li><strong>The Art of Negotiation by Michael Wheeler</strong>: Dynamic negotiating. Benefits: Adapt in real-time. Link: <a href="https://www.amazon.com/Art-Negotiation-How-Get-Deals/dp/1451690428" target="_blank">Amazon</a></li>
                        <li><strong>Bargaining for Advantage by G. Richard Shell</strong>: Strategy. Benefits: Mortgage negotiations. Link: <a href="https://www.amazon.com/Bargaining-Advantage-Negotiation-Strategies-Reasonable/dp/0143036971" target="_blank">Amazon</a></li>
                        <li><strong>Ninja Selling by Larry Kendall</strong>: Subtle negotiation. Benefits: LO sales. Link: <a href="https://www.amazon.com/Ninja-Selling-Subtle-Skills-Results/dp/1626342849" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Financial Management <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Rich Dad Poor Dad by Robert Kiyosaki</strong>: Financial literacy. Benefits: Personal finance. Link: <a href="https://www.amazon.com/Rich-Dad-Poor-Teach-Middle/dp/1612680194" target="_blank">Amazon</a></li>
                        <li><strong>The Total Money Makeover by Dave Ramsey</strong>: Debt management. Benefits: Budgeting. Link: <a href="https://www.amazon.com/Total-Money-Makeover-Classic-Financial/dp/1400205298" target="_blank">Amazon</a></li>
                        <li><strong>Financial Intelligence for Entrepreneurs by Karen Berman</strong>: Business finance. Benefits: LO finances. Link: <a href="https://www.amazon.com/Financial-Intelligence-Entrepreneurs-Numbers-Really/dp/1422119122" target="_blank">Amazon</a></li>
                        <li><strong>Profit First by Mike Michalowicz</strong>: Profit-focused. Benefits: Sales finances. Link: <a href="https://upmetrics.co/template/mortgage-broker-business-plan" target="_blank">Amazon</a></li>
                        <li><strong>The Richest Man in Babylon by George S. Clason</strong>: Wealth building. Benefits: Timeless advice. Link: <a href="https://www.amazon.com/Richest-Man-Babylon-George-Clason/dp/0451205367" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
            <div class="accordion">
                <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Other Relevant Categories <i class="fas fa-chevron-down"></i></button>
                <div class="accordion-content">
                    <ul class="space-y-4">
                        <li><strong>Leadership: The 21 Irrefutable Laws of Leadership by John C. Maxwell</strong>: Leadership skills. Benefits: Team management. Link: <a href="https://www.amazon.com/21-Irrefutable-Laws-Leadership-Anniversary/dp/0785288376" target="_blank">Amazon</a></li>
                        <li><strong>Productivity: Atomic Habits by James Clear</strong>: Habit building. Benefits: Daily efficiency. Link: <a href="https://www.amazon.com/Atomic-Habits-Proven-Build-Break/dp/0735211299" target="_blank">Amazon</a></li>
                        <li><strong>Mindset: Mindset by Carol S. Dweck</strong>: Growth mindset. Benefits: Personal development. Link: <a href="https://www.amazon.com/Mindset-Psychology-Carol-S-Dweck/dp/0345472322" target="_blank">Amazon</a></li>
                    </ul>
                </div>
            </div>
        </section>
                <!-- AI Chat Section -->
        <section id="ai-chat" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">AI Chat Assistant</h2>
    <p class="mb-8 text-lg">Ask me anything ‚Äî sales scripts, market updates, marketing ideas, motivation, or just chat. I'm here to help you win.</p>
    <div id="chat-messages" class="bg-gray-50 dark:bg-gray-900 p-6 rounded-2xl mb-6 min-h-32 max-h-96 overflow-y-auto prose dark:prose-invert max-w-none transition-all duration-300">
    <!-- Messages appear here -->
</div>
    <div class="flex space-x-4">
        <textarea id="chat-input" rows="3" class="flex-grow p-4 rounded-lg border border-[#00A89D] focus:ring-[#F15A29] text-lg resize-none" placeholder="Type your message..."></textarea>
        <button onclick="sendChatMessage()" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-6 py-4 rounded-lg font-bold hover:opacity-90">Send</button>
    </div>
    <div id="chat-loading" class="text-center mt-6 hidden">
        <i class="fas fa-spinner fa-spin text-4xl text-[#00A89D]"></i>
        <p class="mt-4 text-xl">Thinking...</p>
    </div>
</section>
                <section id="calculator" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
            <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Advanced Payment Calculator</h2>
            <p class="mb-6">Estimate monthly payments with taxes, insurance, PMI, extra payments, and biweekly options. See lifetime interest, payoff timeline, and potential savings.</p>

            <form id="calc-form" class="space-y-4 calc-grid gap-4">
                <label class="block"><strong>Loan Amount ($):</strong> 
                    <input type="number" id="loanAmount" min="50000" value="300000" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Interest Rate (%):</strong> 
                    <input type="number" id="rate" min="0" step="0.001" value="6.5" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Loan Term (years):</strong> 
                    <input type="number" id="term" min="10" max="40" value="30" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Annual Property Taxes ($):</strong> 
                    <input type="number" id="taxes" value="3600" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>Annual Homeowners Insurance ($):</strong> 
                    <input type="number" id="insurance" value="1500" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block"><strong>PMI Rate (% of loan, if &lt;20% down):</strong> 
    <input type="number" id="pmi" step="0.01" value="0" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
</label>
                <label class="block"><strong>Extra Monthly Payment ($):</strong> 
                    <input type="number" id="extraMonthly" value="0" placeholder="e.g., 200" class="w-full p-2 rounded-lg border border-[#00A89D] focus:ring-[#F15A29]">
                </label>
                <label class="block flex items-center">
                    <input type="checkbox" id="biweekly" class="mr-3 h-5 w-5 text-[#00A89D]">
                    <strong>Make Biweekly Payments (26 per year)</strong>
                </label>
            </form>

            <button type="button" onclick="calculateAdvanced()" class="mt-8 bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white px-8 py-4 rounded-full hover:opacity-90 w-full font-bold text-lg">
           
            <div id="calc-output" class="mt-8 space-y-6"></div>
        </section>
                <!-- MISSING SECTION: Value Vault -->
                <section id="value-vault" class="card bg-white dark:bg-gray-800 pt-6 pb-12 px-8 rounded-3xl shadow-xl animate-fade-in hidden">
    <h2 class="text-3xl font-bold mb-6 text-[#F15A29]">Value Vault ‚Äì Your Ultimate Resource Library</h2>
    <p class="mb-8 text-lg">Packed with client-facing guides, realtor partnership tools, objection handlers, pop-by ideas, social scripts, and more. Everything here is designed to help you deliver massive value first‚Äîbuilding trust, generating referrals, and closing more loans naturally.</p>

    <!-- Referral Partners + Follow-Up -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Referral Partners: Building Lifelong Relationships <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-6"><strong>Why Consistent Follow-Up Wins Referrals:</strong> Studies show 80% of sales require 5+ touches, yet most stop after 2. Value-first follow-up keeps you top-of-mind and turns partners into referral machines.</p>
            
            <h4 class="text-lg font-bold mb-3">Pro Follow-Up Cadence & Tips</h4>
            <ul class="list-disc pl-6 space-y-2 mb-6">
                <li>Top 10 partners ‚Üí Weekly touch; others ‚Üí Monthly.</li>
                <li>Mix mediums: Call ‚Üí Text/Video ‚Üí Pop-By ‚Üí Email ‚Üí Handwritten note.</li>
                <li>Always lead with value (market update, tool, client win story).</li>
                <li>Personalize heavily: Mention their recent listing, birthday, or mutual client.</li>
                <li>Track everything in CRM: Last touch + next planned action.</li>
                <li>Natural ask: ‚ÄúWho do you know moving or refinancing in the next 6 months?‚Äù</li>
            </ul>

            <h4 class="text-lg font-bold mb-3">Ready-to-Use Follow-Up Scripts</h4>
            <ul class="space-y-4">
                <li><strong>Quick Text/Video:</strong> ‚ÄúHey [Name], just helped [Mutual Client] close smoothly‚Äîthey loved working with you! Any buyers I can pre-approve this week?‚Äù</li>
                <li><strong>Value Email Opener:</strong> ‚ÄúSharing this week‚Äôs rate watch + new buyer checklist. Happy to co-brand for your clients!‚Äù</li>
                <li><strong>Pop-By Delivery:</strong> ‚ÄúQuick drop-off to say thanks for the last referral‚Äîplus fresh open house tools for you!‚Äù</li>
                <li><strong>Phone Check-In:</strong> ‚ÄúHow‚Äôs business treating you? Anything I can do to support your listings this month?‚Äù</li>
            </ul>
        </div>
    </div>

    <!-- Client-Facing Resources -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Client-Facing Resources & Guides <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Share these trusted, compliant resources instantly (all free public links‚Äîreplace with Ruoff-branded versions when ready).</p>
            <ul class="space-y-6">
                <li><strong>First-Time Homebuyer Toolkit</strong> ‚Äì Official CFPB guide (gold standard): <a href="https://files.consumerfinance.gov/f/201503_cfpb_your-home-loan-toolkit-web.pdf" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Download PDF</a></li>
                <li><strong>Home Inspection & Shopping Checklist</strong> ‚Äì HUD official: <a href="https://www.hud.gov/sites/documents/checklist-en.pdf" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Download PDF</a></li>
                <li><strong>Rent vs. Own Calculator</strong> ‚Äì Interactive tool: <a href="https://www.nytimes.com/interactive/2024/upshot/buy-rent-calculator.html" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">NYT Calculator</a></li>
                <li><strong>Refinance Breakeven Calculator</strong>: <a href="https://www.bankrate.com/mortgages/mortgage-refinance-break-even-calculator/" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Bankrate Tool</a></li>
                <li><strong>Credit Improvement Tips</strong> ‚Äì Free annual report access: AnnualCreditReport.com</li>
                <li><strong>Moving Checklist</strong> ‚Äì Comprehensive timeline (custom branded version coming).</li>
                <li><strong>Down Payment Assistance (Ruoff States)</strong>:
                    <ul class="list-disc pl-6 mt-2 space-y-1">
                        <li>Indiana (IHCDA) ‚Üí Up to 6%: <a href="https://www.in.gov/ihcda/homeowners-and-renters/first-time-homebuyers/" target="_blank" class="text-[#00A89D]">Details</a></li>
                        <li>Ohio (OHFA) ‚Üí 2.5‚Äì5%: <a href="https://ohiohome.org/ownwithohfa/" target="_blank" class="text-[#00A89D]">Details</a></li>
                        <li>Michigan (MSHDA) ‚Üí Up to $10K: <a href="https://www.michigan.gov/mshda/homeownership" target="_blank" class="text-[#00A89D]">Details</a></li>
                        <li>Kentucky (KHC): <a href="https://www.kyhousing.org/Products/Pages/Down-Payment-Assistance.aspx" target="_blank" class="text-[#00A89D]">Details</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <!-- Realtor Partner Tools -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Realtor Co-Branded Tools & Ideas <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <ul class="space-y-6">
                <li><strong>Co-Branded Flyers</strong> ‚Äì Open house, 2-1 buydown, buyer presentations (use Canva/Etsy templates).</li>
                <li><strong>Ruoff Marketing Portal</strong> ‚Äì Ready-made flyers, social graphics, videos: <a href="https://marketing.ruoff.com/" target="_blank" class="text-[#00A89D] underline hover:text-[#F15A29]">Visit Site</a></li>
                <li><strong>Open House Support Kit</strong> ‚Äì Pre-approval station signage, financing one-pagers, sign-in sheets.</li>
                <li><strong>Joint Value Adds</strong> ‚Äì Co-host buyer seminars, lunch & learns, or virtual webinars (‚ÄúHomebuyer 101‚Äù).</li>
                <li><strong>Weekly Market Snapshots</strong> ‚Äì Share short rate + inventory updates (offer to co-brand for their clients).</li>
                <li><strong>Scripts for Realtors</strong>:
                    <ul class="list-disc pl-6 space-y-2">
                        <li>‚ÄúLet‚Äôs get your buyer pre-approved today‚Äîit strengthens every offer.‚Äù</li>
                        <li>‚ÄúI can run numbers on that listing‚Äîwant a quick equity review for the seller?‚Äù</li>
                        <li>‚ÄúIf affordability is tight, I have buydown or DPA options‚Äîhappy to jump on a call.‚Äù</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <!-- Objection Handlers -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Top Objection Handlers & Scripts <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-4">‚ÄúRates Are Too High‚Äù ‚Äì 5 Responses</h4>
            <ol class="list-decimal pl-6 space-y-3 mb-8">
                <li>‚ÄúI hear that often‚Äîrates feel higher than 2021. But home prices keep rising. Let‚Äôs compare buy now vs wait 12 months.‚Äù</li>
                <li>‚ÄúWe have 2-1 buydown options that lower your rate for the first two years‚Äîwant to see numbers?‚Äù</li>
                <li>‚ÄúWhat rate would feel good? I can show ARMs or lender credits that get us close.‚Äù</li>
                <li>‚ÄúRates cycle‚Äîmany who waited paid more overall. Rent vs own comparison?‚Äù</li>
                <li>‚ÄúWith projected equity growth, owning still beats renting long-term for most.‚Äù</li>
            </ol>

            <h4 class="text-lg font-bold mb-4">‚ÄúI‚Äôm Waiting for Rates to Drop‚Äù</h4>
            <ol class="list-decimal pl-6 space-y-3 mb-8">
                <li>‚ÄúTotally understandable. But if rates drop 1%, prices often rise 10% from competition. Marry the house, date the rate‚Äîwe can refi later at no cost.‚Äù</li>
                <li>‚ÄúNo one has a crystal ball. I‚Äôve helped clients who waited 2 years and missed $50K+ in equity.‚Äù</li>
                <li>‚ÄúLet‚Äôs get you approved now‚Äîwhen rates drop, we refinance seamlessly.‚Äù</li>
            </ol>

            <h4 class="text-lg font-bold mb-4">‚ÄúMy Credit Score Is Too Low‚Äù</h4>
            <ol class="list-decimal pl-6 space-y-3 mb-8">
                <li>‚ÄúMany buyers start where you are. We have rapid-rescore programs and credit boost strategies‚Äîlet‚Äôs review your report together.‚Äù</li>
                <li>‚ÄúWhat score are you seeing? I‚Äôve helped clients raise 50+ points in 3‚Äì6 months with simple steps.‚Äù</li>
                <li>‚ÄúGood news‚Äîthere are programs for scores as low as 580. Want to see what you qualify for today?‚Äù</li>
            </ol>

            <h4 class="text-lg font-bold mb-4">‚ÄúI Don‚Äôt Have Enough for Down Payment‚Äù</h4>
            <ol class="list-decimal pl-6 space-y-3">
                <li>‚ÄúYou may not need 20%‚Äîmany programs allow 3‚Äì5% or even 0% down. Let‚Äôs check state assistance options.‚Äù</li>
                <li>‚ÄúGift funds from family are allowed on most loans‚Äîhave you considered that?‚Äù</li>
                <li>‚ÄúWe have down payment assistance in IN/OH/MI/KY‚Äîup to $10K forgiven. Want details?‚Äù</li>
            </ol>
        </div>
    </div>

    <!-- Pop-By & Giveaways -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Pop-By & Giveaway Ideas <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Budget $5‚Äì15. Attach tag with pun + contact info. Highest ROI marketing activity!</p>
            
            <h4 class="text-lg font-bold mb-3">Year-Round Favorites</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <li>Reusable tote ‚Üí ‚ÄúLet‚Äôs BAG your dream home!‚Äù</li>
                <li>Coffee gift card ‚Üí ‚ÄúThanks a LATTE for the referral!‚Äù</li>
                <li>Lottery tickets ‚Üí ‚ÄúYou‚Äôre a WINNER in my book!‚Äù</li>
                <li>Sunscreen ‚Üí ‚ÄúProtecting your biggest investment!‚Äù</li>
                <li>Candle ‚Üí ‚ÄúYou LIGHT up the market!‚Äù</li>
                <li>Popcorn ‚Üí ‚ÄúJust POPPING by to say thanks!‚Äù</li>
                <li>Plant seeds ‚Üí ‚ÄúWatching your business GROW!‚Äù</li>
                <li>Hand sanitizer ‚Üí ‚ÄúWe‚Äôve got you COVERED!‚Äù</li>
                <li>Mints ‚Üí ‚ÄúWe‚Äôre MINT to work together!‚Äù</li>
                <li>Cookie mix ‚Üí ‚ÄúYou‚Äôre one SMART COOKIE!‚Äù</li>
                <li>Shout wipes ‚Üí ‚ÄúI‚Äôll SHOUT it from the rooftops when you send a referral!‚Äù</li>
                <li>Tape measure ‚Üí ‚ÄúYou always MEASURE up!‚Äù</li>
                <li>Flashlight ‚Üí ‚ÄúYou LIGHT the way for your clients!‚Äù</li>
                <li>Stress ball ‚Üí ‚ÄúSqueezing in a quick thank you!‚Äù</li>
            </ul>

            <h4 class="text-lg font-bold mb-3">Seasonal & Holiday Hits (Perfect for December!)</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <li>Spring seeds/packets ‚Üí ‚ÄúPutting down ROOTS this spring!‚Äù</li>
                <li>Summer spatula ‚Üí ‚ÄúReady to FLIP some houses?‚Äù</li>
                <li>Fall pumpkin spice ‚Üí ‚ÄúYou‚Äôre the PUMPKIN SPICE of real estate!‚Äù</li>
                <li>Winter hot cocoa ‚Üí ‚ÄúWARM wishes from your lender!‚Äù</li>
                <li>Holiday whisk + kisses ‚Üí ‚ÄúWe WHISK you a Merry KISSmas!‚Äù</li>
                <li>New Year champagne poppers ‚Üí ‚ÄúPOP into the New Year with new goals!‚Äù</li>
                <li>Valentine candy ‚Üí ‚ÄúYou‚Äôre the KEY to my success!‚Äù</li>
                <li>St. Patrick‚Äôs shamrock ‚Üí ‚ÄúLUCKY to work with you!‚Äù</li>
                <li>Ice scraper ‚Üí ‚ÄúSCRAPING by to say thanks ‚Äì stay safe this winter!‚Äù</li>
                <li>Hand warmers ‚Üí ‚ÄúWARMING up our partnership this holiday season!‚Äù</li>
                <li>S‚Äômores kit ‚Üí ‚ÄúLet‚Äôs make S‚ÄôMORE memories in your new home!‚Äù</li>
                <li>Mini snow globe ‚Üí ‚ÄúYou make my world SHAKE with great referrals!‚Äù</li>
            </ul>

            <h4 class="text-lg font-bold mb-3">More Creative Ideas</h4>
            <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <li>Local honey ‚Üí ‚ÄúYou‚Äôre the SWEETEST partner!‚Äù</li>
                <li>Bubble wrap ‚Üí ‚ÄúI‚Äôve got your BACK (no popping needed)!‚Äù</li>
                <li>Battery-powered fan ‚Üí ‚ÄúI‚Äôm your biggest FAN!‚Äù</li>
                <li>Potted plant ‚Üí ‚ÄúOur relationship is GROWING strong!‚Äù</li>
            </ul>
        </div>
    </div>

    <!-- Closing & Client Appreciation Gifts -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Closing & Client Appreciation Gifts <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Thoughtful closing gifts create raving fans and referral machines. Aim for useful, home-related items under $50.</p>
            <ul class="space-y-4">
                <li><strong>Personalized address stamper</strong> ‚Äì They‚Äôll use it forever and see your branding.</li>
                <li><strong>Custom cutting board</strong> ‚Äì Engraved with new address + your logo on back.</li>
                <li><strong>House-shaped keychain or ornament</strong> ‚Äì Sent on loan anniversary.</li>
                <li><strong>Welcome mat or doormat</strong> ‚Äì ‚ÄúHome Sweet Home‚Äù with handwritten note.</li>
                <li><strong>Local restaurant gift card</strong> ‚Äì ‚ÄúEnjoy a night out in your new neighborhood!‚Äù</li>
                <li><strong>Tool kit or picture hanging kit</strong> ‚Äì Practical for new homeowners.</li>
                <li><strong>Scented candle set</strong> ‚Äì ‚ÄúMay your new home always smell amazing!‚Äù</li>
                <li><strong>Handwritten thank-you note</strong> ‚Äì Always include‚Äîmost remembered part!</li>
            </ul>
        </div>
    </div>

    <!-- Email & Communication Templates -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Email & Communication Templates <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <h4 class="text-lg font-bold mb-3">To Referral Partners (Weekly Value Touch)</h4>
            <p class="mb-4 font-italic">Subject: Quick Market Snapshot + Open House Tool for You</p>
            <p>Hey [Name],<br><br>Hope you're crushing it this week! Quick update: rates eased slightly, inventory up 8% locally.<br><br>Attached a fresh co-branded buyer checklist for your open houses‚Äîfeel free to use or let me customize.<br><br>Any upcoming deals I can pre-approve?<br><br>Thanks for the partnership!<br>[Your Name]</p>

            <h4 class="text-lg font-bold mb-3 mt-6">Post-Closing Thank You to Client</h4>
            <p class="mb-4 font-italic">Subject: Congratulations Again on Your New Home!</p>
            <p>Congrats [Client]!<br><br>Officially a homeowner‚Äîhuge milestone! Your closing went smoothly thanks to your preparation.<br><br>If any questions come up (taxes, insurance, etc.), I'm here. Also attached your final docs for reference.<br><br>Enjoy making memories!<br>[Your Name]</p>

            <h4 class="text-lg font-bold mb-3 mt-6">Refinance Check-In (6‚Äì12 Months Post-Close)</h4>
            <p class="mb-4 font-italic">Subject: Rates Dropped‚ÄîCould Save You $X Monthly?</p>
            <p>Hi [Client],<br><br>Hope you're loving the new place! Rates have improved since your purchase‚Äîrunning numbers shows potential $287/month savings.<br><br>No obligation‚Äîjust sharing. Want a quick refi quote?<br><br>Best,<br>[Your Name]</p>
        </div>
    </div>

    <!-- NEW: Short Social Media Video Ideas & Scripts -->
    <div class="accordion mb-8">
        <button onclick="toggleAccordion(this)" class="w-full text-left text-xl font-semibold py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">Short Video Ideas & Scripts (Reels/TikTok ‚Äì 15-60 sec) <i class="fas fa-chevron-down"></i></button>
        <div class="accordion-content">
            <p class="mb-4">Quick, engaging videos that educate + entertain. Use trending audio, text overlays, and end with CTA: ‚ÄúComment your biggest mortgage question!‚Äù</p>

            <h4 class="text-lg font-bold mb-3">1. Myth Bust: ‚ÄúYou Need 20% Down‚Äù (Humorous)</h4>
            <p><strong>Script:</strong> [You holding fake money] ‚ÄúMyth: You need 20% down to buy a home. Reality: Many programs let you put 3%, 5%, or even 0% down! FHA, VA, USDA, state assistance‚Äîoptions everywhere. Stop renting, start owning. DM me your down payment question!‚Äù</p>

            <h4 class="text-lg font-bold mb-3">2. Rates Too High Skit</h4>
            <p><strong>Script:</strong> [Act as client] ‚ÄúRates are too high!‚Äù [Switch to you] ‚ÄúI get it‚Äîbut waiting could cost more in home prices. Plus, buydowns lower your rate temporarily. Marry the house, date the rate. Want to see real numbers?‚Äù</p>

            <h4 class="text-lg font-bold mb-3">3. Closing Day Chaos (Funny Skits)</h4>
            <p><strong>Script:</strong> [Fast cuts: spilling coffee, losing keys] ‚ÄúWhat closing day feels like vs reality [smooth signing, happy family]. I handle the chaos so you don‚Äôt have to. Tag a friend buying soon!‚Äù</p>

            <h4 class="text-lg font-bold mb-3">4. Quick Tip: Credit Boost</h4>
            <p><strong>Script:</strong> ‚ÄúWant to raise your credit 50 points fast? Pay down cards below 30%, dispute errors, become authorized user. Free pull at AnnualCreditReport.com. Comment ‚ÄòCREDIT‚Äô for my checklist!‚Äù</p>

            <h4 class="text-lg font-bold mb-3">5. ‚ÄúKaren‚Äù Borrower Skit (Viral Humor)</h4>
            <p><strong>Script:</strong> [Wig on as Karen] ‚ÄúI want a 3% rate or I‚Äôll speak to your manager!‚Äù [Remove wig] ‚ÄúI AM the manager‚Äîand here‚Äôs why today‚Äôs rates still beat renting. Let‚Äôs talk options.‚Äù</p>

            <h4 class="text-lg font-bold mb-3">6. Rent vs Own in 2025</h4>
            <p><strong>Script:</strong> [Show rent check tearing up] ‚ÄúAverage rent up 30% since 2020. Buying locks your payment + builds equity. Run your numbers free‚Äîlink in bio!‚Äù</p>

            <h4 class="text-lg font-bold mb-3">7. Day in the Life</h4>
            <p><strong>Script:</strong> [Time-lapse: coffee, calls, approvals] ‚ÄúA day helping families buy homes. Coffee, crunch numbers, celebrate closings. Love what I do‚Äîready for yours?‚Äù</p>

            <h4 class="text-lg font-bold mb-3">8. Local Market Update</h4>
            <p><strong>Script:</strong> [Point to map] ‚ÄúInventory up 10% locally, rates dipping‚Äîperfect buyer window! Thinking of moving? Comment your neighborhood.‚Äù</p>
        </div>
    </div>
</section>
<!-- Full Updated Weekly Win Plan Section -->
 <!-- NEWSLETTER GENERATOR TOOL -->
<section id="newsletter-generator" class="hidden">
    <div class="max-w-5xl mx-auto px-6 py-12">
        <h2 class="text-4xl md:text-5xl font-bold text-center text-[#F15A29] mb-4">‚úâÔ∏è Newsletter Magic Generator</h2>
        <p class="text-xl text-center text-gray-700 dark:text-gray-300 mb-12 max-w-3xl mx-auto">
            Create beautiful, personalized newsletters in seconds. Stay top-of-mind with partners, past clients, and your sphere ‚Äî effortlessly. 
            <button onclick="openNewsletterTips()" class="ml-4 text-[#00A89D] underline hover:text-[#F15A29] font-semibold">Why newsletters crush it ‚Üí</button>
        </p>

        <!-- Loading Overlay -->
        <div id="newsletter-loading" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
            <div class="bg-white dark:bg-gray-800 p-12 rounded-3xl shadow-2xl text-center max-w-lg mx-4">
                <i class="fas fa-spinner fa-spin text-8xl text-[#00A89D] mb-8"></i>
                <p class="text-3xl font-bold text-[#002B5C] dark:text-white">Crafting Your Magical Newsletter...</p>
                <p class="text-xl mt-6 text-gray-600 dark:text-gray-400">Pulling fresh local content ‚Äî this takes 30-60 seconds.</p>
            </div>
        </div>

        <!-- Inputs Card -->
        <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-12 mb-12">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                <!-- Audience -->
                <div>
                    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Audience Focus</label>
                    <select id="nl-audience" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                        <option value="full">Full Database</option>
                        <option value="partners">Referral Partners</option>
                        <option value="past">Past Clients</option>
                        <option value="sphere">Sphere of Influence</option>
                    </select>
                </div>

                <!-- Frequency -->
                <div>
                    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Frequency</label>
                    <select id="nl-frequency" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                    </select>
                </div>

                <!-- Tone -->
                <div>
                    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Tone & Style</label>
                    <select id="nl-tone" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                        <option value="friendly">Casual & Friendly</option>
                        <option value="professional">Professional & Polished</option>
                        <option value="fun">Fun & Playful</option>
                    </select>
                </div>

                <!-- NEW INPUT: Newsletter Length -->
<!-- Add this right after the Tone dropdown (or in the grid) -->
<div>
    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Newsletter Length</label>
    <select id="nl-length" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
        <option value="short">Short (quick read, ~400 words)</option>
        <option value="medium" selected>Medium (balanced, ~600 words)</option>
        <option value="long">Long (in-depth, ~800 words)</option>
    </select>
</div>

                <!-- ADD THIS INPUT: Newsletter Title (Optional) -->
<!-- Place it right after the Tone dropdown (or in the first grid row) -->
<div class="col-span-1 md:col-span-2">
    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Newsletter Title (Optional ‚Äî Grok creates a great one if blank)</label>
    <input type="text" id="nl-title" placeholder="e.g., Fort Wayne Mortgage Weekly | January 2026 Insights" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
</div>

                <!-- Local Market -->
                <div>
                    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Your Local Market (City, State)</label>
                    <input type="text" id="nl-location" placeholder="e.g., Auburn, Indiana" class="w-full p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50">
                </div>
            </div>

            <!-- Sections Checkboxes -->
            <label class="block text-xl font-semibold text-[#00A89D] mb-4">Sections to Include</label>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-market" checked class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Market Updates üìà</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-industry" checked class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Industry News üì∞</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-local" checked class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Local Events üéâ</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-recipes" class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Recipes üç≥</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-fun" checked class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Fun Facts ü§ì</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-tip" checked class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Homeownership Tip üè°</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-quote" class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Motivational Quote üí™</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-rate" class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Rate Watch üìä</span>
                </label>
                <label class="flex items-center gap-3 text-lg cursor-pointer">
                    <input type="checkbox" id="nl-personal" class="w-6 h-6 text-[#F15A29] rounded focus:ring-[#00A89D]">
                    <span>Personal Update ‚ù§Ô∏è</span>
                </label>
                 </div>

<div class="mb-8">
    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Specific Topics/Headlines/Recipes/Links to Include (Optional)</label>
    <textarea id="nl-specific" rows="5" placeholder="e.g., 'Include this recipe: https://example.com/chili' or 'Headline: Fort Wayne Home Show Jan 24-26' or 'Talk about Komets winning streak' ‚Äî We'll incorporate it perfectly!" class="w-full p-5 rounded-2xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50"></textarea>
</div>
            <!-- Personal Update (hidden until checked) -->
            <!-- UPDATED Personal Update Section (Always Visible, with Guidance) -->
<!-- Replace your current personal update block with this (makes it always available, not hidden) -->
<div class="mb-8">
    <label class="block text-xl font-semibold text-[#00A89D] mb-3">Your Personal Update (Optional ‚Äî We'll polish it perfectly)</label>
    <textarea id="nl-personal-text" rows="6" placeholder="Share a quick life update, recent win, family moment, hobby, or fun story ‚Äî e.g., 'Just closed my biggest deal yet!' or 'Loving the snowy Fort Wayne winters with family snowball fights!' We'll make it warm, authentic, and newsletter-ready. Personal touches build trust & referrals! ‚ù§Ô∏è" 
              class="w-full p-5 rounded-2xl border-2 border-[#00A89D] bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-4 focus:ring-[#F15A29]/50"></textarea>
</div>


            <!-- Optional Branding -->
<!-- UPDATED Branding Inputs: Add YouTube, X, Google Business -->
<!-- Replace your current branding <details> with this -->
<details class="mb-8 bg-gray-100 dark:bg-gray-700 rounded-2xl p-6">
    <summary class="text-xl font-semibold text-[#00A89D] cursor-pointer mb-4">Optional Branding & Contact Info (auto-saved)</summary>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
        <input type="text" id="nl-name" placeholder="Your Name (e.g., Adam Garman)" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="tel" id="nl-cell" placeholder="Cell Phone (e.g., 260-348-0905)" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="email" id="nl-email" placeholder="Email (e.g., adam@ruoff.com)" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-headshot" placeholder="Headshot URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-logo" placeholder="Company Logo URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="text" id="nl-signature" placeholder="Signature (e.g., NMLS #124792)" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-facebook" placeholder="Facebook URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-instagram" placeholder="Instagram URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-linkedin" placeholder="LinkedIn URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-youtube" placeholder="YouTube URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-x" placeholder="X (Twitter) URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
        <input type="url" id="nl-google" placeholder="Google Business URL" class="p-4 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
    </div>
</details>

            <!-- Generate Button -->
            <div class="text-center">
                <button id="generate-newsletter-btn" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 px-12 rounded-full font-bold text-2xl shadow-2xl hover:opacity-90 transition-all">
                    <i class="fas fa-magic mr-4"></i> Generate My Magical Newsletter
                </button>
            </div>
        </div>

        <!-- UPDATED Output Section: Download Button + Clean Copy -->
<!-- Replace your current #newsletter-output block with this (adds download, removes subjects from copy) -->
<div id="newsletter-output" class="hidden">
    <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-12">
        <div class="flex justify-between items-center mb-8 flex-wrap gap-4">
            <h3 class="text-3xl font-bold text-[#F15A29]">Your Newsletter Preview ‚ú®</h3>
            <div class="flex gap-4 flex-wrap">
                <button onclick="copyNewsletterHTML()" class="bg-[#00A89D] hover:bg-[#00887A] text-white px-6 py-3 rounded-full font-bold">Copy HTML</button>
                <button onclick="downloadNewsletterHTML()" class="bg-[#F15A29] hover:bg-orange-600 text-white px-6 py-3 rounded-full font-bold">Download .html File</button>
                           </div>
        </div>

        <p class="text-lg mb-6 text-gray-700 dark:text-gray-300">
            <strong>How to use:</strong> Copy HTML ‚Üí paste into Mailchimp/Constant Contact. Or download the .html file, double-click to preview in browser, then upload to your email platform.
        </p>

        <!-- Preview -->
        <div id="nl-preview" class="border-2 border-gray-300 dark:border-gray-600 rounded-2xl overflow-hidden min-h-96 bg-gray-50 dark:bg-gray-900"></div>

        <!-- Raw HTML (hidden) -->
        <textarea id="nl-html-raw" class="hidden"></textarea>
    </div>
</div>
   <!-- Newsletter Tips Modal -->
<div id="newsletter-tips-modal" class="modal" style="display: none;">
    <div class="modal-content max-w-4xl">
        <span class="close-modal" onclick="closeNewsletterTips()">&times;</span>
        <div class="modal-header">
            <h3 class="text-4xl">Why Newsletters Are Pure Gold üí∞</h3>
        </div>
        <div class="space-y-6 text-lg">
            <p><strong>Stay Top-of-Mind:</strong> Consistent touchpoints = more referrals without cold outreach.</p>
            <p><strong>Build Trust:</strong> Mix value (market updates, tips) with personal (life updates) = genuine relationships.</p>
            <p><strong>People Love Them:</strong> Recipes, local events, fun facts ‚Äî your audience actually opens and enjoys these.</p>
            <p><strong>Pro Tips:</strong></p>
            <ul class="list-disc pl-8 space-y-2">
                <li>Send consistently (weekly or monthly) ‚Äî momentum compounds.</li>
                <li>Keep it short & scannable ‚Äî bold headers, emojis, short paragraphs.</li>
                <li>End with a soft CTA: "Know anyone thinking about buying/refinancing? I'm here to help!"</li>
                <li>Use tools like Mailchimp/Constant Contact for pretty delivery & tracking.</li>
                <li>Personal updates are magic ‚Äî share wins, family, hobbies to humanize yourself.</li>
            </ul>
            <p class="font-bold text-[#F15A29]">You got this ‚Äî one newsletter at a time, you're building an unstoppable network! üî•</p>
        </div>
    </div>
</div>
</section>

<section id="weekly-win-plan" class="hidden">
    <div class="ai-tool-wrapper">
        <div class="text-center mb-12">
            <h2 class="text-5xl font-black mb-4 text-[#F15A29] tracking-tight" id="personalized-title">My Weekly Win Plan üî•</h2>
            <p class="text-xl text-gray-900 max-w-3xl mx-auto">
                Your personal prospecting coach. Clear daily actions, built-in balance, and execution help to make winning feel effortless.
            </p>
        </div>

        <!-- Hero Motivation + Streak -->
        <div class="bg-gradient-to-br from-[#002B5C]/60 to-[#00A89D]/40 rounded-3xl p-10 mb-12 shadow-2xl border border-[#00A89D]/30">
            <div class="flex flex-col md:flex-row items-center justify-around gap-8 text-center">
                <div class="text-6xl animate-pulse">üî•</div>
                <div>
                    <p class="text-4xl font-bold text-[#F15A29]" id="streak-display">0 Week Streak</p>
                    <p class="text-2xl mt-2" id="streak-message">Let's start your fire today!</p>
                </div>
                <div class="text-6xl">üí∞</div>
                <div>
                    <p class="text-2xl font-bold">Monthly Goal: <span id="monthly-goal-display">8</span> Funded Loans</p>
                    <p class="text-lg mt-2" id="weekly-target">Aim for ~72 touches this week</p>
                </div>
                <div class="text-6xl">üèÜ</div>
            </div>
        </div>
<div class="text-center my-12">
    <button id="edit-setup-btn" class="w-full max-w-2xl mx-auto bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl">
        <i class="fas fa-eye mr-3"></i> View/Change Plan Details
    </button>
</div>
        <!-- Generate Button (ID added, onclick removed, full gradient for perfect match) -->
        <div class="text-center my-12">
            <button id="generate-win-plan-btn" class="w-full max-w-2xl mx-auto bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl">
    <i class="fas fa-bolt-lightning mr-4 text-3xl"></i> Build My Personalized Win Plan
</button>
        </div>

        <!-- Weekly Task Cards -->
        <div id="weekly-tasks-container" class="space-y-12 hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                <!-- Tasks injected by JS -->
            </div>

            <!-- Progress Summary -->
            <div class="mt-20 text-center">
                <p class="text-4xl font-bold mb-8">
                    <span id="tasks-completed">0</span> / <span id="tasks-total">0</span> Tasks Complete
                </p>
                <div class="w-full max-w-3xl mx-auto bg-gray-800 rounded-full h-10 overflow-hidden shadow-2xl">
                    <div id="weekly-progress-bar" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] h-full w-0 transition-all duration-1000 rounded-full"></div>
                </div>
                <p class="text-3xl mt-10" id="completion-message">Keep going ‚Äî you're building momentum!</p>
            </div>
        </div>

        <!-- Confetti Canvas -->
        <canvas id="confetti-canvas" class="fixed inset-0 pointer-events-none z-50 hidden"></canvas>

        <!-- Task Help Modal -->
        <div id="task-help-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
            <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-10 max-w-2xl shadow-2xl border border-[#00A89D]/50">
                <h3 class="text-3xl font-bold text-[#F15A29] mb-6" id="task-help-title">Task Help</h3>
                <div id="task-help-content" class="text-lg text-gray-200 space-y-4"></div>
                <div class="text-center mt-10">
                    <button onclick="closeTaskHelp()" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-4 rounded-full hover:opacity-90 transition-all font-bold text-xl shadow-2xl">
                        Got It ‚Äî Back to Winning
                    </button>
                </div>
            </div>
        </div>
    </div>

   <div id="setup-wizard" class="fixed inset-0 bg-black/90 z-50 flex items-center justify-center hidden">
    <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 md:p-12 max-w-4xl w-full mx-4 shadow-2xl border border-[#00A89D]/50 max-h-[95vh] overflow-y-auto">
        
        <h3 class="text-4xl md:text-5xl font-bold text-[#FF6B35] dark:text-[#FF6B35] text-center mb-6">Your Personalized Setup ‚ö°</h3>
<p class="text-lg md:text-xl font-semibold text-[#00A89D] text-center mb-12 max-w-3xl mx-auto">
    The more you share (all optional except goal), the smarter your weekly plan becomes ‚Äî perfectly balanced with your production, schedule, and passions.
</p>

<!-- Form Fields Row (replace your existing name/goal inputs with this structure) -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
    <div>
        <label class="block text-xl font-semibold text-[#00A89D] mb-4 flex items-center">
            <i class="fas fa-user mr-3 text-[#F15A29]"></i> Your Name (for motivation)
        </label>
        <input type="text" id="setup-name" value="Adam" placeholder="Your name" 
               class="w-full p-5 rounded-2xl bg-white dark:bg-gray-900/90 border-2 border-[#00A89D] text-gray-900 dark:text-white text-lg focus:outline-none focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all">
    </div>
    <div>
        <label class="block text-xl font-semibold text-[#00A89D] mb-4 flex items-center">
            <i class="fas fa-trophy mr-3 text-[#F15A29]"></i> Monthly Funded Loan Goal
        </label>
        <input type="number" id="setup-monthly-goal" value="10" min="1" placeholder="e.g., 10"
               class="w-full p-5 rounded-2xl bg-white dark:bg-gray-900/90 border-2 border-[#00A89D] text-gray-900 dark:text-white text-lg focus:outline-none focus:ring-4 focus:ring-[#F15A29]/50 focus:border-[#F15A29] transition-all">
    </div>
</div>

            <!-- Row 2: Production & Database (3 columns, even) -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4">Last Month's Funded Loans</label>
                    <input type="number" id="setup-last-month" min="0" placeholder="Optional" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4"># Active Referral Partners ü§ù</label>
                    <input type="number" id="setup-partners" min="0" placeholder="Optional" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4">Number of Past Clients üè°</label>
                    <input type="number" id="setup-past-clients" min="0" placeholder="Optional" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                </div>
            </div>

            <!-- Row 3: Schedule & Focus -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4 flex items-center">
                        <i class="fas fa-clock mr-3"></i> Weekly Prospecting Hours Available
                    </label>
                    <select id="setup-hours" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                        <option>Less than 10</option>
                        <option>10‚Äì15</option>
                        <option selected>15‚Äì20 (recommended)</option>
                        <option>20+</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xl md:text-2xl font-semibold text-[#00A89D] mb-4">Preferred Prospecting Focus (optional)</label>
                    <select id="setup-focus" class="w-full p-5 rounded-2xl bg-gray-800/80 border-2 border-[#00A89D] text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all">
                        <option>Balanced (Realtors + Past Clients + Equity)</option>
                        <option>Heavy Realtor Partnerships</option>
                        <option>Past Client Refi Focus</option>
                        <option>Equity Scanner Leads</option>
                    </select>
                </div>
            </div>

            <!-- Hobbies Section -->
            <div>
    <label class="block text-2xl font-bold text-[#00A89D] mb-6 flex items-center">
        <i class="fas fa-heart mr-4 text-[#F15A29]"></i> Your Passions & Hobbies (weave into plan for balance & better connections)
    </label>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Golf" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Golf</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Cards/Poker" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Cards/Poker</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Sports" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Sports</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Crafts" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Crafts</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Family Time" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Family Time</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Outdoors" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Outdoors</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Fitness" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Fitness</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Cooking" class="hobby-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Cooking</span>
        </label>
    </div>
    <input type="text" id="setup-hobbies-other" placeholder="Other passions (e.g., pedicures, wine tasting, travel)" 
           class="w-full p-5 rounded-2xl bg-white dark:bg-gray-800/80 border-2 border-gray-300 dark:border-[#00A89D] text-gray-900 dark:text-white text-lg focus:ring-4 focus:ring-[#F15A29]/50 transition-all placeholder-gray-500 dark:placeholder-gray-400">
</div>

<!-- Preferred Prospecting Activities Section -->
<div>
    <label class="block text-2xl font-bold text-[#00A89D] mb-6 flex items-center">
        <i class="fas fa-bullhorn mr-4 text-[#F15A29]"></i> Preferred Prospecting Activities (check all you enjoy ‚Äî we'll prioritize these)
    </label>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Coffee/Drink Appointments" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Coffee or Drink Appointments ‚òï</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Lunch Appointments" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Lunch Appointments üç¥</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Lunch and Learns" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Hosting Lunch & Learns üìä</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Personal Notes/Cards" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Writing Personal Notes/Cards ‚úçÔ∏è</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Social Media Videos" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Creating Social Media Videos üìπ</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Phone Calls" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Making Phone Calls ‚òéÔ∏è</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Deliveries" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Delivering Pop-By Gifts</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Networking Events" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Attending Networking Events ü§ù</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Video Messages" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Sending Video Messages üé•</span>
        </label>
        <label class="flex items-center gap-4 text-lg bg-white dark:bg-gray-800/50 p-5 rounded-2xl hover:bg-gray-100 dark:hover:bg-gray-700/70 transition-all cursor-pointer">
            <input type="checkbox" value="Email Campaigns" class="activity-checkbox w-7 h-7 text-[#F15A29] rounded focus:ring-[#00A89D]">
            <span class="text-gray-900 dark:text-gray-100">Sending Value Emails üìß</span>
        </label>
    </div>
</div>
        <div class="text-center mt-16">
            <button id="save-setup-btn" class="w-full bg-gradient-to-r from-[#00A89D] to-[#F15A29] text-white py-6 rounded-full hover:opacity-90 transition-all font-bold text-2xl shadow-2xl flex items-center justify-center">
    <i class="fas fa-rocket mr-4 text-3xl"></i> Save Preferences
</button>
        </div>
    </div>
</div>
      
</main>
    <script>
// Menu toggle
document.getElementById('menu-toggle').addEventListener('click', () => {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('left-0');
    sidebar.classList.toggle('left-[-300px]');
    sidebar.classList.toggle('open');
});

// Single Quote Display with Manual Arrows & Auto-Rotation
const quotes = [
    "The harder you work, the luckier you get.",
    "Your next loan is one call away.",
    "Success is rented, and the rent is due every day.",
    "Every ‚Äúno‚Äù brings you closer to a ‚Äúyes.‚Äù",
    "You don‚Äôt have to be great to start, but you have to start to be great.",
    "Turn obstacles into opportunities.",
    "Be so good they can‚Äôt ignore you.",
    "Hustle beats talent when talent doesn‚Äôt hustle.",
    "Make someone‚Äôs dream come true today!",
    "Doubt kills more dreams than failure ever will.",
    "The best way to predict the future is to create it.",
    "Winners never quit, and quitters never win.",
    "Your only limit is you.",
    "Small steps today, big wins tomorrow.",
    "Stay positive, work hard, make it happen.",
    "Dream big. Work hard. Stay focused.",
    "You‚Äôre one decision away from a totally different life.",
    "Good things come to those who hustle.",
    "Don‚Äôt wait for opportunity‚Äîcreate it.",
    "Believe you can and you‚Äôre halfway there.",
    "Push yourself because no one else is going to do it for you.",
    "Great things never come from comfort zones.",
    "Rise up and attack the day with enthusiasm.",
    "Turn ‚ÄúI wish‚Äù into ‚ÄúI will.‚Äù",
    "Make today count.",
    "Your future is created by what you do today.",
    "Excuses don‚Äôt build empires.",
    "Stay hungry, stay humble, keep working.",
    "The harder the battle, the sweeter the victory.",
    "You miss 100% of the shots you don‚Äôt take.",
    "Do something today your future self will thank you for.",
    "Success is the sum of small efforts repeated daily.",
    "Be the energy you want to attract.",
    "Fall seven times, stand up eight.",
    "Prove them wrong.",
    "Today‚Äôs grind = tomorrow‚Äôs shine.",
    "Limits exist only in the mind.",
    "Keep going‚Äîyou‚Äôre closer than you think.",
    "One closed loan can change everything.",
    "Discipline is choosing between what you want now and what you want most.",
    "Wake up with purpose, go to bed with satisfaction.",
    "Don‚Äôt stop when you‚Äôre tired‚Äîstop when you‚Äôre done.",
    "The comeback is always stronger than the setback.",
    "You were born to win.",
    "Make it happen. Shock everyone.",
    "Every call counts. Make each one great.",
    "Loans don‚Äôt find themselves‚Äîgo get yours.",
    "Your pipeline is your paycheck. Fill it.",
    "Close the day strong.",
    "Borrowers are waiting‚Äîbe their hero today.",
    "Momentum is built one ‚Äúyes‚Äù at a time.",
    "Outwork yesterday‚Äôs you.",
    "Average effort = average results. Be extraordinary.",
    "Grind now, glow later.",
    "The best loan officers don‚Äôt wait for the phone to ring.",
    "Confidence closes.",
    "Every ‚ÄúI‚Äôll think about it‚Äù is a future ‚ÄúWhere do I sign?‚Äù",
    "Pressure makes diamonds‚Äîthrive in it.",
    "Your next record-breaking month starts today.",
    "Stop wishing, start closing.",
    "Be the lender they brag about to their friends.",
    "One more call could change your year.",
    "Today‚Äôs effort = tomorrow‚Äôs commission check.",
    "Borrowers don‚Äôt care how much you know until they know how much you care.",
    "Speed + service = unstoppable.",
    "You‚Äôve survived 100% of your worst days so far. Keep going.",
    "The magic you‚Äôre looking for is in the work you‚Äôre avoiding.",
    "Build relationships, not just files.",
    "Done is better than perfect.",
    "Lead with value, close with ease.",
    "Turn ‚ÄúI can‚Äôt afford it‚Äù into ‚ÄúHow do I make this happen?‚Äù",
    "Make today so awesome yesterday gets jealous.",
    "The only bad call is the one you didn‚Äôt make.",
    "If you don‚Äôt own the day, the day owns you.",
    "Borrowers remember how you made them feel‚Äîmake it amazing.",
    "Keep swinging‚Äîthe home runs are coming.",
    "Success is a decision away. Decide now.",
    "Go out there and make someone‚Äôs dream happen.",
    "Be intentional with your hours or someone else will be.",
    "Small, consistent actions compound into massive results.",
    "Intentional effort today, dividends paid tomorrow.",
    "Winners are just people who stayed consistent when no one was watching.",
    "Show up on purpose‚Äîevery single day.",
    "Consistency turns average loan officers into top producers.",
    "Intentional mornings create unstoppable months.",
    "Do the boring work consistently and the results will come.",
    "Consistency is louder than motivation ever will be.",
    "The loan you close tomorrow was built by what you did today‚Äîand yesterday.",
    "Consistent follow-up turns ‚Äúmaybe‚Äù into ‚Äúmoney.‚Äù",
    "Intentional loan officers don‚Äôt wait for leads‚Äîthey create them.",
    "Success loves preparation. Be consistent in yours.",
    "Consistency compounds faster than interest rates.",
    "The difference between good and great is one more intentional call.",
    "Consistency is the bridge between leads and legacy.",
    "Intentional effort feels like work; consistent effort feels like winning.",
    "Show up, suit up, follow up‚Äîevery single day.",
    "Intentionality today keeps regret away tomorrow.",
    "Consistency isn‚Äôt sexy until you see the scoreboard.",
    "Be relentlessly intentional about the activities that pay.",
    "Consistency is the silent closer that never takes a day off"
];

let currentQuoteIndex = Math.floor(Math.random() * quotes.length);
const quoteDisplay = document.getElementById('quote-display');
const quotePrev = document.getElementById('quote-prev');
const quoteNext = document.getElementById('quote-next');

function showQuote(index) {
    if (!quoteDisplay) return;
    quoteDisplay.classList.add('fade');
    setTimeout(() => {
        quoteDisplay.textContent = quotes[index];
        quoteDisplay.classList.remove('fade');
    }, 400);
}

if (quoteDisplay) {
    showQuote(currentQuoteIndex);

    setInterval(() => {
        currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
        showQuote(currentQuoteIndex);
    }, 12500);

    if (quotePrev) {
        quotePrev.addEventListener('click', () => {
            currentQuoteIndex = (currentQuoteIndex - 1 + quotes.length) % quotes.length;
            showQuote(currentQuoteIndex);
        });
    }

    if (quoteNext) {
        quoteNext.addEventListener('click', () => {
            currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
            showQuote(currentQuoteIndex);
        });
    }
}

// Activities (full)
const activities = {
    daily: ["Write two personal notes or thank-you cards to clients, referral partners, or prospects.", "Make at least five outbound calls to past clients or referral partners.", "Send personalized birthday messages using video to your past clients.", "Engage on social media by commenting on or liking 10 posts from realtors, clients, and referral partners.", "Record and post one short-form video or story about mortgage tips, market updates, or client success stories.", "Follow up with any new online or social media leads received in the past 24 hours.", "Reach out to a past client just to check in‚Äîno sales pitch, just relationship-building.", "Send a text or video message to a referral partner to stay top of mind.", "Knock on one local business door to introduce yourself (title companies, insurance agents, CPAs, etc.).", "Spend time reviewing and updating CRM with notes, follow-ups, and next actions."],
    weekly: ["Pipeline review with referral partners‚Äîdiscuss upcoming deals and potential new clients.", "Pipeline review with active clients‚Äîtouch base with a weekly update, even if nothing new.", "Host a 15-minute coaching call (Zoom or Teams) for realtors on mortgage trends or strategies.", "Attend at least one networking event (chamber of commerce, BNI, or real estate meetup).", "Send a ‚ÄúWho do you know?‚Äù text to 5+ referral partners asking for warm introductions.", "Create and send a value-packed email to your database (market updates, home tips, etc.).", "Record and send a personalized video email to new leads or referral partners.", "Reach out to 3 new real estate agents via social media or in person.", "Host a casual coffee meeting with a referral partner or past client.", "Review past closed loans and follow up with clients who may benefit from refinancing."],
    monthly: ["Deliver pop-by gifts to your top 10 referral partners or your A+ past clients.", "Host an Ask YOUR Lender Zoom call for realtors and referral partners.", "Host a first-time homebuyer seminar (online or in person).", "Send out handwritten birthday and anniversary cards to past clients.", "Record and post a long-form video covering a trending mortgage topic.", "Partner with a real estate agent for a co-branded marketing campaign.", "Run a targeted Facebook or Instagram ad to generate leads.", "Check in on past pre-approved clients who haven‚Äôt bought yet.", "Attend a local community event and network with homeowners and business owners.", "Review and update your Google Business Profile with new content and reviews."],
    quarterly: ["Host a Lunch & Learn for real estate agents and referral partners.", "Run a local market update webinar for homebuyers and realtors.", "Send a personalized video message to past clients about market trends.", "Organize a Realtor Mastermind event to discuss business growth strategies.", "Sponsor a local event or charity drive to gain visibility in the community.", "Mail out a homeowner equity review letter to past clients.", "Host a networking happy hour for realtors, attorneys, and financial planners.", "Run a contest or giveaway for clients and referral partners.", "Send a direct mail campaign targeting renters or move-up buyers.", "Set up a strategy session with a key referral partner to refine your co-marketing plan."],
    yearly: ["Host a Client Appreciation Party for past clients and referral partners.", "Review and optimize your annual marketing plan and business goals.", "Plan and execute a major branding campaign (e.g., billboards, radio ads, podcast sponsorship).", "Attend at least one national or regional mortgage conference for networking and education.", "Run a VIP dinner for your top referral partners. (Great around the holidays)", "Organize a major community service project under your brand.", "Launch an exclusive mastermind group for elite real estate agents.", "Record a professional brand video to use in marketing.", "Schedule a business planning retreat to evaluate and set goals for the next year.", "Build and refresh your contact database, ensuring all referral partners and clients are engaged."]
};

// Generate time block
function generateTimeBlock() {
    const freq = document.getElementById('frequency').value.toLowerCase();
    const list = activities[freq].map(act => `<li class="mb-2">${act}</li>`).join('');
    document.getElementById('time-block-output').innerHTML = `<h4 class="text-2xl font-medium mb-4 capitalize text-[#00A89D]">${freq} Schedule</h4><ul class="space-y-2">${list}</ul>`;
}
function showSection(id) {
    // Hide all sections
    document.querySelectorAll('main section').forEach(sec => {
        sec.classList.add('hidden');
    });

    // Show target section (with safety check)
    const target = document.getElementById(id);
    if (target) {
        target.classList.remove('hidden');
        target.scrollIntoView({ behavior: 'smooth' });
    } else {
        console.warn(`Section with ID "${id}" not found`);
    }

    // Close mobile sidebar (toggle class for reliability)
    const sidebar = document.getElementById('sidebar');
    if (sidebar) {
        sidebar.classList.add('left-[-300px]');  // Or toggle if you prefer: sidebar.classList.toggle('left-[-300px]', true);
        
        // Optional: Reset hamburger state if you have an open class
        // document.getElementById('menu-toggle')?.classList.remove('open');
    }

    // Optional: Highlight active sidebar item (add .active class to your sidebar CSS for bg/color)
    document.querySelectorAll('.sidebar-item').forEach(item => {
        item.classList.remove('active');
    });
    document.querySelector(`[onclick="showSection('${id}')"]`)?.classList.add('active');
}
// Cycle activities
function cycleActivities() {
    const freq = document.getElementById('frequency').value.toLowerCase();
    const shuffled = [...activities[freq]].sort(() => 0.5 - Math.random());
    const selection = shuffled.slice(0, Math.floor(Math.random() * 6) + 5);
    const list = selection.map(act => `<li class="mb-2">${act}</li>`).join('');
    document.getElementById('time-block-output').innerHTML = `<h4 class="text-2xl font-medium mb-4 capitalize text-[#00A89D]">Cycled ${freq} Ideas</h4><ul class="space-y-2">${list}</ul>`;
}

async function generateSalesScript() {
    const loading = document.getElementById('script-loading');
    const output = document.getElementById('script-output');
    if (loading) loading.classList.remove('hidden');
    if (output) {
        output.innerHTML = '';
        output.classList.add('hidden');
    }

    // Get scenario
    const select = document.getElementById('script-scenario-select');
    const custom = document.getElementById('custom-scenario');
    const context = document.getElementById('script-context')?.value.trim() || '';

    let scenario = select.value;
    if (scenario === ' ' || !scenario) scenario = custom.value.trim();

    if (!scenario) {
        alert('Please select or type a scenario');
        if (loading) loading.classList.add('hidden');
        return;
    }

    const prompt = `You are an expert real estate communication coach helping realtors build better relationships.

Generate exactly 4 varied, natural scripts for this situation:

Situation: "${scenario}"

${context ? `Additional context: ${context}` : ''}

Requirements for each script:
- 3‚Äì6 sentences long
- Warm, curious, helpful ‚Äî never salesy or pushy
- Use open-ended questions
- Include a soft next step
- End with a gentle call-to-action
- Tone: Friendly, relatable, professional, trustworthy

CRITICAL FORMATTING:
- Start each with ## **Script 1** (bold header), ## **Script 2**, etc.
- Start each script with "## Script 1", "## Script 2", etc.
- Use **bold** for light emphasis where it feels natural
- Use - bullet points when listing questions, benefits, or ideas
- Separate paragraphs with a blank line
- Do NOT use code blocks

Focus on building connection and trust ‚Äî not closing the deal.`;

    let renderedHTML = '';

    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [{ role: "user", content: prompt }],
                temperature: 0.8,
                max_tokens: 1400
            })
        });

        if (!response.ok) throw new Error('API failed');

        const data = await response.json();
        const raw = data.choices[0].message.content.trim();

        renderedHTML = marked.parse(raw);

    } catch (err) {
        console.error(err);
        renderedHTML = `<p class="text-red-600 text-center py-20 text-xl">API unavailable locally ‚Äî normal for offline testing.</p>`;
    } finally {
        if (loading) loading.classList.add('hidden');

        if (output) {
            output.innerHTML = `
                <div class="prose prose-lg dark:prose-invert max-w-none mb-12">
                    ${renderedHTML}
                </div>
                <div class="text-center">
                    <button onclick="copySalesScripts()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                        üìã Copy All Scripts
                    </button>
                </div>
            `;
            output.classList.remove('hidden');
            output.scrollIntoView({ behavior: 'smooth' });
        }

        if (typeof confetti === 'function') {
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        }
    }
}

function copySalesScripts() {
    const proseDiv = document.querySelector('#script-output .prose');
    if (!proseDiv) return;

    // Get clean text (strip HTML, preserve line breaks)
    const temp = document.createElement('div');
    temp.innerHTML = proseDiv.innerHTML;

    // Remove the numbered circles for cleaner copy
    const circles = temp.querySelectorAll('.w-14.h-14.rounded-full');
    circles.forEach(el => el.remove());

    const text = temp.innerText || temp.textContent || '';
    navigator.clipboard.writeText(text).then(() => {
        alert('All scripts copied to clipboard!');
    });
}
// Accordion toggle
function toggleAccordion(button) {
    const content = button.nextElementSibling;
    content.classList.toggle('open');
}

// Show section on nav click
document.querySelectorAll('#sidebar a').forEach(link => {
    link.addEventListener('click', (e) => {
        e.preventDefault();
        document.querySelectorAll('section').forEach(sec => sec.classList.add('hidden'));
        const target = document.querySelector(link.getAttribute('href'));
        target.classList.remove('hidden');
        document.getElementById('sidebar').classList.remove('left-0');
        document.getElementById('sidebar').classList.add('left-[-300px]');
        document.getElementById('sidebar').classList.remove('open');
        // Reset accordions
        target.querySelectorAll('.accordion-content').forEach(content => content.classList.remove('open'));
    });
});
// Auto-fill custom textarea when selecting from dropdown (but allow override)
document.getElementById('script-scenario-select').addEventListener('change', function() {
    const selected = this.value;
    if (selected) {
        document.getElementById('custom-scenario').value = selected;
    } else {
        document.getElementById('custom-scenario').value = ''; // Reset to custom when "Use Custom" selected
    }
});

async function generateSocialPost() {
    const type = document.getElementById('post-type').value;
    const details = document.getElementById('post-details').value.trim();
    const loading = document.getElementById('social-loading');
    const output = document.getElementById('social-output');
    loading.classList.remove('hidden');
    output.classList.add('hidden');
    output.innerHTML = '';
    let prompt = `Create a ready-to-post social media caption for a mortgage loan officer.
Post type/goal: ${type === 'custom' ? 'Custom idea' : type.replace('-', ' ')}
${details ? `Specific details/idea: ${details}` : ''}
Requirements:
- Warm, authentic, relationship-focused
- Engaging and conversational
- Never salesy ‚Äî focus on value and trust
- Include relevant emojis
- End with subtle CTA (question, "Comment below", "DM me", "Tag a friend")
- Add 8‚Äì10 relevant hashtags at the end
Make it feel like it comes from a trusted friend who happens to be a mortgage expert.`;
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [{ role: "user", content: prompt }],
                temperature: 0.7,
                max_tokens: 800
            })
        });
        if (!response.ok) throw new Error('API error');
        const data = await response.json();
        const post = data.choices[0].message.content.trim();
        output.innerHTML = `
            <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
                ${marked.parse(post)}
            </div>
            <div class="text-center">
                <button onclick="copySocialPost()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                    üìã Copy Post to Clipboard
                </button>
            </div>
        `;
        output.classList.remove('hidden');
    } catch (error) {
        output.innerHTML = '<p class="text-red-600 text-center py-20">Error generating post. Check console or try again.</p>';
        output.classList.remove('hidden');
    } finally {
        loading.classList.add('hidden');
    }
}
function copySocialPost() {
    const text = document.querySelector('#social-output .prose')?.innerText || '';
    navigator.clipboard.writeText(text).then(() => alert('Post copied!'));
}
function showSocialPostCreator() {
    // Hide all sections
    document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
   
    // Show the AI post creator
    const target = document.getElementById('social-post');
    if (target) {
        target.classList.remove('hidden');
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
       
        // Close mobile sidebar
        document.getElementById('sidebar').classList.add('left-[-300px]');
    } else {
        console.error("Social Post Creator section (#social-post) not found!");
    }
}
// Dynamic helper text and placeholder for post details
// Dynamic helper/placeholder for post details based on selected type
document.getElementById('post-type').addEventListener('change', function() {
    const type = this.value;
    const helper = document.getElementById('details-helper');
    const textarea = document.getElementById('post-details');
    let helperText = '';
    let placeholder = '';
    switch(type) {
        case 'educational':
            helperText = "e.g., Explain rate buydowns, credit tips, or down payment myths";
            placeholder = "e.g., How temporary rate buydowns can lower payments for the first 2 years";
            break;
        case 'local':
            helperText = "e.g., Local event, favorite business, community story";
            placeholder = "e.g., Loved the holiday lights downtown last night!";
            break;
        case 'personal':
            helperText = "e.g., Family updates, hobbies, behind-the-scenes";
            placeholder = "e.g., Weekend hiking with the family ‚Äî nature recharge!";
            break;
        case 'client-win':
        case 'just-closed':
        case 'client-story':
            helperText = "e.g., Client challenge overcome (keep anonymous or with permission)";
            placeholder = "e.g., Helped a first-time buyer close despite credit challenges";
            break;
        case 'market':
        case 'market-update':
            helperText = "e.g., Local stats, rate trends, inventory insight";
            placeholder = "e.g., Inventory up 12% locally ‚Äî great time for buyers!";
            break;
        case 'reel':
            helperText = "e.g., Fun skit, day-in-the-life, myth-bust idea";
            placeholder = "e.g., 'Marry the house, date the rate' wedding skit";
            break;
        case 'engagement':
            helperText = "e.g., Poll or question to spark comments";
            placeholder = "e.g., Rent forever or own your home? Vote!";
            break;
        case 'value':
            helperText = "e.g., Free resource you're giving away";
            placeholder = "e.g., Sharing my 2026 Home Buyer Checklist ‚Äî link in bio";
            break;
        case 'rate-myth':
            helperText = "e.g., Common rate misconception";
            placeholder = "e.g., 'You need 20% down' ‚Äî here's the truth";
            break;
        case 'holiday':
            helperText = "e.g., Holiday tradition or seasonal tie-in";
            placeholder = "e.g., Favorite holiday recipe from our family";
            break;
        case 'realtor-value':
            helperText = "e.g., Tool or support for realtor partners";
            placeholder = "e.g., New co-branded open house flyer ready!";
            break;
        case 'motivational':
            helperText = "e.g., Inspirational message or quote";
            placeholder = "e.g., 'Your dream home is worth the effort'";
            break;
        case 'fun':
            helperText = "e.g., Relatable humor or light moment";
            placeholder = "e.g., When rates drop and everyone calls at once...";
            break;
        case 'referral-ask':
            helperText = "e.g., Soft way to ask for referrals";
            placeholder = "e.g., Know someone thinking about moving? Happy to help";
            break;
        case 'local-spotlight':
            helperText = "e.g., Local business or community feature";
            placeholder = "e.g., Shoutout to [Local Bakery] ‚Äî best donuts in town!";
            break;
        default:
            helperText = "e.g., Describe what you'd like the post to say";
            placeholder = "e.g., Tell me your idea and I'll craft it";
    }
    helper.textContent = helperText;
    textarea.placeholder = placeholder;
});
// Modal functions
function openModal(category) {
    document.getElementById('modal-title').innerText = category;
    document.getElementById('modal-suggestions').innerHTML = getSuggestions(category);
    document.getElementById('post-modal').style.display = 'block';
}
function closeModal() {
    document.getElementById('post-modal').style.display = 'none';
}
// Click outside modal to close
window.onclick = function(event) {
    const modal = document.getElementById('post-modal');
    if (event.target === modal) {
        closeModal();
    }
}
function getSuggestions(category) {
    const suggestions = {
        "Educational": [
            "Myth-bust a common mortgage misconception (e.g., 'You need 20% down')",
            "Explain the difference between pre-qualification and pre-approval",
            "Share '5 costs to expect when buying a home'",
            "Break down how interest rates are determined",
            "Post a quick tip on improving credit score before applying",
            "Explain escrow and why it matters",
            "Share the benefits of a 15-year vs 30-year mortgage",
            "Talk about current FHA or VA loan advantages",
            "Demystify closing costs with a simple infographic idea",
            "Highlight red flags to watch for in a loan estimate"
        ],
        "Local": [
            "Spotlight a local small business or restaurant",
            "Share an upcoming community event or festival",
            "Post about a neighborhood market update or new development",
            "Celebrate a local school's achievement or sports win",
            "Recommend a hidden gem park or trail in the area",
            "Talk about seasonal local activities (e.g., holiday lights tour)",
            "Shout out a local charity or volunteer opportunity",
            "Share fun facts about your city's history",
            "Highlight a new local shop opening",
            "Post about farmers market or seasonal produce tips"
        ],
        "Personal": [
            "Behind-the-scenes of your day (e.g., 'Coffee run before approvals')",
            "Share a non-work hobby or weekend activity",
            "Post a family-friendly outing you enjoyed (with permission)",
            "Talk about a book/podcast you're loving right now",
            "Share your morning routine for staying productive",
            "Celebrate a personal milestone (e.g., years in the industry)",
            "Post a fun 'day in the life' reel",
            "Share what you're grateful for this week",
            "Talk about a lesson learned from a recent challenge",
            "Show your workspace or home office setup"
        ],
        "Client Wins": [
            "'Just helped another family into their dream home!' (with permission/photo)",
            "Share a client testimonial or success story",
            "Celebrate a 'Just Closed' with balloons or keys photo",
            "Post about overcoming a tough approval for a client",
            "Highlight a first-time buyer closing milestone",
            "Share 'From pre-approval to keys in hand' timeline",
            "Celebrate a refinance that saved a client money",
            "Post a fun closing table photo or signing moment",
            "Talk about helping a client buy in a competitive market",
            "Share an anonymous win: 'Helped a family lower their rate by X%'"
        ],
        "Value": [
            "Free downloadable homebuyer checklist",
            "Share a 'First-time buyer guide' link or PDF",
            "Post a mortgage calculator tip or tool",
            "Offer a free credit review or consultation",
            "Share a seasonal home maintenance checklist",
            "Provide a 'Questions to ask your lender' list",
            "Post a refinance breakeven calculator explanation",
            "Share a budget worksheet for homebuyers",
            "Offer a 'Moving checklist' resource",
            "Give away a local vendor list for new homeowners"
        ],
        "Engagement": [
            "Poll: 'What's your dream home feature?'",
            "This or That: 'Beach house or mountain cabin?'",
            "Tag a friend who needs to see this rate tip",
            "Question: 'What's stopping you from buying right now?'",
            "Poll: 'Rent or own ‚Äî what's your plan?'",
            "Ask: 'What's your favorite part of homeownership?'",
            "Tag a friend you'd love to help buy a home",
            "Question: 'How long have you lived in your current home?'",
            "Poll: 'Fixer-upper or move-in ready?'",
            "Ask followers to share their home buying stories"
        ]
    };
    return suggestions[category].map(s => `<li>${s}</li>`).join('');
}
</script>
<script>
    async function generatePlan() {
    const loading = document.getElementById('plan-loading');
    if (loading) loading.classList.remove('hidden');

    const style = document.querySelector('input[name="plan-style"]:checked')?.value || 'Balanced Growth';

    const inputs = {
        income: document.getElementById('target-income')?.value || '',
        commission: document.getElementById('avg-commission')?.value || '',
        closings: document.getElementById('target-closings')?.value || '',
        loanAmount: document.getElementById('avg-loan')?.value || '',
        ratio: document.getElementById('closing-ratio')?.value || '',
        currentPartners: document.getElementById('current-partners')?.value || '',
        newPartners: document.getElementById('new-partners')?.value || '',
        database: document.getElementById('database-size')?.value || ''
    };

    // === FIX: Collect Hobbies & Activities Lists ===
    const hobbiesList = Array.from(document.querySelectorAll('.hobby-checkbox:checked'))
                             .map(cb => cb.nextElementSibling.textContent.trim());  // Gets label text (e.g., "Golf")

    const activitiesList = Array.from(document.querySelectorAll('.activity-checkbox:checked'))
                               .map(cb => cb.nextElementSibling.textContent.trim());  // Gets label text (e.g., "Pop-By Gifts üéÅ")

    const hobbyOther = document.getElementById('hobby-other')?.value || '';

    // Quick client-side calc (unchanged)
    let closings = parseFloat(inputs.closings) || 60;
    const commission = parseFloat(inputs.commission) || 6500;
    if (inputs.income) closings = Math.ceil(parseFloat(inputs.income) / commission);

    const volume = closings * (parseFloat(inputs.loanAmount) || 400000);
    const ratio = (parseFloat(inputs.ratio) || 30) / 100;
    const referrals = Math.ceil(closings / ratio);

    // Show snapshot immediately
    const output = document.getElementById('plan-output');
    if (output) {
        output.innerHTML = `
            <div class="bg-gray-50 dark:bg-gray-900 p-10 rounded-3xl mb-8">
                <h3 class="text-2xl font-bold mb-6 text-[#F15A29]">Quick Snapshot (Full Plan Coming...)</h3>
                <ul class="space-y-3 text-lg">
                    <li><strong>Target Closings:</strong> ${closings}</li>
                    <li><strong>Target Volume:</strong> $${volume.toLocaleString()}</li>
                    <li><strong>Referrals/Leads Needed:</strong> ~${referrals}</li>
                </ul>
            </div>
        `;
        output.classList.remove('hidden');
        output.scrollIntoView({ behavior: 'smooth' });
    }

    let fullPlan = '';

    try {
        const prompt = `You are an expert mortgage sales coach. Create a detailed, motivational 2026 business plan for a loan officer.

Plan Style: ${style}

User Inputs (use defaults where blank - avg commission $6500, loan $400k, 30% close ratio):
- Target Income: ${inputs.income || 'calculated from closings'}
- Avg Commission: ${inputs.commission || '6500'}
- Target Closings: ${inputs.closings || 'calculated'}
- Avg Loan: ${inputs.loanAmount || '400000'}
- Close Ratio: ${inputs.ratio || '30'}%
- Current Partners: ${inputs.currentPartners || 'default'}
- New Partners Goal: ${inputs.newPartners || 'default'}
- Database Size: ${inputs.database || 'default'}
- Hobbies/Passions: ${hobbiesList.join(', ') || 'none shared'} ${hobbyOther}
- Preferred Prospecting Activities: ${activitiesList.join(', ') || 'balanced mix'}

Structure the plan:
1. Executive Summary with key numbers (closings, volume, income, weekly activities)
2. Focus Areas based on style (e.g., Referral Mastery = partner growth strategies)
3. Monthly/Quarterly Milestones
4. Weekly Scorecard Targets
5. Specific Tactics: Pop-bys (ideas), events, objection handlers, database touches, social video ideas
6. Accountability Tips & Motivation

Make it actionable, encouraging, and tied to value-first relationship building. Use clean markdown with headers, bullets, bold for emphasis.`;

           const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                    messages: [{ role: "user", content: prompt }],
                    temperature: 0.7,
                    max_tokens: 2000
                })
            });

            if (!response.ok) throw new Error();

        const data = await response.json();
        fullPlan = marked.parse(data.choices[0].message.content.trim());

    } catch (error) {
        fullPlan = `<p class="text-red-600">API unavailable ‚Äî using snapshot above.</p>`;
    } finally {
        if (loading) loading.classList.add('hidden');

        if (output) {
            output.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-12">
                    <div class="flex justify-between items-center mb-8 flex-wrap gap-4">
                        <h3 class="text-3xl font-bold text-[#F15A29]">Your Custom 2026 Business Plan ‚ú®</h3>
                        <div class="flex gap-4 flex-wrap">
                            <button onclick="copyPlanFormatted()" class="bg-[#002B5C] hover:bg-[#001429] text-white px-6 py-3 rounded-full font-bold">Copy Formatted (for Word)</button>
                            <button onclick="downloadPlanWord()" class="bg-[#F15A29] hover:bg-orange-600 text-white px-6 py-3 rounded-full font-bold">Download Word Doc</button>
                        </div>
                    </div>
                    <div id="plan-preview" class="prose prose-lg dark:prose-invert max-w-none">
                        ${fullPlan}
                    </div>
                </div>
            `;
        }

        if (typeof confetti === 'function') confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
    }
}

// Listener (safe)
document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('generate-plan-btn')?.addEventListener('click', generatePlan);
});

// Copy & Download (rich formatting + Word)
function copyPlanFormatted() {
    const preview = document.getElementById('plan-preview');
    if (!preview) return;

    const range = document.createRange();
    range.selectNode(preview);
    window.getSelection().removeAllRanges();
    window.getSelection().addRange(range);

    try {
        document.execCommand('copy');
        alert('Formatted plan copied! Paste into Word.');
    } catch (err) {
        alert('Copy failed ‚Äî select text manually.');
    }

    window.getSelection().removeAllRanges();
}

function downloadPlanWord() {
    const preview = document.getElementById('plan-preview');
    if (!preview) return;

    const header = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>2026 Business Plan</title><style>body{font-family:Calibri,Arial,sans-serif;margin:40px;line-height:1.6;color:#000;}h1{color:#002B5C;text-align:center;}h2{color:#00A89D;border-bottom:2px solid #00A89D;padding-bottom:8px;}ul{padding-left:30px;}li{margin:12px 0;}</style></head><body>`;
    const content = preview.innerHTML;
    const footer = `</body></html>`;
    const blob = new Blob([header + content + footer], { type: 'application/msword' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = '2026_Business_Plan.doc';
    a.click();
    URL.revokeObjectURL(url);
}
    </script>
    <script>
async function searchUnderwriting() {
    const questionInput = document.getElementById('uw-question');
    const loanTypeSelect = document.getElementById('uw-loan-type');
    const output = document.getElementById('uw-output');
    const loading = document.getElementById('uw-loading');
    const question = questionInput.value.trim();
    const loanType = loanTypeSelect.options[loanTypeSelect.selectedIndex].text;
    if (!question) {
        alert("Please enter an underwriting question.");
        return;
    }
    output.classList.add('hidden');
    loading.classList.remove('hidden');
    output.innerHTML = '';
    let userPrompt = `You are a senior mortgage underwriting compliance expert with 20+ years experience.
Your answers must be extremely accurate, conservative, and based solely on official published guidelines
(FNMA Selling Guide, FHLMC Seller/Servicer Guide, FHA 4000.1, VA PAM 26-7, USDA HB-1-3555) and known lender overlays. ${question}.
Loan type (if specified): ${loanType}
Include:
- Clear answer based on standard guidelines (FNMA, FHLMC, FHA, VA, USDA as relevant)
- Confidence level: High (95%+), Medium (70-94%), Low (<70%) ‚Äî based on how definitive the guidelines are
- If applicable, mention any Ruoff-specific overlays from the following summary:
- Be accurate and conservative. If unsure, say so.
- Provide a precise, well-reasoned answer following the strict rules above.
- Double-check your logic before finalizing. Accuracy is paramount.
Ruoff Overlays Summary (effective 06/18/25):
- Conventional: No Leaseholds. Tribal Areas require CPB 25-04 eligibility. No Manual Underwrites (A/E required). CU score 5 requires second appraisal (use lower value). No business entity gifts. Investment: VOD required. Credit 620-639: 70% Max LTV (HPML review for >70%). Max DTI: Agency guidelines. Manufactured: FNMA/FHLMC direct, no repair escrows (grade/seed only for new), no ARMs, ATRE required (or alternative 50-day lock + title letter + ALTA 7). IL: ALTA 7 for insurability. Single-wide: Primary only, no cash-out, Agency guidelines.
- USDA: No Future Income. Tribal: CPB 25-04. No Leasehold. Min Credit 620. No No Credit Score loans. Manufactured: ATRE (or alternative), IL ALTA 7, Single-wide eligible.
- VA: No State Bond (except KHC). No Leasehold. Tribal: CPB 25-04. No No Credit Score. AUS: Min 600, Cash-Out 100% LTV (600+), 90% (600-619). Manual: Min 600, DTI 41%, Education for Purchase, No Double BK, Cash-Out 90%. High Balance: Min 700, Cash-Out 90%. IRRRL: Max LTV 105%, Exempt DTI. Manufactured: No Manual, No IRRRL, Cash-Out 75%, ATRE, IL ALTA 7, Single-wide: Primary, No Cash-Out.
- FHA: No Leasehold. Tribal: CPB 25-04. 203(k) separate. Manufactured: No Manual, No Non-Credit Streamline, No $100 Down, Cash-Out 75%, ATRE, IL ALTA 7, Single-wide: Primary, No Cash-Out, No HomeNow. AUS: <580 Not Eligible, 580-599 Education for housing lates/rent free, 600-619 Education for rent free/DTI >=40%. Manual: No Credit: Education, No Pre-Approval, No Cash-Out, No Double BK, Zero lates 24mo housing/installment, 12mo revolving, Max LTV 90% or with reserves, No MFH, GNMA direct. <600 Not Eligible, 600-619 No Cash-Out, DTI 31/43, Zero lates. 620-639 Education, Zero lates. >=640 No overlays.
- State Bond HFA: No VA (except KHC), No Manual, Check Encompass, MCC for Conv/FHA, Earnest money verified, Manufactured: Allowed per state, No single-wide, ATRE, IL ALTA 7, Alternative: 50-day lock, etc.
- 2-1 Buydown: Eligible Conv/FHA/VA/USDA, Ineligible State Bond/renov/construction, Purchase only, Fixed rate, 1-2 units, No Manufactured, Occupancy: Gov Primary, Conv Primary/Second, Contract: Buydown fee in concessions, Fee: Seller/builder, No borrower pay, Locked direct FNMA/FHLMC/GNMA.
Confidence Levels:
- High (95%+): Clear, unambiguous rule in primary guideline source
- Medium (70‚Äì94%): Generally accepted practice or overlay, minor ambiguity
- Low (<70%): Unclear, varies significantly, or no definitive source
Structure every response:
1. Direct, concise main answer
2. Supporting guideline reference (if applicable)
3. Ruoff Overlays Check: List any relevant overlays
4. Confidence level (emphasize) + brief explanation
4. Final disclaimer: Double check all answers and be cautious before relying strictly on this response.`;
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [
                    { role: "system", content: "You are an expert in mortgage underwriting guidelines. Provide accurate, concise answers based on standard agency rules and the provided Ruoff overlays. Always include confidence level and remind to verify." },
                    { role: "user", content: userPrompt }
                ],
                temperature: 0.5,
                max_tokens: 1000
            })
        });
        if (!response.ok) throw new Error('API error');
        const data = await response.json();
        const answer = data.choices[0].message.content.trim();
        output.innerHTML = `
            <div class="prose prose-lg dark:prose-invert max-w-none mb-8">
                ${marked.parse(answer)}
            </div>
            <div class="text-center">
                <button onclick="copyUwOutput()" class="bg-[#002B5C] hover:bg-[#002B5C]/80 text-white px-8 py-4 rounded-full font-bold transition-all shadow-md">
                    üìã Copy Response
                </button>
            </div>
        `;
        output.classList.remove('hidden');
    } catch (error) {
        console.error(error);
        output.innerHTML = `
            <div class="text-center text-red-600 dark:text-red-400 p-8 bg-red-50 dark:bg-red-900/30 rounded-2xl">
                <p class="font-bold text-xl">Error generating response</p>
                <p>Check console or try again.</p>
            </div>
        `;
        output.classList.remove('hidden');
    } finally {
        loading.classList.add('hidden');
    }
}
function copyUwOutput() {
    const text = document.querySelector('#uw-output .prose')?.innerText || '';
    navigator.clipboard.writeText(text).then(() => alert('Response copied!'));
}
let chatHistory = [
    {
        role: "system",
        content: `You are Grok, the ultimate AI Sales Coach for loan officers. This app is packed with powerful AI tools designed to help LOs close more loans, build stronger relationships, and grow their business.
When asked what the tool does or about its features, ALWAYS highlight the AI TOOLS first ‚Äî they are the coolest and most valuable part:
‚Ä¢ Sales Script Generator ‚Äì Instant objection handlers and conversation scripts
‚Ä¢ Social Media Post Creator ‚Äì Ready-to-post content that builds trust and engagement
‚Ä¢ Social Media Monthly Plan Creator
‚Ä¢ Blog Creator ‚Äì Full SEO-optimized blog posts in seconds
‚Ä¢ Business Plan Creator
‚Ä¢ Weekly Win Plan Creator
‚Ä¢ AI Chat Assistant ‚Äì Ask anything: motivation, marketing ideas, scenario help
Other key sections:
‚Ä¢ Prospecting strategies
‚Ä¢ Event planning ideas
‚Ä¢ Referral partner systems
‚Ä¢ Database nurturing
‚Ä¢ Underwriting Guideline Search ‚Äì Fast, accurate answers with confidence levels
Be enthusiastic, encouraging, and focus on how these tools save time and help win more business. Use bullet points for clarity.
Never lead with underwriting ‚Äî it's one tool among many amazing features.`
    }
];
async function sendChatMessage() {
    const input = document.getElementById('chat-input');
    const messagesDiv = document.getElementById('chat-messages');
    const loading = document.getElementById('chat-loading');
    const userMessage = input.value.trim();
    if (!userMessage) return;
    // === SMART ROUTING: Check if it's an underwriting question ===
    if (smartRouteChat(userMessage)) {
        // If routed to underwriting tool, add message to chat and exit
        messagesDiv.innerHTML += `
            <div class="text-right mb-4">
                <div class="inline-block bg-[#F15A29] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                    ${userMessage}
                </div>
            </div>
            <div class="text-left mb-4">
                <div class="inline-block bg-[#002B5C] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                    <p class="italic">I've moved you to the <strong>Underwriting Guideline Search</strong> tool for the most accurate answer. Your question is pre-filled ‚Äî just hit "Search Guidelines" or review the result!</p>
                </div>
            </div>
        `;
        input.value = '';
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
        return; // Stop here ‚Äî don't send to general Grok
    }
    // === END SMART ROUTING ===
    // Normal chat flow continues below
    messagesDiv.innerHTML += `
        <div class="text-right mb-4">
            <div class="inline-block bg-[#F15A29] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                ${userMessage}
            </div>
        </div>
    `;
    input.value = '';
    loading.classList.remove('hidden');
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
    chatHistory.push({ role: "user", content: userMessage });
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: chatHistory,
                temperature: 0.7,
                max_tokens: 1000
            })
        });
        if (!response.ok) throw new Error(`API Error: ${response.status}`);
        const data = await response.json();
        const aiReply = data.choices[0].message.content;
        messagesDiv.innerHTML += `
            <div class="text-left mb-4">
                <div class="inline-block bg-[#002B5C] text-white rounded-2xl px-6 py-4 max-w-lg shadow-lg">
                    ${marked.parse(aiReply)}
                </div>
            </div>
        `;
        chatHistory.push({ role: "assistant", content: aiReply });
    } catch (error) {
        console.error(error);
        messagesDiv.innerHTML += `
            <div class="text-center text-red-600 font-bold p-4 bg-red-50 dark:bg-red-900/30 rounded-2xl">
                Error: Could not get response. Check console or try again.
            </div>
        `;
    } finally {
        loading.classList.add('hidden');
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
}
// Allow Enter to send
document.getElementById('chat-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendChatMessage();
});
// Calculator JS
function calculateAdvanced() {
    const loanAmount = parseFloat(document.getElementById('loanAmount').value) || 0;
    const annualRate = parseFloat(document.getElementById('rate').value) || 0;
    const termYears = parseFloat(document.getElementById('term').value) || 30;
    const annualTaxes = parseFloat(document.getElementById('taxes').value) || 0;
    const annualInsurance = parseFloat(document.getElementById('insurance').value) || 0;
    const pmiRate = parseFloat(document.getElementById('pmi').value) || 0;
    const extraMonthly = parseFloat(document.getElementById('extraMonthly').value) || 0;
    const biweekly = document.getElementById('biweekly').checked;
    if (loanAmount <= 0 || annualRate <= 0 || termYears <= 0) {
        document.getElementById('calc-output').innerHTML = '<p class="text-red-600 font-bold">Invalid inputs.</p>';
        return;
    }
    const monthlyRate = annualRate / 100 / 12;
    const totalPayments = termYears * 12;
    // Standard P&I for the selected term
    const standardPI = loanAmount * monthlyRate * Math.pow(1 + monthlyRate, totalPayments) /
                      (Math.pow(1 + monthlyRate, totalPayments) - 1);
    const monthlyTaxes = annualTaxes / 12;
    const monthlyInsurance = annualInsurance / 12;
    const monthlyPMI = pmiRate > 0 ? loanAmount * pmiRate / 100 / 12 : 0;
    const basePITI = standardPI + monthlyTaxes + monthlyInsurance + monthlyPMI;
    // Standard interest over full selected term
    const standardInterest = standardPI * totalPayments - loanAmount;
    // Custom principal payment
    let principalPayment = standardPI + extraMonthly;
    let userMonthlyCost = basePITI + extraMonthly;
    if (biweekly) {
        principalPayment = (standardPI + extraMonthly) * 13 / 12;
        userMonthlyCost = userMonthlyCost / 2 * 26 / 12;
    }
    // Exact months to payoff (no extra month bug)
    let monthsToPayoff = totalPayments;
    if (principalPayment > loanAmount * monthlyRate + 0.01) { // safety for floating point
        const ratio = principalPayment / (principalPayment - loanAmount * monthlyRate);
        monthsToPayoff = Math.log(ratio) / Math.log(1 + monthlyRate);
        monthsToPayoff = Math.round(monthsToPayoff); // round to nearest month
    }
    const yearsToPayoff = Math.floor(monthsToPayoff / 12);
    const remainingMonths = monthsToPayoff % 12;
    const customInterest = principalPayment * monthsToPayoff - loanAmount;
    const interestSavings = standardInterest - customInterest;
    // Output with full breakdown and high-contrast text
    document.getElementById('calc-output').innerHTML = `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
            <div class="p-8 bg-white dark:bg-gray-800 rounded-3xl shadow-2xl border-4 border-[#002B5C]">
                <h4 class="text-2xl font-bold mb-8 text-[#002B5C] dark:text-[#00A89D]">Standard ${termYears}-Year Schedule</h4>
                <div class="space-y-4 text-gray-800 dark:text-gray-200 text-lg">
                    <p><strong>Principal & Interest:</strong> $${standardPI.toFixed(2)}/mo</p>
                    <p><strong>Property Taxes:</strong> $${monthlyTaxes.toFixed(2)}/mo</p>
                    <p><strong>Homeowners Insurance:</strong> $${monthlyInsurance.toFixed(2)}/mo</p>
                    <p><strong>PMI:</strong> $${monthlyPMI.toFixed(2)}/mo</p>
                    <p class="text-xl font-bold pt-4 border-t-2 border-[#002B5C]/30 text-[#002B5C] dark:text-[#00A89D]">
                        <strong>Total Monthly Payment:</strong> $${basePITI.toFixed(2)}
                    </p>
                    <p class="mt-6"><strong>Total Interest Over Term:</strong> $${standardInterest.toFixed(0)}</p>
                </div>
            </div>
            <div class="p-8 bg-white dark:bg-gray-800 rounded-3xl shadow-2xl border-4 border-[#F15A29]">
                <h4 class="text-2xl font-bold mb-8 text-[#F15A29]">Your Custom Schedule</h4>
                <div class="space-y-4 text-gray-800 dark:text-gray-200 text-lg">
                    <p><strong>Principal & Interest Applied:</strong> $${(standardPI + extraMonthly).toFixed(2)}/mo${biweekly ? ' (biweekly)' : ''}</p>
                    <p><strong>Property Taxes:</strong> $${monthlyTaxes.toFixed(2)}/mo</p>
                    <p><strong>Homeowners Insurance:</strong> $${monthlyInsurance.toFixed(2)}/mo</p>
                    <p><strong>PMI:</strong> $${monthlyPMI.toFixed(2)}/mo</p>
                    <p><strong>Extra Principal:</strong> $${extraMonthly.toFixed(2)}/mo</p>
                    <p class="text-xl font-bold pt-4 border-t-2 border-[#F15A29]/30 text-[#F15A29]">
                        <strong>Your Total Monthly Cost:</strong> $${userMonthlyCost.toFixed(2)}
                    </p>
                    <p class="mt-6"><strong>Payoff Time:</strong> ${yearsToPayoff} years${remainingMonths > 0 ? ', ' + remainingMonths + ' months' : ''}</p>
                    <p><strong>Total Interest Paid:</strong> $${customInterest.toFixed(0)}</p>
                    <p class="text-3xl font-bold ${interestSavings > 0 ? 'text-green-600' : 'text-red-600'} mt-8">
                        You Save: $${interestSavings.toFixed(0)} in interest
                    </p>
                </div>
            </div>
        </div>
    `;
}
// Auto-calculate on any input change (including checkbox)
document.querySelectorAll('#calculator input, #calculator input[type="checkbox"]').forEach(input => {
    input.addEventListener('input', calculateAdvanced);
    input.addEventListener('change', calculateAdvanced);
});
// Search with highlights
const searchInput = document.getElementById('search');
const searchWrapper = searchInput.parentElement;

if (searchInput) {
    let resultsDropdown = null;

    searchInput.addEventListener('input', (e) => {
        const query = e.target.value.trim().toLowerCase();
        
        // Clear previous
        if (resultsDropdown) {
            resultsDropdown.remove();
            resultsDropdown = null;
        }

        if (query === '') return;

        const sections = Array.from(document.querySelectorAll('main section'));
        const matches = [];

        sections.forEach(sec => {
            const titleEl = sec.querySelector('h2');
            const title = titleEl ? titleEl.textContent.toLowerCase() : '';
            const content = sec.textContent.toLowerCase();

            if (title.includes(query) || content.includes(query)) {
                // Score: title match = higher priority
                const score = title.includes(query) ? 2 : 1;
                // Snippet: find context around match
                const idx = content.indexOf(query);
                const start = Math.max(0, idx - 50);
                const snippetText = sec.textContent.slice(start, idx + query.length + 100);
                const highlighted = snippetText.replace(new RegExp(`(${query})`, 'gi'), '<strong class="font-bold text-[#F15A29]">$1</strong>');

                matches.push({
                    id: sec.id,
                    title: titleEl ? titleEl.textContent : 'Untitled',
                    snippet: highlighted + (snippetText.length < sec.textContent.length ? '...' : ''),
                    score
                });
            }
        });

        // Sort: title matches first, then relevance
        matches.sort((a, b) => b.score - a.score);

        // Limit to 6
        const limitedMatches = matches.slice(0, 6);

        if (limitedMatches.length === 0) {
            return;  // Or add "No results" div
        }

        // Build dropdown
        resultsDropdown = document.createElement('div');
        resultsDropdown.className = 'absolute top-full left-0 right-0 mt-2 bg-white/95 dark:bg-gray-800/95 backdrop-blur-md rounded-2xl shadow-2xl max-h-96 overflow-y-auto z-50 border border-white/20';
        resultsDropdown.innerHTML = `
            <ul class="py-2">
                ${limitedMatches.map(match => `
                    <li class="px-6 py-4 hover:bg-[#F15A29]/10 dark:hover:bg-[#F15A29]/20 cursor-pointer flex items-center justify-between border-b border-gray-200/50 dark:border-gray-700/50 last:border-0 transition-all" onclick="showSection('${match.id}'); searchInput.value = ''; resultsDropdown.remove(); dashboardHeader?.scrollIntoView({ behavior: 'smooth', block: 'start' });">
                        <div>
                            <p class="font-bold text-[#002B5C] dark:text-white text-lg">${match.title}</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1" innerHTML="${match.snippet}"></p>
                        </div>
                        <i class="fas fa-arrow-right text-[#F15A29] ml-4"></i>
                    </li>
                `).join('')}
                ${matches.length > 6 ? '<li class="px-6 py-3 text-center text-gray-500 text-sm">+ ${matches.length - 6} more results ‚Äî refine search</li>' : ''}
            </ul>
        `;
        searchWrapper.appendChild(resultsDropdown);
    });

    // Close on outside click
    document.addEventListener('click', (e) => {
        if (!searchWrapper.contains(e.target)) {
            if (resultsDropdown) resultsDropdown.remove();
        }
    });
}
// KEEP THIS ‚Äî this is the good one
document.getElementById('script-scenario-select').addEventListener('change', function() {
    const customWrapper = document.getElementById('custom-scenario-wrapper');
    const customTextarea = document.getElementById('custom-scenario');
    if (this.value === ' ') {
        customWrapper.classList.remove('hidden');
        customTextarea.value = '';
        customTextarea.focus();
    } else {
        customWrapper.classList.add('hidden');
        customTextarea.value = '';
    }
});
// Page load: show Prospecting, initial calc, and quote
// Page load: show AI Chat Assistant by default
// Page load: show AI Chat Assistant by default (no auto-scroll)
document.addEventListener('DOMContentLoaded', () => {
    // Hide all sections
    document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
    const chatInput = document.getElementById('chat-input');
    if (chatInput) {
        chatInput.value = "Tell me how this tool can help me as a loan officer. What are all the features?";
    }
    // Show AI Chat Assistant
    const aiChat = document.querySelector('#ai-chat');
    if (aiChat) {
        aiChat.classList.remove('hidden');
        // REMOVED: aiChat.scrollIntoView({ behavior: 'smooth' }); <-- Delete this line
    } else {
        // Fallback: show first section if AI Chat not found
        document.querySelector('main section')?.classList.remove('hidden');
    }
    // Initial calculation and quote (keep if needed)
    calculateAdvanced();
    generateQuote();
});
   // === DATABASE NURTURING CATEGORY MODALS ===
function openDatabaseModal(category) {
    const modal = document.getElementById('db-modal');
    const title = document.getElementById('db-modal-title');
    const content = document.getElementById('db-modal-content');
    modal.style.display = 'block';
    let html = '';
    if (category === 'Past Clients') {
        title.textContent = 'Past Clients ‚Äì Your Gold Mine';
        html = `
            <p class="font-semibold mb-6">Highest referral potential ‚Äî treat them like family.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Home Anniversary:</strong> Personalized gift + equity review call</li>
                <li><strong>Birthday:</strong> Handwritten card + small meaningful gift</li>
                <li><strong>Life Events:</strong> Track marriages, babies ‚Äî send thoughtful congrats + help</li>
                <li><strong>Quarterly Touch:</strong> Personal video: "Just checking in ‚Äî anything I can help with?"</li>
                <li><strong>Referral Ask:</strong> Only after value: "Who do you know buying/refinancing?"</li>
            </ul>
            <p class="mt-6 font-semibold">Goal: 2‚Äì3 referrals per 100 past clients/year</p>
        `;
    } else if (category === 'Sphere of Influence') {
        title.textContent = 'Sphere of Influence ‚Äì Friends & Family';
        html = `
            <p class="font-semibold mb-6">They already trust you ‚Äî nurture authentically.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Share real life updates (vacations, kids, hobbies)</li>
                <li>Help without asking: "Saw you're moving ‚Äî need lender insights?"</li>
                <li>Host casual gatherings (BBQ, game night) ‚Äî no pitch</li>
                <li>Remember personal details and follow up</li>
            </ul>
        `;
    } else if (category === 'Referral Partners') {
        title.textContent = 'Referral Partners ‚Äì Realtors & Professionals';
        html = `
            <p class="font-semibold mb-6">Become indispensable ‚Äî value first.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Weekly value: Market stats, co-branded tools</li>
                <li>Co-host events (buyer seminars, happy hours)</li>
                <li>Fast communication & smooth closings</li>
                <li>Monthly personal check-in: "How can I support your business?"</li>
                <li>Celebrate their wins publicly</li>
            </ul>
        `;
    } else if (category === 'Community Connections') {
        title.textContent = 'Community Connections ‚Äì Local Network';
        html = `
            <p class="font-semibold mb-6">Become the go-to mortgage expert locally.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Join chamber, BNI, rotary</li>
                <li>Sponsor local events (sports, 5Ks)</li>
                <li>Host free workshops at library</li>
                <li>Cross-promote with local businesses</li>
                <li>Volunteer and share stories</li>
            </ul>
        `;
    } else if (category === 'Prospects') {
        title.textContent = 'Prospects ‚Äì Warm Leads';
        html = `
            <p class="font-semibold mb-6">They said "not yet" ‚Äî stay helpful until "yes".</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Monthly value drip (tips, updates)</li>
                <li>Bi-monthly video check-in</li>
                <li>Invite to events/seminars</li>
                <li>Share success stories of similar buyers</li>
            </ul>
        `;
    } else if (category === 'A+ VIPs') {
        title.textContent = 'A+ VIPs ‚Äì Top 50 Influencers';
        html = `
            <p class="font-semibold mb-6">Highest ROI relationships ‚Äî platinum treatment.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>Quarterly personal lunch/dinner</li>
                <li>Exclusive event invites</li>
                <li>Premium hand-delivered gifts</li>
                <li>Proactive annual reviews</li>
                <li>Facilitate introductions</li>
            </ul>
        `;
    }
    content.innerHTML = html;
}
// Auto-fill text input when selecting from dropdown
document.getElementById('blog-topic-select').addEventListener('change', function() {
    if (this.value) {
        document.getElementById('blog-topic').value = this.value;
    }
});
// ... other functions
async function generateBlog() {
    const topicInput = document.getElementById('blog-topic').value.trim();
    const tone = document.getElementById('blog-tone').value;
    if (!topicInput) {
        alert('Please select or type a blog topic');
        return;
    }
    const output = document.getElementById('blog-output');
    const loading = document.getElementById('blog-loading');
    // Show loading spinner, hide output
    output.classList.add('hidden');
    loading.classList.remove('hidden');
    output.innerHTML = '';
    const systemPrompt = `You are an expert mortgage content writer creating high-quality, GEO-optimized blog posts for loan officers.
Key Requirements:
- Length: 600‚Äì1,000 words
- Tone: ${tone}
- Structure:
  - Engaging, clickable title
  - Strong intro hook
  - H2 subheadings
  - Short paragraphs
  - Bullet points where helpful
  - Bold key phrases
  - FAQ section near end
  - Soft CTA at end: "Ready to explore your options? Reach out ‚Äî I‚Äôm here to help."
- SEO/GEO: Natural keywords, reader-first, local relevance
- Avoid: Any "trigger terms"that could lead to compliance issues. 
- Voice: Helpful, trustworthy, never salesy
- At the end of the blog post, add a clear separator (---) followed by a short, clearly labeled social media caption (e.g., **Suggested Social Media Caption:**) to post with a link to the blog. Keep the caption 100-200 characters (but do NOT include the character count in your response), engaging, and include relevant hashtags.
Write a complete blog post on: ${topicInput}`;
    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [{ role: "user", content: systemPrompt }],
                temperature: 0.7,
                max_tokens: 3000
            })
        });
        if (!response.ok) throw new Error('API error');
        const data = await response.json();
        let fullContent = data.choices[0].message.content.trim();

        // Split blog and caption at separator
        let blogMarkdown = fullContent;
        let captionText = '';
        const separatorIndex = fullContent.lastIndexOf('---');
        if (separatorIndex !== -1) {
            blogMarkdown = fullContent.substring(0, separatorIndex).trim();
            captionText = fullContent.substring(separatorIndex + 3).trim();
            // Clean caption label if present
            captionText = captionText.replace(/^\*\*Suggested Social Media Caption:\*\*\s*/i, '').trim();
        }

        const wordCount = blogMarkdown.split(/\s+/).length;

        output.innerHTML = `
            <div class="prose prose-lg dark:prose-invert max-w-none mb-12">
                ${marked.parse(blogMarkdown)}
            </div>

            <h4 class="text-3xl font-bold text-[#F15A29] mb-6">Suggested Social Media Caption</h4>
            <div id="social-caption" class="bg-gray-100 dark:bg-gray-700 p-8 rounded-2xl text-lg mb-12 whitespace-pre-wrap font-medium">
                ${captionText || 'No caption generated ‚Äî try regenerating!'}
            </div>

            <div class="flex flex-col md:flex-row gap-6 justify-center">
                <button id="copy-blog-btn" class="bg-[#F15A29] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#F15A29]/80 flex items-center justify-center gap-3">
                    <i class="fas fa-copy"></i> Copy Blog (with Formatting)
                </button>
                <button id="copy-caption-btn" class="bg-[#00A89D] text-white px-10 py-5 rounded-full font-bold text-2xl shadow-2xl hover:bg-[#00A89D]/80 flex items-center justify-center gap-3">
                    <i class="fas fa-share-alt"></i> Copy Social Caption
                </button>
            </div>

            <div class="flex justify-between items-center pt-8 mt-12 border-t border-gray-300 dark:border-gray-700">
                <p class="text-gray-600 dark:text-gray-400 text-lg">Word count: ${wordCount}</p>
            </div>
        `;
        output.classList.remove('hidden');

        // Attach copy handlers (must be after DOM insertion)
        document.getElementById('copy-blog-btn').onclick = copyBlogWithFormatting;
        document.getElementById('copy-caption-btn').onclick = copySocialCaption;

    } catch (error) {
        output.innerHTML = '<p class="text-red-600 text-center py-20 text-xl font-bold">Error generating blog. Check console or API key.</p>';
        output.classList.remove('hidden');
        console.error(error);
    } finally {
        loading.classList.add('hidden');
    }
}

// Rich copy for blog (preserves formatting)
function copyBlogWithFormatting() {
    const blogContent = document.querySelector('#blog-output .prose');
    if (!blogContent) {
        alert('No blog content to copy!');
        return;
    }
    const html = blogContent.innerHTML;
    const plainText = blogContent.innerText;

    const clipboardItem = new ClipboardItem({
        'text/html': new Blob([html], { type: 'text/html' }),
        'text/plain': new Blob([plainText], { type: 'text/plain' })
    });

    navigator.clipboard.write([clipboardItem]).then(() => {
        alert('Blog copied with formatting! Paste into WordPress, email, Google Docs, etc.');
    }).catch(err => {
        console.error('Rich copy failed:', err);
        navigator.clipboard.writeText(plainText).then(() => {
            alert('Copied as plain text (rich formatting not supported)');
        });
    });
}

// Plain text copy for caption
function copySocialCaption() {
    const captionEl = document.getElementById('social-caption');
    if (!captionEl || !captionEl.textContent.trim()) {
        alert('No caption to copy!');
        return;
    }
    const caption = captionEl.textContent.trim();
    navigator.clipboard.writeText(caption).then(() => {
        alert('Social caption copied! Ready for LinkedIn, Facebook, Instagram, etc.');
    }).catch(err => {
        console.error('Copy failed:', err);
        alert('Copy failed ‚Äî select and copy manually');
    });
}
function closeDatabaseModal() {
    document.getElementById('db-modal').style.display = 'none';
}
// Close database modal when clicking outside
window.addEventListener('click', (event) => {
    const dbModal = document.getElementById('db-modal');
    if (event.target === dbModal) {
        dbModal.style.display = 'none';
    }
});
// === REFERRAL PARTNERS CATEGORY MODALS ===
function openReferralModal(type) {
    const modal = document.getElementById('referral-modal');
    const title = document.getElementById('referral-modal-title');
    const content = document.getElementById('referral-modal-content');
    modal.style.display = 'block';
    let html = '';
    if (type === 'Realtors') {
        title.textContent = 'Realtors ‚Äì Your Core Referral Engine';
        html = `
            <p class="font-semibold mb-6">Realtors drive 60‚Äì80% of purchase business. Become their trusted financing partner.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Ideal Targets:</strong> Rising stars (2‚Äì6 years), established producers open to new lenders, team leaders</li>
                <li><strong>Outreach:</strong> Open house pop-bys with treats + pre-approval station, genuine social engagement ‚Üí value DM ‚Üí coffee invite</li>
                <li><strong>Value Offers:</strong> Co-branded buyer guides, listing presentation inserts ("My Preferred Lender"), fast pre-approvals, buydown explanations</li>
                <li><strong>Events:</strong> Lunch & learns ("Winning Offers in 2026"), happy hours, co-hosted buyer seminars</li>
                <li><strong>Transaction Excellence:</strong> Weekly agent updates, immediate milestone calls, celebrate their wins</li>
                <li><strong>Retention:</strong> Public social shoutouts, quarterly personal gifts, annual partnership review</li>
            </ul>
            <p class="mt-6 font-bold">Proven Result: Top LOs get 80%+ of business from 10‚Äì20 core realtor partners.</p>
        `;
    } else if (type === 'Builders') {
        title.textContent = 'Builders ‚Äì New Construction Goldmine';
        html = `
            <p class="font-semibold mb-6">Preferred lender status = steady, high-volume pipeline.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> Attend model home openings, offer on-site financing station</li>
                <li><strong>Value Offers:</strong> Construction-to-perm loans, builder incentives, spec home financing</li>
                <li><strong>Events:</strong> Builder appreciation lunches, model home buyer seminars</li>
                <li><strong>Co-Marketing:</strong> Co-branded spec sheets, community signage</li>
                <li><strong>Retention:</strong> Quarterly builder meetings, exclusive rate incentives</li>
            </ul>
        `;
    } else if (type === 'Financial Planners') {
        title.textContent = 'Financial Planners & CPAs';
        html = `
            <p class="font-semibold mb-6">High-net-worth clients ‚Äî perfect for jumbo, investment, and refi business.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> Joint seminars: "Homeownership in Wealth Planning"</li>
                <li><strong>Value Offers:</strong> Jumbo expertise, cash-out for investments, reverse mortgage education</li>
                <li><strong>Co-Marketing:</strong> Co-branded client reports, shared educational content</li>
                <li><strong>Retention:</strong> Annual joint client reviews, reciprocal referrals</li>
            </ul>
        `;
    } else if (type === 'Attorneys') {
        title.textContent = 'Attorneys ‚Äì Sensitive Situations';
        html = `
            <p class="font-semibold mb-6">Divorce, probate, estate clients need compassionate, fast solutions.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> CLE presentations on mortgage implications in divorce/probate</li>
                <li><strong>Value Offers:</strong> Quick approvals for time-sensitive sales, cash-out for legal fees</li>
                <li><strong>Approach:</strong> Empathy first ‚Äî "I'm here to make this transition as smooth as possible"</li>
                <li><strong>Retention:</strong> Quarterly lunch, charity donation thank-yous</li>
            </ul>
        `;
    } else if (type === 'Insurance Agents') {
        title.textContent = 'Insurance Agents ‚Äì Natural Cross-Sell';
        html = `
            <p class="font-semibold mb-6">Bundle home + auto = easy referrals.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li><strong>Outreach:</strong> Co-branded "Home Buyer Protection Package"</li>
                <li><strong>Value Offers:</strong> Joint quotes, shared client events</li>
                <li><strong>Events:</strong> Client appreciation insurance + mortgage reviews</li>
                <li><strong>Retention:</strong> Monthly referral lunch, shared marketing</li>
            </ul>
        `;
    } else if (type === 'Other') {
        title.textContent = 'Other Professionals';
        html = `
            <p class="font-semibold mb-6">Niche goldmines that others overlook.</p>
            <ul class="list-disc pl-6 space-y-4">
                <li>HR Directors ‚Äî Corporate relocation programs</li>
                <li>Relocation Companies ‚Äî Employee move financing</li>
                <li>Title Agents ‚Äî Joint marketing & education</li>
                <li>Chamber/Networking Groups ‚Äî Visibility & warm intros</li>
                <li>Approach: Find their pain point (speed, communication) and solve it</li>
            </ul>
        `;
    }
    content.innerHTML = html;
}
function closeReferralModal() {
    document.getElementById('referral-modal').style.display = 'none';
}
function copyOutput(outputId) {
    const prose = document.querySelector(`#${outputId} .prose`);
    if (!prose) {
        alert('No content to copy yet');
        return;
    }
    navigator.clipboard.writeText(prose.innerText).then(() => {
        alert('Copied to clipboard!');
    });
}
// Close referral modal when clicking outside
window.addEventListener('click', (event) => {
    const referralModal = document.getElementById('referral-modal');
    if (event.target === referralModal) {
        referralModal.style.display = 'none';
    }
});
// Smart routing for AI Chat Assistant ‚Äî more flexible
// Smart routing for AI Chat Assistant ‚Äì optimized for your exact IDs
function smartRouteChat(message) {
    const lower = message.toLowerCase();

    // === BLOCK: Explicitly about the tool/app/features/help ===
    const blockPhrases = [
        'what is this tool', 'what does this tool do', 'what can this tool do', 'features',
        'tell me about this app', 'how does this help', 'what are the tools', 'ai tools',
        'help me with', 'sales script', 'marketing idea', 'motivation', 'weekly plan',
        'win plan', 'equity scanner', 'social media planner', 'chat assistant',
        'how do i use', 'what sections', 'navigate', 'dashboard'
    ];
    if (blockPhrases.some(phrase => lower.includes(phrase))) {
        return false; // Stay in chat
    }

    // === PRIMARY: Must have at least one strict underwriting keyword ===
    const primaryKeywords = [
        'guideline', 'guidelines', 'underwriting', 'scenario', 'du finding', 'lp finding',
        'aus finding', 'overlay', 'manual underwrite', 'compensating factor'
    ];
    const hasPrimary = primaryKeywords.some(kw => lower.includes(kw));

    if (!hasPrimary) return false;

    // === SECONDARY: Loan/underwriting context terms (optional but boosts accuracy) ===
    const secondaryKeywords = [
        'dti', 'debt to income', 'credit score', 'fico', 'ltv', 'cltv', 'self-employed',
        'bankruptcy', 'foreclosure', 'fha', 'va', 'usda', 'conventional', 'jumbo',
        'non-qm', '203k', 'buydown', 'cash out', 'lpmi', 'manufactured home'
    ];
    const hasSecondary = secondaryKeywords.some(kw => lower.includes(kw));

    // === QUESTION STRUCTURE: Boost if it's phrased as a question ===
    const isQuestion = lower.includes('?') || 
                       lower.includes('what is') || 
                       lower.includes('can i') || 
                       lower.includes('qualify') || 
                       lower.includes('eligible');

    // === ROUTE ONLY IF STRONG SIGNAL ===
    if (hasPrimary && (hasSecondary || isQuestion)) {
        // Switch to underwriting section
        document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
        const uwSection = document.getElementById('underwriting-search');
        if (uwSection) {
            uwSection.classList.remove('hidden');
        }

        // Pre-fill and focus (NO auto-search)
        const uwInput = document.getElementById('uw-question');
        if (uwInput) {
            uwInput.value = message;
            uwInput.focus();
            uwInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        return true; // Routed
    }

    // Default: Stay in general chat
    return false;
}
</script>
<script>
// Toggle custom preferences visibility
document.getElementById('calendar-template').addEventListener('change', function() {
    document.getElementById('custom-preferences').classList.toggle('hidden', this.value !== 'custom');
});

// Large idea pools (varied, no repetition across year) ‚Äî kept your original + slight expansions for variety
const ideaPools = {
    personal: [
        "Morning coffee routine with a view of the backyard", "Weekend hike photo and what you love about Indiana trails",
        "Family game night snapshot", "Favorite local coffee shop visit", "Book I'm reading this week",
        "My dog's funny morning zoomies", "Garden update ‚Äî first tomatoes of the season!", "Throwback to my first home purchase",
        "Gratitude post: Thankful for great clients and teammates", "Sunday meal prep ‚Äî what's your go-to recipe?",
        "Kids' sports game highlight", "Favorite podcast episode this week", "Home office setup tour", "Pet playing in the snow/rain",
        "Weekend BBQ with friends", "Hobby share: Golf swing at local course", "Simple pleasure: Fresh baked cookies",
        "Throwback vacation memory", "Morning walk in the neighborhood", "What I'm watching on Netflix",
        "Favorite seasonal drink recipe", "Family tradition we love", "Home project progress pic", "Sunset from the porch",
        "Weekend farmer's market haul", "Cozy reading nook photo", "My why: Helping families achieve homeownership",
        "Quick life hack I use daily", "Favorite quote on my desk", "Behind-the-scenes: My daily planner",
        "Local Auburn park visit", "Favorite Indiana festival memory", "Home workout routine share"
    ],
    engagement: [
        "Poll: Coffee or tea person?", "This or That: City living or suburbs?", "What's your dream home feature?",
        "Biggest home-buying fear ‚Äî comment below!", "Favorite local restaurant in your area?", "Buy now or wait for rates ‚Äî thoughts?",
        "Share your best moving tip", "Beach house or mountain cabin?", "Rate your credit knowledge 1‚Äì10",
        "What's one home upgrade on your wish list?", "Cats or dogs as the ultimate home companion?", "Favorite season for house hunting?",
        "Would you rather renovate or buy new?", "Best advice you ever got about money?", "Share a home DIY win or fail!",
        "Favorite Auburn spot?", "Winter or summer in Indiana?"
    ],
    motivational: [
        "Monday motivation: Ziglar quote about attitude", "Your why matters ‚Äî quick story about why I love this industry",
        "Small steps lead to big wins ‚Äî client example", "Mindset tip: Start the week with gratitude",
        "Quote: 'Success is 80% mindset, 20% strategy'", "Overcoming obstacles ‚Äî my biggest lesson learned",
        "Gratitude changes everything", "Focus on progress, not perfection"
    ],
    tips: [
        "Quick tip: How escrow accounts work", "Myth: You need 20% down to buy ‚Äî here's the truth",
        "3 ways to boost your credit score fast", "Closing costs explained in plain English",
        "Should you lock your rate now? Factors to consider", "FHA vs Conventional ‚Äî quick comparison",
        "How to remove PMI early", "Debt-to-income ratio basics"
    ],
    wins: [
        "Just helped another family close on their dream home! üè°", "Client testimonial Thursday (with permission)",
        "Recent closing table celebration photo", "Saved a client $250/month on their refi ‚Äî love these wins!",
        "Another smooth approval ‚Äî teamwork makes the dream work!"
    ],
    community: [
        "Local business spotlight: Amazing Auburn/Fort Wayne spot", "Upcoming community event worth checking out",
        "Support local ‚Äî share your favorite small business!", "Volunteer day recap ‚Äî giving back feels great",
        "Shoutout to a great DeKalb County business"
    ],
    fun: [
        "Fun fact: The average American moves 11.7 times!", "Real estate myth busted with humor",
        "Friday funny: Mortgage meme that hits home", "Poll: What's the weirdest home feature you've seen?",
        "Weekend laugh: Funny home renovation fail"
    ]
};

// Weekly themes
const weeklyThemes = {
    Sun: "Personal & Relax Sunday ‚Äì Family, hobbies, weekend vibes",
    Mon: "Motivational Monday ‚Äì Inspiration & mindset",
    Tue: "Tip Tuesday ‚Äì Quick mortgage/finance value",
    Wed: "Wins Wednesday ‚Äì Testimonials & celebrations",
    Thu: "Community Thursday ‚Äì Local spotlight & support",
    Fri: "Fun Friday ‚Äì Polls, facts & humor",
    Sat: "Engagement Saturday ‚Äì Questions & personal stories"
};

const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

function getDaysInMonth(year, month) {
    return new Date(year, month + 1, 0).getDate();
}

function pickRandom(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function generateLocalMonths(year, weekStart, template) {
    const weekdays = weekStart === 'Sun' ? ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'] : ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    let months = [];

    for (let m = 0; m < 12; m++) {
        const daysInMonth = getDaysInMonth(year, m);
        let monthDays = [];

        for (let d = 1; d <= daysInMonth; d++) {
            const dateObj = new Date(year, m, d);
            const wdIndex = dateObj.getDay();
            const weekday = weekdays[wdIndex === 0 ? 6 : wdIndex - (weekStart === 'Sun' ? 0 : 1)];
            const theme = weeklyThemes[weekday] || "General Day";

            let ideas = [];
            // Always 2 personal/engagement base
            ideas.push(pickRandom(ideaPools.personal));
            ideas.push(pickRandom([...ideaPools.personal, ...ideaPools.engagement]));

            // Template-specific weighting
            if (template === 'engagement') {
                ideas.push(pickRandom(ideaPools.engagement));
                ideas.push(pickRandom(ideaPools.engagement));
            } else if (template === 'personal') {
                ideas.push(pickRandom(ideaPools.personal));
                ideas.push(pickRandom(ideaPools.personal));
            } else if (template === 'realtor') {
                ideas.push("Value for agents: Fast pre-approvals & smooth closings");
                ideas.push(pickRandom([...ideaPools.personal, ...ideaPools.engagement]));
            } else {
                // Balanced ‚Äî add 1 themed business + 1 mixed
                const themedPool = weekday === 'Mon' ? ideaPools.motivational :
                                  weekday === 'Tue' ? ideaPools.tips :
                                  weekday === 'Wed' ? ideaPools.wins :
                                  weekday === 'Thu' ? ideaPools.community :
                                  weekday === 'Fri' ? ideaPools.fun :
                                  ideaPools.tips;
                ideas.push(pickRandom(themedPool));
                ideas.push(pickRandom([...ideaPools.personal, ...ideaPools.engagement]));
            }

            monthDays.push({
                date: d.toString(),
                weekday,
                theme,
                ideas
            });
        }
        months.push({ name: monthNames[m], days: monthDays });
    }
    return months;
}

// New: Branded Overview Cover Sheet
function createOverviewSheet(year) {
    const data = [
        [`Your ${year} Social Media Success Plan`, "", "", "", "", "", "", ""],
        ["Built for Loan Officers in Auburn & Beyond ‚Äî Consistency Made Simple", "", "", "", "", "", "", ""],
        [],
        ["Core Strategy", "", "", "", "", "", "", ""],
        ["75% Personal/Engagement/Community ‚Üí Build authentic relationships", "", "", "", "", "", "", ""],
        ["25% Business/Educational ‚Üí Position yourself as the go-to expert", "", "", "", "", "", "", ""],
        [],
        ["Weekly Themes", "", "", "", "", "", "", ""],
        ["Sunday: Personal & Relax", "Monday: Motivational", "Tuesday: Tip", "Wednesday: Wins", "", "", "", ""],
        ["Thursday: Community/Local", "Friday: Fun", "Saturday: Engagement", "", "", "", "", ""],
        [],
        ["Pro Tips for Maximum Results", "", "", "", "", "", "", ""],
        ["‚Ä¢ Post 3‚Äì5 times per week minimum", "", "", "", "", "", "", ""],
        ["‚Ä¢ Engage daily: Like/comment/share on others' posts", "", "", "", "", "", "", ""],
        ["‚Ä¢ Use Stories/Reels for behind-the-scenes", "", "", "", "", "", "", ""],
        ["‚Ä¢ Track engagement & double down on what works", "", "", "", "", "", "", ""],
        ["‚Ä¢ Always add value ‚Äî never hard sell", "", "", "", "", "", "", ""],
        [],
        ["You've got this! Start posting today and watch your business grow.", "", "", "", "", "", "", ""]
    ];

    const ws = XLSX.utils.aoa_to_sheet(data);
    ws['!merges'] = [
        { s: { r: 0, c: 0 }, e: { r: 0, c: 7 } },
        { s: { r: 1, c: 0 }, e: { r: 1, c: 7 } },
        { s: { r: 3, c: 0 }, e: { r: 3, c: 7 } },
        { s: { r: 7, c: 0 }, e: { r: 7, c: 7 } },
        { s: { r: 11, c: 0 }, e: { r: 11, c: 7 } },
        { s: { r: 18, c: 0 }, e: { r: 18, c: 7 } }
    ];
    ws['!cols'] = [{ wch: 60 }, { wch: 40 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }];

    // Styling for title
    if (ws['A1']) {
        ws['A1'].s = { font: { bold: true, sz: 24, color: { rgb: "F15A29" } }, alignment: { horizontal: 'center' } };
    }
    if (ws['A2']) {
        ws['A2'].s = { font: { bold: true, sz: 18 }, alignment: { horizontal: 'center' } };
    }

    return ws;
}

// Updated createMonthSheet with holidays, hashtags, local flavor
function createMonthSheet(month, year, monthIndex, weekStart) {
    const data = [];

    data.push([`${month.name} ${year}`]);
    data.push([]); data.push([]);

    data.push(['Weekly Themes Recap']);
    data.push(['Day', 'Theme Description']);
    const weekdayOrder = weekStart === 'Sun' ? ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'] : ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    weekdayOrder.forEach(wd => {
        data.push([wd, weeklyThemes[wd] || 'General Day']);
    });
    data.push([]); data.push([]);

    data.push(['Daily Post Ideas']);
    data.push(['Date', 'Weekday', 'Theme', 'Post Idea 1', 'Post Idea 2', 'Post Idea 3', 'Post Idea 4', 'Suggested Hashtags']);

    // 2026 US Holidays (major ones)
    const holidays = {
        'January 1': 'üéâ New Year‚Äôs Day ‚Äì Share your goals!',
        'January 19': 'MLK Day ‚Äì Inspiration & equality post',
        'February 16': 'Presidents‚Äô Day',
        'May 25': 'Memorial Day',
        'June 19': 'Juneteenth',
        'July 4': 'Independence Day üá∫üá∏',
        'September 7': 'Labor Day',
        'November 26': 'Thanksgiving ü¶É',
        'December 25': 'Christmas üéÑ'
    };

    month.days.forEach(day => {
        const fullDateKey = `${month.name} ${day.date}`;
        const holidayNote = holidays[fullDateKey] || '';

        let hashtags = '#LoanOfficerLife #IndianaRealEstate #AuburnIN';
        if (day.weekday === 'Mon') hashtags += ' #MotivationMonday';
        if (day.weekday === 'Tue') hashtags += ' #TipTuesday';
        if (day.weekday === 'Wed') hashtags += ' #WinsWednesday';
        if (day.weekday === 'Thu') hashtags += ' #SupportLocal';
        if (day.weekday === 'Fri') hashtags += ' #FunFriday';
        if (holidayNote) hashtags += ' #HappyHolidays';

        data.push([
            `${month.name} ${day.date}, ${year}${holidayNote ? ' üéâ' : ''}`,
            day.weekday,
            day.theme + (holidayNote ? ' (Holiday!)' : ''),
            ...day.ideas.slice(0,4).map(idea => idea || ''),
            hashtags
        ]);

        if (holidayNote) {
            data[data.length-1][3] = holidayNote; // Override first idea with holiday suggestion
        }
    });

    const ws = XLSX.utils.aoa_to_sheet(data);

    ws['!merges'] = [
        { s: { r: 0, c: 0 }, e: { r: 0, c: 7 } },
        { s: { r: 3, c: 0 }, e: { r: 3, c: 7 } },
        { s: { r: data.length - month.days.length - 2, c: 0 }, e: { r: data.length - month.days.length - 2, c: 7 } }
    ];

    ws['!cols'] = [
        { wch: 24 }, { wch: 12 }, { wch: 55 },
        { wch: 55 }, { wch: 55 }, { wch: 55 }, { wch: 55 },
        { wch: 70 }
    ];

    // Wrap text + holiday highlighting
    const ideasStartRow = 11 + weekdayOrder.length;
    for (let r = ideasStartRow; r < data.length; r++) {
        for (let c = 2; c <= 7; c++) {
            const cell = XLSX.utils.encode_cell({ r, c });
            if (ws[cell]) {
                ws[cell].s = { 
                    alignment: { wrapText: true, vertical: 'top', horizontal: 'left' },
                    font: { sz: 11 }
                };
                if (data[r][2].includes('Holiday')) {
                    ws[cell].s.fill = { fgColor: { rgb: "E8F5E9" } }; // Light green
                }
            }
        }
    }

    // Bold headers + title styling (your original retained)
    const headerRows = [3, 4, data.length - month.days.length - 1];
    headerRows.forEach(rowIdx => {
        for (let c = 0; c < 8; c++) {
            const cell = XLSX.utils.encode_cell({ r: rowIdx, c });
            if (ws[cell]) {
                ws[cell].s = ws[cell].s || {};
                ws[cell].s.font = { bold: true, sz: 12 };
            }
        }
    });

    if (ws['A1']) {
        ws['A1'].s = { font: { bold: true, sz: 18 }, alignment: { horizontal: 'center' } };
    }

    return ws;
}

// Your createTipsSheet (kept as-is ‚Äî it's solid)
function createTipsSheet() {
    const data = [
        ["Social Media Success Tips for Loan Officers", "", "", "", "", "", "", ""],
        [],
        ["Key Principle: ~75% personal/community/engagement ‚Äî people connect with YOU first.", "", "", "", "", "", "", ""],
        ["~25% business/educational ‚Äî provide genuine value.", "", "", "", "", "", "", ""],
        [],
        ["Frequency Guidelines"],
        ["Daily:", "Like/comment/share on followers' posts + 1‚Äì3 personal posts"],
        ["Weekly:", "Motivational Monday, Tip Tuesday, Wins Wednesday, Community Thursday, Fun Friday"],
        ["Monthly:", "Market update, local spotlight, deeper educational reel"],
        ["As they occur:", "Testimonials, closing pics, just-listed/sold (with permission)"],
        [],
        ["Idea Bank ‚Äì Steal These Anytime"],
        ["Personal Ideas:", ...ideaPools.personal.slice(0,20).join(", ").split(", ")],
        [],
        ["Engagement Prompts:", ...ideaPools.engagement.slice(0,15).join(", ").split(", ")],
        [],
        ["Mortgage Tips:", ...ideaPools.tips],
        ["Fun/Community:", ...ideaPools.fun.concat(ideaPools.community)]
    ];

    const ws = XLSX.utils.aoa_to_sheet(data);
    ws['!cols'] = [
        { wch: 30 }, { wch: 50 }, { wch: 50 }, { wch: 50 }, 
        { wch: 50 }, { wch: 50 }, { wch: 50 }, { wch: 50 }
    ];
    ws['!merges'] = [{ s: { r: 0, c: 0 }, e: { r: 0, c: 7 } }];

    return ws;
}

// Full generateCalendar with your AI fetch, progress, overview sheet, etc.
async function generateMonthlyPlan() {
    const month = document.getElementById('plan-month').value;
    const year = document.getElementById('plan-year').value;
    const localArea = document.getElementById('plan-areas')?.value.trim() || 'your area';
    const customPrompt = document.getElementById('custom-plan-prompt')?.value.trim() || '';

    // Collect checked themes (null-safe)
    const themes = [];
    if (document.getElementById('theme-family')?.checked) themes.push('family and personal life');
    if (document.getElementById('theme-hobbies')?.checked) themes.push('hobbies, interests, music, sports, restaurants, vacations');
    if (document.getElementById('theme-local')?.checked) themes.push('local events and spots in ' + localArea);
    if (document.getElementById('theme-fun')?.checked) themes.push('fun and humor');
    if (document.getElementById('theme-polls')?.checked) themes.push('polls and engagement');
    if (document.getElementById('theme-refi')?.checked) themes.push('refi and rate tips');
    if (document.getElementById('theme-cashout')?.checked) themes.push('cash-out ideas');
    if (document.getElementById('theme-purchase')?.checked) themes.push('purchase and first-time buyer tips');
    if (document.getElementById('theme-equity')?.checked) themes.push('equity and move-up power');
    if (document.getElementById('theme-recipes')?.checked) themes.push('recipe ideas');
    if (document.getElementById('theme-trivia')?.checked) themes.push('trivia and fun facts');
    if (document.getElementById('theme-localbusiness')?.checked) themes.push('local business spotlights');

    const monthNames = ["", "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    const monthName = monthNames[parseInt(month)];

    // Dynamic days in month (handles 28/29/30/31 correctly, including leap years)
    const daysInMonth = new Date(year, month, 0).getDate();  // month is 1-based in select, but Date expects 0-based for month

    const fullPrompt = `You are the world's best social media coach for loan officers. Generate a full month content calendar for ${monthName} ${year} (exactly ${daysInMonth} days) for a loan officer primarily in ${localArea}.

Core philosophy: 70% relationship-building (personal, local, fun, engaging) and 30% mortgage value. Make people WANT to see posts ‚Äî be entertaining, human, and trust-building.

Weave in these themes naturally: ${themes.length ? themes.join(', ') : 'balanced personal and local content'}.

Custom instructions: ${customPrompt || 'None ‚Äî use best judgment'}.

CRITICAL: Output EXACTLY ${daysInMonth} days (Day 1 to Day ${daysInMonth}). For EVERY day, provide EXACTLY 4 varied post ideas.

Output as clean Markdown with:
- Strong Overview section (key themes, why it works, execution motivation ‚Äî inspiring and actionable).
- Calendar as a table: columns "Day", "Date", "Theme", "Post 1", "Post 2", "Post 3", "Post 4".
- Each post: full caption + hashtags.
Include local ${localArea} events, holidays, trends. Tone: warm, fun, conversational.`;

    const loading = document.getElementById('social-plan-loading');
    const output = document.getElementById('social-plan-output');

    if (loading) loading.classList.remove('hidden');
    if (output) output.innerHTML = '';

    try {
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [
                    { role: 'system', content: 'You are an expert social media strategist for loan officers following the 70/30 relationship rule.' },
                    { role: 'user', content: fullPrompt }
                ],
                temperature: 0.7,
                max_tokens: 6000
            })
        });

        if (!response.ok) throw new Error(`API error: ${response.status}`);

        const data = await response.json();
        const planContent = data.choices[0].message.content;

        // Parse to HTML
        const rawHTML = marked.parse(planContent);
        const parser = new DOMParser();
        const doc = parser.parseFromString(rawHTML, 'text/html');

        // Extract Overview
        let overviewHTML = '';
        let tableHTML = '';

        const table = doc.querySelector('table');
        if (table) {
            tableHTML = table.outerHTML;
            overviewHTML = doc.body.innerHTML.split(table.outerHTML)[0] || '<p>No overview generated.</p>';
        } else {
            overviewHTML = rawHTML;
        }

        // Build day cards ‚Äî use dynamic daysInMonth
        let cardsHTML = '<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mt-12">';

        for (let day = 1; day <= daysInMonth; day++) {
            const dayDate = `${monthName} ${day}`;
            let theme = 'Daily Mix';

            const posts = [];
            for (let i = 0; i < 4; i++) {
                posts.push('<p class="italic text-gray-500">Free choice ‚Äî share something personal or local!</p>');
            }

            // Override with Grok data if available
            if (table) {
                const row = table.querySelectorAll('tr')[day];
                if (row) {
                    const cells = row.querySelectorAll('td');
                    if (cells.length >= 3) {
                        theme = cells[2].textContent.trim() || theme;
                        for (let i = 3; i < 7 && i < cells.length; i++) {
                            const content = cells[i].textContent.trim();
                            if (content) posts[i - 3] = `<p class="leading-relaxed">${content}</p>`;
                        }
                    }
                }
            }

            const postBoxes = posts.map((post, pIdx) => {
                const postId = `post-${day}-${pIdx}`;
                return `
                    <div class="relative mb-6 p-6 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 rounded-2xl shadow-md border border-[#00A89D]/20">
                        <button type="button" onclick="copySinglePost('${postId}', event)" class="absolute top-4 right-4 bg-[#00A89D] hover:bg-[#00887A] text-white p-3 rounded-full shadow-lg transition-all flex items-center gap-2 copy-btn" data-post-id="${postId}">
                            <i class="fas fa-copy"></i>
                        </button>
                        <div id="${postId}" class="text-lg leading-relaxed">${post}</div>
                    </div>
                `;
            }).join('');

            cardsHTML += `
                <div class="bg-white dark:bg-gray-800 p-10 rounded-3xl shadow-2xl hover:shadow-3xl hover:-translate-y-4 transition-all border-2 border-[#00A89D]/30">
                    <h3 class="text-3xl font-black text-[#F15A29] mb-4">${dayDate}</h3>
                    <p class="text-2xl font-bold text-[#00A89D] mb-8">${theme}</p>
                    <div class="space-y-6">
                        ${postBoxes}
                    </div>
                </div>
            `;
        }
        cardsHTML += '</div>';

        // Larger overview
        const overviewSection = `
            <div class="mb-20">
                <h1 class="text-5xl font-black text-[#F15A29] text-center mb-12">${monthName} Social Media Calendar</h1>
                <div class="prose prose-3xl dark:prose-invert max-w-none text-left dark:text-white dark:text-gray-200 leading-loose">
                    ${overviewHTML}
                </div>
            </div>
        `;

        // Progress tracking (30 posts goal, reset on every generation)
        let progress = JSON.parse(localStorage.getItem('socialPlanProgress') || '{}');
        const planKey = `${monthName}_${year}`;
        progress[planKey] = { copied: 0, total: 30 };  // Reset copied to 0 every generation
        localStorage.setItem('socialPlanProgress', JSON.stringify(progress));

        let copiedCount = progress[planKey].copied;

        const progressBar = `
            <div id="progress-container" class="mt-20 p-10 bg-gradient-to-br from-[#002B5C]/50 to-[#00A89D]/30 rounded-3xl shadow-2xl text-center">
                <h3 class="text-4xl font-bold text-[#F15A29] mb-8">Your Posting Progress</h3>
                <div class="w-full max-w-2xl mx-auto bg-gray-700 rounded-full h-10 mb-6 overflow-hidden">
                    <div id="progress-fill" class="bg-gradient-to-r from-[#00A89D] to-[#F15A29] h-10 rounded-full transition-all duration-1000" style="width: 0%"></div>
                </div>
                <p class="text-3xl text-white">Copied <span class="font-black text-[#F15A29]" id="copied-count">${copiedCount}</span> of 30 posts</p>
                <p class="text-xl text-gray-300 mt-6" id="progress-message">Start copying to track progress!</p>
            </div>
        `;

        output.innerHTML = `
            <div id="printable-plan" class="bg-white dark:bg-gray-800 p-12 rounded-3xl shadow-2xl">
                ${overviewSection}
                ${cardsHTML}
                ${progressBar}
            </div>
        `;

        // Single post copy with live progress update
        window.copySinglePost = function(postId, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }

            const el = document.getElementById(postId);
            if (!el) return;

            let text = el.innerText.trim();
            text = text.replace(/^(IG|FB|LinkedIn|TikTok|Reels?|Story|Post|Stories):\s*/i, '').trim();

            const html = el.innerHTML;

            navigator.clipboard.write([
                new ClipboardItem({
                    'text/plain': new Blob([text], { type: 'text/plain' }),
                    'text/html': new Blob([`<div style="font-family: sans-serif; font-size: 16pt; line-height: 1.6;">${html}</div>`], { type: 'text/html' })
                })
            ]).then(() => {
                const btn = document.querySelector(`[data-post-id="${postId}"]`);
                if (btn) {
                    const original = btn.innerHTML;
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    btn.classList.replace('bg-[#00A89D]', 'bg-green-600');

                    // Update progress live
                    let progress = JSON.parse(localStorage.getItem('socialPlanProgress') || '{}');
                    const planKey = `${monthName}_${year}`;
                    if (progress[planKey]) {
                        progress[planKey].copied += 1;
                        localStorage.setItem('socialPlanProgress', JSON.stringify(progress));

                        copiedCount = progress[planKey].copied;
                        document.getElementById('copied-count').textContent = copiedCount;
                        document.getElementById('progress-message').textContent = copiedCount >= 30 ? 'üéâ You crushed it ‚Äî consistent wins!' : copiedCount >= 21 ? 'üî• On fire ‚Äî keep posting!' : 'Start copying to track progress!';

                        // Confetti every 10 copies + big at 30
                        if (copiedCount % 10 === 0 || copiedCount === 30) {
                            confetti({
                                particleCount: copiedCount === 30 ? 300 : 100,
                                spread: 70,
                                origin: { y: 0.6 }
                            });
                        }
                    }

                    setTimeout(() => {
                        btn.innerHTML = original;
                        btn.classList.replace('bg-green-600', 'bg-[#00A89D]');
                    }, 2000);
                }
            }).catch(() => {
                navigator.clipboard.writeText(text);
            });
        };

    } catch (err) {
        console.error('Plan generation error:', err);
        output.innerHTML = `<p class="text-red-600 text-center text-2xl">Error: ${err.message}</p>`;
    } finally {
        if (loading) loading.classList.add('hidden');
    }
}
// Toggle function ‚Äî add this to your existing <script> block (or create a new one if needed)
function toggleCalendarSection() {
    const content = document.getElementById('calendar-content');
    const icon = document.getElementById('calendar-toggle-icon');
    
    content.classList.toggle('hidden');
    icon.classList.toggle('rotate-180');
}
</script>
<script>
function syncRateControls() {
    const slider = document.getElementById('new-rate-slider');
    const input = document.getElementById('new-rate-input');

    if (!slider || !input) {
        console.warn('Rate slider or input not found');
        return;
    }

    const clamp = (val) => Math.max(3.0, Math.min(8.0, parseFloat(val) || 6.0));

    // Initial sync
    let currentVal = clamp(slider.value);
    slider.value = currentVal;
    input.value = currentVal.toFixed(3);

    // Clone for clean reset (fixes any post-generate glitches)
    const freshSlider = slider.cloneNode(true);
    slider.parentNode.replaceChild(freshSlider, slider);

    // Real-time drag: Update input box only (lightweight = no glitch/lag)
    freshSlider.addEventListener('input', () => {
        input.value = parseFloat(freshSlider.value).toFixed(3);
    });

    // On release: Final sync + trigger live dashboard update
    freshSlider.addEventListener('change', () => {
        let val = parseFloat(freshSlider.value);
        input.value = val.toFixed(3);

        updateDashboardWithNewRate(val);

        console.log('Rate changed to:', val, '‚Äî recalculating savings...');

        // FIX: If in remaining term mode, force a second recalc after short delay
        if (savingsMode === 'remaining') {
            setTimeout(() => updateDashboardWithNewRate(val), 80);
        }

        // Force repaint (keeps smooth thumb movement)
        freshSlider.style.display = 'none';
        freshSlider.offsetHeight;
        freshSlider.style.display = '';
    });

    // Box typing: Update slider live
    input.addEventListener('input', () => {
        let val = clamp(input.value);
        freshSlider.value = val;
        input.value = val.toFixed(3);
    });

    // Box finish (blur/Enter): Trigger live dashboard update
    input.addEventListener('change', () => {
        let val = clamp(input.value);
        freshSlider.value = val;
        input.value = val.toFixed(3);

        updateDashboardWithNewRate(val);

        console.log('Rate changed to:', val, '‚Äî recalculating savings...');

        // FIX: If in remaining term mode, force a second recalc after short delay
        if (savingsMode === 'remaining') {
            setTimeout(() => updateDashboardWithNewRate(val), 80);
        }
    });
}

// Run on page load
document.addEventListener('DOMContentLoaded', syncRateControls);

// Savings Mode Toggle
document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('savings-mode-toggle')?.addEventListener('click', () => {
        savingsMode = savingsMode === 'full' ? 'remaining' : 'full';

        const thumb = document.getElementById('toggle-thumb');
        if (thumb) {
            if (savingsMode === 'full') {
                thumb.classList.remove('translate-x-11');
                thumb.classList.add('translate-x-1');
            } else {
                thumb.classList.remove('translate-x-1');
                thumb.classList.add('translate-x-11');
            }
        }

        const toggleBtn = document.getElementById('savings-mode-toggle');
        if (toggleBtn) {
            toggleBtn.classList.toggle('bg-[#00A89D]', savingsMode === 'full');
            toggleBtn.classList.toggle('bg-orange-500', savingsMode === 'remaining');
        }

        const modeLabel = document.getElementById('mode-label');
        if (modeLabel) {
            modeLabel.textContent = savingsMode === 'full' ? 'Full Term Reset' : 'Remaining Term';
        }

        const currentRate = parseFloat(
            document.getElementById('new-rate-input')?.value ||
            document.getElementById('new-rate-slider')?.value || '6.0'
        );

        updateDashboardWithNewRate(currentRate);

        // FIX: Force a second recalc after mode switch (especially critical for remaining term sync)
        setTimeout(() => updateDashboardWithNewRate(currentRate), 100);
    });
});

// Theme Toggle + Persistence (dark/light)
document.addEventListener('DOMContentLoaded', () => {
    const toggleBtn = document.getElementById('theme-toggle');
    const icon = document.getElementById('theme-icon');
    const label = toggleBtn?.querySelector('span');

    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') {
        document.documentElement.classList.remove('dark');
        if (icon) {
            icon.classList.replace('fa-moon', 'fa-sun');
            icon.classList.replace('text-yellow-400', 'text-yellow-500');
        }
        if (label) label.textContent = 'Light Mode';
    } else {
        document.documentElement.classList.add('dark');
    }

    if (toggleBtn) {
        toggleBtn.addEventListener('click', () => {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                if (icon) {
                    icon.classList.replace('fa-moon', 'fa-sun');
                    icon.classList.replace('text-yellow-400', 'text-yellow-500');
                }
                if (label) label.textContent = 'Light Mode';
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                if (icon) {
                    icon.classList.replace('fa-sun', 'fa-moon');
                    icon.classList.replace('text-yellow-500', 'text-yellow-400');
                }
                if (label) label.textContent = 'Dark Mode';
            }
        });
    }
});

// Load saved personal info and themes
document.addEventListener('DOMContentLoaded', () => {
    const savedPersonal = localStorage.getItem('socialPlanPersonal');
    if (savedPersonal) {
        const data = JSON.parse(savedPersonal);
        if (document.getElementById('plan-areas')) document.getElementById('plan-areas').value = data.areas || '';
        if (document.getElementById('plan-hobbies')) document.getElementById('plan-hobbies').value = data.hobbies || '';
        if (document.getElementById('plan-family')) document.getElementById('plan-family').value = data.family || '';
        if (document.getElementById('custom-plan-prompt')) document.getElementById('custom-plan-prompt').value = data.custom || '';
    }

    const savedThemes = localStorage.getItem('socialPlanThemes');
    if (savedThemes) {
        const themes = JSON.parse(savedThemes);
        const themeIds = [
            'theme-family', 'theme-hobbies', 'theme-local', 'theme-fun', 'theme-polls',
            'theme-refi', 'theme-cashout', 'theme-purchase', 'theme-equity',
            'theme-recipes', 'theme-trivia', 'theme-localbusiness'
        ];
        themeIds.forEach(id => {
            const el = document.getElementById(id);
            if (el && themes[id] !== undefined) el.checked = themes[id];
        });
    }
});

// Save personal info on change
['plan-areas', 'plan-hobbies', 'plan-family', 'custom-plan-prompt'].forEach(id => {
    const el = document.getElementById(id);
    if (el) {
        el.addEventListener('input', () => {
            const data = {
                areas: document.getElementById('plan-areas')?.value || '',
                hobbies: document.getElementById('plan-hobbies')?.value || '',
                family: document.getElementById('plan-family')?.value || '',
                custom: document.getElementById('custom-plan-prompt')?.value || ''
            };
            localStorage.setItem('socialPlanPersonal', JSON.stringify(data));
        });
    }
});

// Save themes on change
const themeIds = [
    'theme-family', 'theme-hobbies', 'theme-local', 'theme-fun', 'theme-polls',
    'theme-refi', 'theme-cashout', 'theme-purchase', 'theme-equity',
    'theme-recipes', 'theme-trivia', 'theme-localbusiness'
];

themeIds.forEach(id => {
    const el = document.getElementById(id);
    if (el) {
        el.addEventListener('change', () => {
            const saved = JSON.parse(localStorage.getItem('socialPlanThemes') || '{}');
            saved[id] = el.checked;
            localStorage.setItem('socialPlanThemes', JSON.stringify(saved));
        });
    }
});
</script>
<script>
// === FULL EQUITY SCANNER ‚Äî CLEAN & FIXED (REPLACE ALL OLD CODE WITH THIS) ===

const CURRENT_DATE = new Date();

// Upload Listeners
const uploadArea = document.getElementById('upload-area');
const fileInput = document.getElementById('database-upload');
const fileStatus = document.getElementById('file-status');
const fileNameDisplay = document.getElementById('file-name');

uploadArea.addEventListener('click', (e) => {
    if (e.target.tagName === 'BUTTON') return;
    fileInput.click();
});

fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
        const file = e.target.files[0];
        fileStatus.textContent = 'File selected:';
        fileNameDisplay.textContent = file.name;
        fileNameDisplay.classList.remove('hidden');
    }
});

uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('border-[#F15A29]', 'bg-[#F15A29]/10');
});

uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('border-[#F15A29]', 'bg-[#F15A29]/10');
});

uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('border-[#F15A29]', 'bg-[#F15A29]/10');
    if (e.dataTransfer.files.length > 0) {
        fileInput.files = e.dataTransfer.files;
        const file = e.dataTransfer.files[0];
        fileStatus.textContent = 'File selected:';
        fileNameDisplay.textContent = file.name;
        fileNameDisplay.classList.remove('hidden');
    }
});

// Helpers
function excelSerialToDate(serial) {
    if (!serial || isNaN(serial)) return null;
    const utc_days = Math.floor(serial - 25569);
    const utc_value = utc_days * 86400 * 1000;
    const date = new Date(utc_value);
    date.setUTCDate(date.getUTCDate() + 1);
    return date;
}

function monthsBetween(start) {
    if (!start) return 0;
    let months = (CURRENT_DATE.getFullYear() - start.getFullYear()) * 12 + (CURRENT_DATE.getMonth() - start.getMonth());
    if (CURRENT_DATE.getDate() < start.getDate()) months--;
    return Math.max(0, months);
}

function getTermMonths(program, termCol) {
    // Priority 1: Use TERM column if present and valid (it's in months, e.g., 120 for 10yr, 360 for 30yr)
    if (termCol && !isNaN(termCol) && termCol > 0) {
        return parseInt(termCol);
    }

    // Priority 2: Parse years from Loan Program string (robust for "10 Yr.", "15 Yr.", "30 Yr.", etc.)
    if (program) {
        const match = program.match(/(\d+)\s*[Yy]r\.?/i);  // Matches "10 Yr", "15 Yr.", "30 Yr." etc.
        if (match) {
            return parseInt(match[1]) * 12;
        }
    }

    // Safe default (30 years) if nothing matches
    return 360;
}

function pmt(ratePercent, nper, pv) {
    const rate = ratePercent / 100 / 12;
    if (rate === 0) return pv / nper;
    return pv * rate / (1 - Math.pow(1 + rate, -nper));
}

function remainingBalance(principal, ratePercent, totalMonths, monthsPaid) {
    if (monthsPaid >= totalMonths || principal <= 0) return 0;
    const monthlyRate = ratePercent / 100 / 12;
    const payment = pmt(ratePercent, totalMonths, principal);
    let balance = principal;
    for (let i = 0; i < monthsPaid; i++) {
        const interest = balance * monthlyRate;
        balance -= (payment - interest);
        if (balance <= 0) return 0;
    }
    return Math.round(balance);
}

function formatMoney(num) {
    num = parseFloat(num) || 0;
    return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
}
let savingsMode = 'full';  // 'full' = Full Term Reset (Option 2, default), 'remaining' = Remaining Term (Option 1)
// Generate Report
function generateEquityReport() {
    if (!fileInput.files.length) {
        alert('Please upload a file');
        return;
    }

    const file = fileInput.files[0];
    const loading = document.getElementById('equity-loading');
    const output = document.getElementById('equity-output');

    if (loading) loading.classList.remove('hidden');
    if (output) {
        output.classList.add('hidden');
        output.innerHTML = '';
    }

    const reader = new FileReader();

    reader.onload = function(e) {
        let rawRows = [];
        try {
            const workbook = XLSX.read(e.target.result, { type: 'binary' });
            const sheet = workbook.Sheets['Data'] || workbook.Sheets[workbook.SheetNames[0]];
            rawRows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

            const headers = rawRows[0] || [];
            const col = {};
            const map = {
                first: 'BORROWER FIRST NAME',
                last: 'Borrower Last Name',
                email: 'BORR EMAIL',
                phone: 'BORR HOME PHONE',
                address: 'Subject Property Address',
                city: 'Subject Property City',
                state: 'Subject Property State',
                zip: 'Subject Property Zip',
                closing: 'CLOSING DATE',
                program: 'Loan Program',
                amount: 'Loan Amount',
                rate: 'Note Rate',
                term: 'TERM',
                appraised: 'Appraised Value',
                purchase: 'SUBJECT PROPERTY PURCHASE PRICE',
                mi: 'Monthly Mortgage Insurance at closing',
                pi: 'Principal and Interest Payment',
                ltv: 'LTV',
                insurance: 'UNDERWRITING HAZARD INS',
                taxes: 'UNDERWRITING TAXES',
                agent: 'BUYERS AGENT CONTACT NAME',
                transactionType: 'Loan Purpose'
            };

            Object.keys(map).forEach(k => {
                col[k] = headers.findIndex(h => h && h.trim() === map[k]);
            });

            // Temporary array for all processed rows
const tempRows = [];

// First pass: Process all rows
for (let i = 1; i < rawRows.length; i++) {
    const r = rawRows[i];
    if (!r || r.length < 10) continue;

    const loanAmount = parseFloat(r[col.amount]) || 0;
    if (loanAmount === 0) continue;

    const closingDate = excelSerialToDate(r[col.closing]);
    if (!closingDate) continue;

    let baseValue = parseFloat(r[col.purchase]) || 0;
    if (baseValue === 0) baseValue = parseFloat(r[col.appraised]) || 0;
    if (baseValue === 0) continue;

    const years = (CURRENT_DATE - closingDate) / (365.25 * 24 * 60 * 60 * 1000);
    const yearsInHome = Math.round(years);
    const currentValue = Math.round(baseValue * Math.pow(1.05, years));

    const rate = parseFloat(r[col.rate]) || 0;
    const termMonths = getTermMonths(r[col.program], r[col.term]);
    const monthsPaid = monthsBetween(closingDate);
    const balance = remainingBalance(loanAmount, rate, termMonths, monthsPaid);

    const originalLTV = parseFloat(r[col.ltv]) || 0;
    const currentLTV = currentValue > 0 ? (balance / currentValue) * 100 : 0;
    const pmiEligible = originalLTV > 80 && currentLTV <= 80;

    const equity = currentValue - balance;
    const cashOut = Math.max(0, Math.round(currentValue * 0.80 - balance));
    const moveUp = Math.max(0, Math.round(currentValue * 0.95 - balance));

    const fullName = `${r[col.first] || ''} ${r[col.last] || ''}`.trim() || 'Unknown Client';
    const fullAddress = `${r[col.address] || ''}, ${r[col.city] || ''}, ${r[col.state] || ''} ${r[col.zip] || ''}`.trim();

    let originalPI = parseFloat(r[col.pi]) || 0;
    if (originalPI <= 0 && rate >= 0 && termMonths > 0 && loanAmount > 0) {
        originalPI = pmt(rate, termMonths, loanAmount);
    }

    const monthlyMI = parseFloat(r[col.mi]) || (originalLTV > 80 ? Math.round(loanAmount * 0.008 / 12) : 0);
    const monthlyInsurance = parseFloat(r[col.insurance]) || Math.round(baseValue * 0.0035 / 12);
    const monthlyTaxes = parseFloat(r[col.taxes]) || Math.round(baseValue * 0.011 / 12);

    tempRows.push({
        fullName,
        fullAddress,
        phone: r[col.phone] || '',
        email: r[col.email] || '',
        loanProgram: r[col.program] || 'N/A',
        closingDate: closingDate.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric', year: 'numeric' }),
        closingDateObj: closingDate,
        rate,
        termMonths,
        remainingMonths: Math.max(termMonths - monthsPaid, 0),
        estimatedBalance: balance,
        currentValue,
        equity,
        cashOut,
        moveUp,
        yearsInHome,
        originalPI,
        originalMI: monthlyMI,
        originalInsurance: monthlyInsurance,
        originalTaxes: monthlyTaxes,
        originalLTV,
        currentLTV,
        pmiEligible,
        buyersAgent: r[col.agent] || '',
        transactionType: (r[col.transactionType] || 'N/A').trim(),
        monthlySavings: 0,
        isRefiReady: false,
        isCashOut: cashOut > 30000,
        isMoveUpReady: yearsInHome >= 3 && moveUp > 50000
    });
}

// Normalize address for duplicate key (removes punctuation, standardizes spacing)
const normalizeAddress = (addr) => addr
    .toLowerCase()
    .replace(/\./g, '')  // Remove periods (E. -> E)
    .replace(/,/g, '')   // Remove commas
    .replace(/\s+/g, ' ') // Multiple spaces to single
    .trim();

// De-duplication: Keep only newest loan per name + address
const seen = new Map();
tempRows.forEach(row => {
    const key = `${row.fullName.toLowerCase()}|${normalizeAddress(row.fullAddress)}`;
    const existing = seen.get(key);

    if (!existing || row.closingDateObj > existing.closingDateObj) {
        seen.set(key, row);
    }
});

// Final unique clients (newest loans only)
const clients = Array.from(seen.values());

window.currentOpportunities = clients;
buildDashboard();

const currentRate = parseFloat(document.getElementById('new-rate-input')?.value || 
                               document.getElementById('new-rate-slider')?.value || '6.0');
updateDashboardWithNewRate(currentRate);

        } catch (err) {
            console.error('Processing error:', err);
            if (output) {
                output.innerHTML = `<p class="text-red-600 text-center py-20 text-xl font-bold">Error processing file: ${err.message || 'Unknown error'}</p>`;
                output.classList.remove('hidden');
            }
        } finally {
            if (loading) loading.classList.add('hidden');
        }
    };

    reader.onerror = function() {
        if (output) {
            output.innerHTML = '<p class="text-red-600 text-center py-20 text-xl font-bold">Error reading file.</p>';
            output.classList.remove('hidden');
        }
        if (loading) loading.classList.add('hidden');
    };

    reader.readAsBinaryString(file);
}

// Dashboard - Updated to align initial savings with slider rate
function buildDashboard() {
    const opps = window.currentOpportunities || [];
    const output = document.getElementById('equity-output');
    if (!output) return;

    // Get current slider rate for initial recalc
    const currentRate = parseFloat(document.getElementById('new-rate-input')?.value || 
                                   document.getElementById('new-rate-slider')?.value || '6.0');

    output.innerHTML = `
    <div class="max-w-7xl mx-auto">
        <div class="bg-gradient-to-r from-[#F15A29] to-[#7c3aed] text-white p-8 rounded-3xl shadow-2xl mb-10 text-center relative">
            <button onclick="resetEquityTool()" class="absolute top-4 left-4 bg-white/20 hover:bg-white/30 text-white px-6 py-3 rounded-full font-bold transition-all shadow-md text-lg">
                ‚Üê New Scan
            </button>
            <h3 class="text-4xl font-bold mb-3">Equity Opportunity Dashboard</h3>
            <p class="text-xl mb-6">Analyzed ${opps.length} clients</p>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div class="bg-white/20 p-6 rounded-2xl">
                    <p class="text-5xl font-bold" id="count-refi">0</p>
                    <p class="text-xl mt-2">Refi Ready</p>
                </div>
                <div class="bg-white/20 p-6 rounded-2xl">
                    <p class="text-5xl font-bold" id="count-cash">0</p>
                    <p class="text-xl mt-2">Cash-Out</p>
                </div>
                <div class="bg-white/20 p-6 rounded-2xl">
                    <p class="text-5xl font-bold" id="count-move">0</p>
                    <p class="text-xl mt-2">Move-Up Ready</p>
                </div>
                <div class="bg-white/20 p-6 rounded-2xl">
                    <p class="text-5xl font-bold" id="count-pmi">0</p>
                    <p class="text-xl mt-2">PMI Removal</p>
                </div>
            </div>
        </div>

        <div class="flex flex-wrap gap-6 my-8 items-end justify-start">
            <div class="flex gap-4 items-center">
                <label class="text-xl font-semibold text-[#00A89D]">Sort by:</label>
                <select id="sort-select" class="p-3 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
                    <option value="savings">Highest Savings</option>
                    <option value="equity">Most Equity</option>
                    <option value="cash">Most Cash-Out</option>
                    <option value="move">Most Move-Up</option>
                    <option value="name">Name A‚ÄìZ</option>
                </select>
            </div>

            <div class="flex gap-4 items-center">
                <label class="text-xl font-semibold text-[#00A89D]">Transaction Type:</label>
                <select id="filter-transaction-type" class="p-3 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
                    <option value="All">All</option>
                    <option value="Purchase">Purchase</option>
                    <option value="Refinance">Refinance</option>
                </select>
            </div>

            <div class="flex gap-4 items-center">
                <label class="text-xl font-semibold text-[#00A89D]">Opportunity Type:</label>
                <select id="filter-opportunity-type" class="p-3 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
                    <option value="All">All</option>
                    <option value="Refi Ready">Refi Ready</option>
                    <option value="Cash-Out Goldmine">Cash-Out Goldmine</option>
                    <option value="Move-Up Ready">Move-Up Ready</option>
                    <option value="PMI Removal">PMI Removal</option>
                </select>
            </div>

            <div class="flex flex-nowrap items-center gap-8">
                <div class="flex gap-4 items-center">
                    <label class="text-xl font-semibold text-[#00A89D]">Closing Date From:</label>
                    <input type="date" id="filter-closing-from" class="p-3 w-48 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
                </div>
                <div class="flex gap-4 items-center">
                    <label class="text-xl font-semibold text-[#00A89D]">Closing Date To:</label>
                    <input type="date" id="filter-closing-to" class="p-3 w-48 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
                </div>
            </div>

            <div class="flex gap-4 items-center flex-1 max-w-lg ml-auto">
                <label class="text-xl font-semibold text-[#00A89D]">Search:</label>
                <input type="search" id="opportunity-search" placeholder="Name, address, city, phone, email..." class="flex-1 p-3 rounded-xl border-2 border-[#00A89D] bg-white dark:bg-gray-800">
            </div>
        </div>

        <div id="opportunity-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mb-12"></div>

        <div class="text-center mt-12 space-x-8">
            <button onclick="copyDashboard()" class="bg-[#002B5C] text-white px-12 py-6 rounded-full font-bold text-xl shadow-2xl">üìã Copy All Data</button>
            <button onclick="window.print()" class="bg-[#00A89D] text-white px-12 py-6 rounded-full font-bold text-xl shadow-2xl">üñ®Ô∏è Print Dashboard</button>
        </div>
    </div>
`;

    output.classList.remove('hidden');

    // Recalculate savings/flags/counts consistently (respects toggle mode and Math.abs)
    updateDashboardWithNewRate(currentRate);

    renderCards(opps);
    attachSearchAndSort();
}
function updateDashboardWithNewRate(newRate) {
    const opps = window.currentOpportunities || [];
    if (opps.length === 0) return;

    // Determine the actual rate to use (priority: passed newRate > fallback to 6%)
    let marketRate;
    
    if (typeof newRate === 'number' && !isNaN(newRate) && newRate > 0) {
        marketRate = newRate;  // No /100 ‚Äî pmt expects percent
    } else {
        const rateInput = document.getElementById('new-rate-input')?.value;
        const rateSlider = document.getElementById('new-rate-slider')?.value;
        
        const fallbackRate = parseFloat(rateInput || rateSlider || '6.0');
        marketRate = isNaN(fallbackRate) || fallbackRate <= 0 ? 6.0 : fallbackRate;
    }

    opps.forEach(opp => {
        const paddedBalance = (opp.estimatedBalance || 0) + 4000;
        let newPI = 0;

        const termToUse = savingsMode === 'full' 
            ? opp.termMonths 
            : (opp.remainingMonths || 0);

        if (termToUse > 0 && paddedBalance > 0 && marketRate > 0) {
            newPI = Math.abs(pmt(marketRate, termToUse, paddedBalance));
        }

        const newLTV = opp.currentValue > 0 ? (paddedBalance / opp.currentValue) * 100 : 100;
        const newMI = (newLTV > 80) ? (opp.originalMI || 0) : 0;

        let monthlySavings = (opp.originalPI + (opp.originalMI || 0)) - (newPI + newMI);
        monthlySavings = Math.max(0, Math.round(monthlySavings || 0));

        opp.monthlySavings = monthlySavings;

        const isRefiReady = monthlySavings > 100;
        const isCashOut = opp.cashOut > 50000;
        const isMoveUpReady = (opp.yearsInHome || 0) >= 3 && opp.moveUp > 100000;

        let primaryType = 'Standard Opportunity';
        if (isRefiReady) {
            primaryType = 'Refi Ready';
        } else if (isCashOut) {
            primaryType = 'Cash-Out Goldmine';
        } else if (isMoveUpReady) {
            primaryType = 'Move-Up Ready';
        }

        opp.isRefiReady = isRefiReady;
        opp.isCashOut = isCashOut;
        opp.isMoveUpReady = isMoveUpReady;
        opp.type = primaryType;

        opp.score = Math.round((monthlySavings / 5) + (opp.moveUp / 4000) + (opp.cashOut / 4000));
    });

    // Re-render tiles with updated data
    sortAndRenderCards();

    // Inline header counts update (uses the existing opps from top)
    if (opps.length > 0) {
        const refiReadyCount = opps.filter(opp => opp.isRefiReady).length;
        const cashOutCount = opps.filter(opp => opp.isCashOut).length;
        const moveUpCount = opps.filter(opp => opp.isMoveUpReady).length;
        const pmiCount = opps.filter(opp => opp.pmiEligible).length;

        document.getElementById('count-refi').textContent = refiReadyCount;
        document.getElementById('count-cash').textContent = cashOutCount;
        document.getElementById('count-move').textContent = moveUpCount;
        document.getElementById('count-pmi').textContent = pmiCount;
    }
}
// Render Cards (badges, no fallback)
function renderCards(opps) {
    const container = document.getElementById('opportunity-cards');
    if (!container) return;
    container.innerHTML = '';

    opps.forEach(c => {
        const card = document.createElement('div');
        card.className = 'bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 cursor-pointer hover:translate-y-[-8px] transition-all';
        card.innerHTML = `
            <h3 class="text-2xl font-bold text-[#00A89D] mb-2">${c.fullName}</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">${c.fullAddress}</p>
            <div class="grid grid-cols-2 gap-4 text-lg mb-6">
    <div><strong>Est. Value:</strong> ${formatMoney(c.currentValue)}</div>
    <div><strong>Est. Balance:</strong> ${formatMoney(c.estimatedBalance)}</div>
    <div><strong>Equity:</strong> ${formatMoney(c.equity)}</div>
    <div><strong>Savings/mo:</strong> <span class="text-green-600 font-bold">${formatMoney(c.monthlySavings)}</span></div>
    
    <!-- NEW: Conditional Cash-Out Amount -->
    ${c.cashOut > 50000 ? `<div><strong>Cash-Out Potential:</strong> <span class="text-green-600 font-bold text-xl">${formatMoney(c.cashOut)}</span></div>` : ''}
    
    <!-- NEW: Conditional Move-Up Amount -->
    ${c.moveUp > 100000 ? `<div><strong>Move-Up Equity:</strong> <span class="text-blue-600 font-bold text-xl">${formatMoney(c.moveUp)}</span></div>` : ''}
</div>
            <div class="flex flex-wrap gap-3">
                ${c.isRefiReady ? '<span class="px-5 py-2.5 rounded-full text-white font-bold bg-teal-600 shadow-md">Refi Ready</span>' : ''}
                ${c.isCashOut ? '<span class="px-5 py-2.5 rounded-full text-white font-bold bg-green-600 shadow-md">Cash-Out</span>' : ''}
                ${c.isMoveUpReady ? '<span class="px-5 py-2.5 rounded-full text-white font-bold bg-blue-600 shadow-md">Move-Up Ready</span>' : ''}
                ${c.pmiEligible ? '<span class="px-5 py-2.5 rounded-full text-white font-bold bg-purple-600 shadow-md">PMI Removal</span>' : ''}
            </div>
        `;
        card.onclick = () => openDetailModal(c);
        container.appendChild(card);
    });
}
function sortAndRenderCards() {
    let filtered = window.currentOpportunities || [];

    // Search
    const searchQuery = (document.getElementById('search-input')?.value || '').toLowerCase().trim();
    if (searchQuery) {
        filtered = filtered.filter(o => 
            (o.fullName || '').toLowerCase().includes(searchQuery) ||
            (o.fullAddress || '').toLowerCase().includes(searchQuery)
        );
    }

    // Filter type
    const filterType = document.getElementById('filter-type')?.value || 'All';
    if (filterType !== 'All') {
        if (filterType === 'Refi Ready') filtered = filtered.filter(o => o.isRefiReady);
        else if (filterType === 'Cash-Out Goldmine') filtered = filtered.filter(o => o.isCashOut);
        else if (filterType === 'Move-Up Ready') filtered = filtered.filter(o => o.isMoveUpReady);
        else if (filterType === 'PMI Removal Eligible') filtered = filtered.filter(o => o.pmiEligible);
    }

    // Sort
    const sortBy = document.getElementById('sort-by')?.value || 'score';
    filtered.sort((a, b) => (b[sortBy] || 0) - (a[sortBy] || 0));

    renderCards(filtered);
}
// Search & Sort
function attachSearchAndSort() {
    const search = document.getElementById('opportunity-search');
    const sort = document.getElementById('sort-select');
    const filterTransaction = document.getElementById('filter-transaction-type');
    const filterOpportunity = document.getElementById('filter-opportunity-type');
    const filterFrom = document.getElementById('filter-closing-from');
    const filterTo = document.getElementById('filter-closing-to');

    const refresh = () => {
        let list = window.currentOpportunities || [];

        // Search
        const term = search?.value.toLowerCase() || '';
        if (term) {
            list = list.filter(c => 
                c.fullName.toLowerCase().includes(term) ||
                c.fullAddress.toLowerCase().includes(term) ||
                (c.phone || '').includes(term) ||
                (c.email || '').toLowerCase().includes(term)
            );
        }

        // Transaction Type Filter (matches variations like "NoCash-Out Refinance", "Cash-Out Refinance")
        const transType = filterTransaction?.value || 'All';
        if (transType !== 'All') {
            if (transType === 'Purchase') {
                list = list.filter(c => c.transactionType && c.transactionType.toLowerCase().includes('purchase'));
            } else if (transType === 'Refinance') {
                list = list.filter(c => c.transactionType && c.transactionType.toLowerCase().includes('refinance'));
            }
        }

        // Opportunity Type Filter
        const oppType = filterOpportunity?.value || 'All';
        if (oppType !== 'All') {
            if (oppType === 'Refi Ready') list = list.filter(c => c.isRefiReady);
            else if (oppType === 'Cash-Out Goldmine') list = list.filter(c => c.isCashOut);
            else if (oppType === 'Move-Up Ready') list = list.filter(c => c.isMoveUpReady);
            else if (oppType === 'PMI Removal') list = list.filter(c => c.pmiEligible);
        }

        // Closing Date Range Filter (native calendar pickers)
        const fromDateStr = filterFrom?.value;
        const toDateStr = filterTo?.value;
        if (fromDateStr || toDateStr) {
            list = list.filter(c => {
                if (!c.closingDate) return false;
                const parts = c.closingDate.split('/');
                if (parts.length !== 3) return false;
                const clientDate = new Date(`${parts[2]}-${parts[0].padStart(2, '0')}-${parts[1].padStart(2, '0')}`);
                if (isNaN(clientDate.getTime())) return false;

                if (fromDateStr) {
                    const fromDate = new Date(fromDateStr);
                    if (clientDate < fromDate) return false;
                }
                if (toDateStr) {
                    const toDate = new Date(toDateStr);
                    toDate.setHours(23, 59, 59, 999);  // Include full end day
                    if (clientDate > toDate) return false;
                }
                return true;
            });
        }

        // Sort
        const val = sort?.value || 'savings';
        list.sort((a, b) => {
            if (val === 'savings') return b.monthlySavings - a.monthlySavings;
            if (val === 'equity') return b.equity - a.equity;
            if (val === 'cash') return b.cashOut - a.cashOut;
            if (val === 'move') return b.moveUp - a.moveUp;
            if (val === 'name') return a.fullName.localeCompare(b.fullName);
            return 0;
        });

        renderCards(list);
    };

    // Listeners
    if (search) search.addEventListener('input', refresh);
    if (sort) sort.addEventListener('change', refresh);
    if (filterTransaction) filterTransaction.addEventListener('change', refresh);
    if (filterOpportunity) filterOpportunity.addEventListener('change', refresh);
    if (filterFrom) filterFrom.addEventListener('change', refresh);
    if (filterTo) filterTo.addEventListener('change', refresh);

    refresh();  // Initial render
}

// Live Rate Updates (tiles savings match modal Option 2, badges/counts live)
document.addEventListener('DOMContentLoaded', () => {
    const rateSlider = document.getElementById('new-rate-slider');
    const rateInput = document.getElementById('new-rate-input');

    if (!rateSlider || !rateInput) return;

    const updateLive = () => {
        let rate = parseFloat(rateInput.value) || parseFloat(rateSlider.value) || 6.0;
        rate = Math.max(3.0, Math.min(8.0, rate));

        rateSlider.value = rate;
        rateInput.value = rate.toFixed(3);

        const opps = window.currentOpportunities;
        if (opps) {
            let refiCount = 0;
            opps.forEach(c => {
                const padded = c.estimatedBalance + 4000;
                const newPI = pmt(rate, c.termMonths, padded); // Match modal Option 2
                const newLTV = c.currentValue ? (padded / c.currentValue) * 100 : 100;
                const newMI = newLTV > 80 ? c.originalMI : 0;
                const savings = Math.max(0, Math.round(c.originalPI + c.originalMI - newPI - newMI));

                c.monthlySavings = savings;
                c.isRefiReady = savings > 100;

                if (c.isRefiReady) refiCount++;
            });

            document.getElementById('count-refi').textContent = refiCount;
        }

        renderCards(opps);
        if (window.currentOpenClient) updateRefiComparison(window.currentOpenClient);
    };

    rateSlider.addEventListener('input', updateLive);
    rateSlider.addEventListener('change', updateLive);
    rateInput.addEventListener('input', updateLive);
    rateInput.addEventListener('change', updateLive);

    updateLive();
});

// Dual Refi Comparison
function updateRefiComparison(client) {
    if (!client) return;

    const newRate = parseFloat(document.getElementById('new-rate-input')?.value || document.getElementById('new-rate-slider')?.value) || 6.0;
    const balance = client.estimatedBalance;
    const value = client.currentValue;
    const currentPI = client.originalPI;
    const currentMI = client.originalMI;

    let remainingMonths = client.termMonths;
    if (client.closingDate) {
        const parts = client.closingDate.split('/');
        if (parts.length === 3) {
            const closingDateObj = new Date(`${parts[2]}-${parts[0]}-${parts[1]}`);
            if (!isNaN(closingDateObj.getTime())) {
                const monthsPassed = monthsBetween(closingDateObj);
                remainingMonths = Math.max(client.termMonths - monthsPassed, 0);
            }
        }
    }

    const paddedBalance = balance + 4000;
    const currentLTV = value > 0 ? ((balance / value) * 100).toFixed(2) : 'N/A';

    // Use Math.abs to ensure positive payment values (consistent with dashboard)
    const newPIOpt1 = remainingMonths <= 0 ? 0 : Math.abs(pmt(newRate, remainingMonths, paddedBalance));
    const newMIOpt1 = currentMI;  // MI removal logic is already in dashboard; keep simple for modal (or add LTV check if desired)

    const newPIOpt2 = Math.abs(pmt(newRate, client.termMonths, paddedBalance));

    const savingsOpt1 = Math.max(0, Math.round(currentPI + currentMI - newPIOpt1 - newMIOpt1));
    const savingsOpt2 = Math.max(0, Math.round(currentPI + currentMI - newPIOpt2 - newMIOpt1));

    // Format values for the note
    const balanceFormatted = formatMoney(balance);
    const currentPIFormatted = formatMoney(currentPI);

    const note1 = `Savings calculated as: Current P&I (${currentPIFormatted}) - New P&I (${formatMoney(newPIOpt1)}) based on current balance (${balanceFormatted}), assuming $4,000 added for closing costs, new rate (${newRate.toFixed(3)}%), and remaining term (${remainingMonths} months).`;

    const note2 = `Savings calculated as: Current P&I (${currentPIFormatted}) - New P&I (${formatMoney(newPIOpt2)}) based on current balance (${balanceFormatted}), assuming $4,000 added for closing costs, new rate (${newRate.toFixed(3)}%), and reset to original term (${client.termMonths} months).`;

    document.getElementById('refi-comparison-grid').innerHTML = `
        <div class="space-y-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-300 dark:border-gray-600">
            <h5 class="text-2xl font-extrabold text-[#002B5C] dark:text-[#00A89D]">Option 1: Keep Remaining Term (~${remainingMonths} months)</h5>
            <p class="text-lg"><strong>Current Est. LTV:</strong> <span class="font-bold text-blue-600 text-xl">${currentLTV}%</span></p>
            <p class="text-lg"><strong>Current P&I:</strong> <span class="text-xl font-bold">${formatMoney(currentPI)}</span></p>
            <p class="text-lg"><strong>New P&I @ ${newRate.toFixed(3)}%:</strong> <span class="text-xl font-bold text-green-600">${formatMoney(newPIOpt1)}</span></p>
            <p class="text-lg"><strong>Monthly Savings:</strong> <span class="text-2xl font-extrabold text-green-600">${formatMoney(savingsOpt1)}</span></p>
            <p class="text-sm text-gray-500 italic mt-4">${note1}</p>
        </div>

        <div class="space-y-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-300 dark:border-gray-600">
            <h5 class="text-2xl font-extrabold text-[#002B5C] dark:text-[#00A89D]">Option 2: Reset to Original Term (${client.termMonths} months)</h5>
            <p class="text-lg"><strong>Current Est. LTV:</strong> <span class="font-bold text-blue-600 text-xl">${currentLTV}%</span></p>
            <p class="text-lg"><strong>Current P&I:</strong> <span class="text-xl font-bold">${formatMoney(currentPI)}</span></p>
            <p class="text-lg"><strong>New P&I @ ${newRate.toFixed(3)}%:</strong> <span class="text-xl font-bold text-green-600">${formatMoney(newPIOpt2)}</span></p>
            <p class="text-lg"><strong>Monthly Savings:</strong> <span class="text-2xl font-extrabold text-green-600">${formatMoney(savingsOpt2)}</span></p>
            <p class="text-sm text-gray-500 italic mt-4">${note2}</p>
        </div>
    `;
}
// Open Modal
function openDetailModal(client) {
    window.currentOpenClient = client;

    document.getElementById('modal-client-name').textContent = client.fullName || 'N/A';
    document.getElementById('modal-address').textContent = client.fullAddress || 'N/A';

    const phoneLink = document.getElementById('modal-phone-link');
    if (client.phone) {
        phoneLink.href = 'tel:' + client.phone.replace(/\D/g, '');
        phoneLink.textContent = client.phone;
        document.getElementById('modal-phone-na').classList.add('hidden');
    } else {
        document.getElementById('modal-phone-na').classList.remove('hidden');
    }

    const emailLink = document.getElementById('modal-email-link');
    if (client.email) {
        emailLink.href = 'mailto:' + client.email;
        emailLink.textContent = client.email;
        document.getElementById('modal-email-na').classList.add('hidden');
    } else {
        document.getElementById('modal-email-na').classList.remove('hidden');
    }

    document.getElementById('modal-program').textContent = client.loanProgram || 'N/A';
    document.getElementById('modal-closing-date').textContent = client.closingDate || 'N/A';
    document.getElementById('modal-current-rate').textContent = client.rate.toFixed(3) + '%';
    document.getElementById('modal-term').textContent = Math.round(client.termMonths / 12) + ' years';
    document.getElementById('modal-original-ltv').textContent = client.originalLTV.toFixed(2) + '%';
    document.getElementById('modal-balance').textContent = formatMoney(client.estimatedBalance);
    document.getElementById('modal-value').textContent = formatMoney(client.currentValue);
    document.getElementById('modal-original-pi').textContent = formatMoney(client.originalPI);
    document.getElementById('modal-original-mi').textContent = formatMoney(client.originalMI);
    document.getElementById('modal-original-insurance').textContent = formatMoney(client.originalInsurance);
    document.getElementById('modal-original-taxes').textContent = formatMoney(client.originalTaxes);
    
    document.getElementById('modal-pmi-alert').style.display = client.pmiEligible ? 'flex' : 'none';
// Add Equity Opportunities section (clean, high-impact, no duplicates)
let equitySection = document.getElementById('equity-opportunities-section');
if (equitySection) equitySection.remove();  // Remove previous if exists

equitySection = document.createElement('div');
equitySection.id = 'equity-opportunities-section';
equitySection.className = 'mt-10 p-8 bg-gradient-to-br from-green-100 to-blue-100 dark:from-green-900 dark:to-blue-900 rounded-2xl shadow-inner';

equitySection.innerHTML = `
    <h4 class="text-2xl font-bold text-[#002B5C] dark:text-[#00A89D] mb-6 flex items-center">
        <i class="fas fa-coins mr-3 text-[#F15A29]"></i>Equity Opportunities
    </h4>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center text-lg">
        <div>
            <p class="text-4xl font-black text-green-600">${formatMoney(client.cashOut)}</p>
            <p class="mt-3 text-gray-700 dark:text-gray-300">Cash-Out Potential<br><span class="text-sm">(80% LTV)</span></p>
        </div>
        <div>
            <p class="text-4xl font-black text-blue-600">${formatMoney(client.moveUp)}</p>
            <p class="mt-3 text-gray-700 dark:text-gray-300">Move-Up Equity<br><span class="text-sm">(95% net proceeds)</span></p>
        </div>
        <div>
            <p class="text-4xl font-black text-purple-600">${formatMoney(client.equity)}</p>
            <p class="mt-3 text-gray-700 dark:text-gray-300">Total Current Equity</p>
        </div>
    </div>
`;

// Insert after Original Loan Details (before Refinance Comparison)
const originalDetailsDiv = document.querySelector('.mt-10.p-8.bg-gradient-to-br.from-gray-100');  // Targets Original Loan Details div
if (originalDetailsDiv) {
    originalDetailsDiv.parentNode.insertBefore(equitySection, originalDetailsDiv.nextElementSibling.nextElementSibling);  // Adjusts for any siblings; safe placement before refi
} else {
    // Fallback: append to modal content if selector fails
    document.querySelector('#detail-modal .p-10').appendChild(equitySection);
}

    const agentSection = document.getElementById('modal-buyers-agent-section');
    agentSection.style.display = client.buyersAgent ? 'block' : 'none';
    if (client.buyersAgent) document.getElementById('modal-buyers-agent').textContent = client.buyersAgent;

    document.getElementById('modal-transaction-type').textContent = client.transactionType || 'N/A';

    const types = [];
    if (client.monthlySavings > 100) types.push('Refi Ready');
    if (client.cashOut > 50000) types.push('Cash-Out');
    if (client.moveUp > 100000) types.push('Move-Up Ready');
    if (client.pmiEligible) types.push('PMI Removal');
    document.getElementById('modal-type-badge').innerHTML = types.length ? types.map(t => `<span class="bg-[#F15A29] text-white px-4 py-2 rounded-full mr-2">${t}</span>`).join('') : '';

    updateRefiComparison(client);

    let scriptContent = '';
    const firstName = client.fullName.split(' ')[0] || 'there';
    const refiSavings = client.savingsOpt2 || 0;

    if (refiSavings > 50) {
        scriptContent = `Hi ${firstName},\n\nHope you're doing great! Quick update ‚Äî with current rates, we could **save you approximately $${Math.round(refiSavings)} per month** on your mortgage`;
        if (client.pmiEligible && client.originalMI > 0) {
            scriptContent += `, **including removing your $${Math.round(client.originalMI)} monthly PMI** since your equity has grown significantly.`;
        }
        scriptContent += `\n\nThis is one of the strongest opportunities I've seen for you right now. No pressure ‚Äî just wanted to offer a free review and see if this makes sense for your goals.\n\nWhen's a good time for a quick chat?\n\nBest,\n[Your Name]`;
    } else if (client.cashOut > 50000) {
        scriptContent = `Hi ${firstName},\n\nYour home has built up **$${Math.round(client.cashOut)} in potential cash-out equity** ‚Äî perfect for home improvements, debt consolidation, or any big plans you have.\n\nWith rates where they are, this could be a great time to access that equity. Interested in exploring your options?\n\nBest,\n[Your Name]`;
    } else if (client.moveUp > 100000) {
        scriptContent = `Hi ${firstName},\n\nWith **$${Math.round(client.moveUp)} in equity**, you're in a fantastic position to move up to your next dream home with a strong down payment.\n\nI'd love to help you explore what's possible in today's market. When can we chat?\n\nBest,\n[Your Name]`;
    } else {
        scriptContent = `Hi ${firstName},\n\nJust checking in on your loan from ${client.closingDate}. Your home has built solid equity since then ‚Äî wanted to see if there's anything we can do to improve your situation or prepare for your next steps.\n\nNo rush ‚Äî just let me know if you'd like a quick review!\n\nBest,\n[Your Name]`;
    }

        const scriptsSection = document.getElementById('modal-scripts');
    if (scriptsSection) {
        scriptsSection.innerHTML = `
            <div class="mt-12 p-8 bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 rounded-2xl">
                <div class="flex justify-between items-center mb-6">
                    <h4 class="text-2xl font-bold text-[#002B5C] dark:text-[#00A89D]">Personalized Outreach Script</h4>
                    <button id="copy-script-btn" class="bg-[#00A89D] hover:bg-[#00887A] text-white px-6 py-3 rounded-full font-bold flex items-center gap-3 shadow-lg transition-all">
                        <i class="fas fa-copy"></i> Copy Script
                    </button>
                </div>
                <div id="script-content" class="whitespace-pre-wrap text-lg bg-gray-50 dark:bg-gray-900 p-6 rounded-xl">${scriptContent}</div>
            </div>

            <div class="mt-8 p-4 bg-gradient-to-br from-[#00A89D]/5 to-[#F15A29]/5 rounded-xl text-sm">
                <h4 class="text-lg font-bold mb-3 text-[#002B5C] dark:text-[#00A89D]">Calculation Key</h4>
                <ul class="space-y-2 text-gray-700 dark:text-gray-300">
                    <li>‚Ä¢ <strong>Direct from file:</strong> Rate, P&I, MI, insurance, taxes, closing date, value, contacts</li>
                    <li>‚Ä¢ <strong>Home Value:</strong> Starting value √ó 5% annual compounded appreciation</li>
                    <li>‚Ä¢ <strong>Balance:</strong> Amortized from original terms</li>
                    <li>‚Ä¢ <strong>Cash-Out:</strong> 80% of value ‚àí balance</li>
                    <li>‚Ä¢ <strong>Move-Up:</strong> 95% of value (net selling costs) ‚àí balance</li>
                    <li>‚Ä¢ <strong>Savings:</strong> Current P&I + MI vs new loan @ selected rate (+$4k costs)</li>
                </ul>
            </div>
        `;

        // Copy button functionality with success feedback
        const copyBtn = document.getElementById('copy-script-btn');
        const scriptText = document.getElementById('script-content');
        if (copyBtn && scriptText) {
            copyBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(scriptText.textContent).then(() => {
                    copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    copyBtn.classList.remove('bg-[#00A89D]', 'hover:bg-[#00887A]');
                    copyBtn.classList.add('bg-green-600');
                    setTimeout(() => {
                        copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copy Script';
                        copyBtn.classList.remove('bg-green-600');
                        copyBtn.classList.add('bg-[#00A89D]', 'hover:bg-[#00887A]');
                    }, 2000);
                }).catch(() => {
                    alert('Copy failed ‚Äî please select and copy manually');
                });
            });
        }
    }

    document.getElementById('detail-modal').style.display = 'flex';
}

function closeDetailModal() {
    document.getElementById('detail-modal').style.display = 'none';
}

function copyDashboard() {
    const opps = window.currentOpportunities || [];
    if (opps.length === 0) return alert('No data');
    let text = 'Name\tAddress\tPhone\tEmail\tSavings\tCash-Out\tMove-Up\tValue\tBalance\n';
    opps.forEach(o => text += `${o.fullName}\t${o.fullAddress}\t${o.phone}\t${o.email}\t${o.monthlySavings}\t${o.cashOut}\t${o.moveUp}\t${o.currentValue}\t${o.estimatedBalance}\n`);
    navigator.clipboard.writeText(text).then(() => alert('Copied!'));
}

function resetEquityTool() {
    document.getElementById('equity-output')?.classList.add('hidden');
    fileInput.value = '';
    window.currentOpportunities = null;
}
</script>
<!-- Loading Overlay -->
<div id="generate-loading" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
    <div class="bg-white dark:bg-gray-800 p-12 rounded-3xl shadow-2xl text-center max-w-lg mx-4">
        <i class="fas fa-spinner fa-spin text-8xl text-[#00A89D] mb-8"></i>
        <p class="text-3xl font-bold text-[#002B5C] dark:text-white">Building Your Weekly Win Plan...</p>
        <p class="text-xl mt-6 text-gray-600 dark:text-gray-400">Preparing your personalized plan, it may take 45‚Äì60 seconds...
    </div>
</div>

<!-- Post Ideas Modal -->
<div id="post-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <div class="modal-header">
            <h3 id="modal-title" class="text-3xl font-bold"></h3>
            <p class="text-xl mt-4 text-gray-600 dark:text-gray-400">Feel free to copy any idea, or use it as inspiration for the AI generator!</p>
        </div>
        <ul id="modal-suggestions" class="modal-suggestions list-disc pl-8 space-y-4 text-lg">
            <!-- Filled by JS -->
        </ul>
    </div>
</div>
<!-- Database Nurturing Category Modals -->
<div id="db-modal" class="modal">
    <div class="modal-content max-w-4xl">
        <span class="close-modal" onclick="closeDatabaseModal()">&times;</span>
        <div class="modal-header">
            <h3 id="db-modal-title" class="text-4xl"></h3>
        </div>
        <div id="db-modal-content" class="space-y-8 text-lg">
            <!-- Filled dynamically by JS -->
        </div>
    </div>
</div>
<!-- Referral Partners Category Modals -->
<div id="referral-modal" class="modal">
    <div class="modal-content max-w-4xl">
        <span class="close-modal" onclick="closeReferralModal()">&times;</span>
        <div class="modal-header">
            <h3 id="referral-modal-title" class="text-4xl"></h3>
        </div>
        <div id="referral-modal-content" class="space-y-8 text-lg">
            <!-- Filled dynamically by JS -->
        </div>
    </div>
</div>
<!-- Add this modal HTML anywhere in your <body> (preferably near other modals like #detail-modal) -->
<!-- UPDATED Modal HTML (make tip the star) -->
<div id="task-tip-modal" class="fixed inset-0 bg-black/70 z-50 items-center justify-center hidden" onclick="closeTaskTipModal()">
    <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl w-full max-w-2xl max-h-[80vh] overflow-y-auto m-4 p-12 relative text-center" onclick="event.stopPropagation()">
        <button onclick="closeTaskTipModal()" class="absolute top-6 right-6 ...">&times;</button>

        <i class="fas fa-lightbulb text-8xl text-[#F15A29] mb-8 block mx-auto animate-pulse"></i>
        <h3 class="text-4xl font-bold text-[#00A89D] mb-8">Elite Coaching Tip</h3>
        <div id="task-tip-text" class="text-2xl text-gray-800 dark:text-gray-200 leading-relaxed px-8"></div>

        <p class="mt-12 text-lg text-gray-600 dark:text-gray-400 italic">Click outside, X, or Esc to close ‚Ä¢ Go crush it! üî•</p>
    </div>
</div>
</div>
<!-- Detail Modal for Equity Scanner -->
<div id="detail-modal" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4" style="display: none;" onclick="closeDetailModal()">
    <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
        <!-- Close button -->
        <button onclick="closeDetailModal()" class="absolute top-6 right-6 text-4xl text-gray-500 hover:text-gray-700 z-10 bg-white/90 dark:bg-gray-800/90 rounded-full w-14 h-14 flex items-center justify-center shadow-lg">&times;</button>

        <!-- Content -->
        <div class="p-10 pt-20 pb-12">
            <h3 class="text-4xl font-black text-[#F15A29] mb-4" id="modal-client-name"></h3>
            <p class="text-2xl text-gray-700 dark:text-gray-300 mb-10" id="modal-address"></p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10 mb-10">
                <div class="space-y-6 text-lg">
                    <p><strong>Phone:</strong> 
                        <a id="modal-phone-link" href="" class="text-green-600 font-bold hover:underline text-xl"></a>
                        <span id="modal-phone-na" class="text-gray-500 ml-3 hidden">Not available</span>
                    </p>
                    <p><strong>Email:</strong> 
                        <a id="modal-email-link" href="" class="text-blue-600 font-bold hover:underline text-xl"></a>
                        <span id="modal-email-na" class="text-gray-500 ml-3 hidden">Not available</span>
                    </p>
                </div>
                <div class="space-y-6 text-lg" id="modal-buyers-agent-section" style="display: none;">
                    <p><strong>Transaction Type:</strong> <span id="modal-transaction-type"></span></p>
                    <p><strong>Buyer's Agent:</strong> <span id="modal-buyers-agent" class="font-bold text-purple-600"></span></p>
                </div>
            </div>

            <!-- Original Loan Details Section -->
            <div class="mt-10 p-8 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-900 dark:to-gray-800 rounded-2xl shadow-inner">
                <h4 class="text-2xl font-bold text-[#002B5C] dark:text-[#00A89D] mb-6 flex items-center"><i class="fas fa-file-invoice-dollar mr-3 text-[#F15A29]"></i>Original Loan Details</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-lg">
                    <p><strong>Program:</strong> <span id="modal-program"></span></p>
                    <p><strong>Closing Date:</strong> <span id="modal-closing-date"></span></p>
                    <p><strong>Rate:</strong> <span id="modal-current-rate"></span></p>
                    <p><strong>Term:</strong> <span id="modal-term"></span></p>
                    <p><strong>Original LTV:</strong> <span id="modal-original-ltv"></span></p>
                    <p><strong>Est. Balance:</strong> <span id="modal-balance"></span></p>
                    <p><strong>Estimated Home Value:</strong> <span id="modal-value"></span></p>
                    <p><strong>P&I Payment:</strong> <span id="modal-original-pi"></span></p>
                    <p><strong>Monthly MI:</strong> <span id="modal-original-mi"></span></p>
                    <p><strong>Homeowners Insurance:</strong> <span id="modal-original-insurance"></span></p>
                    <p><strong>Property Taxes:</strong> <span id="modal-original-taxes"></span></p>
                </div>
                <p id="modal-pmi-alert" class="bg-green-600 text-green p-6 rounded-xl font-bold flex items-center justify-center text-lg shadow-lg mt-6" style="display: none;">
    <i class="fas fa-check-circle mr-3 text-2xl"></i>Eligible for PMI Removal! (Current LTV ‚â§ 80%)
</p>
            </div>

                     <!-- Current Estimates & Comparison Section -->
<div class="mt-10 p-8 bg-gradient-to-br from-[#00A89D]/10 to-[#F15A29]/10 rounded-2xl shadow-inner">
    <h4 class="text-3xl font-bold text-[#002B5C] dark:text-[#00A89D] mb-8 flex items-center"><i class="fas fa-chart-line mr-3 text-[#00A89D] text-2xl"></i>Current Estimates & Refinance Comparison</h4>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10" id="refi-comparison-grid">
        <!-- This will be populated dynamically by JS -->
    </div>
</div>

            <p class="mt-6"><strong>Opportunity Type(s):</strong> <span id="modal-type-badge"></span></p>

                        <!-- Personalized Scripts Section -->
            <div id="modal-scripts" class="mt-12"></div>

                       <!-- Call to Action Buttons -->
            <div class="mt-10 text-center">
                <button onclick="closeDetailModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-10 py-4 rounded-full font-bold text-xl">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>
</div>
<div id="save-toast" class="hidden fixed bottom-8 left-1/2 -translate-x-1/2 bg-green-600 text-white px-10 py-6 rounded-full shadow-2xl text-2xl font-bold z-50 flex items-center gap-4 animate-pulse transition-all">
    <i class="fas fa-check-circle text-4xl"></i>
    Settings Saved Successfully!
</div>
<script>

    const dailyActivities = [
        "Write two personal notes or thank-you cards to clients, referral partners, or prospects.",
        "Make at least five outbound calls to past clients or referral partners.",
        "Send personalized birthday messages using video to your past clients.",
        "Engage on social media by commenting on or liking 10 posts from realtors, clients, and referral partners.",
        "Record and post one short-form video or story about mortgage tips, market updates, or client success stories.",
        "Follow up with any new online or social media leads received in the past 24 hours.",
        "Reach out to a past client just to check in‚Äîno sales pitch, just relationship-building.",
        "Send a text or video message to a referral partner to stay top of mind.",
        "Knock on one local business door to introduce yourself (title companies, insurance agents, CPAs, etc.).",
        "Spend time reviewing and updating CRM with notes, follow-ups, and next actions."
    ];

    const weeklyActivities = [
        "Pipeline review with referral partners‚Äîdiscuss upcoming deals and potential new clients.",
        "Pipeline review with active clients‚Äîtouch base with a weekly update, even if nothing new.",
        "Host a 15-minute coaching call (Zoom or Teams) for realtors on mortgage trends or strategies.",
        "Attend at least one networking event (chamber of commerce, BNI, or real estate meetup).",
        "Send a ‚ÄúWho do you know?‚Äù text to 5+ referral partners asking for warm introductions.",
        "Create and send a value-packed email to your database (market updates, home tips, etc.).",
        "Record and send a personalized video email to new leads or referral partners.",
        "Reach out to 3 new real estate agents via social media or in person.",
        "Host a casual coffee meeting with a referral partner or past client.",
        "Review past closed loans and follow up with clients who may benefit from refinancing."
    ];

    const weekendActivities = [
        "Post a personal social media update (family, hobby, local Auburn spot, or fun weekend vibe)",
        "Check and respond to any weekend inquiries, messages, or new leads",
        "Engage lightly on social: Like/comment on 5‚Äì10 posts from realtors/clients (no heavy prospecting)",
        "Quick Sunday prep: Review your calendar and pick Monday's top 10 calls",
        "Plan your social posts for the upcoming week (use your Social Calendar tool)",
        "Light CRM check: Flag any hot weekend leads for Monday follow-up",
        "Relax & recharge ‚Äî share a weekend inspiration quote or gratitude post",
        "Family/fun time post ‚Äî keep it authentic and relationship-focused",
        "Quick win: Send 3 'just checking in' texts to warm past clients",
        "Prepare one value video (market tip or fun fact) to post Monday"
    ];

    // Confetti function
    function launchConfetti() {
        const canvas = document.getElementById('confetti-canvas');
        if (!canvas) return;
        canvas.classList.remove('hidden');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const confetti = [];
        const colors = ['#F15A29', '#00A89D', '#FFD700', '#FF69B4'];

        for (let i = 0; i < 400; i++) {
            confetti.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                r: Math.random() * 8 + 3,
                d: Math.random() * 12 + 6,
                color: colors[Math.floor(Math.random() * colors.length)],
                tilt: Math.random() * 10 - 5,
                tiltAngle: 0
            });
        }

        let animationFrame;
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((c, i) => {
                c.tiltAngle += 0.1;
                c.y += c.d;
                c.tilt = Math.sin(c.tiltAngle) * 20;

                ctx.beginPath();
                ctx.lineWidth = c.r;
                ctx.strokeStyle = c.color;
                ctx.moveTo(c.x + c.tilt + c.r, c.y);
                ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r);
                ctx.stroke();

                if (c.y > canvas.height) confetti.splice(i, 1);
            });

            if (confetti.length > 0) animationFrame = requestAnimationFrame(draw);
            else canvas.classList.add('hidden');
        }
        draw();
    }

    // Setup & Persistence
    let userSetup = JSON.parse(localStorage.getItem('winPlanSetup')) || {
    name: "Loan Officer",
    monthlyGoal: 8,
    focus: "Balanced",
    lastMonth: 0,
    partners: 0,
    pastClients: 0,
    hours: "15‚Äì20",
    hobbies: [],
    hobbiesOther: "",
    preferredActivities: []  // NEW: Initialize as empty array
};
    let streak = parseInt(localStorage.getItem('winPlanStreak')) || 0;

    function updateSetupDisplays() {
        const name = userSetup.name.trim() || "Loan Officer";
        const titleEl = document.getElementById('personalized-title');
        if (titleEl) titleEl.textContent = `${name}'s Weekly Win Plan üî•`;
        const goalEl = document.getElementById('monthly-goal-display');
        if (goalEl) goalEl.textContent = userSetup.monthlyGoal;

        const touchesNeeded = userSetup.monthlyGoal * 9;
        const targetEl = document.getElementById('weekly-target');
        if (targetEl) targetEl.textContent = `For ${userSetup.monthlyGoal} loans: Aim for ~${touchesNeeded} touches this week`;

        const streakEl = document.getElementById('streak-display');
        if (streakEl) streakEl.textContent = `${streak} Week Streak`;
        const messageEl = document.getElementById('streak-message');
        if (messageEl) messageEl.textContent = streak > 0 ? `${name}, you're on fire!` : `${name}, let's build your streak!`;
    }

    updateSetupDisplays();

    // Wizard functions
    function openSetupWizard() {
        const wizard = document.getElementById('setup-wizard');
        if (!wizard) return;
        document.getElementById('setup-name').value = userSetup.name;
        document.getElementById('setup-monthly-goal').value = userSetup.monthlyGoal;
        document.getElementById('setup-focus').value = userSetup.focus;
        document.getElementById('setup-last-month').value = userSetup.lastMonth || '';
        document.getElementById('setup-partners').value = userSetup.partners || '';
        document.getElementById('setup-past-clients').value = userSetup.pastClients || '';
        document.getElementById('setup-hours').value = userSetup.hours;
        document.getElementById('setup-hobbies-other').value = userSetup.hobbiesOther || '';
        wizard.classList.remove('hidden');
    }

    function saveSetup() {
    const wizard = document.getElementById('setup-wizard');
    if (!wizard) return;

    // Capture and save all values (exactly as you had it)
    userSetup.name = document.getElementById('setup-name').value.trim() || "Loan Officer";
    userSetup.monthlyGoal = parseInt(document.getElementById('setup-monthly-goal').value) || 8;
    userSetup.focus = document.getElementById('setup-focus').value;
    userSetup.lastMonth = parseInt(document.getElementById('setup-last-month').value) || 0;
    userSetup.partners = parseInt(document.getElementById('setup-partners').value) || 0;
    userSetup.pastClients = parseInt(document.getElementById('setup-past-clients').value) || 0;
    userSetup.hours = document.getElementById('setup-hours').value;
    userSetup.hobbies = Array.from(document.querySelectorAll('.hobby-checkbox:checked')).map(cb => cb.value);
    userSetup.hobbiesOther = document.getElementById('setup-hobbies-other').value.trim();
    userSetup.preferredActivities = Array.from(document.querySelectorAll('.activity-checkbox:checked')).map(cb => cb.value);

    // Save to localStorage
    localStorage.setItem('winPlanSetup', JSON.stringify(userSetup));

    // Close the modal
    wizard.classList.add('hidden');

    // Update any live displays (e.g., name/goal in header)
    updateSetupDisplays();

    // Show the big green confirmation toast
    const toast = document.getElementById('save-toast');
    if (toast) {
        toast.classList.remove('hidden');
        setTimeout(() => {
            toast.classList.add('hidden');
        }, 4000); // Auto-hide after 4 seconds
    }
}

    // Task Help
    function showTaskHelp(task) {
        const modal = document.getElementById('task-help-modal');
        if (!modal) return;
        document.getElementById('task-help-title').textContent = task;
        let content = `<p class="text-xl mb-6 font-bold">How to crush this:</p>`;

        if (task.includes("calls") || task.includes("outbound")) {
            content += `<p><strong>Script:</strong> "Hey [Name], it's ${userSetup.name} ‚Äî rates are great right now, who do you know thinking about buying/refi?"</p>`;
            content += `<p class="mt-4">Tip: Smile when you dial ‚Äî they hear it!</p>`;
        } else if (task.includes("social") || task.includes("post")) {
            content += `<p>Use your Social Post Creator ‚Üí grab today's idea and post it now</p>`;
        } else if (userSetup.hobbies.length > 0) {
            content += `<p>Pro move: Tie this to your passion (${userSetup.hobbies[0]}) ‚Äî invite a partner to join!</p>`;
        }

        content += `<p class="mt-6 text-2xl font-bold">‚è± Start a 25-min timer and go!</p>`;
        document.getElementById('task-help-content').innerHTML = content;
        modal.classList.remove('hidden');
    }

    function closeTaskHelp() {
        const modal = document.getElementById('task-help-modal');
        if (!modal) return;
        modal.classList.add('hidden');
    }

    function buildPlanCards(dayTasksArray) {
    const container = document.getElementById('weekly-tasks-container');
    if (!container) {
        console.error('ERROR: #weekly-tasks-container missing in HTML');
        return;
    }

    let grid = container.querySelector('.grid');
    if (!grid) {
        // Safety: create grid if missing
        grid = document.createElement('div');
        grid.className = 'grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8';
        const progressSection = container.querySelector('.mt-20');
        container.insertBefore(grid, progressSection || null);
    }
    grid.innerHTML = ''; // Clear old cards

    let allTasks = 0;
    const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];

    dayTasksArray.forEach((dayObj, i) => {
        if (!dayObj || !dayObj.tasks || !Array.isArray(dayObj.tasks)) return;

        const day = days[i] || 'Day';
        const card = document.createElement('div');
        card.className = 'bg-gradient-to-br from-gray-800/90 to-gray-900 rounded-3xl p-8 shadow-2xl hover:scale-105 transition-all border border-[#00A89D]/30';

        let taskHTML = '<ul class="space-y-6">';
        dayObj.tasks.forEach(item => {
            // Support both string tasks (old format) and object {task, tip}
            const taskText = typeof item === 'object' ? item.task || '' : item;
            const tipText = typeof item === 'object' ? (item.tip || 'Stay focused and crush this task!') : 'Pro tip: Batch similar tasks for maximum momentum.';

            // Escape single quotes for JS safety
            const escapedTip = tipText.replace(/'/g, "\\'").replace(/"/g, '&quot;');

            taskHTML += `
                <li onclick="showTaskTip('${escapedTip}')" 
                    class="flex items-start gap-5 text-lg hover:bg-white/10 p-4 rounded-2xl transition-all cursor-pointer">
                    <input type="checkbox" class="w-8 h-8 mt-1 text-[#F15A29] rounded-lg focus:ring-[#00A89D] flex-shrink-0">
                    <span class="text-gray-200 leading-relaxed">${taskText}</span>
                </li>`;
            allTasks++;
        });
        taskHTML += '</ul>';

        const dayEmoji = day === "Saturday" || day === "Sunday" 
            ? ['üå¥','‚òÄÔ∏è','üõãÔ∏è','üì±','üåô'][i - 5] || 'üåü'
            : ['üí™','‚òéÔ∏è','ü§ù','üìà','‚òï'][i];

        card.innerHTML = `
            <h3 class="text-3xl font-bold mb-6 flex items-center ${
                day === "Saturday" || day === "Sunday" ? 'text-[#F15A29]/80' : 'text-[#00A89D]'
            }">
                <span class="text-5xl mr-4">${dayEmoji}</span> ${day} ${day === "Saturday" || day === "Sunday" ? '(Recharge Mode)' : ''}
            </h3>
            ${taskHTML}
        `;

        grid.appendChild(card);
    });

    // Update total tasks
    const tasksTotalEl = document.getElementById('tasks-total');
    if (tasksTotalEl) tasksTotalEl.textContent = allTasks;

    // Update progress + streak (your existing logic)
    updateProgress();

    streak++;
    localStorage.setItem('winPlanStreak', streak);
    updateSetupDisplays();
}

// === Simple, Clean Tip Display (replace alert with toast/modal later if desired) ===
function showTaskTip(tipText) {
    // Clean up any escaped quotes
    tipText = tipText.replace(/&quot;/g, '"').replace(/\\'/g, "'");

    // Set the tip text
    const tipEl = document.getElementById('task-tip-text');
    if (tipEl) tipEl.textContent = tipText;

    // Open modal
    const modal = document.getElementById('task-tip-modal');
    if (modal) {
        modal.classList.remove('hidden');
        modal.classList.add('flex');
    }

    // Optional confetti burst for energy
    if (typeof confetti === 'function') {
        confetti({
            particleCount: 80,
            spread: 70,
            origin: { y: 0.6 }
        });
    }
}

function closeTaskTipModal() {
    const modal = document.getElementById('task-tip-modal');
    if (modal) {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
    }
}

// Optional: Close on Escape key
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeTaskTipModal();
    }
});

    // Generate Plan ‚Äî AI first, silent local fallback
    async function generateWeeklyPlan() {
    const loading = document.getElementById('generate-loading');
    const generateBtn = document.getElementById('generate-win-plan-btn');
    const originalBtnText = generateBtn ? generateBtn.innerHTML : '<i class="fas fa-bolt-lightning mr-4 text-3xl"></i> Build My Personalized Win Plan';

    if (loading) loading.classList.remove('hidden');
    if (generateBtn) {
        generateBtn.disabled = true;
        generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-3"></i>Generating AI Plan...';
    }

    const container = document.getElementById('weekly-tasks-container');
    if (!container) {
        if (loading) loading.classList.add('hidden');
        if (generateBtn) {
            generateBtn.disabled = false;
            generateBtn.innerHTML = originalBtnText;
        }
        return;
    }

    container.classList.remove('hidden');

    let grid = container.querySelector('.grid');
    if (!grid) {
        grid = document.createElement('div');
        grid.className = 'grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8';
        const progressSection = container.querySelector('.mt-20');
        container.insertBefore(grid, progressSection || null);
    }
    grid.innerHTML = '';

    let dayTasks = [];

    if (userSetup.focus !== "Balanced") {
        try {
            const systemPrompt = `You are a world-class, elite loan officer sales coach with 20+ years of experience coaching top-producing loan officers to 7-figure incomes. Your style is direct, motivational, strategic, and deeply personalized‚Äîyou speak like a high-energy mentor who truly cares about the loan officer's success, work-life balance, and authentic relationships.

Create an ultra-personalized, high-impact 7-day prospecting and relationship-building plan for ${userSetup.name}. This plan must feel custom-built for them, incorporating every detail they shared to maximize production while protecting their energy and personal life.

Key Personal Details:
- Name: ${userSetup.name}
- Monthly funded loan goal: ${userSetup.monthlyGoal} loans
- Last month's funded loans: ${userSetup.lastMonth > 0 ? userSetup.lastMonth : 'not provided / starting fresh'}
- Active referral partners: ${userSetup.partners}
- Past client database size: ${userSetup.pastClients} clients
- Weekly prospecting hours available: ${userSetup.hours}
- Primary prospecting focus: ${userSetup.focus}
- Passions & hobbies: ${[...userSetup.hobbies, userSetup.hobbiesOther].filter(Boolean).join(", ") || 'none shared‚Äîfocus on professional growth and family time'}
- Preferred prospecting activities: ${userSetup.preferredActivities.length > 0 ? userSetup.preferredActivities.join(", ") : 'no strong preferences ‚Äî mix it up'}

Prioritize tasks involving these activities when possible, while keeping balance.

Strategic Guidelines:
- Scale task volume and intensity to fit their available prospecting hours (${userSetup.hours}). Do not overload‚Äîaim for focused, high-leverage actions.
- Leverage their database size: prioritize warm outreach when possible.
- Honor their primary focus (${userSetup.focus})‚Äîweight tasks accordingly.
- Weave in passions/hobbies naturally ONLY when authentic (e.g., golf for partner outreach).
- Weekdays: Heavy focused prospecting.
- Weekends: Light recharge, nurturing, recovery.
- Tasks: Specific, actionable, motivating, with emojis.
- Draw from these pools but vary wording: Daily: ${dailyActivities.join("; ")}; Weekly: ${weeklyActivities.join("; ")}; Weekend: ${weekendActivities.join("; ")}

CRITICAL TIP GUIDELINES (MUST FOLLOW EXACTLY):
- For EVERY task, provide EXACTLY one short, high-value tip (1-2 sentences).
- Tip MUST be directly relevant/practical for that SPECIFIC task (mindset, script, leverage).
- Make tips coach-like and motivating ("Crush this by...", "Pro move:").
- Weave hobbies ONLY if it genuinely fits ‚Äî NEVER force.
- Tips must ALWAYS make sense and deliver real value.

Output ONLY valid JSON:
{
  "days": [
    {
      "day": "Monday",
      "tasks": [
        {
          "task": "üéØ Example task",
          "tip": "Practical motivating tip here"
        }
      ]
    }
  ]
}`;

            const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                    messages: [{ role: "user", content: systemPrompt }],
                    temperature: 0.8,
                    max_tokens: 2000
                })
            });

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`API error ${response.status}: ${errorText}`);
            }

            const data = await response.json();
            const rawContent = data.choices[0]?.message?.content || '';

            if (!rawContent) throw new Error('Empty response');

            // Robust JSON extraction
            let jsonString = rawContent.trim();
            jsonString = jsonString.replace(/^```json\s*|```$/gi, '').trim();
            const firstBrace = jsonString.indexOf('{');
            const lastBrace = jsonString.lastIndexOf('}');
            if (firstBrace !== -1 && lastBrace !== -1) {
                jsonString = jsonString.substring(firstBrace, lastBrace + 1);
            }

            let parsed = JSON.parse(jsonString);

            // Normalize to {day, tasks: [{task, tip}]}
            dayTasks = (parsed.days || []).map(dayObj => ({
                day: dayObj.day || 'Day',
                tasks: (dayObj.tasks || []).map(item => ({
                    task: (typeof item === 'object' ? (item.task || item.text || '') : item || '').trim(),
                    tip: (typeof item === 'object' ? (item.tip || item.advice || 'Execute with focus and energy!') : 'Crush this task with intention!').trim()
                })).filter(t => t.task)
            }));

            if (dayTasks.length === 0) throw new Error('No valid tasks');

        } catch (err) {
            console.log('AI plan failed:', err.message || err);
            console.log('Using enhanced local fallback');
            dayTasks = generateLocalDayTasks();
        }
    } else {
        dayTasks = generateLocalDayTasks();
    }

    buildPlanCards(dayTasks);
    updateProgress();

    if (loading) loading.classList.add('hidden');
    if (generateBtn) {
        generateBtn.disabled = false;
        generateBtn.innerHTML = originalBtnText;
    }
}

// === Enhanced Local Fallback (returns {task, tip} with valuable generic tips) ===
function generateLocalDayTasks() {
    const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];

    const tipMap = {
        'call': 'Smile and stand ‚Äî energy transfers over the phone. Lead with curiosity.',
        'follow': 'Reference your last touch immediately for instant rapport.',
        'partner': 'Offer value first (market update) before asking for referrals.',
        'social': 'Include a clear CTA and engage every comment fast.',
        'client': 'Make it personal ‚Äî mention something specific from their life.',
        'default': 'Batch similar tasks and track results for momentum.'
    };

    return days.map((day, i) => {
        let tasks = [];
        if (day === "Saturday" || day === "Sunday") {
            tasks = weekendActivities.map(t => ({
                task: `üåü ${t}`,
                tip: tipMap['social'] || tipMap['default']
            }));
        } else {
            dailyActivities.slice(0, 6).forEach(t => {
                const key = t.toLowerCase().includes('call') ? 'call' :
                            t.toLowerCase().includes('follow') ? 'follow' :
                            t.toLowerCase().includes('partner') ? 'partner' : 'default';
                tasks.push({ task: `üéØ ${t}`, tip: tipMap[key] });
            });
            if (i < weeklyActivities.length) {
                tasks.push({
                    task: weeklyActivities[i],
                    tip: 'Block deep focus time ‚Äî these compound massively.'
                });
            }
        }
        return { day, tasks };
    });
}

function updateProgress() {
    const checkboxes = document.querySelectorAll('#weekly-tasks-container input[type="checkbox"]');
    const completed = Array.from(checkboxes).filter(cb => cb.checked).length;
    const total = checkboxes.length;

    const tasksCompletedEl = document.getElementById('tasks-completed');
    if (tasksCompletedEl) tasksCompletedEl.textContent = completed;

    const tasksTotalEl = document.getElementById('tasks-total');
    if (tasksTotalEl) tasksTotalEl.textContent = total;

    const progressBar = document.getElementById('weekly-progress-bar');
    if (progressBar) {
        const percent = total > 0 ? (completed / total) * 100 : 0;
        progressBar.style.width = percent + '%';
    }

    const completionMsg = document.getElementById('completion-message');
    if (!completionMsg) return;

    const name = userSetup.name.trim() || "Champion"; // pulls your saved name
    const percent = total > 0 ? (completed / total) * 100 : 0;

    if (percent === 100) {
        completionMsg.innerHTML = `
            <span class="text-5xl animate-bounce">üéâ ${name}, YOU CRUSHED THIS WEEK! üéâ</span><br>
            <span class="text-3xl mt-6 block">Top-tier performance ‚Äî you're unstoppable!</span>
        `;
        launchConfetti();
    } else if (percent >= 80) {
        completionMsg.textContent = `${name}, almost there ‚Äî finish like a boss! üî•`;
    } else if (percent >= 50) {
        completionMsg.textContent = `Great momentum, ${name} ‚Äî keep winning!`;
    } else {
        completionMsg.textContent = `Solid start, ${name} ‚Äî you've got this!`;
    }
}

function pickRandom(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

updateSetupDisplays();
updateProgress();
    // Scrolling Quote Arrows + Auto-Scroll
    const scroller = document.getElementById('quote-scroller');
    const scrollLeft = document.getElementById('scroll-left');
    const scrollRight = document.getElementById('scroll-right');

    if (scroller && scrollLeft && scrollRight) {
        // Manual scroll on arrow click
        scrollLeft.addEventListener('click', () => {
            scroller.scrollBy({ left: -400, behavior: 'smooth' });
        });

        scrollRight.addEventListener('click', () => {
            scroller.scrollBy({ left: 400, behavior: 'smooth' });
        });

        // Auto-scroll forward every 12 seconds if not hovered
        setInterval(() => {
            if (!scroller.matches(':hover')) {
                scroller.scrollBy({ left: 400, behavior: 'smooth' });
            }
        }, 12000);
    }
    // Weekly Win Plan buttons + checkbox delegation (safe, no duplicates)
document.addEventListener('DOMContentLoaded', () => {
    // Edit/View Change Plan Details
    const editBtn = document.getElementById('edit-setup-btn');
    if (editBtn) editBtn.addEventListener('click', openSetupWizard);

    // Build My Personalized Win Plan
    const generateBtn = document.getElementById('generate-win-plan-btn');
    if (generateBtn) generateBtn.addEventListener('click', generateWeeklyPlan);

    // Save Setup (if exists)
    const saveBtn = document.getElementById('save-setup-btn');
    if (saveBtn) saveBtn.addEventListener('click', saveSetup);

    // Checkbox progress update (dynamic cards)
    const tasksContainer = document.getElementById('weekly-tasks-container');
    if (tasksContainer) {
        tasksContainer.addEventListener('change', (e) => {
            if (e.target.type === 'checkbox') updateProgress();
        });
    }

    // Initial calls
    updateSetupDisplays();
    updateProgress();
});
</script>
<script>
// === Newsletter Generator: Magical, Persistent, Grok-Powered ===
// Auto-load/save all inputs, generate with fresh local content, beautiful outputs

// Load saved values on start
document.addEventListener('DOMContentLoaded', () => {
    const fields = [
        'nl-audience', 'nl-frequency', 'nl-tone', 'nl-location', 
        'nl-name', 'nl-headshot', 'nl-logo', 'nl-signature', 
        'nl-facebook', 'nl-instagram', 'nl-linkedin', 
        'nl-youtube', 'nl-x', 'nl-google', 'nl-length',
        'nl-title', 'nl-cell', 'nl-email'  // All here ‚Äî one source of truth
    ];

    fields.forEach(id => {
        const saved = localStorage.getItem(id);
        if (saved) document.getElementById(id).value = saved;
    });

    const checkboxes = ['nl-market', 'nl-industry', 'nl-local', 'nl-recipes', 'nl-fun', 'nl-tip', 'nl-quote', 'nl-rate', 'nl-personal', 'nl-referral'];
    const savedChecks = JSON.parse(localStorage.getItem('nl_sections') || '[]');
    checkboxes.forEach(id => {
        if (savedChecks.includes(id)) document.getElementById(id).checked = true;
    const savedLength = localStorage.getItem('nl-length');
    if (savedLength) document.getElementById('nl-length').value = savedLength;
    });

    togglePersonalSection();
});

// Auto-save on change
document.querySelectorAll('#newsletter-generator input, #newsletter-generator select').forEach(el => {
    el.addEventListener('change', () => {
        if (el.type === 'checkbox') {
            const checked = Array.from(document.querySelectorAll('#newsletter-generator input[type="checkbox"]:checked')).map(c => c.id);
            localStorage.setItem('nl_sections', JSON.stringify(checked));
        } else {
            localStorage.setItem(el.id, el.value);
        }
        togglePersonalSection();
    });
});

// Show/hide personal update
function openNewsletterTips() {
    const modal = document.getElementById('newsletter-tips-modal');
    if (modal) {
        modal.style.display = 'flex';  // Shows modal (flex for centering)
    }
}

function closeNewsletterTips() {
    const modal = document.getElementById('newsletter-tips-modal');
    if (modal) {
        modal.style.display = 'none';
    }
}

// Optional: Close on Escape key (nice UX)
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeNewsletterTips();
    }
});

// === FULL REPLACEMENT: Newsletter Generate Button Listener (Safe, Offline-Friendly, No Errors) ===
document.getElementById('generate-newsletter-btn')?.addEventListener('click', async () => {
    const loading = document.getElementById('newsletter-loading');
    if (loading) loading.classList.remove('hidden');

    let html = '';

    try {
        // Build sections list
        const sections = Array.from(document.querySelectorAll('#newsletter-generator input[type="checkbox"]:checked'))
                         .map(c => c.id.replace('nl-', ''))
                         .join(', ');

        // Your full prompt (use the latest version from previous message)
        const prompt = `You are a world-class email designer. Create ONE newsletter using this EXACT template ‚Äî fill content only, NEVER change structure/layout or images.

User Inputs:
- Audience: ${document.getElementById('nl-audience').value || 'Full Database'}
- Frequency: ${document.getElementById('nl-frequency').value || 'Weekly'}
- Tone: ${document.getElementById('nl-tone').value || 'Professional'}
- Location: ${document.getElementById('nl-location').value || 'Fort Wayne, Indiana'}
- Title: ${document.getElementById('nl-title').value || 'Mortgage Insights | January 2026'}
- Length: ${document.getElementById('nl-length').value || 'medium'}
- Sections: ${sections || 'Market Update, Industry News, Local Spotlight, Quick Recipe'}
- Personal update: """${document.getElementById('nl-personal-text').value || 'Excited to help more families achieve homeownership this year!'}"""
- Specific topics: """${document.getElementById('nl-specific').value || 'None'}"""

Branding:
- Name: ${document.getElementById('nl-name').value || 'Your Loan Officer'}
- Headshot URL: ${document.getElementById('nl-headshot').value || 'https://via.placeholder.com/120x160/002B5C/FFFFFF?text=Headshot'}
- Logo URL: ${document.getElementById('nl-logo').value || ''}
- Cell: ${document.getElementById('nl-cell').value || ''}
- Email: ${document.getElementById('nl-email').value || ''}
- Signature (NMLS number): ${document.getElementById('nl-signature').value || ''}

CRITICAL RULES: Follow these above all else) 
- HERO IMAGE: Find an image of a gorgeous midwestern home with a working link and use that for the header hero image. 
- CONFIRM WORKING HERO IMAGE LINK
- HEADSHOT: Vertical oval ‚Äî 120x160px, border-radius 50%/40%, object-fit:cover.
- PERSONAL UPDATE: Always rewrite/polish the raw input ‚Äî make it warm, relatable, newsletter-perfect (never raw paste).
- ALL EXTERNAL LINKS: target="_blank" rel="noopener".
- DOUBLE CHECK ALL CONTENT: Accuracy is of utmost importance. Verify content with at least 2 sources. 
- NO separate "Personal Note" or "Referral Time" sections ‚Äî personal update ALWAYS in signature, referral CTA ALWAYS at bottom.
- ONLY ONE IMAGE: Hero beautiful winter Midwest home.Compliance: No specific rates, disclaimer in footer.
- Content: Fresh from the most recent month, source links.

OUTPUT ONLY complete standalone HTML:

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Title]</title>
    <style>
        body { margin:0; background:#f4f4f4; font-family:Arial,sans-serif; }
        .container { max-width:600px; margin:0 auto; background:white; }
        .header { text-align:center; padding:40px 20px; background:white; }
        .hero img { width:100%; height:auto; display:block; }
        .section { padding:30px; border-left:8px solid #00A89D; margin:20px; background:#f9f9f9; box-shadow:0 4px 12px rgba(0,0,0,0.05); }
        .section h2 { color:#002B5C; font-size:26px; margin:0 0 20px; }
        .signature { padding:20px; background:white; display:flex; align-items:center; gap:50px; flex-wrap:wrap; }
        .headshot { 
            width:120px; 
            height:160px; 
            border-radius:50%/40%; 
            border:5px solid #00A89D; 
            object-fit:cover; 
        }
        .signature-text { flex:1; min-width:300px; }
        .cta { text-align:center; padding:20px; background:white; }
        .cta-button { background:#F15A29; color:white; padding:20px 44px; border-radius:30px; font-weight:bold; text-decoration:none; font-size:20px; display:inline-block; }
        .footer { padding:30px; background:#002B5C; color:white; text-align:center; font-size:14px; }
        a { color:#00A89D; text-decoration:underline; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            [Logo centered if provided]
            <h1 style="color:#002B5C; font-size:36px;">[Title]</h1>
            <p style="color:#666;">Weekly Insights from [Location] | January 2026</p>
        </div>
        <div class="hero">
            [ONE beautiful winter Midwest home image full-width]
        </div>
        [Main section cards ‚Äî only the checked sections]
        <div class="signature">
            <img src="[Headshot URL]" alt="[Name]" class="headshot">
            <div class="signature-text">
                <h2 style="color:#002B5C; font-size:28px; margin:0;">From [Name]</h2>
                <p style="margin:15px 0; font-size:18px;">[Polished personal update]</p>
                [If Signature provided: <p>NMLS # [Signature]</p>]
                <p style="margin:10px 0; font-size:16px;">
                    <a href="tel:[Cell]">[Cell]</a> | <a href="mailto:[Email]">[Email]</a>
                </p>
                <div class="social-icons">
                    [If Facebook: <a href="[Facebook URL]" target="_blank"><i class="fab fa-facebook"></i> Facebook</a>]
                    [If Instagram: <a href="[Instagram URL]" target="_blank"><i class="fab fa-instagram"></i> Instagram</a>]
                    [If LinkedIn: <a href="[LinkedIn URL]" target="_blank"><i class="fab fa-linkedin"></i> LinkedIn</a>]
                    [If YouTube: <a href="[YouTube URL]" target="_blank"><i class="fab fa-youtube"></i> YouTube</a>]
                    [If X: <a href="[X URL]" target="_blank"><i class="fab fa-twitter"></i> X</a>]
                    [If Google: <a href="[Google URL]" target="_blank"><i class="fab fa-google"></i> Google</a>]
                </div>
            </div>
        </div>
        <div class="cta">
            <h2 style="color:#002B5C; font-size:28px;">Know Someone Ready to Buy or Refinance?</h2>
            <p style="font-size:18px; margin:20px 0;">I'd love to help ‚Äî forward this or click below!</p>
            <a href="mailto:[Email]?subject=Referral from a Friend ‚Äî Ready for Mortgage Help!&body=Hi [Name],%0A%0AI'd like to refer someone who's interested in mortgage options.%0A%0AName: %0APhone: %0AEmail: %0AThey're looking for: (buying / refinancing / other)%0A%0AThanks!%0A%0A[Sender Name]" class="cta-button">Send Me a Referral</a>
            <p style="margin-top:20px; font-size:16px;">Or text/call: <a href="tel:[Cell]">[Cell]</a></p>
        </div>
        <div class="footer">
            <p>Rates and programs subject to change. Contact me for personalized quote.</p>
        </div>
    </div>
</body>
</html>`;
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
              },
            body: JSON.stringify({
                model: "grok-4-1-fast-reasoning",
                messages: [{ role: "user", content: prompt }],
                temperature: 0.8,
                max_tokens: 3000
            })
        });

        if (!response.ok) throw new Error('API failed');

        const data = await response.json();
        let fullContent = data.choices[0]?.message?.content?.trim() || '';

        // === AGGRESSIVE CLEANING: Pure HTML only ===
        // Strip everything before HTML start
        const htmlStart = fullContent.search(/<!DOCTYPE html|<html/i);
        if (htmlStart !== -1) {
            fullContent = fullContent.substring(htmlStart);
        }

        // Strip everything after </html>
        const htmlEnd = fullContent.toLowerCase().indexOf('</html>');
        if (htmlEnd !== -1) {
            fullContent = fullContent.substring(0, htmlEnd + 7);
        }

        // Remove fences/prefix
        fullContent = fullContent.replace(/^html\s*/i, '').trim();
        fullContent = fullContent.replace(/^```html?\s*/i, '').trim();
        fullContent = fullContent.replace(/^```\s*/g, '').trim();
        fullContent = fullContent.replace(/```$/g, '').trim();

        // Wrap if missing doctype
        if (!fullContent.toLowerCase().startsWith('<!doctype') && !fullContent.toLowerCase().startsWith('<html')) {
            fullContent = `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Newsletter</title></head><body>${fullContent}</body></html>`;
        }

        html = fullContent || '<p>Newsletter content coming soon!</p>';

        // === FORCE HERO IMAGE (always visible) ===
        if (!html.includes('class="hero"')) {
            const heroHTML = `<div class="hero">
                <img src="https://images.unsplash.com/photo-1605142619858-7e3c3e0d0e8e?auto=format&fit=crop&w=1200&q=80" alt="Beautiful winter Midwest home" style="width:100%;height:auto;display:block;">
            </div>`;
            html = html.replace(/<\/div>\s*<\/div>/i, '</div></div>' + heroHTML);  // After header
        }

    } catch (err) {
        console.log('Generation failed ‚Äî using beautiful fallback');

        html = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fort Wayne Mortgage Weekly</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; background: #f4f4f4; }
        .container { max-width: 600px; margin: 20px auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .header { text-align: center; padding: 40px 20px; background: linear-gradient(to bottom, #002B5C, #001429); color: white; }
        .hero img { width: 100%; height: auto; display: block; }
        .section { padding: 30px; border-left: 8px solid #00A89D; background: #f9f9f9; margin: 20px; border-radius: 8px; }
        .section h2 { color: #002B5C; font-size: 26px; margin: 0 0 20px; }
        .signature { padding: 40px; background: white; display: flex; align-items: center; gap: 30px; }
        .headshot { width: 120px; height: 120px; border-radius: 50%; border: 4px solid #00A89D; }
        .cta { text-align: center; padding: 40px; background: white; }
        .cta-button { background: #F15A29; color: white; padding: 18px 40px; border-radius: 30px; font-weight: bold; text-decoration: none; font-size: 18px; }
        .footer { padding: 30px; background: #002B5C; color: white; text-align: center; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Fort Wayne Mortgage Weekly</h1>
            <p>January 2026 | Insights from Adam Garman</p>
        </div>
        <div class="hero">
            <img src="https://images.unsplash.com/photo-1605142619858-7e3c3e0d0e8e?auto=format&fit=crop&w=1200&q=80" alt="Beautiful winter home">
        </div>
        <div class="section">
            <h2>Market Update</h2>
            <p>Rates trending lower ‚Äî improved affordability heading into spring. Local inventory steady.</p>
        </div>
        <div class="section">
            <h2>Local Spotlight</h2>
            <p>Fort Wayne winter events heating up ‚Äî don't miss the ice festival!</p>
        </div>
        <div class="section">
            <h2>Quick Recipe</h2>
            <p>Cozy chili for cold nights ‚Äî perfect comfort food.</p>
        </div>
        <div class="signature">
            <img src="https://via.placeholder.com/120?text=Adam" class="headshot" alt="Adam Garman">
            <div>
                <h2>From Adam</h2>
                <p>Excited for a fresh start to 2026 in snowy Fort Wayne!</p>
                <p>260-348-0905 | adam@ruoff.com</p>
            </div>
        </div>
        <div class="cta">
            <h2>Know Someone Ready to Buy or Refinance?</h2>
            <p>I'd love to help ‚Äî forward this or click below!</p>
            <a href="mailto:adam@ruoff.com?subject=Referral" class="cta-button">Send Me a Referral</a>
        </div>
        <div class="footer">
            <p>Rates subject to change. Contact me for details.</p>
        </div>
    </div>
</body>
</html>`;
    } finally {
    if (loading) loading.classList.add('hidden');

    const previewEl = document.getElementById('nl-preview');
    if (previewEl) {
        previewEl.innerHTML = `
            <div class="bg-white text-gray-900 rounded-2xl shadow-2xl overflow-hidden">
                ${html}
            </div>
        `;
    }

    const rawEl = document.getElementById('nl-html-raw');
    if (rawEl) rawEl.value = html;

    const output = document.getElementById('newsletter-output');
    if (output) {
        output.classList.remove('hidden');
        output.scrollIntoView({ behavior: 'smooth' });
    }

    if (typeof confetti === 'function') {
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
    }
}
});

// Copy functions
function copyNewsletterHTML() {
    navigator.clipboard.writeText(document.getElementById('nl-html-raw').value);
    alert('HTML copied! Paste into your email platform.');
}

function downloadNewsletterHTML() {
    const html = document.getElementById('nl-html-raw').value;
    const blob = new Blob([html], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `newsletter_${new Date().toISOString().slice(0,10)}.html`;
    a.click();
    URL.revokeObjectURL(url);
    alert('Newsletter downloaded! Double-click the file to preview.');
}

</script>
<script>

document.addEventListener('DOMContentLoaded', () => {
    // === STEP 1: LOAD SAVED VALUES ===
    // Text / Number / Select inputs (by ID)
    const singleFields = [
        'setup-name',              // Your Name
        'setup-monthly-goal',      // Monthly Funded Loan Goal
        'setup-last-month',        // Last Month Funded
        'setup-partners',          // Active Referral Partners
        'setup-past-clients',      // Past Client Database Size
        'setup-hours',             // Weekly Prospecting Hours
        'setup-focus',             // Primary Focus (select or radio group)
        'setup-hobbies-other'      // Other Passions text box
    ];

    singleFields.forEach(id => {
        const el = document.getElementById(id);
        if (el) {
            const saved = localStorage.getItem('winPlan_' + id);
            if (saved !== null) {
                el.value = saved;
            }
        }
    });

    // Hobby Checkboxes (class="hobby-checkbox")
    const savedHobbies = JSON.parse(localStorage.getItem('winPlan_hobbies') || '[]');
    document.querySelectorAll('.hobby-checkbox').forEach(cb => {
        if (savedHobbies.includes(cb.value)) {
            cb.checked = true;
        }
    });

    // Preferred Activity Checkboxes (class="activity-checkbox")
    const savedActivities = JSON.parse(localStorage.getItem('winPlan_activities') || '[]');
    document.querySelectorAll('.activity-checkbox').forEach(cb => {
        if (savedActivities.includes(cb.value)) {
            cb.checked = true;
        }
    });

    // Optional: Visual feedback that setup loaded
    const anySaved = singleFields.some(id => localStorage.getItem('winPlan_' + id) !== null) ||
                     savedHobbies.length > 0 || savedActivities.length > 0;
    if (anySaved) {
        // You can replace alert with a toast/div if you want something prettier
        console.log('‚úÖ Weekly Win Plan setup auto-loaded from previous session');
        // alert('‚úÖ Your setup auto-loaded from last time!');
    }
});

// === STEP 2: AUTO-SAVE ON EVERY CHANGE ===
(function autoSaveSetup() {
    // Helper to save a single field
    function saveField(id) {
        const el = document.getElementById(id);
        if (el) {
            localStorage.setItem('winPlan_' + id, el.value || '');
        }
    }

    // Text/Number/Select fields ‚Äî save on 'change' (when user finishes editing)
    const singleFields = [
        'setup-name',
        'setup-monthly-goal',
        'setup-last-month',
        'setup-partners',
        'setup-past-clients',
        'setup-hours',
        'setup-focus',
        'setup-hobbies-other'
    ];

    singleFields.forEach(id => {
        const el = document.getElementById(id);
        if (el) {
            el.addEventListener('change', () => saveField(id));
            // Optional: Also save live while typing for text fields
            if (el.type === 'text') {
                el.addEventListener('input', () => saveField(id));
            }
        }
    });

    // Hobby Checkboxes ‚Äî save entire array on any change
    document.querySelectorAll('.hobby-checkbox').forEach(cb => {
        cb.addEventListener('change', () => {
            const checked = Array.from(document.querySelectorAll('.hobby-checkbox:checked'))
                                 .map(c => c.value);
            localStorage.setItem('winPlan_hobbies', JSON.stringify(checked));
        });
    });

    // Preferred Activity Checkboxes ‚Äî save entire array on any change
    document.querySelectorAll('.activity-checkbox').forEach(cb => {
        cb.addEventListener('change', () => {
            const checked = Array.from(document.querySelectorAll('.activity-checkbox:checked'))
                                 .map(c => c.value);
            localStorage.setItem('winPlan_activities', JSON.stringify(checked));
        });
    });

    console.log('üîÑ Weekly Win Plan auto-save enabled ‚Äî changes save instantly');
})();
</script>
<script>
// Reliable listener for Social Post generate button (paste at very bottom, before </body>)
document.addEventListener('DOMContentLoaded', () => {
    // Find button by inline onclick (works even without ID)
    const generateBtn = document.querySelector('button[onclick="generateSocialPost()"]');

    if (generateBtn) {
        generateBtn.addEventListener('click', generateSocialPost);
        console.log('Social Post generate button listener attached successfully');
    } else {
        console.warn('Social Post generate button not found ‚Äî check inline onclick');
    }
});
</script>
</body>
</html>

